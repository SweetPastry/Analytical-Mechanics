{"_id":"magic-string-stack","_rev":"3-8bd13dad8878ac9da1bf3839ebf08af0","name":"magic-string-stack","dist-tags":{"latest":"0.1.1"},"versions":{"0.0.0":{"name":"magic-string-stack","type":"module","version":"0.0.0","packageManager":"pnpm@8.15.3","description":"Magic string stacking","author":{"name":"Anthony Fu","email":"anthonyfu117@hotmail.com"},"license":"MIT","funding":"https://github.com/sponsors/antfu","homepage":"https://github.com/antfu/magic-string-stack#readme","repository":{"type":"git","url":"git+https://github.com/antfu/magic-string-stack.git"},"bugs":{"url":"https://github.com/antfu/magic-string-stack/issues"},"keywords":[],"sideEffects":false,"exports":{".":{"types":"./dist/index.d.ts","import":"./dist/index.mjs","require":"./dist/index.cjs"}},"main":"./dist/index.mjs","module":"./dist/index.mjs","types":"./dist/index.d.ts","typesVersions":{"*":{"*":["./dist/*","./dist/index.d.ts"]}},"scripts":{"build":"unbuild","dev":"unbuild --stub","lint":"eslint .","prepublishOnly":"nr build","release":"bumpp && npm publish","start":"esno src/index.ts","test":"vitest","typecheck":"tsc --noEmit","prepare":"simple-git-hooks"},"devDependencies":{"@antfu/eslint-config":"^2.6.4","@antfu/ni":"^0.21.12","@antfu/utils":"^0.7.7","@types/node":"^20.11.19","bumpp":"^9.3.0","eslint":"^8.56.0","esno":"^4.0.0","lint-staged":"^15.2.2","pnpm":"^8.15.3","rimraf":"^5.0.5","simple-git-hooks":"^2.9.0","typescript":"^5.3.3","unbuild":"^2.0.0","vite":"^5.1.4","vitest":"^1.3.1"},"simple-git-hooks":{"pre-commit":"pnpm lint-staged"},"lint-staged":{"*":"eslint --fix"},"_id":"magic-string-stack@0.0.0","gitHead":"e3a399213757a07c8c391cf143c78b61ca53b8aa","_nodeVersion":"20.11.1","_npmVersion":"10.2.4","dist":{"integrity":"sha512-BD913XaND4USmgt1LUSIeVaxhGsE/ApJ/jfrH+DnE2wEDdwoltMH4DXySwD1ouj4W7Ti04jP5PmsKxrzv5yr0w==","shasum":"36895a833f9a22cfdfb77fa48fa44f208b60f622","tarball":"https://registry.npmjs.org/magic-string-stack/-/magic-string-stack-0.0.0.tgz","fileCount":8,"unpackedSize":4786,"signatures":[{"keyid":"SHA256:jl3bwswu80PjjokCgh0o2w5c2U4LhQAE57gj9cz1kzA","sig":"MEUCIQD/Mv9GUAOFomgV6KPKQL6mOdedzJw+/qlFTisjEXndtQIgZD3M13MoE7qiF9WzNhpAmg1rpgmFVQknvOFo38ABmVQ="}]},"_npmUser":{"name":"antfu","email":"anthonyfu117@hotmail.com"},"directories":{},"maintainers":[{"name":"antfu","email":"anthonyfu117@hotmail.com"}],"_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/magic-string-stack_0.0.0_1713277470141_0.7744519350275929"},"_hasShrinkwrap":false},"0.0.1":{"name":"magic-string-stack","type":"module","version":"0.0.1","packageManager":"pnpm@8.15.3","description":"magic-string with the capability of committing changes","author":{"name":"Anthony Fu","email":"anthonyfu117@hotmail.com"},"license":"MIT","funding":"https://github.com/sponsors/antfu","homepage":"https://github.com/antfu/magic-string-stack#readme","repository":{"type":"git","url":"git+https://github.com/antfu/magic-string-stack.git"},"bugs":{"url":"https://github.com/antfu/magic-string-stack/issues"},"keywords":[],"sideEffects":false,"exports":{".":{"types":"./dist/index.d.ts","import":"./dist/index.mjs","require":"./dist/index.cjs"}},"main":"./dist/index.mjs","module":"./dist/index.mjs","types":"./dist/index.d.ts","typesVersions":{"*":{"*":["./dist/*","./dist/index.d.ts"]}},"scripts":{"build":"unbuild","dev":"unbuild --stub","lint":"eslint .","prepublishOnly":"nr build","release":"bumpp && npm publish","start":"esno src/index.ts","test":"vitest","typecheck":"tsc --noEmit","prepare":"simple-git-hooks"},"dependencies":{"@ampproject/remapping":"^2.3.0","magic-string":"^0.30.9"},"devDependencies":{"@antfu/eslint-config":"^2.6.4","@antfu/ni":"^0.21.12","@antfu/utils":"^0.7.7","@types/node":"^20.11.19","bumpp":"^9.3.0","eslint":"^8.56.0","esno":"^4.0.0","lint-staged":"^15.2.2","pnpm":"^8.15.3","rimraf":"^5.0.5","simple-git-hooks":"^2.9.0","typescript":"^5.3.3","unbuild":"^2.0.0","vite":"^5.1.4","vitest":"^1.3.1"},"simple-git-hooks":{"pre-commit":"pnpm lint-staged"},"lint-staged":{"*":"eslint --fix"},"_id":"magic-string-stack@0.0.1","gitHead":"8773f54197d6a893c378ba1a78c79ccb5cfb0a70","_nodeVersion":"20.11.1","_npmVersion":"10.2.4","dist":{"integrity":"sha512-ub/EtN3uP9veDfIu3HkD+m3eoVpuROrclFyFImb2GUp1rXreXngdfdvT0yAgD4MwuqOijK/2q4JwaZx5X0uTGg==","shasum":"4e5f89885c5cadf3d39292132b7a75bac35fdaab","tarball":"https://registry.npmjs.org/magic-string-stack/-/magic-string-stack-0.0.1.tgz","fileCount":8,"unpackedSize":13897,"signatures":[{"keyid":"SHA256:jl3bwswu80PjjokCgh0o2w5c2U4LhQAE57gj9cz1kzA","sig":"MEUCIQDrXzCoxDJMi5vXkWyUpyhq13jDx23X0NYIeXytcGuX9gIgRr8k1GNYcw0f23cxi7e7+BGQC2nuzYbMcS5rTIY8QhU="}]},"_npmUser":{"name":"antfu","email":"anthonyfu117@hotmail.com"},"directories":{},"maintainers":[{"name":"antfu","email":"anthonyfu117@hotmail.com"}],"_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/magic-string-stack_0.0.1_1713283117719_0.9587850011461863"},"_hasShrinkwrap":false},"0.1.0":{"name":"magic-string-stack","type":"module","version":"0.1.0","packageManager":"pnpm@9.0.1","description":"magic-string with the capability of committing changes","author":{"name":"Anthony Fu","email":"anthonyfu117@hotmail.com"},"license":"MIT","funding":"https://github.com/sponsors/antfu","homepage":"https://github.com/antfu/magic-string-stack#readme","repository":{"type":"git","url":"git+https://github.com/antfu/magic-string-stack.git"},"bugs":{"url":"https://github.com/antfu/magic-string-stack/issues"},"keywords":["magic-string","sourcemap"],"sideEffects":false,"exports":{".":{"types":"./dist/index.d.ts","import":"./dist/index.mjs","require":"./dist/index.cjs"}},"main":"./dist/index.mjs","module":"./dist/index.mjs","types":"./dist/index.d.ts","typesVersions":{"*":{"*":["./dist/*","./dist/index.d.ts"]}},"scripts":{"build":"unbuild","dev":"unbuild --stub","lint":"eslint .","prepublishOnly":"nr build","release":"bumpp && npm publish","start":"esno src/index.ts","test":"vitest","typecheck":"tsc --noEmit","prepare":"simple-git-hooks"},"dependencies":{"@ampproject/remapping":"^2.3.0","magic-string":"^0.30.9"},"devDependencies":{"@antfu/eslint-config":"^2.14.0","@antfu/ni":"^0.21.12","@antfu/utils":"^0.7.7","@types/node":"^20.12.7","bumpp":"^9.4.0","eslint":"^9.0.0","esno":"^4.7.0","lint-staged":"^15.2.2","pnpm":"^9.0.1","rimraf":"^5.0.5","simple-git-hooks":"^2.11.1","typescript":"^5.4.5","unbuild":"^2.0.0","vite":"^5.2.9","vitest":"^1.5.0"},"simple-git-hooks":{"pre-commit":"pnpm lint-staged"},"lint-staged":{"*":"eslint --fix"},"_id":"magic-string-stack@0.1.0","gitHead":"1028d293b86a16fea9e10e46c0c434c8a556cc81","_nodeVersion":"20.11.1","_npmVersion":"10.2.4","dist":{"integrity":"sha512-T8jHkTVCnA/zFFtJ2JaxDmB+kT+YSKcXMzZlzuOWuxeFEZiPMxDBDEhzH/488OHL1uqbukeVWk48exikvLftpQ==","shasum":"3615047db6aeabef4f532f08dd078d37350d12d2","tarball":"https://registry.npmjs.org/magic-string-stack/-/magic-string-stack-0.1.0.tgz","fileCount":8,"unpackedSize":17418,"signatures":[{"keyid":"SHA256:jl3bwswu80PjjokCgh0o2w5c2U4LhQAE57gj9cz1kzA","sig":"MEYCIQDptDFVQaxaLAWBjs/CTrz0fn6CW/psQygziyHrRqN6qAIhAOutM+xoHYfCDOIY8SwhBt+NR8jFXrRLNKusIKb9Gb4L"}]},"_npmUser":{"name":"antfu","email":"anthonyfu117@hotmail.com"},"directories":{},"maintainers":[{"name":"antfu","email":"anthonyfu117@hotmail.com"}],"_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/magic-string-stack_0.1.0_1713340802240_0.6800144363508172"},"_hasShrinkwrap":false},"0.1.1":{"name":"magic-string-stack","type":"module","version":"0.1.1","packageManager":"pnpm@9.0.1","description":"magic-string with the capability of committing changes","author":{"name":"Anthony Fu","email":"anthonyfu117@hotmail.com"},"license":"MIT","funding":"https://github.com/sponsors/antfu","homepage":"https://github.com/antfu/magic-string-stack#readme","repository":{"type":"git","url":"git+https://github.com/antfu/magic-string-stack.git"},"bugs":{"url":"https://github.com/antfu/magic-string-stack/issues"},"keywords":["magic-string","sourcemap"],"sideEffects":false,"exports":{".":{"types":"./dist/index.d.ts","import":"./dist/index.mjs","require":"./dist/index.cjs"}},"main":"./dist/index.mjs","module":"./dist/index.mjs","types":"./dist/index.d.ts","typesVersions":{"*":{"*":["./dist/*","./dist/index.d.ts"]}},"scripts":{"build":"unbuild","dev":"unbuild --stub","lint":"eslint .","prepublishOnly":"nr build","release":"bumpp && npm publish","start":"esno src/index.ts","test":"vitest","typecheck":"tsc --noEmit","prepare":"simple-git-hooks"},"dependencies":{"@ampproject/remapping":"^2.3.0","magic-string":"^0.30.10"},"devDependencies":{"@antfu/eslint-config":"^2.14.0","@antfu/ni":"^0.21.12","@antfu/utils":"^0.7.7","@types/node":"^20.12.7","bumpp":"^9.4.0","eslint":"^9.0.0","esno":"^4.7.0","lint-staged":"^15.2.2","pnpm":"^9.0.1","rimraf":"^5.0.5","simple-git-hooks":"^2.11.1","typescript":"^5.4.5","unbuild":"^2.0.0","vite":"^5.2.9","vitest":"^1.5.0"},"simple-git-hooks":{"pre-commit":"pnpm lint-staged"},"lint-staged":{"*":"eslint --fix"},"_id":"magic-string-stack@0.1.1","gitHead":"d7c45b4ae1a373b5b4d5b58f0cea49a64258233c","_nodeVersion":"20.11.1","_npmVersion":"10.2.4","dist":{"integrity":"sha512-TnOt1Dui/lM8Jrh7B+lGPPfNcczr6gUlFOJ8Calqs1KAuEn8NFab67vXz3F9cetX9YLJeQrEycjz2z0Wj90taw==","shasum":"1f07e7c4d98b5ce7f8c9b4f959b9db32194e57b5","tarball":"https://registry.npmjs.org/magic-string-stack/-/magic-string-stack-0.1.1.tgz","fileCount":8,"unpackedSize":18107,"signatures":[{"keyid":"SHA256:jl3bwswu80PjjokCgh0o2w5c2U4LhQAE57gj9cz1kzA","sig":"MEQCIAtKheo7hWIXu4o9spNx/aPoBw+5oPZdXG1uUA9iK3NdAiAOmqBIPNn2+BYWZ3qL7oUvrrv+I5oXnKPtw2xshGUVUA=="}]},"_npmUser":{"name":"antfu","email":"anthonyfu117@hotmail.com"},"directories":{},"maintainers":[{"name":"antfu","email":"anthonyfu117@hotmail.com"}],"_npmOperationalInternal":{"host":"s3://npm-registry-packages","tmp":"tmp/magic-string-stack_0.1.1_1713373368647_0.5216940363489222"},"_hasShrinkwrap":false}},"time":{"created":"2024-04-16T14:24:30.139Z","0.0.0":"2024-04-16T14:24:30.281Z","modified":"2024-04-17T17:02:49.023Z","0.0.1":"2024-04-16T15:58:37.869Z","0.1.0":"2024-04-17T08:00:02.477Z","0.1.1":"2024-04-17T17:02:48.834Z"},"maintainers":[{"name":"antfu","email":"anthonyfu117@hotmail.com"}],"description":"magic-string with the capability of committing changes","homepage":"https://github.com/antfu/magic-string-stack#readme","keywords":["magic-string","sourcemap"],"repository":{"type":"git","url":"git+https://github.com/antfu/magic-string-stack.git"},"author":{"name":"Anthony Fu","email":"anthonyfu117@hotmail.com"},"bugs":{"url":"https://github.com/antfu/magic-string-stack/issues"},"license":"MIT","readme":"# magic-string-stack\n\n[![npm version][npm-version-src]][npm-version-href]\n[![npm downloads][npm-downloads-src]][npm-downloads-href]\n[![bundle][bundle-src]][bundle-href]\n[![JSDocs][jsdocs-src]][jsdocs-href]\n[![License][license-src]][license-href]\n\n[`magic-string`](https://github.com/rich-harris/magic-string) with the capability of committing changes.\n\nOne of the great features of MagicString is that it always relates to the original string positions. However, in some cases, you want to make changes on top of the previously changed string. Usually, you will need to create a new `MagicString` instance and apply the changes again, which then will end up with multiple sourcemaps that you also need to combine manually. This package makes it magically work on a single instance and generate a single auto-combined sourcemap.\n\nThis package extends `MagicString` class by adding two methods `.commit()` and `.rollback()`. Under the hood, it also proxies all the operations methods.\n\n## Usage\n\n### `.commit()`\n\nCommit all the changes made so far to MagicString. `s.original` will become the current transformed result. And the positions will now be based on the new string. Under the hood, it creates a new `MagicString` instance and swaps all the methods to the new instance.\n\n### `.rollback()`\n\nRollback to the state before the last commit. It throws an error if there is no previous commit.\n\n### `.generateMap()`\n\nSupercharge the original `generateMap` method. Where there are multiple commits, it will generate a combined sourcemap using [`@ampproject/remapping`](https://github.com/ampproject/remapping).\n\n### Example\n\n```ts\nimport MagicStringStack from 'magic-string-stack'\n\nconst s = new MagicStringStack('problems = 99')\n\ns.replace('problems', 'issues')\n  .prepend('var ')\n\ns.toString() // 'var issues = 99'\ns.original // 'problems = 99' (original string)\n\ns.commit() // this will commit the changes\n\ns.original // 'var issues = 99' (applied with previous changes)\ns.replace('issues', 'problems')\ns.toString() // 'var problems = 99'\n\ns.generateMap() // generate sourcemap, if multiple commits happend, it will generate a combined sourcemap\n```\n\n## Sponsors\n\n<p align=\"center\">\n  <a href=\"https://cdn.jsdelivr.net/gh/antfu/static/sponsors.svg\">\n    <img src='https://cdn.jsdelivr.net/gh/antfu/static/sponsors.svg'/>\n  </a>\n</p>\n\n## License\n\n[MIT](./LICENSE) License © 2023-PRESENT [Anthony Fu](https://github.com/antfu)\n\n<!-- Badges -->\n\n[npm-version-src]: https://img.shields.io/npm/v/magic-string-stack?style=flat&colorA=080f12&colorB=1fa669\n[npm-version-href]: https://npmjs.com/package/magic-string-stack\n[npm-downloads-src]: https://img.shields.io/npm/dm/magic-string-stack?style=flat&colorA=080f12&colorB=1fa669\n[npm-downloads-href]: https://npmjs.com/package/magic-string-stack\n[bundle-src]: https://img.shields.io/bundlephobia/minzip/magic-string-stack?style=flat&colorA=080f12&colorB=1fa669&label=minzip\n[bundle-href]: https://bundlephobia.com/result?p=magic-string-stack\n[license-src]: https://img.shields.io/github/license/antfu/magic-string-stack.svg?style=flat&colorA=080f12&colorB=1fa669\n[license-href]: https://github.com/antfu/magic-string-stack/blob/main/LICENSE\n[jsdocs-src]: https://img.shields.io/badge/jsdocs-reference-080f12?style=flat&colorA=080f12&colorB=1fa669\n[jsdocs-href]: https://www.jsdocs.io/package/magic-string-stack\n","readmeFilename":"README.md"}