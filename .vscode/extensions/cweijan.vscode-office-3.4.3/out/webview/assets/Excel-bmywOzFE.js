import{r as Ws,S as t_,Q as Gs}from"./index-Cqe1aZJu.js";import{c as Eg}from"./_commonjs-dynamic-modules-TDtrdbi3.js";import{V as r_}from"./vscode-CwuLe5yX.js";import{S as n_}from"./index-D-EvAOzf.js";import{T as i_}from"./index-CajWZa0w.js";import"./index-Zdd6VGmJ.js";import"./EllipsisOutlined-CrXYF16L.js";var Bh=function(t,r){return Bh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])},Bh(t,r)};function Me(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");Bh(t,r);function e(){this.constructor=t}t.prototype=r===null?Object.create(r):(e.prototype=r.prototype,new e)}var Y=function(){return Y=Object.assign||function(r){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(r[a]=e[a])}return r},Y.apply(this,arguments)};function nn(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(e[n[i]]=t[n[i]]);return e}function Ar(t,r,e,n){function i(a){return a instanceof e?a:new e(function(o){o(a)})}return new(e||(e=Promise))(function(a,o){function s(h){try{u(n.next(h))}catch(v){o(v)}}function l(h){try{u(n.throw(h))}catch(v){o(v)}}function u(h){h.done?a(h.value):i(h.value).then(s,l)}u((n=n.apply(t,[])).next())})}function Nr(t,r){var e={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(h){return l([u,h])}}function l(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(e=0)),e;)try{if(n=1,i&&(a=u[0]&2?i.return:u[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;switch(i=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return e.label++,{value:u[1],done:!1};case 5:e.label++,i=u[1],u=[0];continue;case 7:u=e.ops.pop(),e.trys.pop();continue;default:if(a=e.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){e=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){e.label=u[1];break}if(u[0]===6&&e.label<a[1]){e.label=a[1],a=u;break}if(a&&e.label<a[2]){e.label=a[2],e.ops.push(u);break}a[2]&&e.ops.pop(),e.trys.pop();continue}u=r.call(t,e)}catch(h){u=[6,h],i=0}finally{n=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Wr(t){var r=typeof Symbol=="function"&&Symbol.iterator,e=r&&t[r],n=0;if(e)return e.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function te(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),i,a=[],o;try{for(;(r===void 0||r-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(s){o={error:s}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return a}function pe(t,r,e){if(e||arguments.length===2)for(var n=0,i=r.length,a;n<i;n++)(a||!(n in r))&&(a||(a=Array.prototype.slice.call(r,0,n)),a[n]=r[n]);return t.concat(a||Array.prototype.slice.call(r))}function a_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var iy={exports:{}};(function(t){var r=Object.prototype.hasOwnProperty,e="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(e=!1));function i(l,u,h){this.fn=l,this.context=u,this.once=h||!1}function a(l,u,h,v,p){if(typeof h!="function")throw new TypeError("The listener must be a function");var m=new i(h,v||l,p),C=e?e+u:u;return l._events[C]?l._events[C].fn?l._events[C]=[l._events[C],m]:l._events[C].push(m):(l._events[C]=m,l._eventsCount++),l}function o(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function s(){this._events=new n,this._eventsCount=0}s.prototype.eventNames=function(){var u=[],h,v;if(this._eventsCount===0)return u;for(v in h=this._events)r.call(h,v)&&u.push(e?v.slice(1):v);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},s.prototype.listeners=function(u){var h=e?e+u:u,v=this._events[h];if(!v)return[];if(v.fn)return[v.fn];for(var p=0,m=v.length,C=new Array(m);p<m;p++)C[p]=v[p].fn;return C},s.prototype.listenerCount=function(u){var h=e?e+u:u,v=this._events[h];return v?v.fn?1:v.length:0},s.prototype.emit=function(u,h,v,p,m,C){var w=e?e+u:u;if(!this._events[w])return!1;var b=this._events[w],E=arguments.length,R,M;if(b.fn){switch(b.once&&this.removeListener(u,b.fn,void 0,!0),E){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,h),!0;case 3:return b.fn.call(b.context,h,v),!0;case 4:return b.fn.call(b.context,h,v,p),!0;case 5:return b.fn.call(b.context,h,v,p,m),!0;case 6:return b.fn.call(b.context,h,v,p,m,C),!0}for(M=1,R=new Array(E-1);M<E;M++)R[M-1]=arguments[M];b.fn.apply(b.context,R)}else{var k=b.length,L;for(M=0;M<k;M++)switch(b[M].once&&this.removeListener(u,b[M].fn,void 0,!0),E){case 1:b[M].fn.call(b[M].context);break;case 2:b[M].fn.call(b[M].context,h);break;case 3:b[M].fn.call(b[M].context,h,v);break;case 4:b[M].fn.call(b[M].context,h,v,p);break;default:if(!R)for(L=1,R=new Array(E-1);L<E;L++)R[L-1]=arguments[L];b[M].fn.apply(b[M].context,R)}}return!0},s.prototype.on=function(u,h,v){return a(this,u,h,v,!1)},s.prototype.once=function(u,h,v){return a(this,u,h,v,!0)},s.prototype.removeListener=function(u,h,v,p){var m=e?e+u:u;if(!this._events[m])return this;if(!h)return o(this,m),this;var C=this._events[m];if(C.fn)C.fn===h&&(!p||C.once)&&(!v||C.context===v)&&o(this,m);else{for(var w=0,b=[],E=C.length;w<E;w++)(C[w].fn!==h||p&&!C[w].once||v&&C[w].context!==v)&&b.push(C[w]);b.length?this._events[m]=b.length===1?b[0]:b:o(this,m)}return this},s.prototype.removeAllListeners=function(u){var h;return u?(h=e?e+u:u,this._events[h]&&o(this,h)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=e,s.EventEmitter=s,t.exports=s})(iy);var o_=iy.exports,Qd=a_(o_),Ht=1e-6,ir=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,r=arguments.length;r--;)t+=arguments[r]*arguments[r];return Math.sqrt(t)});function ay(){var t=new ir(9);return ir!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function s_(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[4],t[4]=r[5],t[5]=r[6],t[6]=r[8],t[7]=r[9],t[8]=r[10],t}function l_(t,r,e,n,i,a,o,s,l){var u=new ir(9);return u[0]=t,u[1]=r,u[2]=e,u[3]=n,u[4]=i,u[5]=a,u[6]=o,u[7]=s,u[8]=l,u}function Ot(){var t=new ir(16);return ir!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function oy(t){var r=new ir(16);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r}function to(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function u_(t,r,e,n,i,a,o,s,l,u,h,v,p,m,C,w){var b=new ir(16);return b[0]=t,b[1]=r,b[2]=e,b[3]=n,b[4]=i,b[5]=a,b[6]=o,b[7]=s,b[8]=l,b[9]=u,b[10]=h,b[11]=v,b[12]=p,b[13]=m,b[14]=C,b[15]=w,b}function Fh(t,r,e,n,i,a,o,s,l,u,h,v,p,m,C,w,b){return t[0]=r,t[1]=e,t[2]=n,t[3]=i,t[4]=a,t[5]=o,t[6]=s,t[7]=l,t[8]=u,t[9]=h,t[10]=v,t[11]=p,t[12]=m,t[13]=C,t[14]=w,t[15]=b,t}function Ol(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function sy(t,r){if(t===r){var e=r[1],n=r[2],i=r[3],a=r[6],o=r[7],s=r[11];t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=e,t[6]=r[9],t[7]=r[13],t[8]=n,t[9]=a,t[11]=r[14],t[12]=i,t[13]=o,t[14]=s}else t[0]=r[0],t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=r[1],t[5]=r[5],t[6]=r[9],t[7]=r[13],t[8]=r[2],t[9]=r[6],t[10]=r[10],t[11]=r[14],t[12]=r[3],t[13]=r[7],t[14]=r[11],t[15]=r[15];return t}function Ti(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],o=r[4],s=r[5],l=r[6],u=r[7],h=r[8],v=r[9],p=r[10],m=r[11],C=r[12],w=r[13],b=r[14],E=r[15],R=e*s-n*o,M=e*l-i*o,k=e*u-a*o,L=n*l-i*s,_=n*u-a*s,I=i*u-a*l,P=h*w-v*C,U=h*b-p*C,q=h*E-m*C,Q=v*b-p*w,J=v*E-m*w,re=p*E-m*b,ne=R*re-M*J+k*Q+L*q-_*U+I*P;return ne?(ne=1/ne,t[0]=(s*re-l*J+u*Q)*ne,t[1]=(i*J-n*re-a*Q)*ne,t[2]=(w*I-b*_+E*L)*ne,t[3]=(p*_-v*I-m*L)*ne,t[4]=(l*q-o*re-u*U)*ne,t[5]=(e*re-i*q+a*U)*ne,t[6]=(b*k-C*I-E*M)*ne,t[7]=(h*I-p*k+m*M)*ne,t[8]=(o*J-s*q+u*P)*ne,t[9]=(n*q-e*J-a*P)*ne,t[10]=(C*_-w*k+E*R)*ne,t[11]=(v*k-h*_-m*R)*ne,t[12]=(s*U-o*Q-l*P)*ne,t[13]=(e*Q-n*U+i*P)*ne,t[14]=(w*M-C*L-b*R)*ne,t[15]=(h*L-v*M+p*R)*ne,t):null}function c_(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],o=r[4],s=r[5],l=r[6],u=r[7],h=r[8],v=r[9],p=r[10],m=r[11],C=r[12],w=r[13],b=r[14],E=r[15];return t[0]=s*(p*E-m*b)-v*(l*E-u*b)+w*(l*m-u*p),t[1]=-(n*(p*E-m*b)-v*(i*E-a*b)+w*(i*m-a*p)),t[2]=n*(l*E-u*b)-s*(i*E-a*b)+w*(i*u-a*l),t[3]=-(n*(l*m-u*p)-s*(i*m-a*p)+v*(i*u-a*l)),t[4]=-(o*(p*E-m*b)-h*(l*E-u*b)+C*(l*m-u*p)),t[5]=e*(p*E-m*b)-h*(i*E-a*b)+C*(i*m-a*p),t[6]=-(e*(l*E-u*b)-o*(i*E-a*b)+C*(i*u-a*l)),t[7]=e*(l*m-u*p)-o*(i*m-a*p)+h*(i*u-a*l),t[8]=o*(v*E-m*w)-h*(s*E-u*w)+C*(s*m-u*v),t[9]=-(e*(v*E-m*w)-h*(n*E-a*w)+C*(n*m-a*v)),t[10]=e*(s*E-u*w)-o*(n*E-a*w)+C*(n*u-a*s),t[11]=-(e*(s*m-u*v)-o*(n*m-a*v)+h*(n*u-a*s)),t[12]=-(o*(v*b-p*w)-h*(s*b-l*w)+C*(s*p-l*v)),t[13]=e*(v*b-p*w)-h*(n*b-i*w)+C*(n*p-i*v),t[14]=-(e*(s*b-l*w)-o*(n*b-i*w)+C*(n*l-i*s)),t[15]=e*(s*p-l*v)-o*(n*p-i*v)+h*(n*l-i*s),t}function ly(t){var r=t[0],e=t[1],n=t[2],i=t[3],a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],h=t[9],v=t[10],p=t[11],m=t[12],C=t[13],w=t[14],b=t[15],E=r*o-e*a,R=r*s-n*a,M=r*l-i*a,k=e*s-n*o,L=e*l-i*o,_=n*l-i*s,I=u*C-h*m,P=u*w-v*m,U=u*b-p*m,q=h*w-v*C,Q=h*b-p*C,J=v*b-p*w;return E*J-R*Q+M*q+k*U-L*P+_*I}function Gr(t,r,e){var n=r[0],i=r[1],a=r[2],o=r[3],s=r[4],l=r[5],u=r[6],h=r[7],v=r[8],p=r[9],m=r[10],C=r[11],w=r[12],b=r[13],E=r[14],R=r[15],M=e[0],k=e[1],L=e[2],_=e[3];return t[0]=M*n+k*s+L*v+_*w,t[1]=M*i+k*l+L*p+_*b,t[2]=M*a+k*u+L*m+_*E,t[3]=M*o+k*h+L*C+_*R,M=e[4],k=e[5],L=e[6],_=e[7],t[4]=M*n+k*s+L*v+_*w,t[5]=M*i+k*l+L*p+_*b,t[6]=M*a+k*u+L*m+_*E,t[7]=M*o+k*h+L*C+_*R,M=e[8],k=e[9],L=e[10],_=e[11],t[8]=M*n+k*s+L*v+_*w,t[9]=M*i+k*l+L*p+_*b,t[10]=M*a+k*u+L*m+_*E,t[11]=M*o+k*h+L*C+_*R,M=e[12],k=e[13],L=e[14],_=e[15],t[12]=M*n+k*s+L*v+_*w,t[13]=M*i+k*l+L*p+_*b,t[14]=M*a+k*u+L*m+_*E,t[15]=M*o+k*h+L*C+_*R,t}function Ea(t,r,e){var n=e[0],i=e[1],a=e[2],o,s,l,u,h,v,p,m,C,w,b,E;return r===t?(t[12]=r[0]*n+r[4]*i+r[8]*a+r[12],t[13]=r[1]*n+r[5]*i+r[9]*a+r[13],t[14]=r[2]*n+r[6]*i+r[10]*a+r[14],t[15]=r[3]*n+r[7]*i+r[11]*a+r[15]):(o=r[0],s=r[1],l=r[2],u=r[3],h=r[4],v=r[5],p=r[6],m=r[7],C=r[8],w=r[9],b=r[10],E=r[11],t[0]=o,t[1]=s,t[2]=l,t[3]=u,t[4]=h,t[5]=v,t[6]=p,t[7]=m,t[8]=C,t[9]=w,t[10]=b,t[11]=E,t[12]=o*n+h*i+C*a+r[12],t[13]=s*n+v*i+w*a+r[13],t[14]=l*n+p*i+b*a+r[14],t[15]=u*n+m*i+E*a+r[15]),t}function Ku(t,r,e){var n=e[0],i=e[1],a=e[2];return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*i,t[5]=r[5]*i,t[6]=r[6]*i,t[7]=r[7]*i,t[8]=r[8]*a,t[9]=r[9]*a,t[10]=r[10]*a,t[11]=r[11]*a,t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function f_(t,r,e,n){var i=n[0],a=n[1],o=n[2],s=Math.hypot(i,a,o),l,u,h,v,p,m,C,w,b,E,R,M,k,L,_,I,P,U,q,Q,J,re,ne,ce;return s<Ht?null:(s=1/s,i*=s,a*=s,o*=s,l=Math.sin(e),u=Math.cos(e),h=1-u,v=r[0],p=r[1],m=r[2],C=r[3],w=r[4],b=r[5],E=r[6],R=r[7],M=r[8],k=r[9],L=r[10],_=r[11],I=i*i*h+u,P=a*i*h+o*l,U=o*i*h-a*l,q=i*a*h-o*l,Q=a*a*h+u,J=o*a*h+i*l,re=i*o*h+a*l,ne=a*o*h-i*l,ce=o*o*h+u,t[0]=v*I+w*P+M*U,t[1]=p*I+b*P+k*U,t[2]=m*I+E*P+L*U,t[3]=C*I+R*P+_*U,t[4]=v*q+w*Q+M*J,t[5]=p*q+b*Q+k*J,t[6]=m*q+E*Q+L*J,t[7]=C*q+R*Q+_*J,t[8]=v*re+w*ne+M*ce,t[9]=p*re+b*ne+k*ce,t[10]=m*re+E*ne+L*ce,t[11]=C*re+R*ne+_*ce,r!==t&&(t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t)}function uy(t,r,e){var n=Math.sin(e),i=Math.cos(e),a=r[4],o=r[5],s=r[6],l=r[7],u=r[8],h=r[9],v=r[10],p=r[11];return r!==t&&(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[4]=a*i+u*n,t[5]=o*i+h*n,t[6]=s*i+v*n,t[7]=l*i+p*n,t[8]=u*i-a*n,t[9]=h*i-o*n,t[10]=v*i-s*n,t[11]=p*i-l*n,t}function cy(t,r,e){var n=Math.sin(e),i=Math.cos(e),a=r[0],o=r[1],s=r[2],l=r[3],u=r[8],h=r[9],v=r[10],p=r[11];return r!==t&&(t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=a*i-u*n,t[1]=o*i-h*n,t[2]=s*i-v*n,t[3]=l*i-p*n,t[8]=a*n+u*i,t[9]=o*n+h*i,t[10]=s*n+v*i,t[11]=l*n+p*i,t}function h_(t,r,e){var n=Math.sin(e),i=Math.cos(e),a=r[0],o=r[1],s=r[2],l=r[3],u=r[4],h=r[5],v=r[6],p=r[7];return r!==t&&(t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=a*i+u*n,t[1]=o*i+h*n,t[2]=s*i+v*n,t[3]=l*i+p*n,t[4]=u*i-a*n,t[5]=h*i-o*n,t[6]=v*i-s*n,t[7]=p*i-l*n,t}function fy(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function hy(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=r[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function d_(t,r,e){var n=e[0],i=e[1],a=e[2],o=Math.hypot(n,i,a),s,l,u;return o<Ht?null:(o=1/o,n*=o,i*=o,a*=o,s=Math.sin(r),l=Math.cos(r),u=1-l,t[0]=n*n*u+l,t[1]=i*n*u+a*s,t[2]=a*n*u-i*s,t[3]=0,t[4]=n*i*u-a*s,t[5]=i*i*u+l,t[6]=a*i*u+n*s,t[7]=0,t[8]=n*a*u+i*s,t[9]=i*a*u-n*s,t[10]=a*a*u+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function v_(t,r){var e=Math.sin(r),n=Math.cos(r);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=e,t[7]=0,t[8]=0,t[9]=-e,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function p_(t,r){var e=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=0,t[2]=-e,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=e,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function g_(t,r){var e=Math.sin(r),n=Math.cos(r);return t[0]=n,t[1]=e,t[2]=0,t[3]=0,t[4]=-e,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function dy(t,r,e){var n=r[0],i=r[1],a=r[2],o=r[3],s=n+n,l=i+i,u=a+a,h=n*s,v=n*l,p=n*u,m=i*l,C=i*u,w=a*u,b=o*s,E=o*l,R=o*u;return t[0]=1-(m+w),t[1]=v+R,t[2]=p-E,t[3]=0,t[4]=v-R,t[5]=1-(h+w),t[6]=C+b,t[7]=0,t[8]=p+E,t[9]=C-b,t[10]=1-(h+m),t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function m_(t,r){var e=new ir(3),n=-r[0],i=-r[1],a=-r[2],o=r[3],s=r[4],l=r[5],u=r[6],h=r[7],v=n*n+i*i+a*a+o*o;return v>0?(e[0]=(s*o+h*n+l*a-u*i)*2/v,e[1]=(l*o+h*i+u*n-s*a)*2/v,e[2]=(u*o+h*a+s*i-l*n)*2/v):(e[0]=(s*o+h*n+l*a-u*i)*2,e[1]=(l*o+h*i+u*n-s*a)*2,e[2]=(u*o+h*a+s*i-l*n)*2),dy(t,r,e),t}function Zu(t,r){return t[0]=r[12],t[1]=r[13],t[2]=r[14],t}function Qo(t,r){var e=r[0],n=r[1],i=r[2],a=r[4],o=r[5],s=r[6],l=r[8],u=r[9],h=r[10];return t[0]=Math.hypot(e,n,i),t[1]=Math.hypot(a,o,s),t[2]=Math.hypot(l,u,h),t}function ju(t,r){var e=new ir(3);Qo(e,r);var n=1/e[0],i=1/e[1],a=1/e[2],o=r[0]*n,s=r[1]*i,l=r[2]*a,u=r[4]*n,h=r[5]*i,v=r[6]*a,p=r[8]*n,m=r[9]*i,C=r[10]*a,w=o+h+C,b=0;return w>0?(b=Math.sqrt(w+1)*2,t[3]=.25*b,t[0]=(v-m)/b,t[1]=(p-l)/b,t[2]=(s-u)/b):o>h&&o>C?(b=Math.sqrt(1+o-h-C)*2,t[3]=(v-m)/b,t[0]=.25*b,t[1]=(s+u)/b,t[2]=(p+l)/b):h>C?(b=Math.sqrt(1+h-o-C)*2,t[3]=(p-l)/b,t[0]=(s+u)/b,t[1]=.25*b,t[2]=(v+m)/b):(b=Math.sqrt(1+C-o-h)*2,t[3]=(s-u)/b,t[0]=(p+l)/b,t[1]=(v+m)/b,t[2]=.25*b),t}function y_(t,r,e,n){var i=r[0],a=r[1],o=r[2],s=r[3],l=i+i,u=a+a,h=o+o,v=i*l,p=i*u,m=i*h,C=a*u,w=a*h,b=o*h,E=s*l,R=s*u,M=s*h,k=n[0],L=n[1],_=n[2];return t[0]=(1-(C+b))*k,t[1]=(p+M)*k,t[2]=(m-R)*k,t[3]=0,t[4]=(p-M)*L,t[5]=(1-(v+b))*L,t[6]=(w+E)*L,t[7]=0,t[8]=(m+R)*_,t[9]=(w-E)*_,t[10]=(1-(v+C))*_,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function il(t,r,e,n,i){var a=r[0],o=r[1],s=r[2],l=r[3],u=a+a,h=o+o,v=s+s,p=a*u,m=a*h,C=a*v,w=o*h,b=o*v,E=s*v,R=l*u,M=l*h,k=l*v,L=n[0],_=n[1],I=n[2],P=i[0],U=i[1],q=i[2],Q=(1-(w+E))*L,J=(m+k)*L,re=(C-M)*L,ne=(m-k)*_,ce=(1-(p+E))*_,me=(b+R)*_,oe=(C+M)*I,Se=(b-R)*I,Te=(1-(p+w))*I;return t[0]=Q,t[1]=J,t[2]=re,t[3]=0,t[4]=ne,t[5]=ce,t[6]=me,t[7]=0,t[8]=oe,t[9]=Se,t[10]=Te,t[11]=0,t[12]=e[0]+P-(Q*P+ne*U+oe*q),t[13]=e[1]+U-(J*P+ce*U+Se*q),t[14]=e[2]+q-(re*P+me*U+Te*q),t[15]=1,t}function ev(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],o=e+e,s=n+n,l=i+i,u=e*o,h=n*o,v=n*s,p=i*o,m=i*s,C=i*l,w=a*o,b=a*s,E=a*l;return t[0]=1-v-C,t[1]=h+E,t[2]=p-b,t[3]=0,t[4]=h-E,t[5]=1-u-C,t[6]=m+w,t[7]=0,t[8]=p+b,t[9]=m-w,t[10]=1-u-v,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function C_(t,r,e,n,i,a,o){var s=1/(e-r),l=1/(i-n),u=1/(a-o);return t[0]=a*2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*l,t[6]=0,t[7]=0,t[8]=(e+r)*s,t[9]=(i+n)*l,t[10]=(o+a)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*a*2*u,t[15]=0,t}function vy(t,r,e,n,i){var a=1/Math.tan(r/2),o;return t[0]=a/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(n-i),t[10]=(i+n)*o,t[14]=2*i*n*o):(t[10]=-1,t[14]=-2*n),t}var w_=vy;function x_(t,r,e,n,i){var a=1/Math.tan(r/2),o;return t[0]=a/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(o=1/(n-i),t[10]=i*o,t[14]=i*n*o):(t[10]=-1,t[14]=-n),t}function b_(t,r,e,n){var i=Math.tan(r.upDegrees*Math.PI/180),a=Math.tan(r.downDegrees*Math.PI/180),o=Math.tan(r.leftDegrees*Math.PI/180),s=Math.tan(r.rightDegrees*Math.PI/180),l=2/(o+s),u=2/(i+a);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((o-s)*l*.5),t[9]=(i-a)*u*.5,t[10]=n/(e-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*e/(e-n),t[15]=0,t}function py(t,r,e,n,i,a,o){var s=1/(r-e),l=1/(n-i),u=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(r+e)*s,t[13]=(i+n)*l,t[14]=(o+a)*u,t[15]=1,t}var gy=py;function my(t,r,e,n,i,a,o){var s=1/(r-e),l=1/(n-i),u=1/(a-o);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(r+e)*s,t[13]=(i+n)*l,t[14]=a*u,t[15]=1,t}function yy(t,r,e,n){var i,a,o,s,l,u,h,v,p,m,C=r[0],w=r[1],b=r[2],E=n[0],R=n[1],M=n[2],k=e[0],L=e[1],_=e[2];return Math.abs(C-k)<Ht&&Math.abs(w-L)<Ht&&Math.abs(b-_)<Ht?Ol(t):(h=C-k,v=w-L,p=b-_,m=1/Math.hypot(h,v,p),h*=m,v*=m,p*=m,i=R*p-M*v,a=M*h-E*p,o=E*v-R*h,m=Math.hypot(i,a,o),m?(m=1/m,i*=m,a*=m,o*=m):(i=0,a=0,o=0),s=v*o-p*a,l=p*i-h*o,u=h*a-v*i,m=Math.hypot(s,l,u),m?(m=1/m,s*=m,l*=m,u*=m):(s=0,l=0,u=0),t[0]=i,t[1]=s,t[2]=h,t[3]=0,t[4]=a,t[5]=l,t[6]=v,t[7]=0,t[8]=o,t[9]=u,t[10]=p,t[11]=0,t[12]=-(i*C+a*w+o*b),t[13]=-(s*C+l*w+u*b),t[14]=-(h*C+v*w+p*b),t[15]=1,t)}function S_(t,r,e,n){var i=r[0],a=r[1],o=r[2],s=n[0],l=n[1],u=n[2],h=i-e[0],v=a-e[1],p=o-e[2],m=h*h+v*v+p*p;m>0&&(m=1/Math.sqrt(m),h*=m,v*=m,p*=m);var C=l*p-u*v,w=u*h-s*p,b=s*v-l*h;return m=C*C+w*w+b*b,m>0&&(m=1/Math.sqrt(m),C*=m,w*=m,b*=m),t[0]=C,t[1]=w,t[2]=b,t[3]=0,t[4]=v*b-p*w,t[5]=p*C-h*b,t[6]=h*w-v*C,t[7]=0,t[8]=h,t[9]=v,t[10]=p,t[11]=0,t[12]=i,t[13]=a,t[14]=o,t[15]=1,t}function E_(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function T_(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function __(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t[3]=r[3]+e[3],t[4]=r[4]+e[4],t[5]=r[5]+e[5],t[6]=r[6]+e[6],t[7]=r[7]+e[7],t[8]=r[8]+e[8],t[9]=r[9]+e[9],t[10]=r[10]+e[10],t[11]=r[11]+e[11],t[12]=r[12]+e[12],t[13]=r[13]+e[13],t[14]=r[14]+e[14],t[15]=r[15]+e[15],t}function Cy(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t[3]=r[3]-e[3],t[4]=r[4]-e[4],t[5]=r[5]-e[5],t[6]=r[6]-e[6],t[7]=r[7]-e[7],t[8]=r[8]-e[8],t[9]=r[9]-e[9],t[10]=r[10]-e[10],t[11]=r[11]-e[11],t[12]=r[12]-e[12],t[13]=r[13]-e[13],t[14]=r[14]-e[14],t[15]=r[15]-e[15],t}function R_(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t[3]=r[3]*e,t[4]=r[4]*e,t[5]=r[5]*e,t[6]=r[6]*e,t[7]=r[7]*e,t[8]=r[8]*e,t[9]=r[9]*e,t[10]=r[10]*e,t[11]=r[11]*e,t[12]=r[12]*e,t[13]=r[13]*e,t[14]=r[14]*e,t[15]=r[15]*e,t}function L_(t,r,e,n){return t[0]=r[0]+e[0]*n,t[1]=r[1]+e[1]*n,t[2]=r[2]+e[2]*n,t[3]=r[3]+e[3]*n,t[4]=r[4]+e[4]*n,t[5]=r[5]+e[5]*n,t[6]=r[6]+e[6]*n,t[7]=r[7]+e[7]*n,t[8]=r[8]+e[8]*n,t[9]=r[9]+e[9]*n,t[10]=r[10]+e[10]*n,t[11]=r[11]+e[11]*n,t[12]=r[12]+e[12]*n,t[13]=r[13]+e[13]*n,t[14]=r[14]+e[14]*n,t[15]=r[15]+e[15]*n,t}function M_(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]&&t[8]===r[8]&&t[9]===r[9]&&t[10]===r[10]&&t[11]===r[11]&&t[12]===r[12]&&t[13]===r[13]&&t[14]===r[14]&&t[15]===r[15]}function O_(t,r){var e=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],h=t[8],v=t[9],p=t[10],m=t[11],C=t[12],w=t[13],b=t[14],E=t[15],R=r[0],M=r[1],k=r[2],L=r[3],_=r[4],I=r[5],P=r[6],U=r[7],q=r[8],Q=r[9],J=r[10],re=r[11],ne=r[12],ce=r[13],me=r[14],oe=r[15];return Math.abs(e-R)<=Ht*Math.max(1,Math.abs(e),Math.abs(R))&&Math.abs(n-M)<=Ht*Math.max(1,Math.abs(n),Math.abs(M))&&Math.abs(i-k)<=Ht*Math.max(1,Math.abs(i),Math.abs(k))&&Math.abs(a-L)<=Ht*Math.max(1,Math.abs(a),Math.abs(L))&&Math.abs(o-_)<=Ht*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(s-I)<=Ht*Math.max(1,Math.abs(s),Math.abs(I))&&Math.abs(l-P)<=Ht*Math.max(1,Math.abs(l),Math.abs(P))&&Math.abs(u-U)<=Ht*Math.max(1,Math.abs(u),Math.abs(U))&&Math.abs(h-q)<=Ht*Math.max(1,Math.abs(h),Math.abs(q))&&Math.abs(v-Q)<=Ht*Math.max(1,Math.abs(v),Math.abs(Q))&&Math.abs(p-J)<=Ht*Math.max(1,Math.abs(p),Math.abs(J))&&Math.abs(m-re)<=Ht*Math.max(1,Math.abs(m),Math.abs(re))&&Math.abs(C-ne)<=Ht*Math.max(1,Math.abs(C),Math.abs(ne))&&Math.abs(w-ce)<=Ht*Math.max(1,Math.abs(w),Math.abs(ce))&&Math.abs(b-me)<=Ht*Math.max(1,Math.abs(b),Math.abs(me))&&Math.abs(E-oe)<=Ht*Math.max(1,Math.abs(E),Math.abs(oe))}var A_=Gr,N_=Cy,k_=Object.freeze({__proto__:null,add:__,adjoint:c_,clone:oy,copy:to,create:Ot,determinant:ly,equals:O_,exactEquals:M_,frob:T_,fromQuat:ev,fromQuat2:m_,fromRotation:d_,fromRotationTranslation:dy,fromRotationTranslationScale:y_,fromRotationTranslationScaleOrigin:il,fromScaling:hy,fromTranslation:fy,fromValues:u_,fromXRotation:v_,fromYRotation:p_,fromZRotation:g_,frustum:C_,getRotation:ju,getScaling:Qo,getTranslation:Zu,identity:Ol,invert:Ti,lookAt:yy,mul:A_,multiply:Gr,multiplyScalar:R_,multiplyScalarAndAdd:L_,ortho:gy,orthoNO:py,orthoZO:my,perspective:w_,perspectiveFromFieldOfView:b_,perspectiveNO:vy,perspectiveZO:x_,rotate:f_,rotateX:uy,rotateY:cy,rotateZ:h_,scale:Ku,set:Fh,str:E_,sub:N_,subtract:Cy,targetTo:S_,translate:Ea,transpose:sy});function at(){var t=new ir(3);return ir!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function ea(t){var r=new ir(3);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r}function ra(t){var r=t[0],e=t[1],n=t[2];return Math.hypot(r,e,n)}function _t(t,r,e){var n=new ir(3);return n[0]=t,n[1]=r,n[2]=e,n}function cn(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t}function Jn(t,r,e,n){return t[0]=r,t[1]=e,t[2]=n,t}function Xo(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t}function Tg(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t}function I_(t,r,e){return t[0]=r[0]*e[0],t[1]=r[1]*e[1],t[2]=r[2]*e[2],t}function Hh(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t}function P_(t,r){var e=r[0]-t[0],n=r[1]-t[1],i=r[2]-t[2];return Math.hypot(e,n,i)}function Ja(t,r){var e=r[0],n=r[1],i=r[2],a=e*e+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=r[0]*a,t[1]=r[1]*a,t[2]=r[2]*a,t}function _i(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]}function Wu(t,r,e){var n=r[0],i=r[1],a=r[2],o=e[0],s=e[1],l=e[2];return t[0]=i*l-a*s,t[1]=a*o-n*l,t[2]=n*s-i*o,t}function zh(t,r,e,n){var i=r[0],a=r[1],o=r[2];return t[0]=i+n*(e[0]-i),t[1]=a+n*(e[1]-a),t[2]=o+n*(e[2]-o),t}function Gn(t,r,e){var n=r[0],i=r[1],a=r[2],o=e[3]*n+e[7]*i+e[11]*a+e[15];return o=o||1,t[0]=(e[0]*n+e[4]*i+e[8]*a+e[12])/o,t[1]=(e[1]*n+e[5]*i+e[9]*a+e[13])/o,t[2]=(e[2]*n+e[6]*i+e[10]*a+e[14])/o,t}function D_(t,r,e){var n=r[0],i=r[1],a=r[2];return t[0]=n*e[0]+i*e[3]+a*e[6],t[1]=n*e[1]+i*e[4]+a*e[7],t[2]=n*e[2]+i*e[5]+a*e[8],t}function B_(t,r,e){var n=e[0],i=e[1],a=e[2],o=e[3],s=r[0],l=r[1],u=r[2],h=i*u-a*l,v=a*s-n*u,p=n*l-i*s,m=i*p-a*v,C=a*h-n*p,w=n*v-i*h,b=o*2;return h*=b,v*=b,p*=b,m*=2,C*=2,w*=2,t[0]=s+h+m,t[1]=l+v+C,t[2]=u+p+w,t}function Us(t,r){var e=t[0],n=t[1],i=t[2],a=r[0],o=r[1],s=r[2];return Math.abs(e-a)<=Ht*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(n-o)<=Ht*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-s)<=Ht*Math.max(1,Math.abs(i),Math.abs(s))}var _g=P_,wy=ra;(function(){var t=at();return function(r,e,n,i,a,o){var s,l;for(e||(e=3),n||(n=0),i?l=Math.min(i*e+n,r.length):l=r.length,s=n;s<l;s+=e)t[0]=r[s],t[1]=r[s+1],t[2]=r[s+2],a(t,t,o),r[s]=t[0],r[s+1]=t[1],r[s+2]=t[2];return r}})();function Fo(){var t=new ir(4);return ir!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function F_(t,r,e,n){var i=new ir(4);return i[0]=t,i[1]=r,i[2]=e,i[3]=n,i}function H_(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t}function z_(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],o=e*e+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),t[0]=e*o,t[1]=n*o,t[2]=i*o,t[3]=a*o,t}function js(t,r,e){var n=r[0],i=r[1],a=r[2],o=r[3];return t[0]=e[0]*n+e[4]*i+e[8]*a+e[12]*o,t[1]=e[1]*n+e[5]*i+e[9]*a+e[13]*o,t[2]=e[2]*n+e[6]*i+e[10]*a+e[14]*o,t[3]=e[3]*n+e[7]*i+e[11]*a+e[15]*o,t}(function(){var t=Fo();return function(r,e,n,i,a,o){var s,l;for(e||(e=4),n||(n=0),i?l=Math.min(i*e+n,r.length):l=r.length,s=n;s<l;s+=e)t[0]=r[s],t[1]=r[s+1],t[2]=r[s+2],t[3]=r[s+3],a(t,t,o),r[s]=t[0],r[s+1]=t[1],r[s+2]=t[2],r[s+3]=t[3];return r}})();function rr(){var t=new ir(4);return ir!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function xa(t,r,e){e=e*.5;var n=Math.sin(e);return t[0]=n*r[0],t[1]=n*r[1],t[2]=n*r[2],t[3]=Math.cos(e),t}function Ta(t,r,e){var n=r[0],i=r[1],a=r[2],o=r[3],s=e[0],l=e[1],u=e[2],h=e[3];return t[0]=n*h+o*s+i*u-a*l,t[1]=i*h+o*l+a*s-n*u,t[2]=a*h+o*u+n*l-i*s,t[3]=o*h-n*s-i*l-a*u,t}function oh(t,r,e,n){var i=r[0],a=r[1],o=r[2],s=r[3],l=e[0],u=e[1],h=e[2],v=e[3],p,m,C,w,b;return m=i*l+a*u+o*h+s*v,m<0&&(m=-m,l=-l,u=-u,h=-h,v=-v),1-m>Ht?(p=Math.acos(m),C=Math.sin(p),w=Math.sin((1-n)*p)/C,b=Math.sin(n*p)/C):(w=1-n,b=n),t[0]=w*i+b*l,t[1]=w*a+b*u,t[2]=w*o+b*h,t[3]=w*s+b*v,t}function sh(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],o=e*e+n*n+i*i+a*a,s=o?1/o:0;return t[0]=-e*s,t[1]=-n*s,t[2]=-i*s,t[3]=a*s,t}function W_(t,r){var e=r[0]+r[4]+r[8],n;if(e>0)n=Math.sqrt(e+1),t[3]=.5*n,n=.5/n,t[0]=(r[5]-r[7])*n,t[1]=(r[6]-r[2])*n,t[2]=(r[1]-r[3])*n;else{var i=0;r[4]>r[0]&&(i=1),r[8]>r[i*3+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(r[i*3+i]-r[a*3+a]-r[o*3+o]+1),t[i]=.5*n,n=.5/n,t[3]=(r[a*3+o]-r[o*3+a])*n,t[a]=(r[a*3+i]+r[i*3+a])*n,t[o]=(r[o*3+i]+r[i*3+o])*n}return t}function vu(t,r,e,n){var i=.5*Math.PI/180;r*=i,e*=i,n*=i;var a=Math.sin(r),o=Math.cos(r),s=Math.sin(e),l=Math.cos(e),u=Math.sin(n),h=Math.cos(n);return t[0]=a*l*h-o*s*u,t[1]=o*s*h+a*l*u,t[2]=o*l*u-a*s*h,t[3]=o*l*h+a*s*u,t}var lh=F_,pu=H_,Rg=Ta,Ju=z_;(function(){var t=at(),r=_t(1,0,0),e=_t(0,1,0);return function(n,i,a){var o=_i(i,a);return o<-.999999?(Wu(t,r,i),wy(t)<1e-6&&Wu(t,e,i),Ja(t,t),xa(n,t,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(Wu(t,i,a),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+o,Ju(n,n))}})();(function(){var t=rr(),r=rr();return function(e,n,i,a,o,s){return oh(t,n,o,s),oh(r,i,a,s),oh(e,t,r,2*s*(1-s)),e}})();(function(){var t=ay();return function(r,e,n,i){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-e[0],t[5]=-e[1],t[8]=-e[2],Ju(r,W_(r,t))}})();function G_(){var t=new ir(2);return ir!=Float32Array&&(t[0]=0,t[1]=0),t}function U_(t,r){var e=new ir(2);return e[0]=t,e[1]=r,e}function V_(t,r){return t[0]=r[0],t[1]=r[1],t}function X_(t,r){var e=r[0],n=r[1],i=e*e+n*n;return i>0&&(i=1/Math.sqrt(i)),t[0]=r[0]*i,t[1]=r[1]*i,t}function Y_(t,r){return t[0]*r[0]+t[1]*r[1]}function $_(t,r){return t[0]===r[0]&&t[1]===r[1]}(function(){var t=G_();return function(r,e,n,i,a,o){var s,l;for(e||(e=2),n||(n=0),i?l=Math.min(i*e+n,r.length):l=r.length,s=n;s<l;s+=e)t[0]=r[s],t[1]=r[s+1],a(t,t,o),r[s]=t[0],r[s+1]=t[1];return r}})();var We=function(t){return t==null},q_={}.toString,Pc=function(t,r){return q_.call(t)==="[object "+r+"]"},tv=function(t){return Array.isArray?Array.isArray(t):Pc(t,"Array")},Gu=function(t){var r=typeof t;return t!==null&&r==="object"||r==="function"},Lg=function(t){if(tv(t))return t.reduce(function(r,e){return Math.max(r,e)},t[0])},Mg=function(t){if(tv(t))return t.reduce(function(r,e){return Math.min(r,e)},t[0])},kr=function(t){return Pc(t,"String")},Tn=function(t,r,e){return t<r?r:t>e?e:t},li=function(t){return Pc(t,"Number")},K_=1e-5;function al(t,r,e){return e===void 0&&(e=K_),Math.abs(t-r)<e}var xy=function(t,r){return(t%r+r)%r},Og=function(t){return Pc(t,"Boolean")},qt=function(t){return t===void 0},by={x1:0,y1:0,x2:0,y2:0,x:0,y:0,qx:null,qy:null};function Z_(t,r,e){if(t[e].length>7){t[e].shift();for(var n=t[e],i=e;n.length;)r[e]="A",t.splice(i+=1,0,["C"].concat(n.splice(0,6)));t.splice(e,1)}}var ol={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0};function Sy(t){return Array.isArray(t)&&t.every(function(r){var e=r[0].toLowerCase();return ol[e]===r.length-1&&"achlmqstvz".includes(e)})}function Ey(t){return Sy(t)&&t.every(function(r){var e=r[0];return e===e.toUpperCase()})}function Ty(t){return Ey(t)&&t.every(function(r){var e=r[0];return"ACLMQZ".includes(e)})}function Ag(t){for(var r=t.pathValue[t.segmentStart],e=r.toLowerCase(),n=t.data;n.length>=ol[e]&&(e==="m"&&n.length>2?(t.segments.push([r].concat(n.splice(0,2))),e="l",r=r==="m"?"l":"L"):t.segments.push([r].concat(n.splice(0,ol[e]))),!!ol[e]););}function j_(t){var r=t.index,e=t.pathValue,n=e.charCodeAt(r);if(n===48){t.param=0,t.index+=1;return}if(n===49){t.param=1,t.index+=1;return}t.err='[path-util]: invalid Arc flag "'+e[r]+'", expecting 0 or 1 at index '+r}function J_(t){return t>=48&&t<=57||t===43||t===45||t===46}function No(t){return t>=48&&t<=57}function Q_(t){var r=t.max,e=t.pathValue,n=t.index,i=n,a=!1,o=!1,s=!1,l=!1,u;if(i>=r){t.err="[path-util]: Invalid path value at index "+i+', "pathValue" is missing param';return}if(u=e.charCodeAt(i),(u===43||u===45)&&(i+=1,u=e.charCodeAt(i)),!No(u)&&u!==46){t.err="[path-util]: Invalid path value at index "+i+', "'+e[i]+'" is not a number';return}if(u!==46){if(a=u===48,i+=1,u=e.charCodeAt(i),a&&i<r&&u&&No(u)){t.err="[path-util]: Invalid path value at index "+n+', "'+e[n]+'" illegal number';return}for(;i<r&&No(e.charCodeAt(i));)i+=1,o=!0;u=e.charCodeAt(i)}if(u===46){for(l=!0,i+=1;No(e.charCodeAt(i));)i+=1,s=!0;u=e.charCodeAt(i)}if(u===101||u===69){if(l&&!o&&!s){t.err="[path-util]: Invalid path value at index "+i+', "'+e[i]+'" invalid float exponent';return}if(i+=1,u=e.charCodeAt(i),(u===43||u===45)&&(i+=1),i<r&&No(e.charCodeAt(i)))for(;i<r&&No(e.charCodeAt(i));)i+=1;else{t.err="[path-util]: Invalid path value at index "+i+', "'+e[i]+'" invalid integer exponent';return}}t.index=i,t.param=+t.pathValue.slice(n,i)}function eR(t){var r=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279];return t===10||t===13||t===8232||t===8233||t===32||t===9||t===11||t===12||t===160||t>=5760&&r.includes(t)}function Uu(t){for(var r=t.pathValue,e=t.max;t.index<e&&eR(r.charCodeAt(t.index));)t.index+=1}function tR(t){switch(t|32){case 109:case 122:case 108:case 104:case 118:case 99:case 115:case 113:case 116:case 97:return!0;default:return!1}}function rR(t){return(t|32)===97}function nR(t){var r=t.max,e=t.pathValue,n=t.index,i=e.charCodeAt(n),a=ol[e[n].toLowerCase()];if(t.segmentStart=n,!tR(i)){t.err='[path-util]: Invalid path value "'+e[n]+'" is not a path command';return}if(t.index+=1,Uu(t),t.data=[],!a){Ag(t);return}for(;;){for(var o=a;o>0;o-=1){if(rR(i)&&(o===3||o===4)?j_(t):Q_(t),t.err.length)return;t.data.push(t.param),Uu(t),t.index<r&&e.charCodeAt(t.index)===44&&(t.index+=1,Uu(t))}if(t.index>=t.max||!J_(e.charCodeAt(t.index)))break}Ag(t)}var iR=function(){function t(r){this.pathValue=r,this.segments=[],this.max=r.length,this.index=0,this.param=0,this.segmentStart=0,this.data=[],this.err=""}return t}();function aR(t){if(Sy(t))return[].concat(t);var r=new iR(t);for(Uu(r);r.index<r.max&&!r.err.length;)nR(r);return r.err?r.err:r.segments}function oR(t){if(Ey(t))return[].concat(t);var r=aR(t),e=0,n=0,i=0,a=0;return r.map(function(o){var s=o.slice(1).map(Number),l=o[0],u=l.toUpperCase();if(l==="M")return e=s[0],n=s[1],i=e,a=n,["M",e,n];var h;if(l!==u)switch(u){case"A":h=[u,s[0],s[1],s[2],s[3],s[4],s[5]+e,s[6]+n];break;case"V":h=[u,s[0]+n];break;case"H":h=[u,s[0]+e];break;default:{var v=s.map(function(m,C){return m+(C%2?n:e)});h=[u].concat(v)}}else h=[u].concat(s);var p=h.length;switch(u){case"Z":e=i,n=a;break;case"H":e=h[1];break;case"V":n=h[1];break;default:e=h[p-2],n=h[p-1],u==="M"&&(i=e,a=n)}return h})}function sR(t,r){var e=t[0],n=r.x1,i=r.y1,a=r.x2,o=r.y2,s=t.slice(1).map(Number),l=t;if("TQ".includes(e)||(r.qx=null,r.qy=null),e==="H")l=["L",t[1],i];else if(e==="V")l=["L",n,t[1]];else if(e==="S"){var u=n*2-a,h=i*2-o;r.x1=u,r.y1=h,l=["C",u,h].concat(s)}else if(e==="T"){var v=n*2-r.qx,p=i*2-r.qy;r.qx=v,r.qy=p,l=["Q",v,p].concat(s)}else if(e==="Q"){var m=s[0],C=s[1];r.qx=m,r.qy=C}return l}function Qu(t){if(Ty(t))return[].concat(t);for(var r=oR(t),e=Y({},by),n=0;n<r.length;n+=1){r[n]=sR(r[n],e);var i=r[n],a=i.length;e.x1=+i[a-2],e.y1=+i[a-1],e.x2=+i[a-4]||e.x1,e.y2=+i[a-3]||e.y1}return r}function lR(t){return Ty(t)&&t.every(function(r){var e=r[0];return"MC".includes(e)})}function gu(t,r,e){var n=t*Math.cos(e)-r*Math.sin(e),i=t*Math.sin(e)+r*Math.cos(e);return{x:n,y:i}}function rv(t,r,e,n,i,a,o,s,l,u){var h=t,v=r,p=e,m=n,C=s,w=l,b=Math.PI*120/180,E=Math.PI/180*(+i||0),R=[],M,k,L,_,I;if(u)k=u[0],L=u[1],_=u[2],I=u[3];else{M=gu(h,v,-E),h=M.x,v=M.y,M=gu(C,w,-E),C=M.x,w=M.y;var P=(h-C)/2,U=(v-w)/2,q=P*P/(p*p)+U*U/(m*m);q>1&&(q=Math.sqrt(q),p*=q,m*=q);var Q=p*p,J=m*m,re=(a===o?-1:1)*Math.sqrt(Math.abs((Q*J-Q*U*U-J*P*P)/(Q*U*U+J*P*P)));_=re*p*U/m+(h+C)/2,I=re*-m*P/p+(v+w)/2,k=Math.asin(((v-I)/m*Math.pow(10,9)>>0)/Math.pow(10,9)),L=Math.asin(((w-I)/m*Math.pow(10,9)>>0)/Math.pow(10,9)),k=h<_?Math.PI-k:k,L=C<_?Math.PI-L:L,k<0&&(k=Math.PI*2+k),L<0&&(L=Math.PI*2+L),o&&k>L&&(k-=Math.PI*2),!o&&L>k&&(L-=Math.PI*2)}var ne=L-k;if(Math.abs(ne)>b){var ce=L,me=C,oe=w;L=k+b*(o&&L>k?1:-1),C=_+p*Math.cos(L),w=I+m*Math.sin(L),R=rv(C,w,p,m,i,0,o,me,oe,[L,ce,_,I])}ne=L-k;var Se=Math.cos(k),Te=Math.sin(k),Ie=Math.cos(L),je=Math.sin(L),Be=Math.tan(ne/4),rt=4/3*p*Be,ut=4/3*m*Be,St=[h,v],st=[h+rt*Te,v-ut*Se],fr=[C+rt*je,w-ut*Ie],Pr=[C,w];if(st[0]=2*St[0]-st[0],st[1]=2*St[1]-st[1],u)return st.concat(fr,Pr,R);R=st.concat(fr,Pr,R);for(var Ln=[],Xr=0,mt=R.length;Xr<mt;Xr+=1)Ln[Xr]=Xr%2?gu(R[Xr-1],R[Xr],E).y:gu(R[Xr],R[Xr+1],E).x;return Ln}function uR(t,r,e,n,i,a){var o=.3333333333333333,s=2/3;return[o*t+s*e,o*r+s*n,o*i+s*e,o*a+s*n,i,a]}function ma(t,r,e){var n=t[0],i=t[1],a=r[0],o=r[1];return[n+(a-n)*e,i+(o-i)*e]}var Ng=function(t,r,e,n){var i=.5,a=ma([t,r],[e,n],i);return pe(pe([],a,!0),[e,n,e,n],!1)};function cR(t,r){var e=t[0],n=t.slice(1).map(Number),i=n[0],a=n[1],o,s=r.x1,l=r.y1,u=r.x,h=r.y;switch("TQ".includes(e)||(r.qx=null,r.qy=null),e){case"M":return r.x=i,r.y=a,t;case"A":return o=[s,l].concat(n),["C"].concat(rv(o[0],o[1],o[2],o[3],o[4],o[5],o[6],o[7],o[8],o[9]));case"Q":return r.qx=i,r.qy=a,o=[s,l].concat(n),["C"].concat(uR(o[0],o[1],o[2],o[3],o[4],o[5]));case"L":return["C"].concat(Ng(s,l,i,a));case"Z":return s===u&&l===h?["C",s,l,u,h,u,h]:["C"].concat(Ng(s,l,u,h))}return t}function Wh(t,r){if(r===void 0&&(r=!1),lR(t)){var e=[].concat(t);return r?[e,[]]:e}for(var n=Qu(t),i=Y({},by),a=[],o="",s=n.length,l,u,h=[],v=0;v<s;v+=1){n[v]&&(o=n[v][0]),a[v]=o;var p=cR(n[v],i);n[v]=p,Z_(n,a,v),s=n.length,o==="Z"&&h.push(v),l=n[v],u=l.length,i.x1=+l[u-2],i.y1=+l[u-1],i.x2=+l[u-4]||i.x1,i.y2=+l[u-3]||i.y1}return r?[n,h]:n}function fR(t){return t.map(function(r){return Array.isArray(r)?[].concat(r):r})}function hR(t){var r=t.slice(1).map(function(e,n,i){return n?i[n-1].slice(-2).concat(e.slice(1)):t[0].slice(1).concat(e.slice(1))}).map(function(e){return e.map(function(n,i){return e[e.length-i-2*(1-i%2)]})}).reverse();return[["M"].concat(r[0].slice(0,2))].concat(r.map(function(e){return["C"].concat(e.slice(2))}))}function bn(t,r){return Math.sqrt((t[0]-r[0])*(t[0]-r[0])+(t[1]-r[1])*(t[1]-r[1]))}function Gh(t,r,e,n,i){var a=bn([t,r],[e,n]),o={x:0,y:0};if(typeof i=="number")if(i<=0)o={x:t,y:r};else if(i>=a)o={x:e,y:n};else{var s=ma([t,r],[e,n],i/a),l=s[0],u=s[1];o={x:l,y:u}}return{length:a,point:o,min:{x:Math.min(t,e),y:Math.min(r,n)},max:{x:Math.max(t,e),y:Math.max(r,n)}}}function kg(t,r){var e=t.x,n=t.y,i=r.x,a=r.y,o=e*i+n*a,s=Math.sqrt((Math.pow(e,2)+Math.pow(n,2))*(Math.pow(i,2)+Math.pow(a,2))),l=e*a-n*i<0?-1:1,u=l*Math.acos(o/s);return u}function dR(t,r,e,n,i,a,o,s,l,u){var h=Math.abs,v=Math.sin,p=Math.cos,m=Math.sqrt,C=Math.PI,w=h(e),b=h(n),E=(i%360+360)%360,R=E*(C/180);if(t===s&&r===l)return{x:t,y:r};if(w===0||b===0)return Gh(t,r,s,l,u).point;var M=(t-s)/2,k=(r-l)/2,L={x:p(R)*M+v(R)*k,y:-v(R)*M+p(R)*k},_=Math.pow(L.x,2)/Math.pow(w,2)+Math.pow(L.y,2)/Math.pow(b,2);_>1&&(w*=m(_),b*=m(_));var I=Math.pow(w,2)*Math.pow(b,2)-Math.pow(w,2)*Math.pow(L.y,2)-Math.pow(b,2)*Math.pow(L.x,2),P=Math.pow(w,2)*Math.pow(L.y,2)+Math.pow(b,2)*Math.pow(L.x,2),U=I/P;U=U<0?0:U;var q=(a!==o?1:-1)*m(U),Q={x:q*(w*L.y/b),y:q*(-(b*L.x)/w)},J={x:p(R)*Q.x-v(R)*Q.y+(t+s)/2,y:v(R)*Q.x+p(R)*Q.y+(r+l)/2},re={x:(L.x-Q.x)/w,y:(L.y-Q.y)/b},ne=kg({x:1,y:0},re),ce={x:(-L.x-Q.x)/w,y:(-L.y-Q.y)/b},me=kg(re,ce);!o&&me>0?me-=2*C:o&&me<0&&(me+=2*C),me%=2*C;var oe=ne+me*u,Se=w*p(oe),Te=b*v(oe),Ie={x:p(R)*Se-v(R)*Te+J.x,y:v(R)*Se+p(R)*Te+J.y};return Ie}function vR(t,r,e,n,i,a,o,s,l,u,h){var v,p=h.bbox,m=p===void 0?!0:p,C=h.length,w=C===void 0?!0:C,b=h.sampleSize,E=b===void 0?30:b,R=typeof u=="number",M=t,k=r,L=0,_=[M,k,L],I=[M,k],P=0,U={x:0,y:0},q=[{x:M,y:k}];R&&u<=0&&(U={x:M,y:k});for(var Q=0;Q<=E;Q+=1){if(P=Q/E,v=dR(t,r,e,n,i,a,o,s,l,P),M=v.x,k=v.y,m&&q.push({x:M,y:k}),w&&(L+=bn(I,[M,k])),I=[M,k],R&&L>=u&&u>_[2]){var J=(L-u)/(L-_[2]);U={x:I[0]*(1-J)+_[0]*J,y:I[1]*(1-J)+_[1]*J}}_=[M,k,L]}return R&&u>=L&&(U={x:s,y:l}),{length:L,point:U,min:{x:Math.min.apply(null,q.map(function(re){return re.x})),y:Math.min.apply(null,q.map(function(re){return re.y}))},max:{x:Math.max.apply(null,q.map(function(re){return re.x})),y:Math.max.apply(null,q.map(function(re){return re.y}))}}}function pR(t,r,e,n,i,a,o,s,l){var u=1-l;return{x:Math.pow(u,3)*t+3*Math.pow(u,2)*l*e+3*u*Math.pow(l,2)*i+Math.pow(l,3)*o,y:Math.pow(u,3)*r+3*Math.pow(u,2)*l*n+3*u*Math.pow(l,2)*a+Math.pow(l,3)*s}}function _y(t,r,e,n,i,a,o,s,l,u){var h,v=u.bbox,p=v===void 0?!0:v,m=u.length,C=m===void 0?!0:m,w=u.sampleSize,b=w===void 0?10:w,E=typeof l=="number",R=t,M=r,k=0,L=[R,M,k],_=[R,M],I=0,P={x:0,y:0},U=[{x:R,y:M}];E&&l<=0&&(P={x:R,y:M});for(var q=0;q<=b;q+=1){if(I=q/b,h=pR(t,r,e,n,i,a,o,s,I),R=h.x,M=h.y,p&&U.push({x:R,y:M}),C&&(k+=bn(_,[R,M])),_=[R,M],E&&k>=l&&l>L[2]){var Q=(k-l)/(k-L[2]);P={x:_[0]*(1-Q)+L[0]*Q,y:_[1]*(1-Q)+L[1]*Q}}L=[R,M,k]}return E&&l>=k&&(P={x:o,y:s}),{length:k,point:P,min:{x:Math.min.apply(null,U.map(function(J){return J.x})),y:Math.min.apply(null,U.map(function(J){return J.y}))},max:{x:Math.max.apply(null,U.map(function(J){return J.x})),y:Math.max.apply(null,U.map(function(J){return J.y}))}}}function gR(t,r,e,n,i,a,o){var s=1-o;return{x:Math.pow(s,2)*t+2*s*o*e+Math.pow(o,2)*i,y:Math.pow(s,2)*r+2*s*o*n+Math.pow(o,2)*a}}function mR(t,r,e,n,i,a,o,s){var l,u=s.bbox,h=u===void 0?!0:u,v=s.length,p=v===void 0?!0:v,m=s.sampleSize,C=m===void 0?10:m,w=typeof o=="number",b=t,E=r,R=0,M=[b,E,R],k=[b,E],L=0,_={x:0,y:0},I=[{x:b,y:E}];w&&o<=0&&(_={x:b,y:E});for(var P=0;P<=C;P+=1){if(L=P/C,l=gR(t,r,e,n,i,a,L),b=l.x,E=l.y,h&&I.push({x:b,y:E}),p&&(R+=bn(k,[b,E])),k=[b,E],w&&R>=o&&o>M[2]){var U=(R-o)/(R-M[2]);_={x:k[0]*(1-U)+M[0]*U,y:k[1]*(1-U)+M[1]*U}}M=[b,E,R]}return w&&o>=R&&(_={x:i,y:a}),{length:R,point:_,min:{x:Math.min.apply(null,I.map(function(q){return q.x})),y:Math.min.apply(null,I.map(function(q){return q.y}))},max:{x:Math.max.apply(null,I.map(function(q){return q.x})),y:Math.max.apply(null,I.map(function(q){return q.y}))}}}function Ry(t,r,e){for(var n,i,a,o,s,l,u=Qu(t),h=typeof r=="number",v,p=[],m,C=0,w=0,b=0,E=0,R,M=[],k=[],L=0,_={x:0,y:0},I=_,P=_,U=_,q=0,Q=0,J=u.length;Q<J;Q+=1)R=u[Q],m=R[0],v=m==="M",p=v?p:[C,w].concat(R.slice(1)),v?(b=R[1],E=R[2],_={x:b,y:E},I=_,L=0,h&&r<.001&&(U=_)):m==="L"?(n=Gh(p[0],p[1],p[2],p[3],(r||0)-q),L=n.length,_=n.min,I=n.max,P=n.point):m==="A"?(i=vR(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],p[8],(r||0)-q,e||{}),L=i.length,_=i.min,I=i.max,P=i.point):m==="C"?(a=_y(p[0],p[1],p[2],p[3],p[4],p[5],p[6],p[7],(r||0)-q,e||{}),L=a.length,_=a.min,I=a.max,P=a.point):m==="Q"?(o=mR(p[0],p[1],p[2],p[3],p[4],p[5],(r||0)-q,e||{}),L=o.length,_=o.min,I=o.max,P=o.point):m==="Z"&&(p=[C,w,b,E],s=Gh(p[0],p[1],p[2],p[3],(r||0)-q),L=s.length,_=s.min,I=s.max,P=s.point),h&&q<r&&q+L>=r&&(U=P),k.push(I),M.push(_),q+=L,l=m!=="Z"?R.slice(-2):[b,E],C=l[0],w=l[1];return h&&r>=q&&(U={x:C,y:w}),{length:q,point:U,min:{x:Math.min.apply(null,M.map(function(re){return re.x})),y:Math.min.apply(null,M.map(function(re){return re.y}))},max:{x:Math.max.apply(null,k.map(function(re){return re.x})),y:Math.max.apply(null,k.map(function(re){return re.y}))}}}function yR(t,r){return Ry(t,void 0,Y(Y({},r),{bbox:!1,length:!0})).length}function CR(t){var r=t.length,e=r-1;return t.map(function(n,i){return t.map(function(a,o){var s=i+o,l;return o===0||t[s]&&t[s][0]==="M"?(l=t[s],["M"].concat(l.slice(-2))):(s>=r&&(s-=e),t[s])})})}function wR(t,r){var e=t.length-1,n=[],i=0,a=0,o=CR(t);return o.forEach(function(s,l){t.slice(1).forEach(function(u,h){a+=bn(t[(l+h)%e].slice(-2),r[h%e].slice(-2))}),n[l]=a,a=0}),i=n.indexOf(Math.min.apply(null,n)),o[i]}function xR(t,r,e,n,i,a,o,s){return 3*((s-r)*(e+i)-(o-t)*(n+a)+n*(t-i)-e*(r-a)+s*(i+t/3)-o*(a+r/3))/20}function bR(t){var r=0,e=0,n=0;return Wh(t).map(function(i){var a;switch(i[0]){case"M":return r=i[1],e=i[2],0;default:var o=i.slice(1),s=o[0],l=o[1],u=o[2],h=o[3],v=o[4],p=o[5];return n=xR(r,e,s,l,u,h,v,p),a=i.slice(-2),r=a[0],e=a[1],n}}).reduce(function(i,a){return i+a},0)}function Ig(t){return bR(t)>=0}function SR(t,r,e){return Ry(t,r,Y(Y({},e),{bbox:!1,length:!0})).point}function ER(t,r){r===void 0&&(r=.5);var e=t.slice(0,2),n=t.slice(2,4),i=t.slice(4,6),a=t.slice(6,8),o=ma(e,n,r),s=ma(n,i,r),l=ma(i,a,r),u=ma(o,s,r),h=ma(s,l,r),v=ma(u,h,r);return[["C"].concat(o,u,v),["C"].concat(h,l,a)]}function Pg(t){return t.map(function(r,e,n){var i=e&&n[e-1].slice(-2).concat(r.slice(1)),a=e?_y(i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8],{bbox:!1}).length:0,o;return e?o=a?ER(i):[r,r]:o=[r],{s:r,ss:o,l:a}})}function Ly(t,r,e){var n=Pg(t),i=Pg(r),a=n.length,o=i.length,s=n.filter(function(b){return b.l}).length,l=i.filter(function(b){return b.l}).length,u=n.filter(function(b){return b.l}).reduce(function(b,E){var R=E.l;return b+R},0)/s||0,h=i.filter(function(b){return b.l}).reduce(function(b,E){var R=E.l;return b+R},0)/l||0,v=e||Math.max(a,o),p=[u,h],m=[v-a,v-o],C=0,w=[n,i].map(function(b,E){return b.l===v?b.map(function(R){return R.s}):b.map(function(R,M){return C=M&&m[E]&&R.l>=p[E],m[E]-=C?1:0,C?R.ss:[R.s]}).flat()});return w[0].length===w[1].length?w:Ly(w[0],w[1],v)}function nv(t,r,e){t.prototype=r.prototype=e,e.constructor=t}function My(t,r){var e=Object.create(t.prototype);for(var n in r)e[n]=r[n];return e}function Al(){}var fl=.7,ec=1/fl,Yo="\\s*([+-]?\\d+)\\s*",hl="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Mi="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",TR=/^#([0-9a-f]{3,8})$/,_R=new RegExp("^rgb\\("+[Yo,Yo,Yo]+"\\)$"),RR=new RegExp("^rgb\\("+[Mi,Mi,Mi]+"\\)$"),LR=new RegExp("^rgba\\("+[Yo,Yo,Yo,hl]+"\\)$"),MR=new RegExp("^rgba\\("+[Mi,Mi,Mi,hl]+"\\)$"),OR=new RegExp("^hsl\\("+[hl,Mi,Mi]+"\\)$"),AR=new RegExp("^hsla\\("+[hl,Mi,Mi,hl]+"\\)$"),Dg={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};nv(Al,es,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Bg,formatHex:Bg,formatHsl:NR,formatRgb:Fg,toString:Fg});function Bg(){return this.rgb().formatHex()}function NR(){return Oy(this).formatHsl()}function Fg(){return this.rgb().formatRgb()}function es(t){var r,e;return t=(t+"").trim().toLowerCase(),(r=TR.exec(t))?(e=r[1].length,r=parseInt(r[1],16),e===6?Hg(r):e===3?new _n(r>>8&15|r>>4&240,r>>4&15|r&240,(r&15)<<4|r&15,1):e===8?mu(r>>24&255,r>>16&255,r>>8&255,(r&255)/255):e===4?mu(r>>12&15|r>>8&240,r>>8&15|r>>4&240,r>>4&15|r&240,((r&15)<<4|r&15)/255):null):(r=_R.exec(t))?new _n(r[1],r[2],r[3],1):(r=RR.exec(t))?new _n(r[1]*255/100,r[2]*255/100,r[3]*255/100,1):(r=LR.exec(t))?mu(r[1],r[2],r[3],r[4]):(r=MR.exec(t))?mu(r[1]*255/100,r[2]*255/100,r[3]*255/100,r[4]):(r=OR.exec(t))?Gg(r[1],r[2]/100,r[3]/100,1):(r=AR.exec(t))?Gg(r[1],r[2]/100,r[3]/100,r[4]):Dg.hasOwnProperty(t)?Hg(Dg[t]):t==="transparent"?new _n(NaN,NaN,NaN,0):null}function Hg(t){return new _n(t>>16&255,t>>8&255,t&255,1)}function mu(t,r,e,n){return n<=0&&(t=r=e=NaN),new _n(t,r,e,n)}function kR(t){return t instanceof Al||(t=es(t)),t?(t=t.rgb(),new _n(t.r,t.g,t.b,t.opacity)):new _n}function Uh(t,r,e,n){return arguments.length===1?kR(t):new _n(t,r,e,n??1)}function _n(t,r,e,n){this.r=+t,this.g=+r,this.b=+e,this.opacity=+n}nv(_n,Uh,My(Al,{brighter:function(t){return t=t==null?ec:Math.pow(ec,t),new _n(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=t==null?fl:Math.pow(fl,t),new _n(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:zg,formatHex:zg,formatRgb:Wg,toString:Wg}));function zg(){return"#"+uh(this.r)+uh(this.g)+uh(this.b)}function Wg(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(t===1?")":", "+t+")")}function uh(t){return t=Math.max(0,Math.min(255,Math.round(t)||0)),(t<16?"0":"")+t.toString(16)}function Gg(t,r,e,n){return n<=0?t=r=e=NaN:e<=0||e>=1?t=r=NaN:r<=0&&(t=NaN),new Si(t,r,e,n)}function Oy(t){if(t instanceof Si)return new Si(t.h,t.s,t.l,t.opacity);if(t instanceof Al||(t=es(t)),!t)return new Si;if(t instanceof Si)return t;t=t.rgb();var r=t.r/255,e=t.g/255,n=t.b/255,i=Math.min(r,e,n),a=Math.max(r,e,n),o=NaN,s=a-i,l=(a+i)/2;return s?(r===a?o=(e-n)/s+(e<n)*6:e===a?o=(n-r)/s+2:o=(r-e)/s+4,s/=l<.5?a+i:2-a-i,o*=60):s=l>0&&l<1?0:o,new Si(o,s,l,t.opacity)}function IR(t,r,e,n){return arguments.length===1?Oy(t):new Si(t,r,e,n??1)}function Si(t,r,e,n){this.h=+t,this.s=+r,this.l=+e,this.opacity=+n}nv(Si,IR,My(Al,{brighter:function(t){return t=t==null?ec:Math.pow(ec,t),new Si(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=t==null?fl:Math.pow(fl,t),new Si(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+(this.h<0)*360,r=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,n=e+(e<.5?e:1-e)*r,i=2*e-n;return new _n(ch(t>=240?t-240:t+120,i,n),ch(t,i,n),ch(t<120?t+240:t-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return t=isNaN(t)?1:Math.max(0,Math.min(1,t)),(t===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(t===1?")":", "+t+")")}}));function ch(t,r,e){return(t<60?r+(e-r)*t/60:t<180?e:t<240?r+(e-r)*(240-t)/60:r)*255}function aa(t,r,e,n){var i=t-e,a=r-n;return Math.sqrt(i*i+a*a)}function Ay(t,r){var e=Math.min.apply(Math,pe([],te(t),!1)),n=Math.min.apply(Math,pe([],te(r),!1)),i=Math.max.apply(Math,pe([],te(t),!1)),a=Math.max.apply(Math,pe([],te(r),!1));return{x:e,y:n,width:i-e,height:a-n}}function PR(t,r,e){return Math.atan(-r/t*Math.tan(e))}function DR(t,r,e){return Math.atan(r/(t*Math.tan(e)))}function BR(t,r,e,n,i,a){return e*Math.cos(i)*Math.cos(a)-n*Math.sin(i)*Math.sin(a)+t}function FR(t,r,e,n,i,a){return e*Math.sin(i)*Math.cos(a)+n*Math.cos(i)*Math.sin(a)+r}function HR(t,r,e,n,i,a,o){for(var s=PR(e,n,i),l=1/0,u=-1/0,h=[a,o],v=-Math.PI*2;v<=Math.PI*2;v+=Math.PI){var p=s+v;a<o?a<p&&p<o&&h.push(p):o<p&&p<a&&h.push(p)}for(var v=0;v<h.length;v++){var m=BR(t,r,e,n,i,h[v]);m<l&&(l=m),m>u&&(u=m)}for(var C=DR(e,n,i),w=1/0,b=-1/0,E=[a,o],v=-Math.PI*2;v<=Math.PI*2;v+=Math.PI){var R=C+v;a<o?a<R&&R<o&&E.push(R):o<R&&R<a&&E.push(R)}for(var v=0;v<E.length;v++){var M=FR(t,r,e,n,i,E[v]);M<w&&(w=M),M>b&&(b=M)}return{x:l,y:w,width:u-l,height:b-w}}var zR=1e-4;function Ny(t,r,e,n,i,a){var o=-1,s=1/0,l=[e,n],u=20;a&&a>200&&(u=a/10);for(var h=1/u,v=h/10,p=0;p<=u;p++){var m=p*h,C=[i.apply(void 0,pe([],te(t.concat([m])),!1)),i.apply(void 0,pe([],te(r.concat([m])),!1))],w=aa(l[0],l[1],C[0],C[1]);w<s&&(o=m,s=w)}if(o===0)return{x:t[0],y:r[0]};if(o===1){var b=t.length;return{x:t[b-1],y:r[b-1]}}s=1/0;for(var p=0;p<32&&!(v<zR);p++){var E=o-v,R=o+v,C=[i.apply(void 0,pe([],te(t.concat([E])),!1)),i.apply(void 0,pe([],te(r.concat([E])),!1))],w=aa(l[0],l[1],C[0],C[1]);if(E>=0&&w<s)o=E,s=w;else{var M=[i.apply(void 0,pe([],te(t.concat([R])),!1)),i.apply(void 0,pe([],te(r.concat([R])),!1))],k=aa(l[0],l[1],M[0],M[1]);R<=1&&k<s?(o=R,s=k):v*=.5}}return{x:i.apply(void 0,pe([],te(t.concat([o])),!1)),y:i.apply(void 0,pe([],te(r.concat([o])),!1))}}function ky(t,r,e,n){return aa(t,r,e,n)}function Iy(t,r,e,n,i){return{x:(1-i)*t+i*e,y:(1-i)*r+i*n}}function WR(t,r,e,n,i,a){var o=[e-t,n-r];if($_(o,[0,0]))return Math.sqrt((i-t)*(i-t)+(a-r)*(a-r));var s=[-o[1],o[0]];X_(s,s);var l=[i-t,a-r];return Math.abs(Y_(l,s))}function Vh(t,r,e,n,i){var a=1-i;return a*a*a*t+3*r*i*a*a+3*e*i*i*a+n*i*i*i}function Ug(t,r,e,n){var i=-3*t+9*r-9*e+3*n,a=6*t-12*r+6*e,o=3*r-3*t,s=[],l,u,h;if(al(i,0))al(a,0)||(l=-o/a,l>=0&&l<=1&&s.push(l));else{var v=a*a-4*i*o;al(v,0)?s.push(-a/(2*i)):v>0&&(h=Math.sqrt(v),l=(-a+h)/(2*i),u=(-a-h)/(2*i),l>=0&&l<=1&&s.push(l),u>=0&&u<=1&&s.push(u))}return s}function GR(t,r,e,n,i,a,o,s){for(var l=[t,o],u=[r,s],h=Ug(t,e,i,o),v=Ug(r,n,a,s),p=0;p<h.length;p++)l.push(Vh(t,e,i,o,h[p]));for(var p=0;p<v.length;p++)u.push(Vh(r,n,a,s,v[p]));return Ay(l,u)}function UR(t,r,e,n,i,a,o,s,l,u,h){return Ny([t,e,i,o],[r,n,a,s],l,u,Vh,h)}function Vg(t,r,e,n,i,a,o,s,l,u,h){var v=UR(t,r,e,n,i,a,o,s,l,u,h);return aa(v.x,v.y,l,u)}function VR(t){if(t.length<2)return 0;for(var r=0,e=0;e<t.length-1;e++){var n=t[e],i=t[e+1];r+=aa(n[0],n[1],i[0],i[1])}return r}function XR(t){return VR(t)}function Xh(t,r,e,n){var i=1-n;return i*i*t+2*n*i*r+n*n*e}function Xg(t,r,e){var n=t+e-2*r;if(al(n,0))return[.5];var i=(t-r)/n;return i<=1&&i>=0?[i]:[]}function YR(t,r,e,n,i,a){var o=Xg(t,e,i)[0],s=Xg(r,n,a)[0],l=[t,i],u=[r,a];return o!==void 0&&l.push(Xh(t,e,i,o)),s!==void 0&&u.push(Xh(r,n,a,s)),Ay(l,u)}function $R(t,r,e,n,i,a,o,s){return Ny([t,e,i],[r,n,a],o,s,Xh)}function qR(t,r,e,n,i,a,o,s){var l=$R(t,r,e,n,i,a,o,s);return aa(l.x,l.y,o,s)}var KR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Py={exports:{}};(function(t,r){(function(e,n){t.exports=n()})(KR,function(){function e(L,_,I,P,U){n(L,_,I||0,P||L.length-1,U||a)}function n(L,_,I,P,U){for(;P>I;){if(P-I>600){var q=P-I+1,Q=_-I+1,J=Math.log(q),re=.5*Math.exp(2*J/3),ne=.5*Math.sqrt(J*re*(q-re)/q)*(Q-q/2<0?-1:1),ce=Math.max(I,Math.floor(_-Q*re/q+ne)),me=Math.min(P,Math.floor(_+(q-Q)*re/q+ne));n(L,_,ce,me,U)}var oe=L[_],Se=I,Te=P;for(i(L,I,_),U(L[P],oe)>0&&i(L,I,P);Se<Te;){for(i(L,Se,Te),Se++,Te--;U(L[Se],oe)<0;)Se++;for(;U(L[Te],oe)>0;)Te--}U(L[I],oe)===0?i(L,I,Te):(Te++,i(L,Te,P)),Te<=_&&(I=Te+1),_<=Te&&(P=Te-1)}}function i(L,_,I){var P=L[_];L[_]=L[I],L[I]=P}function a(L,_){return L<_?-1:L>_?1:0}var o=function(_){_===void 0&&(_=9),this._maxEntries=Math.max(4,_),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()};o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(_){var I=this.data,P=[];if(!R(_,I))return P;for(var U=this.toBBox,q=[];I;){for(var Q=0;Q<I.children.length;Q++){var J=I.children[Q],re=I.leaf?U(J):J;R(_,re)&&(I.leaf?P.push(J):E(_,re)?this._all(J,P):q.push(J))}I=q.pop()}return P},o.prototype.collides=function(_){var I=this.data;if(!R(_,I))return!1;for(var P=[];I;){for(var U=0;U<I.children.length;U++){var q=I.children[U],Q=I.leaf?this.toBBox(q):q;if(R(_,Q)){if(I.leaf||E(_,Q))return!0;P.push(q)}}I=P.pop()}return!1},o.prototype.load=function(_){if(!(_&&_.length))return this;if(_.length<this._minEntries){for(var I=0;I<_.length;I++)this.insert(_[I]);return this}var P=this._build(_.slice(),0,_.length-1,0);if(!this.data.children.length)this.data=P;else if(this.data.height===P.height)this._splitRoot(this.data,P);else{if(this.data.height<P.height){var U=this.data;this.data=P,P=U}this._insert(P,this.data.height-P.height-1,!0)}return this},o.prototype.insert=function(_){return _&&this._insert(_,this.data.height-1),this},o.prototype.clear=function(){return this.data=M([]),this},o.prototype.remove=function(_,I){if(!_)return this;for(var P=this.data,U=this.toBBox(_),q=[],Q=[],J,re,ne;P||q.length;){if(P||(P=q.pop(),re=q[q.length-1],J=Q.pop(),ne=!0),P.leaf){var ce=s(_,P.children,I);if(ce!==-1)return P.children.splice(ce,1),q.push(P),this._condense(q),this}!ne&&!P.leaf&&E(P,U)?(q.push(P),Q.push(J),J=0,re=P,P=P.children[0]):re?(J++,P=re.children[J],ne=!1):P=null}return this},o.prototype.toBBox=function(_){return _},o.prototype.compareMinX=function(_,I){return _.minX-I.minX},o.prototype.compareMinY=function(_,I){return _.minY-I.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(_){return this.data=_,this},o.prototype._all=function(_,I){for(var P=[];_;)_.leaf?I.push.apply(I,_.children):P.push.apply(P,_.children),_=P.pop();return I},o.prototype._build=function(_,I,P,U){var q=P-I+1,Q=this._maxEntries,J;if(q<=Q)return J=M(_.slice(I,P+1)),l(J,this.toBBox),J;U||(U=Math.ceil(Math.log(q)/Math.log(Q)),Q=Math.ceil(q/Math.pow(Q,U-1))),J=M([]),J.leaf=!1,J.height=U;var re=Math.ceil(q/Q),ne=re*Math.ceil(Math.sqrt(Q));k(_,I,P,ne,this.compareMinX);for(var ce=I;ce<=P;ce+=ne){var me=Math.min(ce+ne-1,P);k(_,ce,me,re,this.compareMinY);for(var oe=ce;oe<=me;oe+=re){var Se=Math.min(oe+re-1,me);J.children.push(this._build(_,oe,Se,U-1))}}return l(J,this.toBBox),J},o.prototype._chooseSubtree=function(_,I,P,U){for(;U.push(I),!(I.leaf||U.length-1===P);){for(var q=1/0,Q=1/0,J=void 0,re=0;re<I.children.length;re++){var ne=I.children[re],ce=m(ne),me=w(_,ne)-ce;me<Q?(Q=me,q=ce<q?ce:q,J=ne):me===Q&&ce<q&&(q=ce,J=ne)}I=J||I.children[0]}return I},o.prototype._insert=function(_,I,P){var U=P?_:this.toBBox(_),q=[],Q=this._chooseSubtree(U,this.data,I,q);for(Q.children.push(_),h(Q,U);I>=0&&q[I].children.length>this._maxEntries;)this._split(q,I),I--;this._adjustParentBBoxes(U,q,I)},o.prototype._split=function(_,I){var P=_[I],U=P.children.length,q=this._minEntries;this._chooseSplitAxis(P,q,U);var Q=this._chooseSplitIndex(P,q,U),J=M(P.children.splice(Q,P.children.length-Q));J.height=P.height,J.leaf=P.leaf,l(P,this.toBBox),l(J,this.toBBox),I?_[I-1].children.push(J):this._splitRoot(P,J)},o.prototype._splitRoot=function(_,I){this.data=M([_,I]),this.data.height=_.height+1,this.data.leaf=!1,l(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(_,I,P){for(var U,q=1/0,Q=1/0,J=I;J<=P-I;J++){var re=u(_,0,J,this.toBBox),ne=u(_,J,P,this.toBBox),ce=b(re,ne),me=m(re)+m(ne);ce<q?(q=ce,U=J,Q=me<Q?me:Q):ce===q&&me<Q&&(Q=me,U=J)}return U||P-I},o.prototype._chooseSplitAxis=function(_,I,P){var U=_.leaf?this.compareMinX:v,q=_.leaf?this.compareMinY:p,Q=this._allDistMargin(_,I,P,U),J=this._allDistMargin(_,I,P,q);Q<J&&_.children.sort(U)},o.prototype._allDistMargin=function(_,I,P,U){_.children.sort(U);for(var q=this.toBBox,Q=u(_,0,I,q),J=u(_,P-I,P,q),re=C(Q)+C(J),ne=I;ne<P-I;ne++){var ce=_.children[ne];h(Q,_.leaf?q(ce):ce),re+=C(Q)}for(var me=P-I-1;me>=I;me--){var oe=_.children[me];h(J,_.leaf?q(oe):oe),re+=C(J)}return re},o.prototype._adjustParentBBoxes=function(_,I,P){for(var U=P;U>=0;U--)h(I[U],_)},o.prototype._condense=function(_){for(var I=_.length-1,P=void 0;I>=0;I--)_[I].children.length===0?I>0?(P=_[I-1].children,P.splice(P.indexOf(_[I]),1)):this.clear():l(_[I],this.toBBox)};function s(L,_,I){if(!I)return _.indexOf(L);for(var P=0;P<_.length;P++)if(I(L,_[P]))return P;return-1}function l(L,_){u(L,0,L.children.length,_,L)}function u(L,_,I,P,U){U||(U=M(null)),U.minX=1/0,U.minY=1/0,U.maxX=-1/0,U.maxY=-1/0;for(var q=_;q<I;q++){var Q=L.children[q];h(U,L.leaf?P(Q):Q)}return U}function h(L,_){return L.minX=Math.min(L.minX,_.minX),L.minY=Math.min(L.minY,_.minY),L.maxX=Math.max(L.maxX,_.maxX),L.maxY=Math.max(L.maxY,_.maxY),L}function v(L,_){return L.minX-_.minX}function p(L,_){return L.minY-_.minY}function m(L){return(L.maxX-L.minX)*(L.maxY-L.minY)}function C(L){return L.maxX-L.minX+(L.maxY-L.minY)}function w(L,_){return(Math.max(_.maxX,L.maxX)-Math.min(_.minX,L.minX))*(Math.max(_.maxY,L.maxY)-Math.min(_.minY,L.minY))}function b(L,_){var I=Math.max(L.minX,_.minX),P=Math.max(L.minY,_.minY),U=Math.min(L.maxX,_.maxX),q=Math.min(L.maxY,_.maxY);return Math.max(0,U-I)*Math.max(0,q-P)}function E(L,_){return L.minX<=_.minX&&L.minY<=_.minY&&_.maxX<=L.maxX&&_.maxY<=L.maxY}function R(L,_){return _.minX<=L.maxX&&_.minY<=L.maxY&&_.maxX>=L.minX&&_.maxY>=L.minY}function M(L){return{children:L,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function k(L,_,I,P,U){for(var q=[_,I];q.length;)if(I=q.pop(),_=q.pop(),!(I-_<=P)){var Q=_+Math.ceil((I-_)/P/2)*P;e(L,Q,_,I,U),q.push(_,Q,Q,I)}}return o})})(Py);var ZR=Py.exports,ge;(function(t){t.GROUP="g",t.CIRCLE="circle",t.ELLIPSE="ellipse",t.IMAGE="image",t.RECT="rect",t.LINE="line",t.POLYLINE="polyline",t.POLYGON="polygon",t.TEXT="text",t.PATH="path",t.HTML="html",t.MESH="mesh"})(ge||(ge={}));var $o;(function(t){t[t.ZERO=0]="ZERO",t[t.NEGATIVE_ONE=1]="NEGATIVE_ONE"})($o||($o={}));var ho=function(){function t(){this.plugins=[]}return t.prototype.addRenderingPlugin=function(r){this.plugins.push(r),this.context.renderingPlugins.push(r)},t.prototype.removeAllRenderingPlugins=function(){var r=this;this.plugins.forEach(function(e){var n=r.context.renderingPlugins.indexOf(e);n>=0&&r.context.renderingPlugins.splice(n,1)})},t}(),jR=function(){function t(r){this.clipSpaceNearZ=$o.NEGATIVE_ONE,this.plugins=[],this.config=Y({enableDirtyCheck:!0,enableCulling:!1,enableAutoRendering:!0,enableDirtyRectangleRendering:!0,enableDirtyRectangleRenderingDebug:!1,enableSizeAttenuation:!0},r)}return t.prototype.registerPlugin=function(r){var e=this.plugins.findIndex(function(n){return n===r});e===-1&&this.plugins.push(r)},t.prototype.unregisterPlugin=function(r){var e=this.plugins.findIndex(function(n){return n===r});e>-1&&this.plugins.splice(e,1)},t.prototype.getPlugins=function(){return this.plugins},t.prototype.getPlugin=function(r){return this.plugins.find(function(e){return e.name===r})},t.prototype.getConfig=function(){return this.config},t.prototype.setConfig=function(r){Object.assign(this.config,r)},t}();function ko(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t}function fh(t,r,e){return t[0]=r[0]-e[0],t[1]=r[1]-e[1],t[2]=r[2]-e[2],t}function Vu(t,r,e){return t[0]=r[0]+e[0],t[1]=r[1]+e[1],t[2]=r[2]+e[2],t}function Yg(t,r,e){return t[0]=r[0]*e,t[1]=r[1]*e,t[2]=r[2]*e,t}function JR(t,r,e){return t[0]=Math.max(r[0],e[0]),t[1]=Math.max(r[1],e[1]),t[2]=Math.max(r[2],e[2]),t}function QR(t,r,e){return t[0]=Math.min(r[0],e[0]),t[1]=Math.min(r[1],e[1]),t[2]=Math.min(r[2],e[2]),t}function qo(t){return t===void 0?0:t>360||t<-360?t%360:t}function Jr(t,r,e){return r===void 0&&(r=0),e===void 0&&(e=0),Array.isArray(t)&&t.length===3?ea(t):li(t)?_t(t,r,e):_t(t[0],t[1]||r,t[2]||e)}function Vt(t){return t*(Math.PI/180)}function zn(t){return t*(180/Math.PI)}function eL(t){return 360*t}function tL(t,r){var e=r[0],n=r[1],i=r[2],a=r[3],o=e*e,s=n*n,l=i*i,u=a*a,h=o+s+l+u,v=e*a-n*i;return v>.499995*h?(t[0]=Math.PI/2,t[1]=2*Math.atan2(n,e),t[2]=0):v<-.499995*h?(t[0]=-Math.PI/2,t[1]=2*Math.atan2(n,e),t[2]=0):(t[0]=Math.asin(2*(e*i-a*n)),t[1]=Math.atan2(2*(e*a+n*i),1-2*(l+u)),t[2]=Math.atan2(2*(e*n+i*a),1-2*(s+l))),t}function rL(t,r){var e,n,i=Math.PI*.5,a=te(Qo(at(),r),3),o=a[0],s=a[1],l=a[2],u=Math.asin(-r[2]/o);return u<i?u>-i?(e=Math.atan2(r[6]/s,r[10]/l),n=Math.atan2(r[1]/o,r[0]/o)):(n=0,e=-Math.atan2(r[4]/s,r[5]/s)):(n=0,e=Math.atan2(r[4]/s,r[5]/s)),t[0]=e,t[1]=u,t[2]=n,t}function hh(t,r){return r.length===16?rL(t,r):tL(t,r)}function nL(t,r,e,n,i){var a=Math.cos(t),o=Math.sin(t);return l_(n*a,i*o,0,-n*o,i*a,0,r,e,1)}function iL(t,r,e,n,i,a,o,s){s===void 0&&(s=!1);var l=2*a/(e-r),u=2*a/(n-i),h=(e+r)/(e-r),v=(n+i)/(n-i),p,m;return s?(p=-o/(o-a),m=-o*a/(o-a)):(p=-(o+a)/(o-a),m=-2*o*a/(o-a)),t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=h,t[9]=v,t[10]=p,t[11]=-1,t[12]=0,t[13]=0,t[14]=m,t[15]=0,t}function $g(t){var r=t[0],e=t[1],n=t[3],i=t[4],a=Math.sqrt(r*r+e*e),o=Math.sqrt(n*n+i*i),s=r*i-e*n;s<0&&(r<i?a=-a:o=-o),a&&(r*=1/a,e*=1/a),o&&(n*=1/o,i*=1/o);var l=Math.atan2(e,r),u=zn(l);return[t[6],t[7],a,o,u]}var xi=Ot(),Kn=Ot(),Vs=Fo(),Ze=[at(),at(),at()],qg=at();function aL(t,r,e,n,i,a){if(!oL(xi,t)||(to(Kn,xi),Kn[3]=0,Kn[7]=0,Kn[11]=0,Kn[15]=1,Math.abs(ly(Kn))<1e-8))return!1;var o=xi[3],s=xi[7],l=xi[11],u=xi[12],h=xi[13],v=xi[14],p=xi[15];if(o!==0||s!==0||l!==0){Vs[0]=o,Vs[1]=s,Vs[2]=l,Vs[3]=p;var m=Ti(Kn,Kn);if(!m)return!1;sy(Kn,Kn),js(i,Vs,Kn)}else i[0]=i[1]=i[2]=0,i[3]=1;if(r[0]=u,r[1]=h,r[2]=v,sL(Ze,xi),e[0]=ra(Ze[0]),Ja(Ze[0],Ze[0]),n[0]=_i(Ze[0],Ze[1]),dh(Ze[1],Ze[1],Ze[0],1,-n[0]),e[1]=ra(Ze[1]),Ja(Ze[1],Ze[1]),n[0]/=e[1],n[1]=_i(Ze[0],Ze[2]),dh(Ze[2],Ze[2],Ze[0],1,-n[1]),n[2]=_i(Ze[1],Ze[2]),dh(Ze[2],Ze[2],Ze[1],1,-n[2]),e[2]=ra(Ze[2]),Ja(Ze[2],Ze[2]),n[1]/=e[2],n[2]/=e[2],Wu(qg,Ze[1],Ze[2]),_i(Ze[0],qg)<0)for(var C=0;C<3;C++)e[C]*=-1,Ze[C][0]*=-1,Ze[C][1]*=-1,Ze[C][2]*=-1;return a[0]=.5*Math.sqrt(Math.max(1+Ze[0][0]-Ze[1][1]-Ze[2][2],0)),a[1]=.5*Math.sqrt(Math.max(1-Ze[0][0]+Ze[1][1]-Ze[2][2],0)),a[2]=.5*Math.sqrt(Math.max(1-Ze[0][0]-Ze[1][1]+Ze[2][2],0)),a[3]=.5*Math.sqrt(Math.max(1+Ze[0][0]+Ze[1][1]+Ze[2][2],0)),Ze[2][1]>Ze[1][2]&&(a[0]=-a[0]),Ze[0][2]>Ze[2][0]&&(a[1]=-a[1]),Ze[1][0]>Ze[0][1]&&(a[2]=-a[2]),!0}function oL(t,r){var e=r[15];if(e===0)return!1;for(var n=1/e,i=0;i<16;i++)t[i]=r[i]*n;return!0}function sL(t,r){t[0][0]=r[0],t[0][1]=r[1],t[0][2]=r[2],t[1][0]=r[4],t[1][1]=r[5],t[1][2]=r[6],t[2][0]=r[8],t[2][1]=r[9],t[2][2]=r[10]}function dh(t,r,e,n,i){t[0]=r[0]*n+e[0]*i,t[1]=r[1]*n+e[1]*i,t[2]=r[2]*n+e[2]*i}var ur=function(){function t(){this.center=[0,0,0],this.halfExtents=[0,0,0],this.min=[0,0,0],this.max=[0,0,0]}return t.isEmpty=function(r){return!r||r.halfExtents[0]===0&&r.halfExtents[1]===0&&r.halfExtents[2]===0},t.prototype.update=function(r,e){ko(this.center,r),ko(this.halfExtents,e),fh(this.min,this.center,this.halfExtents),Vu(this.max,this.center,this.halfExtents)},t.prototype.setMinMax=function(r,e){Vu(this.center,e,r),Yg(this.center,this.center,.5),fh(this.halfExtents,e,r),Yg(this.halfExtents,this.halfExtents,.5),ko(this.min,r),ko(this.max,e)},t.prototype.getMin=function(){return this.min},t.prototype.getMax=function(){return this.max},t.prototype.add=function(r){if(!t.isEmpty(r)){if(t.isEmpty(this)){this.setMinMax(r.getMin(),r.getMax());return}var e=this.center,n=e[0],i=e[1],a=e[2],o=this.halfExtents,s=o[0],l=o[1],u=o[2],h=n-s,v=n+s,p=i-l,m=i+l,C=a-u,w=a+u,b=r.center,E=b[0],R=b[1],M=b[2],k=r.halfExtents,L=k[0],_=k[1],I=k[2],P=E-L,U=E+L,q=R-_,Q=R+_,J=M-I,re=M+I;P<h&&(h=P),U>v&&(v=U),q<p&&(p=q),Q>m&&(m=Q),J<C&&(C=J),re>w&&(w=re),e[0]=(h+v)*.5,e[1]=(p+m)*.5,e[2]=(C+w)*.5,o[0]=(v-h)*.5,o[1]=(m-p)*.5,o[2]=(w-C)*.5,this.min[0]=h,this.min[1]=p,this.min[2]=C,this.max[0]=v,this.max[1]=m,this.max[2]=w}},t.prototype.setFromTransformedAABB=function(r,e){var n=this.center,i=this.halfExtents,a=r.center,o=r.halfExtents,s=e[0],l=e[4],u=e[8],h=e[1],v=e[5],p=e[9],m=e[2],C=e[6],w=e[10],b=Math.abs(s),E=Math.abs(l),R=Math.abs(u),M=Math.abs(h),k=Math.abs(v),L=Math.abs(p),_=Math.abs(m),I=Math.abs(C),P=Math.abs(w);n[0]=e[12]+s*a[0]+l*a[1]+u*a[2],n[1]=e[13]+h*a[0]+v*a[1]+p*a[2],n[2]=e[14]+m*a[0]+C*a[1]+w*a[2],i[0]=b*o[0]+E*o[1]+R*o[2],i[1]=M*o[0]+k*o[1]+L*o[2],i[2]=_*o[0]+I*o[1]+P*o[2],fh(this.min,n,i),Vu(this.max,n,i)},t.prototype.intersects=function(r){var e=this.getMax(),n=this.getMin(),i=r.getMax(),a=r.getMin();return n[0]<=i[0]&&e[0]>=a[0]&&n[1]<=i[1]&&e[1]>=a[1]&&n[2]<=i[2]&&e[2]>=a[2]},t.prototype.intersection=function(r){if(!this.intersects(r))return null;var e=new t,n=JR([0,0,0],this.getMin(),r.getMin()),i=QR([0,0,0],this.getMax(),r.getMax());return e.setMinMax(n,i),e},t.prototype.getNegativeFarPoint=function(r){return r.pnVertexFlag===273?ko([0,0,0],this.min):r.pnVertexFlag===272?[this.min[0],this.min[1],this.max[2]]:r.pnVertexFlag===257?[this.min[0],this.max[1],this.min[2]]:r.pnVertexFlag===256?[this.min[0],this.max[1],this.max[2]]:r.pnVertexFlag===17?[this.max[0],this.min[1],this.min[2]]:r.pnVertexFlag===16?[this.max[0],this.min[1],this.max[2]]:r.pnVertexFlag===1?[this.max[0],this.max[1],this.min[2]]:[this.max[0],this.max[1],this.max[2]]},t.prototype.getPositiveFarPoint=function(r){return r.pnVertexFlag===273?ko([0,0,0],this.max):r.pnVertexFlag===272?[this.max[0],this.max[1],this.min[2]]:r.pnVertexFlag===257?[this.max[0],this.min[1],this.max[2]]:r.pnVertexFlag===256?[this.max[0],this.min[1],this.min[2]]:r.pnVertexFlag===17?[this.min[0],this.max[1],this.max[2]]:r.pnVertexFlag===16?[this.min[0],this.max[1],this.min[2]]:r.pnVertexFlag===1?[this.min[0],this.min[1],this.max[2]]:[this.min[0],this.min[1],this.min[2]]},t}(),lL=function(){function t(r,e){this.distance=r||0,this.normal=e||_t(0,1,0),this.updatePNVertexFlag()}return t.prototype.updatePNVertexFlag=function(){this.pnVertexFlag=(+(this.normal[0]>=0)<<8)+(+(this.normal[1]>=0)<<4)+ +(this.normal[2]>=0)},t.prototype.distanceToPoint=function(r){return _i(r,this.normal)-this.distance},t.prototype.normalize=function(){var r=1/wy(this.normal);Hh(this.normal,this.normal,r),this.distance*=r},t.prototype.intersectsLine=function(r,e,n){var i=this.distanceToPoint(r),a=this.distanceToPoint(e),o=i/(i-a),s=o>=0&&o<=1;return s&&n&&zh(n,r,e,o),s},t}(),ya;(function(t){t[t.OUTSIDE=4294967295]="OUTSIDE",t[t.INSIDE=0]="INSIDE",t[t.INDETERMINATE=2147483647]="INDETERMINATE"})(ya||(ya={}));var uL=function(){function t(r){if(this.planes=[],r)this.planes=r;else for(var e=0;e<6;e++)this.planes.push(new lL)}return t.prototype.extractFromVPMatrix=function(r){var e=te(r,16),n=e[0],i=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],h=e[7],v=e[8],p=e[9],m=e[10],C=e[11],w=e[12],b=e[13],E=e[14],R=e[15];Jn(this.planes[0].normal,o-n,h-s,C-v),this.planes[0].distance=R-w,Jn(this.planes[1].normal,o+n,h+s,C+v),this.planes[1].distance=R+w,Jn(this.planes[2].normal,o+i,h+l,C+p),this.planes[2].distance=R+b,Jn(this.planes[3].normal,o-i,h-l,C-p),this.planes[3].distance=R-b,Jn(this.planes[4].normal,o-a,h-u,C-m),this.planes[4].distance=R-E,Jn(this.planes[5].normal,o+a,h+u,C+m),this.planes[5].distance=R+E,this.planes.forEach(function(M){M.normalize(),M.updatePNVertexFlag()})},t}(),Tr=function(){function t(r,e){r===void 0&&(r=0),e===void 0&&(e=0),this.x=0,this.y=0,this.x=r,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.copyFrom=function(r){this.x=r.x,this.y=r.y},t}(),ro=function(){function t(r,e,n,i){this.x=r,this.y=e,this.width=n,this.height=i,this.left=r,this.right=r+n,this.top=e,this.bottom=e+i}return t.prototype.toJSON=function(){},t}(),Tt="Method not implemented.",Io="Use document.documentElement instead.",cL="Cannot append a destroyed element.",Ct;(function(t){t[t.ORBITING=0]="ORBITING",t[t.EXPLORING=1]="EXPLORING",t[t.TRACKING=2]="TRACKING"})(Ct||(Ct={}));var dl;(function(t){t[t.DEFAULT=0]="DEFAULT",t[t.ROTATIONAL=1]="ROTATIONAL",t[t.TRANSLATIONAL=2]="TRANSLATIONAL",t[t.CINEMATIC=3]="CINEMATIC"})(dl||(dl={}));var un;(function(t){t[t.ORTHOGRAPHIC=0]="ORTHOGRAPHIC",t[t.PERSPECTIVE=1]="PERSPECTIVE"})(un||(un={}));var Dy={UPDATED:"updated"},Kg=2e-4,By=function(){function t(){this.clipSpaceNearZ=$o.NEGATIVE_ONE,this.eventEmitter=new Qd,this.matrix=Ot(),this.right=_t(1,0,0),this.up=_t(0,1,0),this.forward=_t(0,0,1),this.position=_t(0,0,1),this.focalPoint=_t(0,0,0),this.distanceVector=_t(0,0,-1),this.distance=1,this.azimuth=0,this.elevation=0,this.roll=0,this.relAzimuth=0,this.relElevation=0,this.relRoll=0,this.dollyingStep=0,this.maxDistance=1/0,this.minDistance=-1/0,this.zoom=1,this.rotateWorld=!1,this.fov=30,this.near=.1,this.far=1e3,this.aspect=1,this.projectionMatrix=Ot(),this.projectionMatrixInverse=Ot(),this.jitteredProjectionMatrix=void 0,this.enableUpdate=!0,this.type=Ct.EXPLORING,this.trackingMode=dl.DEFAULT,this.projectionMode=un.PERSPECTIVE,this.frustum=new uL,this.orthoMatrix=Ot()}return t.prototype.isOrtho=function(){return this.projectionMode===un.ORTHOGRAPHIC},t.prototype.getProjectionMode=function(){return this.projectionMode},t.prototype.getPerspective=function(){return this.jitteredProjectionMatrix||this.projectionMatrix},t.prototype.getPerspectiveInverse=function(){return this.projectionMatrixInverse},t.prototype.getFrustum=function(){return this.frustum},t.prototype.getPosition=function(){return this.position},t.prototype.getFocalPoint=function(){return this.focalPoint},t.prototype.getDollyingStep=function(){return this.dollyingStep},t.prototype.getNear=function(){return this.near},t.prototype.getFar=function(){return this.far},t.prototype.getZoom=function(){return this.zoom},t.prototype.getOrthoMatrix=function(){return this.orthoMatrix},t.prototype.getView=function(){return this.view},t.prototype.setEnableUpdate=function(r){this.enableUpdate=r},t.prototype.setType=function(r,e){return this.type=r,this.type===Ct.EXPLORING?this.setWorldRotation(!0):this.setWorldRotation(!1),this._getAngles(),this.type===Ct.TRACKING&&e!==void 0&&this.setTrackingMode(e),this},t.prototype.setProjectionMode=function(r){return this.projectionMode=r,this},t.prototype.setTrackingMode=function(r){if(this.type!==Ct.TRACKING)throw new Error("Impossible to set a tracking mode if the camera is not of tracking type");return this.trackingMode=r,this},t.prototype.setWorldRotation=function(r){return this.rotateWorld=r,this._getAngles(),this},t.prototype.getViewTransform=function(){return Ti(Ot(),this.matrix)},t.prototype.getWorldTransform=function(){return this.matrix},t.prototype.jitterProjectionMatrix=function(r,e){var n=fy(Ot(),[r,e,0]);this.jitteredProjectionMatrix=Gr(Ot(),n,this.projectionMatrix)},t.prototype.clearJitterProjectionMatrix=function(){this.jitteredProjectionMatrix=void 0},t.prototype.setMatrix=function(r){return this.matrix=r,this._update(),this},t.prototype.setFov=function(r){return this.setPerspective(this.near,this.far,r,this.aspect),this},t.prototype.setAspect=function(r){return this.setPerspective(this.near,this.far,this.fov,r),this},t.prototype.setNear=function(r){return this.projectionMode===un.PERSPECTIVE?this.setPerspective(r,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,r,this.far),this},t.prototype.setFar=function(r){return this.projectionMode===un.PERSPECTIVE?this.setPerspective(this.near,r,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,r),this},t.prototype.setViewOffset=function(r,e,n,i,a,o){return this.aspect=r/e,this.view===void 0&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=i,this.view.width=a,this.view.height=o,this.projectionMode===un.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},t.prototype.clearViewOffset=function(){return this.view!==void 0&&(this.view.enabled=!1),this.projectionMode===un.PERSPECTIVE?this.setPerspective(this.near,this.far,this.fov,this.aspect):this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far),this},t.prototype.setZoom=function(r){return this.zoom=r,this.projectionMode===un.ORTHOGRAPHIC?this.setOrthographic(this.left,this.rright,this.top,this.bottom,this.near,this.far):this.projectionMode===un.PERSPECTIVE&&this.setPerspective(this.near,this.far,this.fov,this.aspect),this},t.prototype.setZoomByViewportPoint=function(r,e){var n=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),i=n.x,a=n.y,o=this.roll;this.rotate(0,0,-o),this.setPosition(i,a),this.setFocalPoint(i,a),this.setZoom(r),this.rotate(0,0,o);var s=this.canvas.viewport2Canvas({x:e[0],y:e[1]}),l=s.x,u=s.y,h=_t(l-i,u-a,0),v=_i(h,this.right)/ra(this.right),p=_i(h,this.up)/ra(this.up);return this.pan(-v,-p),this},t.prototype.setPerspective=function(r,e,n,i){var a;this.projectionMode=un.PERSPECTIVE,this.fov=n,this.near=r,this.far=e,this.aspect=i;var o=this.near*Math.tan(Vt(.5*this.fov))/this.zoom,s=2*o,l=this.aspect*s,u=-.5*l;if(!((a=this.view)===null||a===void 0)&&a.enabled){var h=this.view.fullWidth,v=this.view.fullHeight;u+=this.view.offsetX*l/h,o-=this.view.offsetY*s/v,l*=this.view.width/h,s*=this.view.height/v}return iL(this.projectionMatrix,u,u+l,o,o-s,r,this.far,this.clipSpaceNearZ===$o.ZERO),Ku(this.projectionMatrix,this.projectionMatrix,_t(1,-1,1)),Ti(this.projectionMatrixInverse,this.projectionMatrix),this.triggerUpdate(),this},t.prototype.setOrthographic=function(r,e,n,i,a,o){var s;this.projectionMode=un.ORTHOGRAPHIC,this.rright=e,this.left=r,this.top=n,this.bottom=i,this.near=a,this.far=o;var l=(this.rright-this.left)/(2*this.zoom),u=(this.top-this.bottom)/(2*this.zoom),h=(this.rright+this.left)/2,v=(this.top+this.bottom)/2,p=h-l,m=h+l,C=v+u,w=v-u;if(!((s=this.view)===null||s===void 0)&&s.enabled){var b=(this.rright-this.left)/this.view.fullWidth/this.zoom,E=(this.top-this.bottom)/this.view.fullHeight/this.zoom;p+=b*this.view.offsetX,m=p+b*this.view.width,C-=E*this.view.offsetY,w=C-E*this.view.height}return this.clipSpaceNearZ===$o.NEGATIVE_ONE?gy(this.projectionMatrix,p,m,w,C,a,o):my(this.projectionMatrix,p,m,w,C,a,o),Ku(this.projectionMatrix,this.projectionMatrix,_t(1,-1,1)),Ti(this.projectionMatrixInverse,this.projectionMatrix),this._getOrthoMatrix(),this.triggerUpdate(),this},t.prototype.setPosition=function(r,e,n){e===void 0&&(e=this.position[1]),n===void 0&&(n=this.position[2]);var i=Jr(r,e,n);return this._setPosition(i),this.setFocalPoint(this.focalPoint),this.triggerUpdate(),this},t.prototype.setFocalPoint=function(r,e,n){e===void 0&&(e=this.focalPoint[1]),n===void 0&&(n=this.focalPoint[2]);var i=_t(0,1,0);if(this.focalPoint=Jr(r,e,n),this.trackingMode===dl.CINEMATIC){var a=Tg(at(),this.focalPoint,this.position);r=a[0],e=a[1],n=a[2];var o=ra(a),s=zn(Math.asin(e/o)),l=90+zn(Math.atan2(n,r)),u=Ot();cy(u,u,Vt(l)),uy(u,u,Vt(s)),i=Gn(at(),[0,1,0],u)}return Ti(this.matrix,yy(Ot(),this.position,this.focalPoint,i)),this._getAxes(),this._getDistance(),this._getAngles(),this.triggerUpdate(),this},t.prototype.getDistance=function(){return this.distance},t.prototype.getDistanceVector=function(){return this.distanceVector},t.prototype.setDistance=function(r){if(this.distance===r||r<0)return this;this.distance=r,this.distance<Kg&&(this.distance=Kg),this.dollyingStep=this.distance/100;var e=at();r=this.distance;var n=this.forward,i=this.focalPoint;return e[0]=r*n[0]+i[0],e[1]=r*n[1]+i[1],e[2]=r*n[2]+i[2],this._setPosition(e),this.triggerUpdate(),this},t.prototype.setMaxDistance=function(r){return this.maxDistance=r,this},t.prototype.setMinDistance=function(r){return this.minDistance=r,this},t.prototype.setAzimuth=function(r){return this.azimuth=qo(r),this.computeMatrix(),this._getAxes(),this.type===Ct.ORBITING||this.type===Ct.EXPLORING?this._getPosition():this.type===Ct.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},t.prototype.getAzimuth=function(){return this.azimuth},t.prototype.setElevation=function(r){return this.elevation=qo(r),this.computeMatrix(),this._getAxes(),this.type===Ct.ORBITING||this.type===Ct.EXPLORING?this._getPosition():this.type===Ct.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},t.prototype.getElevation=function(){return this.elevation},t.prototype.setRoll=function(r){return this.roll=qo(r),this.computeMatrix(),this._getAxes(),this.type===Ct.ORBITING||this.type===Ct.EXPLORING?this._getPosition():this.type===Ct.TRACKING&&this._getFocalPoint(),this.triggerUpdate(),this},t.prototype.getRoll=function(){return this.roll},t.prototype._update=function(){this._getAxes(),this._getPosition(),this._getDistance(),this._getAngles(),this._getOrthoMatrix(),this.triggerUpdate()},t.prototype.computeMatrix=function(){var r=xa(rr(),[0,0,1],Vt(this.roll));Ol(this.matrix);var e=xa(rr(),[1,0,0],Vt((this.rotateWorld&&this.type!==Ct.TRACKING||this.type===Ct.TRACKING?1:-1)*this.elevation)),n=xa(rr(),[0,1,0],Vt((this.rotateWorld&&this.type!==Ct.TRACKING||this.type===Ct.TRACKING?1:-1)*this.azimuth)),i=Ta(rr(),n,e);i=Ta(rr(),i,r);var a=ev(Ot(),i);this.type===Ct.ORBITING||this.type===Ct.EXPLORING?(Ea(this.matrix,this.matrix,this.focalPoint),Gr(this.matrix,this.matrix,a),Ea(this.matrix,this.matrix,[0,0,this.distance])):this.type===Ct.TRACKING&&(Ea(this.matrix,this.matrix,this.position),Gr(this.matrix,this.matrix,a))},t.prototype._setPosition=function(r,e,n){this.position=Jr(r,e,n);var i=this.matrix;i[12]=this.position[0],i[13]=this.position[1],i[14]=this.position[2],i[15]=1,this._getOrthoMatrix()},t.prototype._getAxes=function(){cn(this.right,Jr(js(Fo(),[1,0,0,0],this.matrix))),cn(this.up,Jr(js(Fo(),[0,1,0,0],this.matrix))),cn(this.forward,Jr(js(Fo(),[0,0,1,0],this.matrix))),Ja(this.right,this.right),Ja(this.up,this.up),Ja(this.forward,this.forward)},t.prototype._getAngles=function(){var r=this.distanceVector[0],e=this.distanceVector[1],n=this.distanceVector[2],i=ra(this.distanceVector);if(i===0){this.elevation=0,this.azimuth=0;return}this.type===Ct.TRACKING?(this.elevation=zn(Math.asin(e/i)),this.azimuth=zn(Math.atan2(-r,-n))):this.rotateWorld?(this.elevation=zn(Math.asin(e/i)),this.azimuth=zn(Math.atan2(-r,-n))):(this.elevation=-zn(Math.asin(e/i)),this.azimuth=-zn(Math.atan2(-r,-n)))},t.prototype._getPosition=function(){cn(this.position,Jr(js(Fo(),[0,0,0,1],this.matrix))),this._getDistance()},t.prototype._getFocalPoint=function(){D_(this.distanceVector,[0,0,-this.distance],s_(ay(),this.matrix)),Xo(this.focalPoint,this.position,this.distanceVector),this._getDistance()},t.prototype._getDistance=function(){this.distanceVector=Tg(at(),this.focalPoint,this.position),this.distance=ra(this.distanceVector),this.dollyingStep=this.distance/100},t.prototype._getOrthoMatrix=function(){if(this.projectionMode===un.ORTHOGRAPHIC){var r=this.position,e=xa(rr(),[0,0,1],-this.roll*Math.PI/180);il(this.orthoMatrix,e,_t((this.rright-this.left)/2-r[0],(this.top-this.bottom)/2-r[1],0),_t(this.zoom,this.zoom,1),r)}},t.prototype.triggerUpdate=function(){if(this.enableUpdate){var r=this.getViewTransform(),e=Gr(Ot(),this.getPerspective(),r);this.getFrustum().extractFromVPMatrix(e),this.eventEmitter.emit(Dy.UPDATED)}},t.prototype.rotate=function(r,e,n){throw new Error(Tt)},t.prototype.pan=function(r,e){throw new Error(Tt)},t.prototype.dolly=function(r){throw new Error(Tt)},t.prototype.createLandmark=function(r,e){throw new Error(Tt)},t.prototype.gotoLandmark=function(r,e){throw new Error(Tt)},t.prototype.cancelLandmarkAnimation=function(){throw new Error(Tt)},t}();function Ir(t,r){if(typeof t!="function"||r!=null&&typeof r!="function")throw new TypeError("Expected a function");var e=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=r?r.apply(this,n):n[0],o=e.cache;if(o.has(a))return o.get(a);var s=t.apply(this,n);return e.cache=o.set(a,s)||o,s};return e.cache=new(Ir.Cache||Map),e}Ir.Cache=Map;var De;(function(t){t[t.kUnknown=0]="kUnknown",t[t.kNumber=1]="kNumber",t[t.kPercentage=2]="kPercentage",t[t.kEms=3]="kEms",t[t.kPixels=4]="kPixels",t[t.kRems=5]="kRems",t[t.kDegrees=6]="kDegrees",t[t.kRadians=7]="kRadians",t[t.kGradians=8]="kGradians",t[t.kTurns=9]="kTurns",t[t.kMilliseconds=10]="kMilliseconds",t[t.kSeconds=11]="kSeconds",t[t.kInteger=12]="kInteger"})(De||(De={}));var En;(function(t){t[t.kUNumber=0]="kUNumber",t[t.kUPercent=1]="kUPercent",t[t.kULength=2]="kULength",t[t.kUAngle=3]="kUAngle",t[t.kUTime=4]="kUTime",t[t.kUOther=5]="kUOther"})(En||(En={}));var Zg;(function(t){t[t.kAll=0]="kAll",t[t.kNonNegative=1]="kNonNegative",t[t.kInteger=2]="kInteger",t[t.kNonNegativeInteger=3]="kNonNegativeInteger",t[t.kPositiveInteger=4]="kPositiveInteger"})(Zg||(Zg={}));var Yh;(function(t){t[t.kYes=0]="kYes",t[t.kNo=1]="kNo"})(Yh||(Yh={}));var $h;(function(t){t[t.kYes=0]="kYes",t[t.kNo=1]="kNo"})($h||($h={}));var fL=[{name:"em",unit_type:De.kEms},{name:"px",unit_type:De.kPixels},{name:"deg",unit_type:De.kDegrees},{name:"rad",unit_type:De.kRadians},{name:"grad",unit_type:De.kGradians},{name:"ms",unit_type:De.kMilliseconds},{name:"s",unit_type:De.kSeconds},{name:"rem",unit_type:De.kRems},{name:"turn",unit_type:De.kTurns}],Ma;(function(t){t[t.kUnknownType=0]="kUnknownType",t[t.kUnparsedType=1]="kUnparsedType",t[t.kKeywordType=2]="kKeywordType",t[t.kUnitType=3]="kUnitType",t[t.kSumType=4]="kSumType",t[t.kProductType=5]="kProductType",t[t.kNegateType=6]="kNegateType",t[t.kInvertType=7]="kInvertType",t[t.kMinType=8]="kMinType",t[t.kMaxType=9]="kMaxType",t[t.kClampType=10]="kClampType",t[t.kTransformType=11]="kTransformType",t[t.kPositionType=12]="kPositionType",t[t.kURLImageType=13]="kURLImageType",t[t.kColorType=14]="kColorType",t[t.kUnsupportedColorType=15]="kUnsupportedColorType"})(Ma||(Ma={}));var hL=function(t){return fL.find(function(r){return r.name===t}).unit_type},dL=function(t){return t?t==="number"?De.kNumber:t==="percent"||t==="%"?De.kPercentage:hL(t):De.kUnknown},vL=function(t){switch(t){case De.kNumber:case De.kInteger:return En.kUNumber;case De.kPercentage:return En.kUPercent;case De.kPixels:return En.kULength;case De.kMilliseconds:case De.kSeconds:return En.kUTime;case De.kDegrees:case De.kRadians:case De.kGradians:case De.kTurns:return En.kUAngle;default:return En.kUOther}},pL=function(t){switch(t){case En.kUNumber:return De.kNumber;case En.kULength:return De.kPixels;case En.kUPercent:return De.kPercentage;case En.kUTime:return De.kSeconds;case En.kUAngle:return De.kDegrees;default:return De.kUnknown}},jg=function(t){var r=1;switch(t){case De.kPixels:case De.kDegrees:case De.kSeconds:break;case De.kMilliseconds:r=.001;break;case De.kRadians:r=180/Math.PI;break;case De.kGradians:r=.9;break;case De.kTurns:r=360;break}return r},qh=function(t){switch(t){case De.kNumber:case De.kInteger:return"";case De.kPercentage:return"%";case De.kEms:return"em";case De.kRems:return"rem";case De.kPixels:return"px";case De.kDegrees:return"deg";case De.kRadians:return"rad";case De.kGradians:return"grad";case De.kMilliseconds:return"ms";case De.kSeconds:return"s";case De.kTurns:return"turn"}return""},Dc=function(){function t(){}return t.isAngle=function(r){return r===De.kDegrees||r===De.kRadians||r===De.kGradians||r===De.kTurns},t.isLength=function(r){return r>=De.kEms&&r<De.kDegrees},t.isRelativeUnit=function(r){return r===De.kPercentage||r===De.kEms||r===De.kRems},t.isTime=function(r){return r===De.kSeconds||r===De.kMilliseconds},t.prototype.toString=function(){return this.buildCSSText(Yh.kNo,$h.kNo,"")},t.prototype.isNumericValue=function(){return this.getType()>=Ma.kUnitType&&this.getType()<=Ma.kClampType},t}(),gL=function(t){Me(r,t);function r(e){var n=t.call(this)||this;return n.colorSpace=e,n}return r.prototype.getType=function(){return Ma.kColorType},r.prototype.to=function(e){return this},r}(Dc),Ri;(function(t){t[t.Constant=0]="Constant",t[t.LinearGradient=1]="LinearGradient",t[t.RadialGradient=2]="RadialGradient"})(Ri||(Ri={}));var yu=function(t){Me(r,t);function r(e,n){var i=t.call(this)||this;return i.type=e,i.value=n,i}return r.prototype.clone=function(){return new r(this.type,this.value)},r.prototype.buildCSSText=function(e,n,i){return i},r.prototype.getType=function(){return Ma.kColorType},r}(Dc),dn=function(t){Me(r,t);function r(e){var n=t.call(this)||this;return n.value=e,n}return r.prototype.clone=function(){return new r(this.value)},r.prototype.getType=function(){return Ma.kKeywordType},r.prototype.buildCSSText=function(e,n,i){return i+this.value},r}(Dc),mL=Ir(function(t){return t===void 0&&(t=""),t.replace(/-([a-z])/g,function(r){return r[1].toUpperCase()})}),Jg=function(t){return t.split("").map(function(r,e){return r.toUpperCase()===r?"".concat(e!==0?"-":"").concat(r.toLowerCase()):r}).join("")};function yL(t){if(!t)throw new Error}function Ho(t){return typeof t=="function"}function CL(t){return typeof t=="symbol"}var wL={d:{alias:"path"},strokeDasharray:{alias:"lineDash"},strokeWidth:{alias:"lineWidth"},textAnchor:{alias:"textAlign"},src:{alias:"img"}},Kh=Ir(function(t){var r=mL(t),e=wL[r];return r=(e==null?void 0:e.alias)||r,r}),xL=function(t,r){r===void 0&&(r="");var e="";return Number.isFinite(t)?(yL(Number.isNaN(t)),e="NaN"):t>0?e="infinity":e="-infinity",e+=r},Zh=function(t){return pL(vL(t))},xr=function(t){Me(r,t);function r(e,n){n===void 0&&(n=De.kNumber);var i=t.call(this)||this,a;return typeof n=="string"?a=dL(n):a=n,i.unit=a,i.value=e,i}return r.prototype.clone=function(){return new r(this.value,this.unit)},r.prototype.equals=function(e){var n=e;return this.value===n.value&&this.unit===n.unit},r.prototype.getType=function(){return Ma.kUnitType},r.prototype.convertTo=function(e){if(this.unit===e)return new r(this.value,this.unit);var n=Zh(this.unit);if(n!==Zh(e)||n===De.kUnknown)return null;var i=jg(this.unit)/jg(e);return new r(this.value*i,e)},r.prototype.buildCSSText=function(e,n,i){var a;switch(this.unit){case De.kUnknown:break;case De.kInteger:a=Number(this.value).toFixed(0);break;case De.kNumber:case De.kPercentage:case De.kEms:case De.kRems:case De.kPixels:case De.kDegrees:case De.kRadians:case De.kGradians:case De.kMilliseconds:case De.kSeconds:case De.kTurns:{var o=-999999,s=999999,l=this.value,u=qh(this.unit);if(l<o||l>s){var h=qh(this.unit);!Number.isFinite(l)||Number.isNaN(l)?a=xL(l,h):a=l+(h||"")}else a="".concat(l).concat(u)}}return i+=a,i},r}(Dc),dr=new xr(0,"px");new xr(1,"px");var ei=new xr(0,"deg"),iv=function(t){Me(r,t);function r(e,n,i,a,o){a===void 0&&(a=1),o===void 0&&(o=!1);var s=t.call(this,"rgb")||this;return s.r=e,s.g=n,s.b=i,s.alpha=a,s.isNone=o,s}return r.prototype.clone=function(){return new r(this.r,this.g,this.b,this.alpha)},r.prototype.buildCSSText=function(e,n,i){return i+"rgba(".concat(this.r,",").concat(this.g,",").concat(this.b,",").concat(this.alpha,")")},r}(gL),Mt=new dn("unset"),bL=new dn("initial"),SL=new dn("inherit"),vh={"":Mt,unset:Mt,initial:bL,inherit:SL},jh=function(t){return vh[t]||(vh[t]=new dn(t)),vh[t]},Jh=new iv(0,0,0,0,!0),Fy=new iv(0,0,0,0),EL=Ir(function(t,r,e,n){return new iv(t,r,e,n)},function(t,r,e,n){return"rgba(".concat(t,",").concat(r,",").concat(e,",").concat(n,")")}),Rt=function(t,r){return r===void 0&&(r=De.kNumber),new xr(t,r)},tc=new xr(50,"%"),Qh;(function(t){t[t.Standard=0]="Standard"})(Qh||(Qh={}));var ts;(function(t){t[t.ADDED=0]="ADDED",t[t.REMOVED=1]="REMOVED",t[t.Z_INDEX_CHANGED=2]="Z_INDEX_CHANGED"})(ts||(ts={}));var Hy={absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ro(0,0,0,0)},Fe;(function(t){t.COORDINATE="<coordinate>",t.COLOR="<color>",t.PAINT="<paint>",t.NUMBER="<number>",t.ANGLE="<angle>",t.OPACITY_VALUE="<opacity-value>",t.SHADOW_BLUR="<shadow-blur>",t.LENGTH="<length>",t.PERCENTAGE="<percentage>",t.LENGTH_PERCENTAGE="<length> | <percentage>",t.LENGTH_PERCENTAGE_12="[<length> | <percentage>]{1,2}",t.LENGTH_PERCENTAGE_14="[<length> | <percentage>]{1,4}",t.LIST_OF_POINTS="<list-of-points>",t.PATH="<path>",t.FILTER="<filter>",t.Z_INDEX="<z-index>",t.OFFSET_DISTANCE="<offset-distance>",t.DEFINED_PATH="<defined-path>",t.MARKER="<marker>",t.TRANSFORM="<transform>",t.TRANSFORM_ORIGIN="<transform-origin>",t.TEXT="<text>",t.TEXT_TRANSFORM="<text-transform>"})(Fe||(Fe={}));function TL(t){var r=t.type,e=t.value;return r==="hex"?"#".concat(e):r==="literal"?e:r==="rgb"?"rgb(".concat(e.join(","),")"):"rgba(".concat(e.join(","),")")}var _L=function(){var t={linearGradient:/^(linear\-gradient)/i,repeatingLinearGradient:/^(repeating\-linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,repeatingRadialGradient:/^(repeating\-radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/^\#([0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^rgb/i,rgbaColor:/^rgba/i,number:/^(([0-9]*\.[0-9]+)|([0-9]+\.?))/},r="";function e(oe){throw new Error(r+": "+oe)}function n(){var oe=i();return r.length>0&&e("Invalid input not EOF"),oe}function i(){return M(a)}function a(){return o("linear-gradient",t.linearGradient,l)||o("repeating-linear-gradient",t.repeatingLinearGradient,l)||o("radial-gradient",t.radialGradient,v)||o("repeating-radial-gradient",t.repeatingRadialGradient,v)||o("conic-gradient",t.conicGradient,v)}function o(oe,Se,Te){return s(Se,function(Ie){var je=Te();return je&&(ce(t.comma)||e("Missing comma before color stops")),{type:oe,orientation:je,colorStops:M(k)}})}function s(oe,Se){var Te=ce(oe);if(Te){ce(t.startCall)||e("Missing (");var Ie=Se(Te);return ce(t.endCall)||e("Missing )"),Ie}}function l(){return u()||h()}function u(){return ne("directional",t.sideOrCorner,1)}function h(){return ne("angular",t.angleValue,1)}function v(){var oe,Se=p(),Te;return Se&&(oe=[],oe.push(Se),Te=r,ce(t.comma)&&(Se=p(),Se?oe.push(Se):r=Te)),oe}function p(){var oe=m()||C();if(oe)oe.at=b();else{var Se=w();if(Se){oe=Se;var Te=b();Te&&(oe.at=Te)}else{var Ie=E();Ie&&(oe={type:"default-radial",at:Ie})}}return oe}function m(){var oe=ne("shape",/^(circle)/i,0);return oe&&(oe.style=re()||w()),oe}function C(){var oe=ne("shape",/^(ellipse)/i,0);return oe&&(oe.style=Q()||w()),oe}function w(){return ne("extent-keyword",t.extentKeywords,1)}function b(){if(ne("position",/^at/,0)){var oe=E();return oe||e("Missing positioning value"),oe}}function E(){var oe=R();if(oe.x||oe.y)return{type:"position",value:oe}}function R(){return{x:Q(),y:Q()}}function M(oe){var Se=oe(),Te=[];if(Se)for(Te.push(Se);ce(t.comma);)Se=oe(),Se?Te.push(Se):e("One extra comma");return Te}function k(){var oe=L();return oe||e("Expected color definition"),oe.length=Q(),oe}function L(){return I()||U()||P()||_()}function _(){return ne("literal",t.literalColor,0)}function I(){return ne("hex",t.hexColor,1)}function P(){return s(t.rgbColor,function(){return{type:"rgb",value:M(q)}})}function U(){return s(t.rgbaColor,function(){return{type:"rgba",value:M(q)}})}function q(){return ce(t.number)[1]}function Q(){return ne("%",t.percentageValue,1)||J()||re()}function J(){return ne("position-keyword",t.positionKeywords,1)}function re(){return ne("px",t.pixelValue,1)||ne("em",t.emValue,1)}function ne(oe,Se,Te){var Ie=ce(Se);if(Ie)return{type:oe,value:Ie[Te]}}function ce(oe){var Se=/^[\n\r\t\s]+/.exec(r);Se&&me(Se[0].length);var Te=oe.exec(r);return Te&&me(Te[0].length),Te}function me(oe){r=r.substring(oe)}return function(oe){return r=oe,n()}}();function RL(t,r,e){var n=Vt(e.value),i=0,a=0,o=i+t/2,s=a+r/2,l=Math.abs(t*Math.cos(n))+Math.abs(r*Math.sin(n)),u=o-Math.cos(n)*l/2,h=s-Math.sin(n)*l/2,v=o+Math.cos(n)*l/2,p=s+Math.sin(n)*l/2;return{x1:u,y1:h,x2:v,y2:p}}function LL(t,r,e,n,i){var a=e.value,o=n.value;e.unit===De.kPercentage&&(a=e.value/100*t),n.unit===De.kPercentage&&(o=n.value/100*r);var s=Math.max(bn([0,0],[a,o]),bn([0,r],[a,o]),bn([t,r],[a,o]),bn([t,0],[a,o]));return i&&(i instanceof xr?s=i.value:i instanceof dn&&(i.value==="closest-side"?s=Math.min(a,t-a,o,r-o):i.value==="farthest-side"?s=Math.max(a,t-a,o,r-o):i.value==="closest-corner"&&(s=Math.min(bn([0,0],[a,o]),bn([0,r],[a,o]),bn([t,r],[a,o]),bn([t,0],[a,o]))))),{x:a,y:o,r:s}}var ML=/^l\s*\(\s*([\d.]+)\s*\)\s*(.*)/i,OL=/^r\s*\(\s*([\d.]+)\s*,\s*([\d.]+)\s*,\s*([\d.]+)\s*\)\s*(.*)/i,AL=/^p\s*\(\s*([axyn])\s*\)\s*(.*)/i,zy=/[\d.]+:(#[^\s]+|[^\)]+\))/gi;function NL(t){var r,e,n,i=t.length;t[i-1].length=(r=t[i-1].length)!==null&&r!==void 0?r:{type:"%",value:"100"},i>1&&(t[0].length=(e=t[0].length)!==null&&e!==void 0?e:{type:"%",value:"0"});for(var a=0,o=Number(t[0].length.value),s=1;s<i;s++){var l=(n=t[s].length)===null||n===void 0?void 0:n.value;if(!We(l)&&!We(o)){for(var u=1;u<s-a;u++)t[a+u].length={type:"%",value:"".concat(o+(Number(l)-o)*u/(s-a))};a=s,o=Number(l)}}}var kL={left:180,top:-90,bottom:90,right:0,"left top":225,"top left":225,"left bottom":135,"bottom left":135,"right top":-45,"top right":-45,"right bottom":45,"bottom right":45},IL=Ir(function(t){var r;return t.type==="angular"?r=Number(t.value):r=kL[t.value]||0,Rt(r,"deg")}),PL=Ir(function(t){var r=50,e=50,n="%",i="%";if((t==null?void 0:t.type)==="position"){var a=t.value,o=a.x,s=a.y;(o==null?void 0:o.type)==="position-keyword"&&(o.value==="left"?r=0:o.value==="center"?r=50:o.value==="right"?r=100:o.value==="top"?e=0:o.value==="bottom"&&(e=100)),(s==null?void 0:s.type)==="position-keyword"&&(s.value==="left"?r=0:s.value==="center"?e=50:s.value==="right"?r=100:s.value==="top"?e=0:s.value==="bottom"&&(e=100)),((o==null?void 0:o.type)==="px"||(o==null?void 0:o.type)==="%"||(o==null?void 0:o.type)==="em")&&(n=o==null?void 0:o.type,r=Number(o.value)),((s==null?void 0:s.type)==="px"||(s==null?void 0:s.type)==="%"||(s==null?void 0:s.type)==="em")&&(i=s==null?void 0:s.type,e=Number(s.value))}return{cx:Rt(r,n),cy:Rt(e,i)}}),DL=Ir(function(t){var r;if(t.indexOf("linear")>-1||t.indexOf("radial")>-1){var e=_L(t);return e.map(function(s){var l=s.type,u=s.orientation,h=s.colorStops;NL(h);var v=h.map(function(M){return{offset:Rt(Number(M.length.value),"%"),color:TL(M)}});if(l==="linear-gradient")return new yu(Ri.LinearGradient,{angle:u?IL(u):ei,steps:v});if(l==="radial-gradient"&&(u||(u=[{type:"shape",value:"circle"}]),u[0].type==="shape"&&u[0].value==="circle")){var p=PL(u[0].at),m=p.cx,C=p.cy,w=void 0;if(u[0].style){var b=u[0].style,E=b.type,R=b.value;E==="extent-keyword"?w=jh(R):w=Rt(R,E)}return new yu(Ri.RadialGradient,{cx:m,cy:C,size:w,steps:v})}})}var n=t[0];if(t[1]==="("||t[2]==="("){if(n==="l"){var i=ML.exec(t);if(i){var a=((r=i[2].match(zy))===null||r===void 0?void 0:r.map(function(s){return s.split(":")}))||[];return[new yu(Ri.LinearGradient,{angle:Rt(parseFloat(i[1]),"deg"),steps:a.map(function(s){var l=te(s,2),u=l[0],h=l[1];return{offset:Rt(Number(u)*100,"%"),color:h}})})]}}else if(n==="r"){var o=BL(t);if(o)if(kr(o))t=o;else return[new yu(Ri.RadialGradient,o)]}else if(n==="p")return FL(t)}});function BL(t){var r,e=OL.exec(t);if(e){var n=((r=e[4].match(zy))===null||r===void 0?void 0:r.map(function(i){return i.split(":")}))||[];return{cx:Rt(50,"%"),cy:Rt(50,"%"),steps:n.map(function(i){var a=te(i,2),o=a[0],s=a[1];return{offset:Rt(Number(o)*100,"%"),color:s}})}}return null}function FL(t){var r=AL.exec(t);if(r){var e=r[1],n=r[2];switch(e){case"a":e="repeat";break;case"x":e="repeat-x";break;case"y":e="repeat-y";break;case"n":e="no-repeat";break;default:e="no-repeat"}return{image:n,repetition:e}}return null}function vl(t){return t&&!!t.image}function rc(t){return t&&!We(t.r)&&!We(t.g)&&!We(t.b)}var Ko=Ir(function(t){if(vl(t))return Y({repetition:"repeat"},t);if(We(t)&&(t=""),t==="transparent")return Fy;t==="currentColor"&&(t="black");var r=DL(t);if(r)return r;var e=es(t),n=[0,0,0,0];return e!==null&&(n[0]=e.r||0,n[1]=e.g||0,n[2]=e.b||0,n[3]=e.opacity),EL.apply(void 0,pe([],te(n),!1))});function HL(t,r){if(!(!rc(t)||!rc(r)))return[[Number(t.r),Number(t.g),Number(t.b),Number(t.alpha)],[Number(r.r),Number(r.g),Number(r.b),Number(r.alpha)],function(e){var n=e.slice();if(n[3])for(var i=0;i<3;i++)n[i]=Math.round(Tn(n[i],0,255));return n[3]=Tn(n[3],0,1),"rgba(".concat(n.join(","),")")}]}function Nl(t,r){if(We(r))return Rt(0,"px");if(r="".concat(r).trim().toLowerCase(),isFinite(Number(r))){if("px".search(t)>=0)return Rt(Number(r),"px");if("deg".search(t)>=0)return Rt(Number(r),"deg")}var e=[];r=r.replace(t,function(i){return e.push(i),"U"+i});var n="U("+t.source+")";return e.map(function(i){return Rt(Number(r.replace(new RegExp("U"+i,"g"),"").replace(new RegExp(n,"g"),"*0")),i)})[0]}var Wy=function(t){return Nl(new RegExp("px","g"),t)},zL=Ir(Wy),WL=function(t){return Nl(new RegExp("%","g"),t)};Ir(WL);var pl=function(t){return li(t)||isFinite(Number(t))?Rt(Number(t)||0,"px"):Nl(new RegExp("px|%|em|rem","g"),t)},rs=Ir(pl),av=function(t){return Nl(new RegExp("deg|rad|grad|turn","g"),t)},Gy=Ir(av);function GL(t,r,e,n,i){i===void 0&&(i=0);var a="",o=t.value||0,s=r.value||0,l=Zh(t.unit),u=t.convertTo(l),h=r.convertTo(l);return u&&h?(o=u.value,s=h.value,a=qh(t.unit)):(xr.isLength(t.unit)||xr.isLength(r.unit))&&(o=wn(t,i,e),s=wn(r,i,e),a="px"),[o,s,function(v){return v+a}]}function Sn(t){var r=0;return t.unit===De.kDegrees?r=t.value:t.unit===De.kRadians?r=zn(Number(t.value)):t.unit===De.kTurns&&(r=eL(Number(t.value))),r}function ph(t,r){var e;return Array.isArray(t)?e=t.map(function(n){return Number(n)}):kr(t)?e=t.split(" ").map(function(n){return Number(n)}):li(t)&&(e=[t]),r===2?e.length===1?[e[0],e[0]]:[e[0],e[1]]:e.length===1?[e[0],e[0],e[0],e[0]]:e.length===2?[e[0],e[1],e[0],e[1]]:e.length===3?[e[0],e[1],e[2],e[1]]:[e[0],e[1],e[2],e[3]]}function Uy(t){return kr(t)?t.split(" ").map(function(r){return rs(r)}):t.map(function(r){return rs(r.toString())})}function wn(t,r,e){if(t.value===0)return 0;if(t.unit===De.kPixels)return Number(t.value);if(t.unit===De.kPercentage&&e){var n=e.nodeName===ge.GROUP?e.getLocalBounds():e.geometry.contentBounds;return t.value/100*n.halfExtents[r]*2}return 0}var UL=function(t){return Nl(/deg|rad|grad|turn|px|%/g,t)},VL=["blur","brightness","drop-shadow","contrast","grayscale","sepia","saturate","hue-rotate","invert"];function Vy(t){if(t===void 0&&(t=""),t=t.toLowerCase().trim(),t==="none")return[];for(var r=/\s*([\w-]+)\(([^)]*)\)/g,e=[],n,i=0;n=r.exec(t);){if(n.index!==i)return[];if(i=n.index+n[0].length,VL.indexOf(n[1])>-1&&e.push({name:n[1],params:n[2].split(" ").map(function(a){return UL(a)||Ko(a)})}),r.lastIndex===t.length)return e}return[]}function Xy(t){return t.toString()}var vs=function(t){return typeof t=="number"?Rt(t):/^\s*[-+]?(\d*\.)?\d+\s*$/.test(t)?Rt(Number(t)):Rt(0)},no=Ir(vs);Ir(function(t){return kr(t)?t.split(" ").map(no):t.map(no)});function ov(t,r){return[t,r,Xy]}function sv(t,r){return function(e,n){return[e,n,function(i){return Xy(Tn(i,t,r))}]}}function Yy(t,r){if(t.length===r.length)return[t,r,function(e){return e}]}function ed(t){return t.parsedStyle.path.totalLength===0&&(t.parsedStyle.path.totalLength=yR(t.parsedStyle.path.absolutePath)),t.parsedStyle.path.totalLength}function XL(t){for(var r=0;r<t.length;r++){var e=t[r-1],n=t[r],i=n[0];if(i==="M"&&e){var a=e[0],o=[n[1],n[2]],s=void 0;a==="L"||a==="M"?s=[e[1],e[2]]:(a==="C"||a==="A"||a==="Q")&&(s=[e[e.length-2],e[e.length-1]]),s&&nc(o,s)&&(t.splice(r,1),r--)}}}function YL(t){for(var r=!1,e=t.length,n=0;n<e;n++){var i=t[n],a=i[0];if(a==="C"||a==="A"||a==="Q"){r=!0;break}}return r}function $L(t){for(var r=[],e=[],n=[],i=0;i<t.length;i++){var a=t[i],o=a[0];o==="M"?(n.length&&(e.push(n),n=[]),n.push([a[1],a[2]])):o==="Z"?n.length&&(r.push(n),n=[]):n.push([a[1],a[2]])}return n.length>0&&e.push(n),{polygons:r,polylines:e}}function nc(t,r){return t[0]===r[0]&&t[1]===r[1]}function qL(t,r){for(var e=[],n=[],i=[],a=0;a<t.length;a++){var o=t[a],s=o.currentPoint,l=o.params,u=o.prePoint,h=void 0;switch(o.command){case"Q":h=YR(u[0],u[1],l[1],l[2],l[3],l[4]);break;case"C":h=GR(u[0],u[1],l[1],l[2],l[3],l[4],l[5],l[6]);break;case"A":var v=o.arcParams;h=HR(v.cx,v.cy,v.rx,v.ry,v.xRotation,v.startAngle,v.endAngle);break;default:e.push(s[0]),n.push(s[1]);break}h&&(o.box=h,e.push(h.x,h.x+h.width),n.push(h.y,h.y+h.height))}e=e.filter(function(E){return!Number.isNaN(E)&&E!==1/0&&E!==-1/0}),n=n.filter(function(E){return!Number.isNaN(E)&&E!==1/0&&E!==-1/0});var p=Mg(e),m=Mg(n),C=Lg(e),w=Lg(n);if(i.length===0)return{x:p,y:m,width:C-p,height:w-m};for(var a=0;a<i.length;a++){var o=i[a],s=o.currentPoint,b=void 0;s[0]===p?(b=Cu(o,r),p=p-b.xExtra):s[0]===C&&(b=Cu(o,r),C=C+b.xExtra),s[1]===m?(b=Cu(o,r),m=m-b.yExtra):s[1]===w&&(b=Cu(o,r),w=w+b.yExtra)}return{x:p,y:m,width:C-p,height:w-m}}function Cu(t,r){var e=t.prePoint,n=t.currentPoint,i=t.nextPoint,a=Math.pow(n[0]-e[0],2)+Math.pow(n[1]-e[1],2),o=Math.pow(n[0]-i[0],2)+Math.pow(n[1]-i[1],2),s=Math.pow(e[0]-i[0],2)+Math.pow(e[1]-i[1],2),l=Math.acos((a+o-s)/(2*Math.sqrt(a)*Math.sqrt(o)));if(!l||Math.sin(l)===0||al(l,0))return{xExtra:0,yExtra:0};var u=Math.abs(Math.atan2(i[1]-n[1],i[0]-n[0])),h=Math.abs(Math.atan2(i[0]-n[0],i[1]-n[1]));u=u>Math.PI/2?Math.PI-u:u,h=h>Math.PI/2?Math.PI-h:h;var v={xExtra:Math.cos(l/2-u)*(r/2*(1/Math.sin(l/2)))-r/2||0,yExtra:Math.cos(h-l/2)*(r/2*(1/Math.sin(l/2)))-r/2||0};return v}function Qg(t,r){return[r[0]+(r[0]-t[0]),r[1]+(r[1]-t[1])]}var em=function(t,r){var e=t.x*r.x+t.y*r.y,n=Math.sqrt((Math.pow(t.x,2)+Math.pow(t.y,2))*(Math.pow(r.x,2)+Math.pow(r.y,2))),i=t.x*r.y-t.y*r.x<0?-1:1,a=i*Math.acos(e/n);return a},tm=function(t,r,e,n,i,a,o,s){r=Math.abs(r),e=Math.abs(e),n=xy(n,360);var l=Vt(n);if(t.x===o.x&&t.y===o.y)return{x:t.x,y:t.y,ellipticalArcAngle:0};if(r===0||e===0)return{x:0,y:0,ellipticalArcAngle:0};var u=(t.x-o.x)/2,h=(t.y-o.y)/2,v={x:Math.cos(l)*u+Math.sin(l)*h,y:-Math.sin(l)*u+Math.cos(l)*h},p=Math.pow(v.x,2)/Math.pow(r,2)+Math.pow(v.y,2)/Math.pow(e,2);p>1&&(r=Math.sqrt(p)*r,e=Math.sqrt(p)*e);var m=Math.pow(r,2)*Math.pow(e,2)-Math.pow(r,2)*Math.pow(v.y,2)-Math.pow(e,2)*Math.pow(v.x,2),C=Math.pow(r,2)*Math.pow(v.y,2)+Math.pow(e,2)*Math.pow(v.x,2),w=m/C;w=w<0?0:w;var b=(i!==a?1:-1)*Math.sqrt(w),E={x:b*(r*v.y/e),y:b*(-(e*v.x)/r)},R={x:Math.cos(l)*E.x-Math.sin(l)*E.y+(t.x+o.x)/2,y:Math.sin(l)*E.x+Math.cos(l)*E.y+(t.y+o.y)/2},M={x:(v.x-E.x)/r,y:(v.y-E.y)/e},k=em({x:1,y:0},M),L={x:(-v.x-E.x)/r,y:(-v.y-E.y)/e},_=em(M,L);!a&&_>0?_-=2*Math.PI:a&&_<0&&(_+=2*Math.PI),_%=2*Math.PI;var I=k+_*s,P=r*Math.cos(I),U=e*Math.sin(I),q={x:Math.cos(l)*P-Math.sin(l)*U+R.x,y:Math.sin(l)*P+Math.cos(l)*U+R.y,ellipticalArcStartAngle:k,ellipticalArcEndAngle:k+_,ellipticalArcAngle:I,ellipticalArcCenter:R,resultantRx:r,resultantRy:e};return q};function KL(t){for(var r=[],e=null,n=null,i=null,a=0,o=t.length,s=0;s<o;s++){var l=t[s];n=t[s+1];var u=l[0],h={command:u,prePoint:e,params:l,startTangent:null,endTangent:null,currentPoint:null,nextPoint:null,arcParams:null,box:null,cubicParams:null};switch(u){case"M":i=[l[1],l[2]],a=s;break;case"A":var v=ZL(e,l);h.arcParams=v;break}if(u==="Z")e=i,n=t[a+1];else{var p=l.length;e=[l[p-2],l[p-1]]}n&&n[0]==="Z"&&(n=t[a],r[a]&&(r[a].prePoint=e)),h.currentPoint=e,r[a]&&nc(e,r[a].currentPoint)&&(r[a].prePoint=h.prePoint);var m=n?[n[n.length-2],n[n.length-1]]:null;h.nextPoint=m;var C=h.prePoint;if(["L","H","V"].includes(u))h.startTangent=[C[0]-e[0],C[1]-e[1]],h.endTangent=[e[0]-C[0],e[1]-C[1]];else if(u==="Q"){var w=[l[1],l[2]];h.startTangent=[C[0]-w[0],C[1]-w[1]],h.endTangent=[e[0]-w[0],e[1]-w[1]]}else if(u==="T"){var b=r[s-1],w=Qg(b.currentPoint,C);b.command==="Q"?(h.command="Q",h.startTangent=[C[0]-w[0],C[1]-w[1]],h.endTangent=[e[0]-w[0],e[1]-w[1]]):(h.command="TL",h.startTangent=[C[0]-e[0],C[1]-e[1]],h.endTangent=[e[0]-C[0],e[1]-C[1]])}else if(u==="C"){var E=[l[1],l[2]],R=[l[3],l[4]];h.startTangent=[C[0]-E[0],C[1]-E[1]],h.endTangent=[e[0]-R[0],e[1]-R[1]],h.startTangent[0]===0&&h.startTangent[1]===0&&(h.startTangent=[E[0]-R[0],E[1]-R[1]]),h.endTangent[0]===0&&h.endTangent[1]===0&&(h.endTangent=[R[0]-E[0],R[1]-E[1]])}else if(u==="S"){var b=r[s-1],E=Qg(b.currentPoint,C),R=[l[1],l[2]];b.command==="C"?(h.command="C",h.startTangent=[C[0]-E[0],C[1]-E[1]],h.endTangent=[e[0]-R[0],e[1]-R[1]]):(h.command="SQ",h.startTangent=[C[0]-R[0],C[1]-R[1]],h.endTangent=[e[0]-R[0],e[1]-R[1]])}else if(u==="A"){var M=rm(h,0),k=M.x,L=M.y,_=rm(h,1,!1),I=_.x,P=_.y;h.startTangent=[k,L],h.endTangent=[I,P]}r.push(h)}return r}function rm(t,r,e){e===void 0&&(e=!0);var n=t.arcParams,i=n.rx,a=i===void 0?0:i,o=n.ry,s=o===void 0?0:o,l=n.xRotation,u=n.arcFlag,h=n.sweepFlag,v=tm({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!h,{x:t.currentPoint[0],y:t.currentPoint[1]},r),p=tm({x:t.prePoint[0],y:t.prePoint[1]},a,s,l,!!u,!!h,{x:t.currentPoint[0],y:t.currentPoint[1]},e?r+.005:r-.005),m=p.x-v.x,C=p.y-v.y,w=Math.sqrt(m*m+C*C);return{x:-m/w,y:-C/w}}function wu(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function td(t,r){return wu(t)*wu(r)?(t[0]*r[0]+t[1]*r[1])/(wu(t)*wu(r)):1}function nm(t,r){return(t[0]*r[1]<t[1]*r[0]?-1:1)*Math.acos(td(t,r))}function ZL(t,r){var e=r[1],n=r[2],i=xy(Vt(r[3]),Math.PI*2),a=r[4],o=r[5],s=t[0],l=t[1],u=r[6],h=r[7],v=Math.cos(i)*(s-u)/2+Math.sin(i)*(l-h)/2,p=-1*Math.sin(i)*(s-u)/2+Math.cos(i)*(l-h)/2,m=v*v/(e*e)+p*p/(n*n);m>1&&(e*=Math.sqrt(m),n*=Math.sqrt(m));var C=e*e*(p*p)+n*n*(v*v),w=C?Math.sqrt((e*e*(n*n)-C)/C):1;a===o&&(w*=-1),isNaN(w)&&(w=0);var b=n?w*e*p/n:0,E=e?w*-n*v/e:0,R=(s+u)/2+Math.cos(i)*b-Math.sin(i)*E,M=(l+h)/2+Math.sin(i)*b+Math.cos(i)*E,k=[(v-b)/e,(p-E)/n],L=[(-1*v-b)/e,(-1*p-E)/n],_=nm([1,0],k),I=nm(k,L);return td(k,L)<=-1&&(I=Math.PI),td(k,L)>=1&&(I=0),o===0&&I>0&&(I=I-2*Math.PI),o===1&&I<0&&(I=I+2*Math.PI),{cx:R,cy:M,rx:nc(t,[u,h])?0:e,ry:nc(t,[u,h])?0:n,startAngle:_,endAngle:_+I,xRotation:i,arcFlag:a,sweepFlag:o}}var $y=function(t){if(t===""||Array.isArray(t)&&t.length===0)return{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:{x:0,y:0,width:0,height:0}};var r;try{r=Qu(t)}catch{r=Qu(""),console.error("[g]: Invalid SVG Path definition: ".concat(t))}XL(r);var e=YL(r),n=$L(r),i=n.polygons,a=n.polylines,o=KL(r),s=qL(o,0),l=s.x,u=s.y,h=s.width,v=s.height;return{absolutePath:r,hasArc:e,segments:o,polygons:i,polylines:a,totalLength:0,rect:{x:Number.isFinite(l)?l:0,y:Number.isFinite(u)?u:0,width:Number.isFinite(h)?h:0,height:Number.isFinite(v)?v:0}}},jL=Ir($y);function rd(t){return kr(t)?jL(t):$y(t)}function JL(t,r,e){var n=t.curve,i=r.curve;(!n||n.length===0)&&(n=Wh(t.absolutePath,!1),t.curve=n),(!i||i.length===0)&&(i=Wh(r.absolutePath,!1),r.curve=i);var a=[n,i];n.length!==i.length&&(a=Ly(n,i));var o=Ig(a[0])!==Ig(a[1])?hR(a[0]):fR(a[0]);return[o,wR(a[1],o),function(s){return s}]}function qy(t,r){var e;kr(t)?e=t.split(" ").map(function(h){var v=te(h.split(","),2),p=v[0],m=v[1];return[Number(p),Number(m)]}):e=t;var n=[],i=0,a,o,s=XR(e);e.forEach(function(h,v){e[v+1]&&(a=[0,0],a[0]=i/s,o=ky(h[0],h[1],e[v+1][0],e[v+1][1]),i+=o,a[1]=i/s,n.push(a))});var l=Math.min.apply(Math,pe([],te(e.map(function(h){return h[0]})),!1)),u=Math.min.apply(Math,pe([],te(e.map(function(h){return h[1]})),!1));return r&&(r.parsedStyle.defX=l,r.parsedStyle.defY=u),{points:e,totalLength:s,segments:n}}function QL(t,r){return[t.points,r.points,function(e){return e}]}var Kt=null;function ln(t){return function(r){var e=0;return t.map(function(n){return n===Kt?r[e++]:n})}}function Va(t){return t}var ic={matrix:["NNNNNN",[Kt,Kt,0,0,Kt,Kt,0,0,0,0,1,0,Kt,Kt,0,1],Va],matrix3d:["NNNNNNNNNNNNNNNN",Va],rotate:["A"],rotatex:["A"],rotatey:["A"],rotatez:["A"],rotate3d:["NNNA"],perspective:["L"],scale:["Nn",ln([Kt,Kt,new xr(1)]),Va],scalex:["N",ln([Kt,new xr(1),new xr(1)]),ln([Kt,new xr(1)])],scaley:["N",ln([new xr(1),Kt,new xr(1)]),ln([new xr(1),Kt])],scalez:["N",ln([new xr(1),new xr(1),Kt])],scale3d:["NNN",Va],skew:["Aa",null,Va],skewx:["A",null,ln([Kt,ei])],skewy:["A",null,ln([ei,Kt])],translate:["Tt",ln([Kt,Kt,dr]),Va],translatex:["T",ln([Kt,dr,dr]),ln([Kt,dr])],translatey:["T",ln([dr,Kt,dr]),ln([dr,Kt])],translatez:["L",ln([dr,dr,Kt])],translate3d:["TTL",Va]};function lv(t){if(t=(t||"none").toLowerCase().trim(),t==="none")return[];for(var r=/\s*(\w+)\(([^)]*)\)/g,e=[],n,i=0;n=r.exec(t);){if(n.index!==i)return[];i=n.index+n[0].length;var a=n[1],o=ic[a];if(!o)return[];var s=n[2].split(","),l=o[0];if(l.length<s.length)return[];for(var u=[],h=0;h<l.length;h++){var v=s[h],p=l[h],m=void 0;if(v?m={A:function(C){return C.trim()==="0"?ei:Gy(C)},N:no,T:rs,L:zL}[p.toUpperCase()](v):m={a:ei,n:u[0],t:dr}[p],m===void 0)return[];u.push(m)}if(e.push({t:a,d:u}),r.lastIndex===t.length)return e}return[]}function im(t){if(t=(t||"none").toLowerCase().trim(),t==="none")return[];for(var r=/\s*(\w+)\(([^)]*)\)/g,e=[],n,i=0;n=r.exec(t);){if(n.index!==i)return[];i=n.index+n[0].length;var a=n[1],o=ic[a];if(!o)return[];var s=n[2].split(","),l=o[0];if(l.length<s.length)return[];for(var u=[],h=0;h<l.length;h++){var v=s[h],p=l[h],m=void 0;if(v?m={A:function(C){return C.trim()==="0"?ei:av(C)},N:vs,T:pl,L:Wy}[p.toUpperCase()](v):m={a:ei,n:u[0],t:dr}[p],m===void 0)return[];u.push(m)}if(e.push({t:a,d:u}),r.lastIndex===t.length)return e}return[]}function eM(t){var r,e,n,i;switch(t.t){case"rotatex":return i=Vt(Sn(t.d[0])),[1,0,0,0,0,Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1];case"rotatey":return i=Vt(Sn(t.d[0])),[Math.cos(i),0,-Math.sin(i),0,0,1,0,0,Math.sin(i),0,Math.cos(i),0,0,0,0,1];case"rotate":case"rotatez":return i=Vt(Sn(t.d[0])),[Math.cos(i),Math.sin(i),0,0,-Math.sin(i),Math.cos(i),0,0,0,0,1,0,0,0,0,1];case"rotate3d":r=t.d[0].value,e=t.d[1].value,n=t.d[2].value,i=Vt(Sn(t.d[3]));var a=r*r+e*e+n*n;if(a===0)r=1,e=0,n=0;else if(a!==1){var o=Math.sqrt(a);r/=o,e/=o,n/=o}var s=Math.sin(i/2),l=s*Math.cos(i/2),u=s*s;return[1-2*(e*e+n*n)*u,2*(r*e*u+n*l),2*(r*n*u-e*l),0,2*(r*e*u-n*l),1-2*(r*r+n*n)*u,2*(e*n*u+r*l),0,2*(r*n*u+e*l),2*(e*n*u-r*l),1-2*(r*r+e*e)*u,0,0,0,0,1];case"scale":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,1,0,0,0,0,1];case"scalex":return[t.d[0].value,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"scaley":return[1,0,0,0,0,t.d[0].value,0,0,0,0,1,0,0,0,0,1];case"scalez":return[1,0,0,0,0,1,0,0,0,0,t.d[0].value,0,0,0,0,1];case"scale3d":return[t.d[0].value,0,0,0,0,t.d[1].value,0,0,0,0,t.d[2].value,0,0,0,0,1];case"skew":var h=Vt(Sn(t.d[0])),v=Vt(Sn(t.d[1]));return[1,Math.tan(v),0,0,Math.tan(h),1,0,0,0,0,1,0,0,0,0,1];case"skewx":return i=Vt(Sn(t.d[0])),[1,0,0,0,Math.tan(i),1,0,0,0,0,1,0,0,0,0,1];case"skewy":return i=Vt(Sn(t.d[0])),[1,Math.tan(i),0,0,0,1,0,0,0,0,1,0,0,0,0,1];case"translate":return r=wn(t.d[0],0,null)||0,e=wn(t.d[1],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,r,e,0,1];case"translatex":return r=wn(t.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,r,0,0,1];case"translatey":return e=wn(t.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,e,0,1];case"translatez":return n=wn(t.d[0],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,n,1];case"translate3d":return r=wn(t.d[0],0,null)||0,e=wn(t.d[1],0,null)||0,n=wn(t.d[2],0,null)||0,[1,0,0,0,0,1,0,0,0,0,1,0,r,e,n,1];case"perspective":var p=wn(t.d[0],0,null)||0,m=p?-1/p:0;return[1,0,0,0,0,1,0,0,0,0,1,m,0,0,0,1];case"matrix":return[t.d[0].value,t.d[1].value,0,0,t.d[2].value,t.d[3].value,0,0,0,0,1,0,t.d[4].value,t.d[5].value,0,1];case"matrix3d":return t.d.map(function(C){return C.value})}}function tM(t,r){return[t[0]*r[0]+t[4]*r[1]+t[8]*r[2]+t[12]*r[3],t[1]*r[0]+t[5]*r[1]+t[9]*r[2]+t[13]*r[3],t[2]*r[0]+t[6]*r[1]+t[10]*r[2]+t[14]*r[3],t[3]*r[0]+t[7]*r[1]+t[11]*r[2]+t[15]*r[3],t[0]*r[4]+t[4]*r[5]+t[8]*r[6]+t[12]*r[7],t[1]*r[4]+t[5]*r[5]+t[9]*r[6]+t[13]*r[7],t[2]*r[4]+t[6]*r[5]+t[10]*r[6]+t[14]*r[7],t[3]*r[4]+t[7]*r[5]+t[11]*r[6]+t[15]*r[7],t[0]*r[8]+t[4]*r[9]+t[8]*r[10]+t[12]*r[11],t[1]*r[8]+t[5]*r[9]+t[9]*r[10]+t[13]*r[11],t[2]*r[8]+t[6]*r[9]+t[10]*r[10]+t[14]*r[11],t[3]*r[8]+t[7]*r[9]+t[11]*r[10]+t[15]*r[11],t[0]*r[12]+t[4]*r[13]+t[8]*r[14]+t[12]*r[15],t[1]*r[12]+t[5]*r[13]+t[9]*r[14]+t[13]*r[15],t[2]*r[12]+t[6]*r[13]+t[10]*r[14]+t[14]*r[15],t[3]*r[12]+t[7]*r[13]+t[11]*r[14]+t[15]*r[15]]}function rM(t){return t.length===0?[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]:t.map(eM).reduce(tM)}function am(t){var r=[0,0,0],e=[1,1,1],n=[0,0,0],i=[0,0,0,1],a=[0,0,0,1];return aL(rM(t),r,e,n,i,a),[[r,e,n,a,i]]}var nM=function(){function t(n,i){for(var a=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],o=0;o<4;o++)for(var s=0;s<4;s++)for(var l=0;l<4;l++)a[o][s]+=i[o][l]*n[l][s];return a}function r(n){return n[0][2]==0&&n[0][3]==0&&n[1][2]==0&&n[1][3]==0&&n[2][0]==0&&n[2][1]==0&&n[2][2]==1&&n[2][3]==0&&n[3][2]==0&&n[3][3]==1}function e(n,i,a,o,s){for(var l=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],u=0;u<4;u++)l[u][3]=s[u];for(var u=0;u<3;u++)for(var h=0;h<3;h++)l[3][u]+=n[h]*l[h][u];var v=o[0],p=o[1],m=o[2],C=o[3],w=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];w[0][0]=1-2*(p*p+m*m),w[0][1]=2*(v*p-m*C),w[0][2]=2*(v*m+p*C),w[1][0]=2*(v*p+m*C),w[1][1]=1-2*(v*v+m*m),w[1][2]=2*(p*m-v*C),w[2][0]=2*(v*m-p*C),w[2][1]=2*(p*m+v*C),w[2][2]=1-2*(v*v+p*p),l=t(l,w);var b=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]];a[2]&&(b[2][1]=a[2],l=t(l,b)),a[1]&&(b[2][1]=0,b[2][0]=a[0],l=t(l,b)),a[0]&&(b[2][0]=0,b[1][0]=a[0],l=t(l,b));for(var u=0;u<3;u++)for(var h=0;h<3;h++)l[u][h]*=i[u];return r(l)?[l[0][0],l[0][1],l[1][0],l[1][1],l[3][0],l[3][1]]:l[0].concat(l[1],l[2],l[3])}return e}();function iM(t){return t.toFixed(6).replace(".000000","")}function gh(t,r){var e,n;return t.decompositionPair!==r&&(t.decompositionPair=r,e=am(t)),r.decompositionPair!==t&&(r.decompositionPair=t,n=am(r)),e[0]===null||n[0]===null?[[!1],[!0],function(i){return i?r[0].d:t[0].d}]:(e[0].push(0),n[0].push(1),[e,n,function(i){var a=oM(e[0][3],n[0][3],i[5]),o=nM(i[0],i[1],i[2],a,i[4]),s=o.map(iM).join(",");return s}])}function aM(t,r){for(var e=0,n=0;n<t.length;n++)e+=t[n]*r[n];return e}function oM(t,r,e){var n=aM(t,r);n=Tn(n,-1,1);var i=[];if(n===1)i=t;else for(var a=Math.acos(n),o=Math.sin(e*a)*1/Math.sqrt(1-n*n),s=0;s<4;s++)i.push(t[s]*(Math.cos(e*a)-n*o)+r[s]*o);return i}function mh(t){return t.replace(/[xy]/,"")}function yh(t){return t.replace(/(x|y|z|3d)?$/,"3d")}var sM=function(t,r){return t==="perspective"&&r==="perspective"||(t==="matrix"||t==="matrix3d")&&(r==="matrix"||r==="matrix3d")};function lM(t,r,e){var n=!1;if(!t.length||!r.length){t.length||(n=!0,t=r,r=[]);for(var i=function(_){var I=t[_],P=I.t,U=I.d,q=P.substring(0,5)==="scale"?1:0;r.push({t:P,d:U.map(function(Q){return typeof Q=="number"?Rt(q):Rt(q,Q.unit)})})},a=0;a<t.length;a++)i(a)}var o=[],s=[],l=[];if(t.length!==r.length){var u=gh(t,r);o=[u[0]],s=[u[1]],l=[["matrix",[u[2]]]]}else for(var a=0;a<t.length;a++){var h=t[a].t,v=r[a].t,p=t[a].d,m=r[a].d,C=ic[h],w=ic[v],b=void 0;if(sM(h,v)){var u=gh([t[a]],[r[a]]);o.push(u[0]),s.push(u[1]),l.push(["matrix",[u[2]]]);continue}else if(h===v)b=h;else if(C[2]&&w[2]&&mh(h)===mh(v))b=mh(h),p=C[2](p),m=w[2](m);else if(C[1]&&w[1]&&yh(h)===yh(v))b=yh(h),p=C[1](p),m=w[1](m);else{var u=gh(t,r);o=[u[0]],s=[u[1]],l=[["matrix",[u[2]]]];break}for(var E=[],R=[],M=[],k=0;k<p.length;k++){var u=GL(p[k],m[k],e,!1,k);E[k]=u[0],R[k]=u[1],M.push(u[2])}o.push(E),s.push(R),l.push([b,M])}if(n){var L=o;o=s,s=L}return[o,s,function(_){return _.map(function(I,P){var U=I.map(function(q,Q){return l[P][1][Q](q)}).join(",");return l[P][0]==="matrix"&&U.split(",").length===16&&(l[P][0]="matrix3d"),l[P][0]==="matrix3d"&&U.split(",").length===6&&(l[P][0]="matrix"),l[P][0]+"("+U+")"}).join(" ")}]}var Ky=Ir(function(t){if(kr(t)){if(t==="text-anchor")return[Rt(0,"px"),Rt(0,"px")];var r=t.split(" ");return r.length===1&&(r[0]==="top"||r[0]==="bottom"?(r[1]=r[0],r[0]="center"):r[1]="center"),r.length!==2?null:[rs(ac(r[0])),rs(ac(r[1]))]}else return[Rt(t[0]||0,"px"),Rt(t[1]||0,"px")]}),uM=function(t){if(kr(t)){if(t==="text-anchor")return[Rt(0,"px"),Rt(0,"px")];var r=t.split(" ");return r.length===1&&(r[0]==="top"||r[0]==="bottom"?(r[1]=r[0],r[0]="center"):r[1]="center"),r.length!==2?null:[pl(ac(r[0])),pl(ac(r[1]))]}else return[Rt(t[0]||0,"px"),Rt(t[1]||0,"px")]};function ac(t){return t==="center"?"50%":t==="left"||t==="top"?"0":t==="right"||t==="bottom"?"100%":t}var uv=[{n:"display",k:["none"]},{n:"opacity",int:!0,inh:!0,d:"1",syntax:Fe.OPACITY_VALUE},{n:"fillOpacity",int:!0,inh:!0,d:"1",syntax:Fe.OPACITY_VALUE},{n:"strokeOpacity",int:!0,inh:!0,d:"1",syntax:Fe.OPACITY_VALUE},{n:"fill",int:!0,k:["none"],d:"none",syntax:Fe.PAINT},{n:"fillRule",k:["nonzero","evenodd"],d:"nonzero"},{n:"stroke",int:!0,k:["none"],d:"none",syntax:Fe.PAINT,l:!0},{n:"shadowType",k:["inner","outer","both"],d:"outer",l:!0},{n:"shadowColor",int:!0,syntax:Fe.COLOR},{n:"shadowOffsetX",int:!0,l:!0,d:"0",syntax:Fe.LENGTH_PERCENTAGE},{n:"shadowOffsetY",int:!0,l:!0,d:"0",syntax:Fe.LENGTH_PERCENTAGE},{n:"shadowBlur",int:!0,l:!0,d:"0",syntax:Fe.SHADOW_BLUR},{n:"lineWidth",int:!0,inh:!0,d:"1",l:!0,a:["strokeWidth"],syntax:Fe.LENGTH_PERCENTAGE},{n:"increasedLineWidthForHitTesting",inh:!0,d:"0",l:!0,syntax:Fe.LENGTH_PERCENTAGE},{n:"lineJoin",inh:!0,l:!0,a:["strokeLinejoin"],k:["miter","bevel","round"],d:"miter"},{n:"lineCap",inh:!0,l:!0,a:["strokeLinecap"],k:["butt","round","square"],d:"butt"},{n:"lineDash",int:!0,inh:!0,k:["none"],a:["strokeDasharray"],syntax:Fe.LENGTH_PERCENTAGE_12},{n:"lineDashOffset",int:!0,inh:!0,d:"0",a:["strokeDashoffset"],syntax:Fe.LENGTH_PERCENTAGE},{n:"offsetPath",syntax:Fe.DEFINED_PATH},{n:"offsetDistance",int:!0,syntax:Fe.OFFSET_DISTANCE},{n:"dx",int:!0,l:!0,d:"0",syntax:Fe.LENGTH_PERCENTAGE},{n:"dy",int:!0,l:!0,d:"0",syntax:Fe.LENGTH_PERCENTAGE},{n:"zIndex",ind:!0,int:!0,d:"0",k:["auto"],syntax:Fe.Z_INDEX},{n:"visibility",k:["visible","hidden"],ind:!0,inh:!0,int:!0,d:"visible"},{n:"pointerEvents",inh:!0,k:["none","auto","stroke","fill","painted","visible","visiblestroke","visiblefill","visiblepainted","all"],d:"auto"},{n:"filter",ind:!0,l:!0,k:["none"],d:"none",syntax:Fe.FILTER},{n:"clipPath",syntax:Fe.DEFINED_PATH},{n:"textPath",syntax:Fe.DEFINED_PATH},{n:"textPathSide",k:["left","right"],d:"left"},{n:"textPathStartOffset",l:!0,d:"0",syntax:Fe.LENGTH_PERCENTAGE},{n:"transform",p:100,int:!0,k:["none"],d:"none",syntax:Fe.TRANSFORM},{n:"transformOrigin",p:100,d:function(t){return t===ge.CIRCLE||t===ge.ELLIPSE?"center":t===ge.TEXT?"text-anchor":"left top"},l:!0,syntax:Fe.TRANSFORM_ORIGIN},{n:"anchor",p:99,d:function(t){return t===ge.CIRCLE||t===ge.ELLIPSE?"0.5 0.5":"0 0"},l:!0,syntax:Fe.LENGTH_PERCENTAGE_12},{n:"cx",int:!0,d:"0",syntax:Fe.COORDINATE},{n:"cy",int:!0,d:"0",syntax:Fe.COORDINATE},{n:"cz",int:!0,d:"0",syntax:Fe.COORDINATE},{n:"r",int:!0,l:!0,d:"0",syntax:Fe.LENGTH_PERCENTAGE},{n:"rx",int:!0,l:!0,d:"0",syntax:Fe.LENGTH_PERCENTAGE},{n:"ry",int:!0,l:!0,d:"0",syntax:Fe.LENGTH_PERCENTAGE},{n:"x",int:!0,d:"0",syntax:Fe.COORDINATE},{n:"y",int:!0,d:"0",syntax:Fe.COORDINATE},{n:"z",int:!0,d:"0",syntax:Fe.COORDINATE},{n:"width",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:Fe.LENGTH_PERCENTAGE},{n:"height",int:!0,l:!0,k:["auto","fit-content","min-content","max-content"],d:"0",syntax:Fe.LENGTH_PERCENTAGE},{n:"radius",int:!0,l:!0,d:"0",syntax:Fe.LENGTH_PERCENTAGE_14},{n:"x1",int:!0,l:!0,syntax:Fe.COORDINATE},{n:"y1",int:!0,l:!0,syntax:Fe.COORDINATE},{n:"z1",int:!0,l:!0,syntax:Fe.COORDINATE},{n:"x2",int:!0,l:!0,syntax:Fe.COORDINATE},{n:"y2",int:!0,l:!0,syntax:Fe.COORDINATE},{n:"z2",int:!0,l:!0,syntax:Fe.COORDINATE},{n:"path",int:!0,l:!0,d:"",a:["d"],syntax:Fe.PATH,p:50},{n:"points",int:!0,l:!0,syntax:Fe.LIST_OF_POINTS,p:50},{n:"text",l:!0,d:"",syntax:Fe.TEXT,p:50},{n:"textTransform",l:!0,inh:!0,k:["capitalize","uppercase","lowercase","none"],d:"none",syntax:Fe.TEXT_TRANSFORM,p:51},{n:"font",l:!0},{n:"fontSize",int:!0,inh:!0,d:"16px",l:!0,syntax:Fe.LENGTH_PERCENTAGE},{n:"fontFamily",l:!0,inh:!0,d:"sans-serif"},{n:"fontStyle",l:!0,inh:!0,k:["normal","italic","oblique"],d:"normal"},{n:"fontWeight",l:!0,inh:!0,k:["normal","bold","bolder","lighter"],d:"normal"},{n:"fontVariant",l:!0,inh:!0,k:["normal","small-caps"],d:"normal"},{n:"lineHeight",l:!0,syntax:Fe.LENGTH,int:!0,d:"0"},{n:"letterSpacing",l:!0,syntax:Fe.LENGTH,int:!0,d:"0"},{n:"miterLimit",l:!0,syntax:Fe.NUMBER,d:function(t){return t===ge.PATH||t===ge.POLYGON||t===ge.POLYLINE?"4":"10"}},{n:"wordWrap",l:!0},{n:"wordWrapWidth",l:!0},{n:"maxLines",l:!0},{n:"textOverflow",l:!0,d:"clip"},{n:"leading",l:!0},{n:"textBaseline",l:!0,inh:!0,k:["top","hanging","middle","alphabetic","ideographic","bottom"],d:"alphabetic"},{n:"textAlign",l:!0,inh:!0,k:["start","center","middle","end","left","right"],d:"start"},{n:"markerStart",syntax:Fe.MARKER},{n:"markerEnd",syntax:Fe.MARKER},{n:"markerMid",syntax:Fe.MARKER},{n:"markerStartOffset",syntax:Fe.LENGTH,l:!0,int:!0,d:"0"},{n:"markerEndOffset",syntax:Fe.LENGTH,l:!0,int:!0,d:"0"}],om=uv.filter(function(t){return!!t.l}).map(function(t){return t.n}),ga={},Do=new WeakMap,cM=function(t,r){var e=Do.get(t);return!e||e.length===0?!0:e.includes(r)},fM=function(){function t(r){var e=this;this.runtime=r,uv.forEach(function(n){e.registerMetadata(n)})}return t.prototype.registerMetadata=function(r){pe([r.n],te(r.a||[]),!1).forEach(function(e){ga[e]=r})},t.prototype.unregisterMetadata=function(r){delete ga[r]},t.prototype.getPropertySyntax=function(r){return this.runtime.CSSPropertySyntaxFactory[r]},t.prototype.processProperties=function(r,e,n){var i=this;if(n===void 0&&(n={skipUpdateAttribute:!1,skipParse:!1,forceUpdateGeometry:!1,usedAttributes:[],memoize:!0}),!this.runtime.enableCSSParsing){Object.assign(r.attributes,e);var a=Object.keys(e),o=r.parsedStyle.clipPath,s=r.parsedStyle.offsetPath;r.parsedStyle=Object.assign(r.parsedStyle,e);var l=!!n.forceUpdateGeometry;if(!l){for(var u=0;u<om.length;u++)if(om[u]in e){l=!0;break}}e.fill&&(r.parsedStyle.fill=Ko(e.fill)),e.stroke&&(r.parsedStyle.stroke=Ko(e.stroke)),e.shadowColor&&(r.parsedStyle.shadowColor=Ko(e.shadowColor)),e.filter&&(r.parsedStyle.filter=Vy(e.filter)),We(e.radius)||(r.parsedStyle.radius=ph(e.radius,4)),We(e.lineDash)||(r.parsedStyle.lineDash=ph(e.lineDash,2)),e.points&&(r.parsedStyle.points=qy(e.points,r)),e.path===""&&(r.parsedStyle.path=Y({},Hy)),e.path&&(r.parsedStyle.path=rd(e.path),r.parsedStyle.defX=r.parsedStyle.path.rect.x,r.parsedStyle.defY=r.parsedStyle.path.rect.y),e.textTransform&&this.runtime.CSSPropertySyntaxFactory["<text-transform>"].calculator(null,null,{value:e.textTransform},r,null),e.clipPath&&this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("clipPath",o,e.clipPath,r,this.runtime),e.offsetPath&&this.runtime.CSSPropertySyntaxFactory["<defined-path>"].calculator("offsetPath",s,e.offsetPath,r,this.runtime),e.anchor&&(r.parsedStyle.anchor=ph(e.anchor,2)),e.transform&&(r.parsedStyle.transform=lv(e.transform)),e.transformOrigin&&(r.parsedStyle.transformOrigin=Ky(e.transformOrigin)),e.markerStart&&(r.parsedStyle.markerStart=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,e.markerStart,e.markerStart,null,null)),e.markerEnd&&(r.parsedStyle.markerEnd=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator(null,e.markerEnd,e.markerEnd,null,null)),e.markerMid&&(r.parsedStyle.markerMid=this.runtime.CSSPropertySyntaxFactory["<marker>"].calculator("",e.markerMid,e.markerMid,null,null)),((r.nodeName===ge.CIRCLE||r.nodeName===ge.ELLIPSE)&&(!We(e.cx)||!We(e.cy))||(r.nodeName===ge.RECT||r.nodeName===ge.IMAGE||r.nodeName===ge.GROUP||r.nodeName===ge.HTML||r.nodeName===ge.TEXT||r.nodeName===ge.MESH)&&(!We(e.x)||!We(e.y)||!We(e.z))||r.nodeName===ge.LINE&&(!We(e.x1)||!We(e.y1)||!We(e.z1)||!We(e.x2)||!We(e.y2)||!We(e.z2)))&&this.runtime.CSSPropertySyntaxFactory["<coordinate>"].postProcessor(r,a),We(e.zIndex)||this.runtime.CSSPropertySyntaxFactory["<z-index>"].postProcessor(r,a),e.path&&this.runtime.CSSPropertySyntaxFactory["<path>"].postProcessor(r,a),e.points&&this.runtime.CSSPropertySyntaxFactory["<list-of-points>"].postProcessor(r,a),We(e.offsetDistance)||this.runtime.CSSPropertySyntaxFactory["<offset-distance>"].postProcessor(r,a),e.transform&&this.runtime.CSSPropertySyntaxFactory["<transform>"].postProcessor(r,a),l&&this.updateGeometry(r);return}var h=n.skipUpdateAttribute,v=n.skipParse,p=n.forceUpdateGeometry,m=n.usedAttributes,C=n.memoize,w=p,b=Object.keys(e);b.forEach(function(E){var R;h||(r.attributes[E]=e[E]),!w&&(!((R=ga[E])===null||R===void 0)&&R.l)&&(w=!0)}),v||b.forEach(function(E){r.computedStyle[E]=i.parseProperty(E,r.attributes[E],r,C)}),m!=null&&m.length&&(b=Array.from(new Set(b.concat(m)))),b.forEach(function(E){E in r.computedStyle&&(r.parsedStyle[E]=i.computeProperty(E,r.computedStyle[E],r,C))}),w&&this.updateGeometry(r),b.forEach(function(E){E in r.parsedStyle&&i.postProcessProperty(E,r,b)}),this.runtime.enableCSSParsing&&r.children.length&&b.forEach(function(E){E in r.parsedStyle&&i.isPropertyInheritable(E)&&r.children.forEach(function(R){R.internalSetAttribute(E,null,{skipUpdateAttribute:!0,skipParse:!0})})})},t.prototype.parseProperty=function(r,e,n,i){var a=ga[r],o=e;if((e===""||We(e))&&(e="unset"),e==="unset"||e==="initial"||e==="inherit")o=jh(e);else if(a){var s=a.k,l=a.syntax,u=l&&this.getPropertySyntax(l);s&&s.indexOf(e)>-1?o=jh(e):u&&(!i&&u.parserUnmemoize?o=u.parserUnmemoize(e,n):u.parser&&(o=u.parser(e,n)))}return o},t.prototype.computeProperty=function(r,e,n,i){var a=ga[r],o=n.id==="g-root",s=e;if(a){var l=a.syntax,u=a.inh,h=a.d;if(e instanceof dn){var v=e.value;if(v==="unset"&&(u&&!o?v="inherit":v="initial"),v==="initial")We(h)||(e=this.parseProperty(r,Ho(h)?h(n.nodeName):h,n,i));else if(v==="inherit"){var p=this.tryToResolveProperty(n,r,{inherited:!0});if(We(p)){this.addUnresolveProperty(n,r);return}else return p}}var m=l&&this.getPropertySyntax(l);if(m&&m.calculator){var C=n.parsedStyle[r];s=m.calculator(r,C,e,n,this.runtime)}else e instanceof dn?s=e.value:s=e}return s},t.prototype.postProcessProperty=function(r,e,n){var i=ga[r];if(i&&i.syntax){var a=i.syntax&&this.getPropertySyntax(i.syntax),o=a;o&&o.postProcessor&&o.postProcessor(e,n)}},t.prototype.addUnresolveProperty=function(r,e){var n=Do.get(r);n||(Do.set(r,[]),n=Do.get(r)),n.indexOf(e)===-1&&n.push(e)},t.prototype.tryToResolveProperty=function(r,e,n){n===void 0&&(n={});var i=n.inherited;if(i&&r.parentElement&&cM(r.parentElement,e)){var a=r.parentElement.parsedStyle[e];return a==="unset"||a==="initial"||a==="inherit"?void 0:a}},t.prototype.recalc=function(r){var e=Do.get(r);if(e&&e.length){var n={};e.forEach(function(i){n[i]=r.attributes[i]}),this.processProperties(r,n),Do.delete(r)}},t.prototype.updateGeometry=function(r){var e=r.nodeName,n=this.runtime.geometryUpdaterFactory[e];if(n){var i=r.geometry;i.contentBounds||(i.contentBounds=new ur),i.renderBounds||(i.renderBounds=new ur);var a=r.parsedStyle,o=n.update(a,r),s=o.width,l=o.height,u=o.depth,h=u===void 0?0:u,v=o.offsetX,p=v===void 0?0:v,m=o.offsetY,C=m===void 0?0:m,w=o.offsetZ,b=w===void 0?0:w,E=[Math.abs(s)/2,Math.abs(l)/2,h/2],R=a,M=R.stroke,k=R.lineWidth,L=R.increasedLineWidthForHitTesting,_=R.shadowType,I=R.shadowColor,P=R.filter,U=P===void 0?[]:P,q=R.transformOrigin,Q=a.anchor;e===ge.TEXT?delete a.anchor:e===ge.MESH&&(a.anchor[2]=.5);var J=[(1-(Q&&Q[0]||0)*2)*s/2+p,(1-(Q&&Q[1]||0)*2)*l/2+C,(1-(Q&&Q[2]||0)*2)*E[2]+b];i.contentBounds.update(J,E);var re=e===ge.POLYLINE||e===ge.POLYGON||e===ge.PATH?Math.SQRT2:.5,ne=M&&!M.isNone;if(ne){var ce=((k||0)+(L||0))*re;E[0]+=ce,E[1]+=ce}if(i.renderBounds.update(J,E),I&&_&&_!=="inner"){var me=i.renderBounds,oe=me.min,Se=me.max,Te=a,Ie=Te.shadowBlur,je=Te.shadowOffsetX,Be=Te.shadowOffsetY,rt=Ie||0,ut=je||0,St=Be||0,st=oe[0]-rt+ut,fr=Se[0]+rt+ut,Pr=oe[1]-rt+St,Ln=Se[1]+rt+St;oe[0]=Math.min(oe[0],st),Se[0]=Math.max(Se[0],fr),oe[1]=Math.min(oe[1],Pr),Se[1]=Math.max(Se[1],Ln),i.renderBounds.setMinMax(oe,Se)}U.forEach(function(Fa){var ha=Fa.name,Ha=Fa.params;if(ha==="blur"){var ql=Ha[0].value;i.renderBounds.update(i.renderBounds.center,Vu(i.renderBounds.halfExtents,i.renderBounds.halfExtents,[ql,ql,0]))}else if(ha==="drop-shadow"){var Kl=Ha[0].value,bs=Ha[1].value,da=Ha[2].value,Zl=i.renderBounds,Fi=Zl.min,Hi=Zl.max,Ss=Fi[0]-da+Kl,wo=Hi[0]+da+Kl,ff=Fi[1]-da+bs,hf=Hi[1]+da+bs;Fi[0]=Math.min(Fi[0],Ss),Hi[0]=Math.max(Hi[0],wo),Fi[1]=Math.min(Fi[1],ff),Hi[1]=Math.max(Hi[1],hf),i.renderBounds.setMinMax(Fi,Hi)}}),Q=a.anchor;var Xr=s<0,mt=l<0,fa=(Xr?-1:1)*(q?wn(q[0],0,r):0),xs=(mt?-1:1)*(q?wn(q[1],1,r):0);fa=fa-(Xr?-1:1)*(Q&&Q[0]||0)*i.contentBounds.halfExtents[0]*2,xs=xs-(mt?-1:1)*(Q&&Q[1]||0)*i.contentBounds.halfExtents[1]*2,r.setOrigin(fa,xs),this.runtime.sceneGraphService.dirtifyToRoot(r)}},t.prototype.updateSizeAttenuation=function(r,e){r.style.isSizeAttenuation?(r.style.rawLineWidth||(r.style.rawLineWidth=r.style.lineWidth),r.style.lineWidth=r.style.rawLineWidth/e,r.nodeName===ge.CIRCLE&&(r.style.rawR||(r.style.rawR=r.style.r),r.style.r=r.style.rawR/e)):(r.style.rawLineWidth&&(r.style.lineWidth=r.style.rawLineWidth,delete r.style.rawLineWidth),r.nodeName===ge.CIRCLE&&r.style.rawR&&(r.style.r=r.style.rawR,delete r.style.rawR))},t.prototype.isPropertyInheritable=function(r){var e=ga[r];return e?e.inh:!1},t}(),hM=function(){function t(){this.parser=Gy,this.parserUnmemoize=av,this.parserWithCSSDisabled=null,this.mixer=ov}return t.prototype.calculator=function(r,e,n,i){return Sn(n)},t}(),dM=function(){function t(){}return t.prototype.calculator=function(r,e,n,i,a){return n instanceof dn&&(n=null),a.sceneGraphService.updateDisplayObjectDependency(r,e,n,i),r==="clipPath"&&i.forEach(function(o){o.childNodes.length===0&&a.sceneGraphService.dirtifyToRoot(o)}),n},t}(),vM=function(){function t(){this.parser=Ko,this.parserWithCSSDisabled=Ko,this.mixer=HL}return t.prototype.calculator=function(r,e,n,i){return n instanceof dn?n.value==="none"?Jh:Fy:n},t}(),pM=function(){function t(){this.parser=Vy}return t.prototype.calculator=function(r,e,n){return n instanceof dn?[]:n},t}();function sm(t){var r=t.parsedStyle.fontSize;return We(r)?null:r}var cv=function(){function t(){this.parser=rs,this.parserUnmemoize=pl,this.parserWithCSSDisabled=null,this.mixer=ov}return t.prototype.calculator=function(r,e,n,i,a){var o;if(li(n))return n;if(xr.isRelativeUnit(n.unit)){var s=a.styleValueRegistry;if(n.unit===De.kPercentage)return 0;if(n.unit===De.kEms){if(i.parentNode){var l=sm(i.parentNode);if(l)return l*=n.value,l;s.addUnresolveProperty(i,r)}else s.addUnresolveProperty(i,r);return 0}else if(n.unit===De.kRems){if(!((o=i==null?void 0:i.ownerDocument)===null||o===void 0)&&o.documentElement){var l=sm(i.ownerDocument.documentElement);if(l)return l*=n.value,l;s.addUnresolveProperty(i,r)}else s.addUnresolveProperty(i,r);return 0}}else return n.value},t}(),gM=function(){function t(){this.mixer=Yy}return t.prototype.parser=function(r){var e=Uy(li(r)?[r]:r),n;return e.length===1?n=[e[0],e[0]]:n=[e[0],e[1]],n},t.prototype.calculator=function(r,e,n){return n.map(function(i){return i.value})},t}(),mM=function(){function t(){this.mixer=Yy}return t.prototype.parser=function(r){var e=Uy(li(r)?[r]:r),n;return e.length===1?n=[e[0],e[0],e[0],e[0]]:e.length===2?n=[e[0],e[1],e[0],e[1]]:e.length===3?n=[e[0],e[1],e[2],e[1]]:n=[e[0],e[1],e[2],e[3]],n},t.prototype.calculator=function(r,e,n){return n.map(function(i){return i.value})},t}(),Xs=Ot();function fv(t,r){var e=r.parsedStyle.defX||0,n=r.parsedStyle.defY||0;return r.resetLocalTransform(),r.setLocalPosition(e,n),t.forEach(function(i){var a=i.t,o=i.d;if(a==="scale"){var s=(o==null?void 0:o.map(function(R){return R.value}))||[1,1];r.scaleLocal(s[0],s[1],1)}else if(a==="scalex"){var s=(o==null?void 0:o.map(function(M){return M.value}))||[1];r.scaleLocal(s[0],1,1)}else if(a==="scaley"){var s=(o==null?void 0:o.map(function(M){return M.value}))||[1];r.scaleLocal(1,s[0],1)}else if(a==="scalez"){var s=(o==null?void 0:o.map(function(M){return M.value}))||[1];r.scaleLocal(1,1,s[0])}else if(a==="scale3d"){var s=(o==null?void 0:o.map(function(M){return M.value}))||[1,1,1];r.scaleLocal(s[0],s[1],s[2])}else if(a==="translate"){var l=o||[dr,dr];r.translateLocal(l[0].value,l[1].value,0)}else if(a==="translatex"){var l=o||[dr];r.translateLocal(l[0].value,0,0)}else if(a==="translatey"){var l=o||[dr];r.translateLocal(0,l[0].value,0)}else if(a==="translatez"){var l=o||[dr];r.translateLocal(0,0,l[0].value)}else if(a==="translate3d"){var l=o||[dr,dr,dr];r.translateLocal(l[0].value,l[1].value,l[2].value)}else if(a==="rotate"){var u=o||[ei];r.rotateLocal(0,0,Sn(u[0]))}else if(a==="rotatex"){var u=o||[ei];r.rotateLocal(Sn(u[0]),0,0)}else if(a==="rotatey"){var u=o||[ei];r.rotateLocal(0,Sn(u[0]),0)}else if(a==="rotatez"){var u=o||[ei];r.rotateLocal(0,0,Sn(u[0]))}else if(a!=="rotate3d")if(a==="skew"){var h=(o==null?void 0:o.map(function(R){return R.value}))||[0,0];r.setLocalSkew(Vt(h[0]),Vt(h[1]))}else if(a==="skewx"){var h=(o==null?void 0:o.map(function(M){return M.value}))||[0];r.setLocalSkew(Vt(h[0]),r.getLocalSkew()[1])}else if(a==="skewy"){var h=(o==null?void 0:o.map(function(M){return M.value}))||[0];r.setLocalSkew(r.getLocalSkew()[0],Vt(h[0]))}else if(a==="matrix"){var v=te(o.map(function(R){return R.value}),6),p=v[0],m=v[1],C=v[2],w=v[3],b=v[4],E=v[5];r.setLocalTransform(Fh(Xs,p,m,0,0,C,w,0,0,0,0,1,0,b+e,E+n,0,1))}else a==="matrix3d"&&(Fh.apply(k_,pe([Xs],te(o.map(function(R){return R.value})),!1)),Xs[12]+=e,Xs[13]+=n,r.setLocalTransform(Xs))}),r.getLocalTransform()}var yM=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.postProcessor=function(e,n){var i,a,o;switch(e.nodeName){case ge.CIRCLE:case ge.ELLIPSE:var s=e.parsedStyle,l=s.cx,u=s.cy,h=s.cz;We(l)||(i=l),We(u)||(a=u),We(h)||(o=h);break;case ge.LINE:var v=e.parsedStyle,p=v.x1,m=v.x2,C=v.y1,w=v.y2,b=Math.min(p,m),E=Math.min(C,w);i=b,a=E,o=0;break;case ge.RECT:case ge.IMAGE:case ge.GROUP:case ge.HTML:case ge.TEXT:case ge.MESH:We(e.parsedStyle.x)||(i=e.parsedStyle.x),We(e.parsedStyle.y)||(a=e.parsedStyle.y),We(e.parsedStyle.z)||(o=e.parsedStyle.z);break}e.nodeName!==ge.PATH&&e.nodeName!==ge.POLYLINE&&e.nodeName!==ge.POLYGON&&(e.parsedStyle.defX=i||0,e.parsedStyle.defY=a||0);var R=!We(i)||!We(a)||!We(o);if(R&&n.indexOf("transform")===-1){var M=e.parsedStyle.transform;if(M&&M.length)fv(M,e);else{var k=te(e.getLocalPosition(),3),L=k[0],_=k[1],I=k[2];e.setLocalPosition(We(i)?L:i,We(a)?_:a,We(o)?I:o)}}},r}(cv),CM=function(){function t(){}return t.prototype.calculator=function(r,e,n,i){n instanceof dn&&(n=null);var a=n==null?void 0:n.cloneNode(!0);return a&&(a.style.isMarker=!0),a},t}(),wM=function(){function t(){this.mixer=ov,this.parser=no,this.parserUnmemoize=vs,this.parserWithCSSDisabled=null}return t.prototype.calculator=function(r,e,n){return n.value},t}(),xM=function(){function t(){this.parser=no,this.parserUnmemoize=vs,this.parserWithCSSDisabled=null,this.mixer=sv(0,1)}return t.prototype.calculator=function(r,e,n){return n.value},t.prototype.postProcessor=function(r){var e=r.parsedStyle,n=e.offsetPath,i=e.offsetDistance;if(n){var a=n.nodeName;if(a===ge.LINE||a===ge.PATH||a===ge.POLYLINE){var o=n.getPoint(i);o&&(r.parsedStyle.defX=o.x,r.parsedStyle.defY=o.y,r.setLocalPosition(o.x,o.y))}}},t}(),bM=function(){function t(){this.parser=no,this.parserUnmemoize=vs,this.parserWithCSSDisabled=null,this.mixer=sv(0,1)}return t.prototype.calculator=function(r,e,n){return n.value},t}(),SM=function(){function t(){this.parser=rd,this.parserWithCSSDisabled=rd,this.mixer=JL}return t.prototype.calculator=function(r,e,n){return n instanceof dn&&n.value==="unset"?{absolutePath:[],hasArc:!1,segments:[],polygons:[],polylines:[],curve:null,totalLength:0,rect:new ro(0,0,0,0)}:n},t.prototype.postProcessor=function(r,e){if(r.parsedStyle.defX=r.parsedStyle.path.rect.x,r.parsedStyle.defY=r.parsedStyle.path.rect.y,r.nodeName===ge.PATH&&e.indexOf("transform")===-1){var n=r.parsedStyle,i=n.defX,a=i===void 0?0:i,o=n.defY,s=o===void 0?0:o;r.setLocalPosition(a,s)}},t}(),EM=function(){function t(){this.parser=qy,this.mixer=QL}return t.prototype.postProcessor=function(r,e){if((r.nodeName===ge.POLYGON||r.nodeName===ge.POLYLINE)&&e.indexOf("transform")===-1){var n=r.parsedStyle,i=n.defX,a=n.defY;r.setLocalPosition(i,a)}},t}(),TM=function(t){Me(r,t);function r(){var e=t.apply(this,pe([],te(arguments),!1))||this;return e.mixer=sv(0,1/0),e}return r}(cv),_M=function(){function t(){}return t.prototype.calculator=function(r,e,n,i){return n instanceof dn?n.value==="unset"?"":n.value:"".concat(n)},t.prototype.postProcessor=function(r){r.nodeValue="".concat(r.parsedStyle.text)||""},t}(),RM=function(){function t(){}return t.prototype.calculator=function(r,e,n,i){var a=i.getAttribute("text");if(a){var o=a;n.value==="capitalize"?o=a.charAt(0).toUpperCase()+a.slice(1):n.value==="lowercase"?o=a.toLowerCase():n.value==="uppercase"&&(o=a.toUpperCase()),i.parsedStyle.text=o}return n.value},t}(),Ch={},LM=0;function MM(t,r){if(t){var e=typeof t=="string"?t:t.id||LM++;Ch[e]&&Ch[e].destroy(),Ch[e]=r}}var kl=typeof window<"u"&&typeof window.document<"u";function OM(t){return!!t.getAttribute}function AM(t,r){for(var e=0,n=t.length;e<n;){var i=e+n>>>1;Zy(t[i],r)<0?e=i+1:n=i}return e}function Zy(t,r){var e=Number(t.parsedStyle.zIndex),n=Number(r.parsedStyle.zIndex);if(e===n){var i=t.parentNode;if(i){var a=i.childNodes||[];return a.indexOf(t)-a.indexOf(r)}}return e-n}function jy(t){var r,e=t;do{var n=(r=e.parsedStyle)===null||r===void 0?void 0:r.clipPath;if(n)return e;e=e.parentElement}while(e!==null);return null}var lm="px";function NM(t,r,e){kl&&t.style&&(t.style.width=r+lm,t.style.height=e+lm)}function Jy(t,r){if(kl)return document.defaultView.getComputedStyle(t,null).getPropertyValue(r)}function kM(t){var r=Jy(t,"width");return r==="auto"?t.offsetWidth:parseFloat(r)}function IM(t){var r=Jy(t,"height");return r==="auto"?t.offsetHeight:parseFloat(r)}var PM=1,DM={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"},nd=typeof performance=="object"&&performance.now?performance:Date;function vo(t,r,e){var n=!1,i=!1,a=!!r&&!r.isNone,o=!!e&&!e.isNone;return t==="visiblepainted"||t==="painted"||t==="auto"?(n=a,i=o):t==="visiblefill"||t==="fill"?n=!0:t==="visiblestroke"||t==="stroke"?i=!0:(t==="visible"||t==="all")&&(n=!0,i=!0),[n,i]}var BM=1,FM=function(){return BM++},Oi=typeof self=="object"&&self.self==self?self:typeof global=="object"&&global.global==global?global:{},HM=Date.now(),zM=function(){return Oi.performance&&typeof Oi.performance.now=="function"?Oi.performance.now():Date.now()-HM},Js={},um=Date.now(),WM=function(t){if(typeof t!="function")throw new TypeError(t+" is not a function");var r=Date.now(),e=r-um,n=e>16?0:16-e,i=FM();return Js[i]=t,Object.keys(Js).length>1||setTimeout(function(){um=r;var a=Js;Js={},Object.keys(a).forEach(function(o){return a[o](zM())})},n),i},GM=function(t){delete Js[t]},UM=["","webkit","moz","ms","o"],Qy=function(t){return typeof t!="string"?WM:t===""?Oi.requestAnimationFrame:Oi[t+"RequestAnimationFrame"]},VM=function(t){return typeof t!="string"?GM:t===""?Oi.cancelAnimationFrame:Oi[t+"CancelAnimationFrame"]||Oi[t+"CancelRequestAnimationFrame"]},XM=function(t,r){for(var e=0;t[e]!==void 0;){if(r(t[e]))return t[e];e=e+1}},eC=XM(UM,function(t){return!!Qy(t)}),tC=Qy(eC),rC=VM(eC);Oi.requestAnimationFrame=tC;Oi.cancelAnimationFrame=rC;var YM=function(){function t(){this.callbacks=[]}return t.prototype.getCallbacksNum=function(){return this.callbacks.length},t.prototype.tapPromise=function(r,e){this.callbacks.push(e)},t.prototype.promise=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return Promise.all(this.callbacks.map(function(n){return n.apply(void 0,pe([],te(r),!1))}))},t}(),$M=function(){function t(){this.callbacks=[]}return t.prototype.tapPromise=function(r,e){this.callbacks.push(e)},t.prototype.promise=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];return Ar(this,void 0,void 0,function(){var n,i,a,o;return Nr(this,function(s){switch(s.label){case 0:return this.callbacks.length?[4,(o=this.callbacks)[0].apply(o,pe([],te(r),!1))]:[3,6];case 1:n=s.sent(),i=0,s.label=2;case 2:return i<this.callbacks.length-1?(a=this.callbacks[i],[4,a(n)]):[3,5];case 3:n=s.sent(),s.label=4;case 4:return i++,[3,2];case 5:return[2,n];case 6:return[2,null]}})})},t}(),Zr=function(){function t(){this.callbacks=[]}return t.prototype.tap=function(r,e){this.callbacks.push(e)},t.prototype.call=function(){var r=arguments;this.callbacks.forEach(function(e){e.apply(void 0,r)})},t}(),wh=function(){function t(){this.callbacks=[]}return t.prototype.tap=function(r,e){this.callbacks.push(e)},t.prototype.call=function(){if(this.callbacks.length){for(var r=arguments,e=this.callbacks[0].apply(void 0,r),n=0;n<this.callbacks.length-1;n++){var i=this.callbacks[n];e=i(e)}return e}return null},t}(),qM=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],KM=/([\"\'])[^\'\"]+\1/;function ZM(t){for(var r=t.fontSize,e=t.fontFamily,n=t.fontStyle,i=t.fontVariant,a=t.fontWeight,o=li(r)&&"".concat(r,"px")||"16px",s=e.split(","),l=s.length-1;l>=0;l--){var u=s[l].trim();!KM.test(u)&&qM.indexOf(u)<0&&(u='"'.concat(u,'"')),s[l]=u}return"".concat(n," ").concat(i," ").concat(a," ").concat(o," ").concat(s.join(","))}var jM=function(){function t(){this.parser=lv,this.parserUnmemoize=im,this.parserWithCSSDisabled=im,this.mixer=lM}return t.prototype.calculator=function(r,e,n,i){return n instanceof dn?[]:n},t.prototype.postProcessor=function(r){var e=r.parsedStyle.transform;fv(e,r)},t}(),JM=function(){function t(){this.parser=Ky,this.parserUnmemoize=uM}return t}(),QM=function(){function t(){this.parser=no,this.parserUnmemoize=vs}return t.prototype.calculator=function(r,e,n,i){return n.value},t.prototype.postProcessor=function(r){if(r.parentNode){var e=r.parentNode,n=e.renderable,i=e.sortable;n&&(n.dirty=!0),i&&(i.dirty=!0,i.dirtyReason=ts.Z_INDEX_CHANGED)}},t}(),eO=function(){function t(){}return t.prototype.update=function(r,e){var n=r.r,i=n*2,a=n*2;return{width:i,height:a}},t}(),tO=function(){function t(){}return t.prototype.update=function(r,e){var n=r.rx,i=r.ry,a=n*2,o=i*2;return{width:a,height:o}},t}(),rO=function(){function t(){}return t.prototype.update=function(r){var e=r.x1,n=r.y1,i=r.x2,a=r.y2,o=Math.min(e,i),s=Math.max(e,i),l=Math.min(n,a),u=Math.max(n,a),h=s-o,v=u-l;return{width:h,height:v}},t}(),nO=function(){function t(){}return t.prototype.update=function(r){var e=r.path,n=e.rect,i=n.width,a=n.height;return{width:i,height:a}},t}(),iO=function(){function t(){}return t.prototype.update=function(r){if(r.points&&tv(r.points.points)){var e=r.points.points,n=Math.min.apply(Math,pe([],te(e.map(function(u){return u[0]})),!1)),i=Math.max.apply(Math,pe([],te(e.map(function(u){return u[0]})),!1)),a=Math.min.apply(Math,pe([],te(e.map(function(u){return u[1]})),!1)),o=Math.max.apply(Math,pe([],te(e.map(function(u){return u[1]})),!1)),s=i-n,l=o-a;return{width:s,height:l}}return{width:0,height:0}},t}(),aO=function(){function t(){}return t.prototype.update=function(r,e){var n=r.img,i=r.width,a=i===void 0?0:i,o=r.height,s=o===void 0?0:o,l=a,u=s;return n&&!kr(n)&&(l||(l=n.width,r.width=l),u||(u=n.height,r.height=u)),{width:l,height:u}},t}(),oO=function(){function t(r){this.globalRuntime=r}return t.prototype.isReadyToMeasure=function(r,e){var n=r.text,i=r.textAlign,a=r.textBaseline,o=r.fontSize,s=r.fontStyle,l=r.fontWeight,u=r.fontVariant,h=r.lineWidth;return n&&o&&s&&l&&u&&i&&a&&!We(h)},t.prototype.update=function(r,e){var n,i,a=r.text,o=r.textAlign,s=r.lineWidth,l=r.textBaseline,u=r.dx,h=r.dy;if(!this.isReadyToMeasure(r,e))return r.metrics={font:"",width:0,height:0,lines:[],lineWidths:[],lineHeight:0,maxLineWidth:0,fontProperties:{ascent:0,descent:0,fontSize:0},lineMetrics:[]},{width:0,height:0,x:0,y:0,offsetX:0,offsetY:0};var v=(((i=(n=e==null?void 0:e.ownerDocument)===null||n===void 0?void 0:n.defaultView)===null||i===void 0?void 0:i.getConfig())||{}).offscreenCanvas,p=this.globalRuntime.textService.measureText(a,r,v);r.metrics=p;var m=p.width,C=p.height,w=p.lineHeight,b=p.fontProperties,E=[m/2,C/2,0],R=[0,1],M=0;o==="center"||o==="middle"?(M=s/2,R=[.5,1]):(o==="right"||o==="end")&&(M=s,R=[1,1]);var k=0;return l==="middle"?k=E[1]:l==="top"||l==="hanging"?k=E[1]*2:l==="alphabetic"?k=this.globalRuntime.enableCSSParsing?w-b.ascent:0:(l==="bottom"||l==="ideographic")&&(k=0),u&&(M+=u),h&&(k+=h),r.anchor=[R[0],R[1],0],{width:E[0]*2,height:E[1]*2,offsetX:M,offsetY:k}},t}();function sO(t){return!!t.type}var Bc=function(){function t(r){this.eventPhase=t.prototype.NONE,this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.defaultPrevented=!1,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer=new Tr,this.page=new Tr,this.canvas=new Tr,this.viewport=new Tr,this.composed=!1,this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=r}return Object.defineProperty(t.prototype,"name",{get:function(){return this.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layerX",{get:function(){return this.layer.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"layerY",{get:function(){return this.layer.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageX",{get:function(){return this.page.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pageY",{get:function(){return this.page.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvasX",{get:function(){return this.canvas.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvasY",{get:function(){return this.canvas.y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewportX",{get:function(){return this.viewport.x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewportY",{get:function(){return this.viewport.y},enumerable:!1,configurable:!0}),t.prototype.composedPath=function(){return this.manager&&(!this.path||this.path[0]!==this.target)&&(this.path=this.target?this.manager.propagationPath(this.target):[]),this.path},Object.defineProperty(t.prototype,"propagationPath",{get:function(){return this.composedPath()},enumerable:!1,configurable:!0}),t.prototype.preventDefault=function(){this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault(),this.defaultPrevented=!0},t.prototype.stopImmediatePropagation=function(){this.propagationImmediatelyStopped=!0},t.prototype.stopPropagation=function(){this.propagationStopped=!0},t.prototype.initEvent=function(){},t.prototype.initUIEvent=function(){},t.prototype.clone=function(){throw new Error(Tt)},t}(),nC=function(t){Me(r,t);function r(){var e=t.apply(this,pe([],te(arguments),!1))||this;return e.client=new Tr,e.movement=new Tr,e.offset=new Tr,e.global=new Tr,e.screen=new Tr,e}return Object.defineProperty(r.prototype,"clientX",{get:function(){return this.client.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"clientY",{get:function(){return this.client.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"movementX",{get:function(){return this.movement.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"movementY",{get:function(){return this.movement.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"offsetX",{get:function(){return this.offset.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"offsetY",{get:function(){return this.offset.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"globalX",{get:function(){return this.global.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"globalY",{get:function(){return this.global.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"screenX",{get:function(){return this.screen.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"screenY",{get:function(){return this.screen.y},enumerable:!1,configurable:!0}),r.prototype.getModifierState=function(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)},r.prototype.initMouseEvent=function(){throw new Error(Tt)},r}(Bc),id=function(t){Me(r,t);function r(){var e=t.apply(this,pe([],te(arguments),!1))||this;return e.width=0,e.height=0,e.isPrimary=!1,e}return r.prototype.getCoalescedEvents=function(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]},r.prototype.getPredictedEvents=function(){throw new Error("getPredictedEvents is not supported!")},r.prototype.clone=function(){return this.manager.clonePointerEvent(this)},r}(nC),ad=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.clone=function(){return this.manager.cloneWheelEvent(this)},r}(nC),Sr=function(t){Me(r,t);function r(e,n){var i=t.call(this,null)||this;return i.type=e,i.detail=n,Object.assign(i,n),i}return r}(Bc),cm=":",iC=function(){function t(){this.emitter=new Qd}return t.prototype.on=function(r,e,n){return this.addEventListener(r,e,n),this},t.prototype.addEventListener=function(r,e,n){var i=Og(n)&&n||Gu(n)&&n.capture,a=Gu(n)&&n.once,o=Ho(e)?void 0:e,s=!1,l="";if(r.indexOf(cm)>-1){var u=te(r.split(cm),2),h=u[0],v=u[1];r=v,l=h,s=!0}if(r=i?"".concat(r,"capture"):r,e=Ho(e)?e:e.handleEvent,s){var p=e;e=function(){for(var m,C=[],w=0;w<arguments.length;w++)C[w]=arguments[w];((m=C[0].target)===null||m===void 0?void 0:m.name)===l&&p.apply(void 0,pe([],te(C),!1))}}return a?this.emitter.once(r,e,o):this.emitter.on(r,e,o),this},t.prototype.off=function(r,e,n){return r?this.removeEventListener(r,e,n):this.removeAllEventListeners(),this},t.prototype.removeAllEventListeners=function(){this.emitter.removeAllListeners()},t.prototype.removeEventListener=function(r,e,n){var i=Og(n)&&n||Gu(n)&&n.capture,a=Ho(e)?void 0:e;return r=i?"".concat(r,"capture"):r,e=Ho(e)?e:e==null?void 0:e.handleEvent,this.emitter.off(r,e,a),this},t.prototype.emit=function(r,e){this.dispatchEvent(new Sr(r,e))},t.prototype.dispatchEvent=function(r,e){var n,i;if(e===void 0&&(e=!1),!sO(r))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");var a;if(this.document?a=this:this.defaultView?a=this.defaultView:a=(n=this.ownerDocument)===null||n===void 0?void 0:n.defaultView,a){if(r.manager=a.getEventService()||null,!r.manager)return!1;r.defaultPrevented=!1,r.path=[],e||(r.target=this),(i=r.manager)===null||i===void 0||i.dispatchEvent(r,r.type,e)}return!r.defaultPrevented},t}(),wr=function(t){Me(r,t);function r(){var e=t.apply(this,pe([],te(arguments),!1))||this;return e.shadow=!1,e.ownerDocument=null,e.isConnected=!1,e.baseURI="",e.childNodes=[],e.nodeType=0,e.nodeName="",e.nodeValue=null,e.parentNode=null,e}return r.isNode=function(e){return!!e.childNodes},Object.defineProperty(r.prototype,"textContent",{get:function(){var e,n,i="";this.nodeName===ge.TEXT&&(i+=this.style.text);try{for(var a=Wr(this.childNodes),o=a.next();!o.done;o=a.next()){var s=o.value;s.nodeName===ge.TEXT?i+=s.nodeValue:i+=s.textContent}}catch(l){e={error:l}}finally{try{o&&!o.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return i},set:function(e){var n=this;this.childNodes.slice().forEach(function(i){n.removeChild(i)}),this.nodeName===ge.TEXT&&(this.style.text="".concat(e))},enumerable:!1,configurable:!0}),r.prototype.getRootNode=function(e){return e===void 0&&(e={}),this.parentNode?this.parentNode.getRootNode(e):e.composed&&this.host?this.host.getRootNode(e):this},r.prototype.hasChildNodes=function(){return this.childNodes.length>0},r.prototype.isDefaultNamespace=function(e){throw new Error(Tt)},r.prototype.lookupNamespaceURI=function(e){throw new Error(Tt)},r.prototype.lookupPrefix=function(e){throw new Error(Tt)},r.prototype.normalize=function(){throw new Error(Tt)},r.prototype.isEqualNode=function(e){return this===e},r.prototype.isSameNode=function(e){return this.isEqualNode(e)},Object.defineProperty(r.prototype,"parent",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"parentElement",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"nextSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"previousSibling",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"firstChild",{get:function(){return this.childNodes.length>0?this.childNodes[0]:null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lastChild",{get:function(){return this.childNodes.length>0?this.childNodes[this.childNodes.length-1]:null},enumerable:!1,configurable:!0}),r.prototype.compareDocumentPosition=function(e){var n;if(e===this)return 0;for(var i=e,a=this,o=[i],s=[a];(n=i.parentNode)!==null&&n!==void 0?n:a.parentNode;)i=i.parentNode?(o.push(i.parentNode),i.parentNode):i,a=a.parentNode?(s.push(a.parentNode),a.parentNode):a;if(i!==a)return r.DOCUMENT_POSITION_DISCONNECTED|r.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC|r.DOCUMENT_POSITION_PRECEDING;var l=o.length>s.length?o:s,u=l===o?s:o;if(l[l.length-u.length]===u[0])return l===o?r.DOCUMENT_POSITION_CONTAINED_BY|r.DOCUMENT_POSITION_FOLLOWING:r.DOCUMENT_POSITION_CONTAINS|r.DOCUMENT_POSITION_PRECEDING;for(var h=l.length-u.length,v=u.length-1;v>=0;v--){var p=u[v],m=l[h+v];if(m!==p){var C=p.parentNode.childNodes;return C.indexOf(p)<C.indexOf(m)?u===o?r.DOCUMENT_POSITION_PRECEDING:r.DOCUMENT_POSITION_FOLLOWING:l===o?r.DOCUMENT_POSITION_PRECEDING:r.DOCUMENT_POSITION_FOLLOWING}}return r.DOCUMENT_POSITION_FOLLOWING},r.prototype.contain=function(e){return this.contains(e)},r.prototype.contains=function(e){for(var n=e;n&&this!==n;)n=n.parentNode;return!!n},r.prototype.getAncestor=function(e){for(var n=this;e>0&&n;)n=n.parentNode,e--;return n},r.prototype.forEach=function(e,n){n===void 0&&(n=!1),e(this)||(n?this.childNodes.slice():this.childNodes).forEach(function(i){i.forEach(e)})},r.DOCUMENT_POSITION_DISCONNECTED=1,r.DOCUMENT_POSITION_PRECEDING=2,r.DOCUMENT_POSITION_FOLLOWING=4,r.DOCUMENT_POSITION_CONTAINS=8,r.DOCUMENT_POSITION_CONTAINED_BY=16,r.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=32,r}(iC),lO=2048,uO=function(){function t(r,e){var n=this;this.globalRuntime=r,this.context=e,this.emitter=new Qd,this.nativeHTMLMap=new WeakMap,this.cursor="default",this.mappingTable={},this.mappingState={trackingData:{}},this.eventPool=new Map,this.tmpMatrix=Ot(),this.tmpVec3=at(),this.onPointerDown=function(i){var a=n.createPointerEvent(i);if(n.dispatchEvent(a,"pointerdown"),a.pointerType==="touch")n.dispatchEvent(a,"touchstart");else if(a.pointerType==="mouse"||a.pointerType==="pen"){var o=a.button===2;n.dispatchEvent(a,o?"rightdown":"mousedown")}var s=n.trackingData(i.pointerId);s.pressTargetsByButton[i.button]=a.composedPath(),n.freeEvent(a)},this.onPointerUp=function(i){var a,o=nd.now(),s=n.createPointerEvent(i,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0);if(n.dispatchEvent(s,"pointerup"),s.pointerType==="touch")n.dispatchEvent(s,"touchend");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;n.dispatchEvent(s,l?"rightup":"mouseup")}var u=n.trackingData(i.pointerId),h=n.findMountedTarget(u.pressTargetsByButton[i.button]),v=h;if(h&&!s.composedPath().includes(h)){for(var p=h;p&&!s.composedPath().includes(p);){if(s.currentTarget=p,n.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch")n.notifyTarget(s,"touchendoutside");else if(s.pointerType==="mouse"||s.pointerType==="pen"){var l=s.button===2;n.notifyTarget(s,l?"rightupoutside":"mouseupoutside")}wr.isNode(p)&&(p=p.parentNode)}delete u.pressTargetsByButton[i.button],v=p}if(v){var m=n.clonePointerEvent(s,"click");m.target=v,m.path=[],u.clicksByButton[i.button]||(u.clicksByButton[i.button]={clickCount:0,target:m.target,timeStamp:o});var C=u.clicksByButton[i.button];C.target===m.target&&o-C.timeStamp<200?++C.clickCount:C.clickCount=1,C.target=m.target,C.timeStamp=o,m.detail=C.clickCount,!((a=s.detail)===null||a===void 0)&&a.preventClick||(!n.context.config.useNativeClickEvent&&(m.pointerType==="mouse"||m.pointerType==="touch")&&n.dispatchEvent(m,"click"),n.dispatchEvent(m,"pointertap")),n.freeEvent(m)}n.freeEvent(s)},this.onPointerMove=function(i){var a=n.createPointerEvent(i,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0),o=a.pointerType==="mouse"||a.pointerType==="pen",s=n.trackingData(i.pointerId),l=n.findMountedTarget(s.overTargets);if(s.overTargets&&l!==a.target){var u=i.type==="mousemove"?"mouseout":"pointerout",h=n.createPointerEvent(i,u,l||void 0);if(n.dispatchEvent(h,"pointerout"),o&&n.dispatchEvent(h,"mouseout"),!a.composedPath().includes(l)){var v=n.createPointerEvent(i,"pointerleave",l||void 0);for(v.eventPhase=v.AT_TARGET;v.target&&!a.composedPath().includes(v.target);)v.currentTarget=v.target,n.notifyTarget(v),o&&n.notifyTarget(v,"mouseleave"),wr.isNode(v.target)&&(v.target=v.target.parentNode);n.freeEvent(v)}n.freeEvent(h)}if(l!==a.target){var p=i.type==="mousemove"?"mouseover":"pointerover",m=n.clonePointerEvent(a,p);n.dispatchEvent(m,"pointerover"),o&&n.dispatchEvent(m,"mouseover");for(var C=l&&wr.isNode(l)&&l.parentNode;C&&C!==(wr.isNode(n.rootTarget)&&n.rootTarget.parentNode)&&C!==a.target;)C=C.parentNode;var w=!C||C===(wr.isNode(n.rootTarget)&&n.rootTarget.parentNode);if(w){var b=n.clonePointerEvent(a,"pointerenter");for(b.eventPhase=b.AT_TARGET;b.target&&b.target!==l&&b.target!==(wr.isNode(n.rootTarget)&&n.rootTarget.parentNode);)b.currentTarget=b.target,n.notifyTarget(b),o&&n.notifyTarget(b,"mouseenter"),wr.isNode(b.target)&&(b.target=b.target.parentNode);n.freeEvent(b)}n.freeEvent(m)}n.dispatchEvent(a,"pointermove"),a.pointerType==="touch"&&n.dispatchEvent(a,"touchmove"),o&&(n.dispatchEvent(a,"mousemove"),n.cursor=n.getCursor(a.target)),s.overTargets=a.composedPath(),n.freeEvent(a)},this.onPointerOut=function(i){var a=n.trackingData(i.pointerId);if(a.overTargets){var o=i.pointerType==="mouse"||i.pointerType==="pen",s=n.findMountedTarget(a.overTargets),l=n.createPointerEvent(i,"pointerout",s||void 0);n.dispatchEvent(l),o&&n.dispatchEvent(l,"mouseout");var u=n.createPointerEvent(i,"pointerleave",s||void 0);for(u.eventPhase=u.AT_TARGET;u.target&&u.target!==(wr.isNode(n.rootTarget)&&n.rootTarget.parentNode);)u.currentTarget=u.target,n.notifyTarget(u),o&&n.notifyTarget(u,"mouseleave"),wr.isNode(u.target)&&(u.target=u.target.parentNode);a.overTargets=null,n.freeEvent(l),n.freeEvent(u)}n.cursor=null},this.onPointerOver=function(i){var a=n.trackingData(i.pointerId),o=n.createPointerEvent(i),s=o.pointerType==="mouse"||o.pointerType==="pen";n.dispatchEvent(o,"pointerover"),s&&n.dispatchEvent(o,"mouseover"),o.pointerType==="mouse"&&(n.cursor=n.getCursor(o.target));var l=n.clonePointerEvent(o,"pointerenter");for(l.eventPhase=l.AT_TARGET;l.target&&l.target!==(wr.isNode(n.rootTarget)&&n.rootTarget.parentNode);)l.currentTarget=l.target,n.notifyTarget(l),s&&n.notifyTarget(l,"mouseenter"),wr.isNode(l.target)&&(l.target=l.target.parentNode);a.overTargets=o.composedPath(),n.freeEvent(o),n.freeEvent(l)},this.onPointerUpOutside=function(i){var a=n.trackingData(i.pointerId),o=n.findMountedTarget(a.pressTargetsByButton[i.button]),s=n.createPointerEvent(i);if(o){for(var l=o;l;)s.currentTarget=l,n.notifyTarget(s,"pointerupoutside"),s.pointerType==="touch"||(s.pointerType==="mouse"||s.pointerType==="pen")&&n.notifyTarget(s,s.button===2?"rightupoutside":"mouseupoutside"),wr.isNode(l)&&(l=l.parentNode);delete a.pressTargetsByButton[i.button]}n.freeEvent(s)},this.onWheel=function(i){var a=n.createWheelEvent(i);n.dispatchEvent(a),n.freeEvent(a)},this.onClick=function(i){if(n.context.config.useNativeClickEvent){var a=n.createPointerEvent(i);n.dispatchEvent(a),n.freeEvent(a)}},this.onPointerCancel=function(i){var a=n.createPointerEvent(i,void 0,void 0,n.context.config.alwaysTriggerPointerEventOnCanvas?n.rootTarget:void 0);n.dispatchEvent(a),n.freeEvent(a)}}return t.prototype.init=function(){this.rootTarget=this.context.renderingContext.root.parentNode,this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointercancel",this.onPointerCancel),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel),this.addEventMapping("click",this.onClick)},t.prototype.destroy=function(){this.emitter.removeAllListeners(),this.mappingTable={},this.mappingState={},this.eventPool.clear()},t.prototype.client2Viewport=function(r){var e=this.context.contextService.getBoundingClientRect();return new Tr(r.x-((e==null?void 0:e.left)||0),r.y-((e==null?void 0:e.top)||0))},t.prototype.viewport2Client=function(r){var e=this.context.contextService.getBoundingClientRect();return new Tr(r.x+((e==null?void 0:e.left)||0),r.y+((e==null?void 0:e.top)||0))},t.prototype.viewport2Canvas=function(r){var e=r.x,n=r.y,i=this.rootTarget.defaultView,a=i.getCamera(),o=this.context.config,s=o.width,l=o.height,u=a.getPerspectiveInverse(),h=a.getWorldTransform(),v=Gr(this.tmpMatrix,h,u),p=Jn(this.tmpVec3,e/s*2-1,(1-n/l)*2-1,0);return Gn(p,p,v),new Tr(p[0],p[1])},t.prototype.canvas2Viewport=function(r){var e=this.rootTarget.defaultView,n=e.getCamera(),i=n.getPerspective(),a=n.getViewTransform(),o=Gr(this.tmpMatrix,i,a),s=Jn(this.tmpVec3,r.x,r.y,0);Gn(this.tmpVec3,this.tmpVec3,o);var l=this.context.config,u=l.width,h=l.height;return new Tr((s[0]+1)/2*u,(1-(s[1]+1)/2)*h)},t.prototype.setPickHandler=function(r){this.pickHandler=r},t.prototype.addEventMapping=function(r,e){this.mappingTable[r]||(this.mappingTable[r]=[]),this.mappingTable[r].push({fn:e,priority:0}),this.mappingTable[r].sort(function(n,i){return n.priority-i.priority})},t.prototype.mapEvent=function(r){if(this.rootTarget){var e=this.mappingTable[r.type];if(e)for(var n=0,i=e.length;n<i;n++)e[n].fn(r);else console.warn("[EventService]: Event mapping not defined for ".concat(r.type))}},t.prototype.dispatchEvent=function(r,e,n){if(!n)r.propagationStopped=!1,r.propagationImmediatelyStopped=!1,this.propagate(r,e);else{r.eventPhase=r.AT_TARGET;var i=this.rootTarget.defaultView||null;r.currentTarget=i,this.notifyListeners(r,e)}this.emitter.emit(e||r.type,r)},t.prototype.propagate=function(r,e){if(r.target){var n=r.composedPath();r.eventPhase=r.CAPTURING_PHASE;for(var i=n.length-1;i>=1;i--)if(r.currentTarget=n[i],this.notifyTarget(r,e),r.propagationStopped||r.propagationImmediatelyStopped)return;if(r.eventPhase=r.AT_TARGET,r.currentTarget=r.target,this.notifyTarget(r,e),!(r.propagationStopped||r.propagationImmediatelyStopped)){var a=n.indexOf(r.currentTarget);r.eventPhase=r.BUBBLING_PHASE;for(var i=a+1;i<n.length;i++)if(r.currentTarget=n[i],this.notifyTarget(r,e),r.propagationStopped||r.propagationImmediatelyStopped)return}}},t.prototype.propagationPath=function(r){var e=[r],n=this.rootTarget.defaultView||null;if(n&&n===r)return e.unshift(n.document),e;for(var i=0;i<lO&&r!==this.rootTarget;i++)wr.isNode(r)&&r.parentNode&&(e.push(r.parentNode),r=r.parentNode);return n&&e.push(n),e},t.prototype.hitTest=function(r){var e=r.viewportX,n=r.viewportY,i=this.context.config,a=i.width,o=i.height,s=i.disableHitTesting;return e<0||n<0||e>a||n>o?null:!s&&this.pickHandler(r)||this.rootTarget||null},t.prototype.isNativeEventFromCanvas=function(r){var e,n=this.context.contextService.getDomElement(),i=(e=r.nativeEvent)===null||e===void 0?void 0:e.target;if(i){if(i===n)return!0;if(n&&n.contains)return n.contains(i)}return r.nativeEvent.composedPath?r.nativeEvent.composedPath().indexOf(n)>-1:!1},t.prototype.getExistedHTML=function(r){var e,n;if(r.nativeEvent.composedPath)try{for(var i=Wr(r.nativeEvent.composedPath()),a=i.next();!a.done;a=i.next()){var o=a.value,s=this.nativeHTMLMap.get(o);if(s)return s}}catch(l){e={error:l}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return null},t.prototype.pickTarget=function(r){return this.hitTest({clientX:r.clientX,clientY:r.clientY,viewportX:r.viewportX,viewportY:r.viewportY,x:r.canvasX,y:r.canvasY})},t.prototype.createPointerEvent=function(r,e,n,i){var a=this.allocateEvent(id);this.copyPointerData(r,a),this.copyMouseData(r,a),this.copyData(r,a),a.nativeEvent=r.nativeEvent,a.originalEvent=r;var o=this.getExistedHTML(a);return a.target=n??(o||this.isNativeEventFromCanvas(a)&&this.pickTarget(a)||i),typeof e=="string"&&(a.type=e),a},t.prototype.createWheelEvent=function(r){var e=this.allocateEvent(ad);this.copyWheelData(r,e),this.copyMouseData(r,e),this.copyData(r,e),e.nativeEvent=r.nativeEvent,e.originalEvent=r;var n=this.getExistedHTML(e);return e.target=n||this.isNativeEventFromCanvas(e)&&this.pickTarget(e),e},t.prototype.trackingData=function(r){return this.mappingState.trackingData[r]||(this.mappingState.trackingData[r]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[r]},t.prototype.cloneWheelEvent=function(r){var e=this.allocateEvent(ad);return e.nativeEvent=r.nativeEvent,e.originalEvent=r.originalEvent,this.copyWheelData(r,e),this.copyMouseData(r,e),this.copyData(r,e),e.target=r.target,e.path=r.composedPath().slice(),e.type=r.type,e},t.prototype.clonePointerEvent=function(r,e){var n=this.allocateEvent(id);return n.nativeEvent=r.nativeEvent,n.originalEvent=r.originalEvent,this.copyPointerData(r,n),this.copyMouseData(r,n),this.copyData(r,n),n.target=r.target,n.path=r.composedPath().slice(),n.type=e??n.type,n},t.prototype.copyPointerData=function(r,e){e.pointerId=r.pointerId,e.width=r.width,e.height=r.height,e.isPrimary=r.isPrimary,e.pointerType=r.pointerType,e.pressure=r.pressure,e.tangentialPressure=r.tangentialPressure,e.tiltX=r.tiltX,e.tiltY=r.tiltY,e.twist=r.twist},t.prototype.copyMouseData=function(r,e){e.altKey=r.altKey,e.button=r.button,e.buttons=r.buttons,e.ctrlKey=r.ctrlKey,e.metaKey=r.metaKey,e.shiftKey=r.shiftKey,e.client.copyFrom(r.client),e.movement.copyFrom(r.movement),e.canvas.copyFrom(r.canvas),e.screen.copyFrom(r.screen),e.global.copyFrom(r.global),e.offset.copyFrom(r.offset)},t.prototype.copyWheelData=function(r,e){e.deltaMode=r.deltaMode,e.deltaX=r.deltaX,e.deltaY=r.deltaY,e.deltaZ=r.deltaZ},t.prototype.copyData=function(r,e){e.isTrusted=r.isTrusted,e.timeStamp=nd.now(),e.type=r.type,e.detail=r.detail,e.view=r.view,e.page.copyFrom(r.page),e.viewport.copyFrom(r.viewport)},t.prototype.allocateEvent=function(r){this.eventPool.has(r)||this.eventPool.set(r,[]);var e=this.eventPool.get(r).pop()||new r(this);return e.eventPhase=e.NONE,e.currentTarget=null,e.path=[],e.target=null,e},t.prototype.freeEvent=function(r){if(r.manager!==this)throw new Error("It is illegal to free an event not managed by this EventBoundary!");var e=r.constructor;this.eventPool.has(e)||this.eventPool.set(e,[]),this.eventPool.get(e).push(r)},t.prototype.notifyTarget=function(r,e){e=e??r.type;var n=r.eventPhase===r.CAPTURING_PHASE||r.eventPhase===r.AT_TARGET?"".concat(e,"capture"):e;this.notifyListeners(r,n),r.eventPhase===r.AT_TARGET&&this.notifyListeners(r,e)},t.prototype.notifyListeners=function(r,e){var n=r.currentTarget.emitter,i=n._events[e];if(i)if("fn"in i)i.once&&n.removeListener(e,i.fn,void 0,!0),i.fn.call(r.currentTarget||i.context,r);else for(var a=0;a<i.length&&!r.propagationImmediatelyStopped;a++)i[a].once&&n.removeListener(e,i[a].fn,void 0,!0),i[a].fn.call(r.currentTarget||i[a].context,r)},t.prototype.findMountedTarget=function(r){if(!r)return null;for(var e=r[r.length-1],n=r.length-2;n>=0;n--){var i=r[n];if(i===this.rootTarget||wr.isNode(i)&&i.parentNode===e)e=r[n];else break}return e},t.prototype.getCursor=function(r){for(var e=r;e;){var n=OM(e)&&e.getAttribute("cursor");if(n)return n;e=wr.isNode(e)&&e.parentNode}},t}(),cO=function(){function t(){}return t.prototype.getOrCreateCanvas=function(r,e){if(this.canvas)return this.canvas;if(r||ye.offscreenCanvas)this.canvas=r||ye.offscreenCanvas,this.context=this.canvas.getContext("2d",Y({willReadFrequently:!0},e));else try{this.canvas=new window.OffscreenCanvas(0,0),this.context=this.canvas.getContext("2d",Y({willReadFrequently:!0},e)),(!this.context||!this.context.measureText)&&(this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"))}catch{this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",Y({willReadFrequently:!0},e))}return this.canvas.width=10,this.canvas.height=10,this.canvas},t.prototype.getOrCreateContext=function(r,e){return this.context?this.context:(this.getOrCreateCanvas(r,e),this.context)},t}(),_a;(function(t){t[t.CAMERA_CHANGED=0]="CAMERA_CHANGED",t[t.DISPLAY_OBJECT_CHANGED=1]="DISPLAY_OBJECT_CHANGED",t[t.NONE=2]="NONE"})(_a||(_a={}));var fO=function(){function t(r,e){this.globalRuntime=r,this.context=e,this.inited=!1,this.stats={total:0,rendered:0},this.zIndexCounter=0,this.hooks={init:new Zr,initAsync:new YM,dirtycheck:new wh,cull:new wh,beginFrame:new Zr,beforeRender:new Zr,render:new Zr,afterRender:new Zr,endFrame:new Zr,destroy:new Zr,pick:new $M,pickSync:new wh,pointerDown:new Zr,pointerUp:new Zr,pointerMove:new Zr,pointerOut:new Zr,pointerOver:new Zr,pointerWheel:new Zr,pointerCancel:new Zr,click:new Zr}}return t.prototype.init=function(r){var e=this,n=Y(Y({},this.globalRuntime),this.context);this.context.renderingPlugins.forEach(function(i){i.apply(n,e.globalRuntime)}),this.hooks.init.call(),this.hooks.initAsync.getCallbacksNum()===0?(this.inited=!0,r()):this.hooks.initAsync.promise().then(function(){e.inited=!0,r()})},t.prototype.getStats=function(){return this.stats},t.prototype.disableDirtyRectangleRendering=function(){var r=this.context.config.renderer,e=r.getConfig().enableDirtyRectangleRendering;return!e||this.context.renderingContext.renderReasons.has(_a.CAMERA_CHANGED)},t.prototype.render=function(r,e){var n=this;this.stats.total=0,this.stats.rendered=0,this.zIndexCounter=0;var i=this.context.renderingContext;if(this.globalRuntime.sceneGraphService.syncHierarchy(i.root),this.globalRuntime.sceneGraphService.triggerPendingEvents(),i.renderReasons.size&&this.inited){i.dirtyRectangleRenderingDisabled=this.disableDirtyRectangleRendering();var a=i.renderReasons.size===1&&i.renderReasons.has(_a.CAMERA_CHANGED),o=!r.disableRenderHooks||!(r.disableRenderHooks&&a);o&&this.renderDisplayObject(i.root,r,i),this.hooks.beginFrame.call(),o&&i.renderListCurrentFrame.forEach(function(s){n.hooks.beforeRender.call(s),n.hooks.render.call(s),n.hooks.afterRender.call(s)}),this.hooks.endFrame.call(),i.renderListCurrentFrame=[],i.renderReasons.clear(),e()}},t.prototype.renderDisplayObject=function(r,e,n){var i=this,a=e.renderer.getConfig(),o=a.enableDirtyCheck,s=a.enableCulling;this.globalRuntime.enableCSSParsing&&this.globalRuntime.styleValueRegistry.recalc(r);var l=r.renderable,u=o?l.dirty||n.dirtyRectangleRenderingDisabled?r:null:r;if(u){var h=s?this.hooks.cull.call(u,this.context.camera):u;h&&(this.stats.rendered++,n.renderListCurrentFrame.push(h))}r.renderable.dirty=!1,r.sortable.renderOrder=this.zIndexCounter++,this.stats.total++;var v=r.sortable;v.dirty&&(this.sort(r,v),v.dirty=!1,v.dirtyChildren=[],v.dirtyReason=void 0),(v.sorted||r.childNodes).forEach(function(p){i.renderDisplayObject(p,e,n)})},t.prototype.sort=function(r,e){e.sorted&&e.dirtyReason!==ts.Z_INDEX_CHANGED?e.dirtyChildren.forEach(function(n){var i=r.childNodes.indexOf(n);if(i===-1){var a=e.sorted.indexOf(n);a>=0&&e.sorted.splice(a,1)}else if(e.sorted.length===0)e.sorted.push(n);else{var o=AM(e.sorted,n);e.sorted.splice(o,0,n)}}):e.sorted=r.childNodes.slice().sort(Zy)},t.prototype.destroy=function(){this.inited=!1,this.hooks.destroy.call(),this.globalRuntime.sceneGraphService.clearPendingEvents()},t.prototype.dirtify=function(){this.context.renderingContext.renderReasons.add(_a.DISPLAY_OBJECT_CHANGED)},t}(),hO=/\[\s*(.*)=(.*)\s*\]/,dO=function(){function t(){}return t.prototype.selectOne=function(r,e){var n=this;if(r.startsWith("."))return e.find(function(s){return((s==null?void 0:s.classList)||[]).indexOf(n.getIdOrClassname(r))>-1});if(r.startsWith("#"))return e.find(function(s){return s.id===n.getIdOrClassname(r)});if(r.startsWith("[")){var i=this.getAttribute(r),a=i.name,o=i.value;return a?e.find(function(s){return e!==s&&(a==="name"?s.name===o:n.attributeToString(s,a)===o)}):null}else return e.find(function(s){return e!==s&&s.nodeName===r})},t.prototype.selectAll=function(r,e){var n=this;if(r.startsWith("."))return e.findAll(function(s){return e!==s&&((s==null?void 0:s.classList)||[]).indexOf(n.getIdOrClassname(r))>-1});if(r.startsWith("#"))return e.findAll(function(s){return e!==s&&s.id===n.getIdOrClassname(r)});if(r.startsWith("[")){var i=this.getAttribute(r),a=i.name,o=i.value;return a?e.findAll(function(s){return e!==s&&(a==="name"?s.name===o:n.attributeToString(s,a)===o)}):[]}else return e.findAll(function(s){return e!==s&&s.nodeName===r})},t.prototype.is=function(r,e){if(r.startsWith("."))return e.className===this.getIdOrClassname(r);if(r.startsWith("#"))return e.id===this.getIdOrClassname(r);if(r.startsWith("[")){var n=this.getAttribute(r),i=n.name,a=n.value;return i==="name"?e.name===a:this.attributeToString(e,i)===a}else return e.nodeName===r},t.prototype.getIdOrClassname=function(r){return r.substring(1)},t.prototype.getAttribute=function(r){var e=r.match(hO),n="",i="";return e&&e.length>2&&(n=e[1].replace(/"/g,""),i=e[2].replace(/"/g,"")),{name:n,value:i}},t.prototype.attributeToString=function(r,e){if(!r.getAttribute)return"";var n=r.getAttribute(e);return We(n)?"":n.toString?n.toString():""},t}(),io=function(t){Me(r,t);function r(e,n,i,a,o,s,l,u){var h=t.call(this,null)||this;return h.relatedNode=n,h.prevValue=i,h.newValue=a,h.attrName=o,h.attrChange=s,h.prevParsedValue=l,h.newParsedValue=u,h.type=e,h}return r.ADDITION=2,r.MODIFICATION=1,r.REMOVAL=3,r}(Bc),ht;(function(t){t.REPARENT="reparent",t.DESTROY="destroy",t.ATTR_MODIFIED="DOMAttrModified",t.INSERTED="DOMNodeInserted",t.REMOVED="removed",t.MOUNTED="DOMNodeInsertedIntoDocument",t.UNMOUNTED="DOMNodeRemovedFromDocument",t.BOUNDS_CHANGED="bounds-changed",t.CULLED="culled"})(ht||(ht={}));function fm(t){var r=t.renderable;r&&(r.renderBoundsDirty=!0,r.boundsDirty=!0)}var vO=new io(ht.REPARENT,null,"","","",0,"",""),pO=function(){function t(r){var e=this;this.runtime=r,this.pendingEvents=[],this.boundsChangedEvent=new Sr(ht.BOUNDS_CHANGED),this.rotate=function(){var n=rr();return function(i,a,o,s){o===void 0&&(o=0),s===void 0&&(s=0),typeof a=="number"&&(a=_t(a,o,s));var l=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)e.rotateLocal(i,a);else{var u=rr();vu(u,a[0],a[1],a[2]);var h=e.getRotation(i),v=e.getRotation(i.parentNode);pu(n,v),sh(n,n),Ta(u,n,u),Ta(l.localRotation,u,h),Ju(l.localRotation,l.localRotation),e.dirtifyLocal(i,l)}}}(),this.rotateLocal=function(){var n=rr();return function(i,a,o,s){o===void 0&&(o=0),s===void 0&&(s=0),typeof a=="number"&&(a=_t(a,o,s));var l=i.transformable;vu(n,a[0],a[1],a[2]),Rg(l.localRotation,l.localRotation,n),e.dirtifyLocal(i,l)}}(),this.setEulerAngles=function(){var n=rr();return function(i,a,o,s){o===void 0&&(o=0),s===void 0&&(s=0),typeof a=="number"&&(a=_t(a,o,s));var l=i.transformable;if(i.parentNode===null||!i.parentNode.transformable)e.setLocalEulerAngles(i,a);else{vu(l.localRotation,a[0],a[1],a[2]);var u=e.getRotation(i.parentNode);pu(n,sh(rr(),u)),Rg(l.localRotation,l.localRotation,n),e.dirtifyLocal(i,l)}}}(),this.translateLocal=function(){return function(n,i,a,o){a===void 0&&(a=0),o===void 0&&(o=0),typeof i=="number"&&(i=_t(i,a,o));var s=n.transformable;Us(i,at())||(B_(i,i,s.localRotation),Xo(s.localPosition,s.localPosition,i),e.dirtifyLocal(n,s))}}(),this.setPosition=function(){var n=Ot(),i=at();return function(a,o){var s=a.transformable;if(i[0]=o[0],i[1]=o[1],i[2]=o[2]||0,!Us(e.getPosition(a),i)){if(cn(s.position,i),a.parentNode===null||!a.parentNode.transformable)cn(s.localPosition,i);else{var l=a.parentNode.transformable;to(n,l.worldTransform),Ti(n,n),Gn(s.localPosition,i,n)}e.dirtifyLocal(a,s)}}}(),this.setLocalPosition=function(){var n=at();return function(i,a){var o=i.transformable;n[0]=a[0],n[1]=a[1],n[2]=a[2]||0,!Us(o.localPosition,n)&&(cn(o.localPosition,n),e.dirtifyLocal(i,o))}}(),this.translate=function(){var n=at(),i=at(),a=at();return function(o,s,l,u){l===void 0&&(l=0),u===void 0&&(u=0),typeof s=="number"&&(s=Jn(i,s,l,u)),!Us(s,n)&&(Xo(a,e.getPosition(o),s),e.setPosition(o,a))}}(),this.setRotation=function(){var n=rr();return function(i,a,o,s,l){var u=i.transformable;if(typeof a=="number"&&(a=lh(a,o,s,l)),i.parentNode===null||!i.parentNode.transformable)e.setLocalRotation(i,a);else{var h=e.getRotation(i.parentNode);pu(n,h),sh(n,n),Ta(u.localRotation,n,a),Ju(u.localRotation,u.localRotation),e.dirtifyLocal(i,u)}}},this.displayObjectDependencyMap=new WeakMap,this.calcLocalTransform=function(){var n=Ot(),i=at(),a=lh(0,0,0,1);return function(o){var s=o.localSkew[0]!==0||o.localSkew[1]!==0;if(s){if(il(o.localTransform,o.localRotation,o.localPosition,_t(1,1,1),o.origin),o.localSkew[0]!==0||o.localSkew[1]!==0){var l=Ol(n);l[4]=Math.tan(o.localSkew[0]),l[1]=Math.tan(o.localSkew[1]),Gr(o.localTransform,o.localTransform,l)}var u=il(n,a,i,o.localScale,o.origin);Gr(o.localTransform,o.localTransform,u)}else il(o.localTransform,o.localRotation,o.localPosition,o.localScale,o.origin)}}()}return t.prototype.matches=function(r,e){return this.runtime.sceneGraphSelector.is(r,e)},t.prototype.querySelector=function(r,e){return this.runtime.sceneGraphSelector.selectOne(r,e)},t.prototype.querySelectorAll=function(r,e){return this.runtime.sceneGraphSelector.selectAll(r,e)},t.prototype.attach=function(r,e,n){var i,a,o=!1;r.parentNode&&(o=r.parentNode!==e,this.detach(r)),r.parentNode=e,We(n)?r.parentNode.childNodes.push(r):r.parentNode.childNodes.splice(n,0,r);var s=e.sortable;(!((i=s==null?void 0:s.sorted)===null||i===void 0)&&i.length||!((a=r.style)===null||a===void 0)&&a.zIndex)&&(s.dirtyChildren.indexOf(r)===-1&&s.dirtyChildren.push(r),s.dirty=!0,s.dirtyReason=ts.ADDED);var l=r.transformable;l&&this.dirtifyWorld(r,l),l.frozen&&this.unfreezeParentToRoot(r),o&&r.dispatchEvent(vO)},t.prototype.detach=function(r){var e,n;if(r.parentNode){var i=r.transformable,a=r.parentNode.sortable;(!((e=a==null?void 0:a.sorted)===null||e===void 0)&&e.length||!((n=r.style)===null||n===void 0)&&n.zIndex)&&(a.dirtyChildren.indexOf(r)===-1&&a.dirtyChildren.push(r),a.dirty=!0,a.dirtyReason=ts.REMOVED);var o=r.parentNode.childNodes.indexOf(r);o>-1&&r.parentNode.childNodes.splice(o,1),i&&this.dirtifyWorld(r,i),r.parentNode=null}},t.prototype.getOrigin=function(r){return r.transformable.origin},t.prototype.setOrigin=function(r,e,n,i){n===void 0&&(n=0),i===void 0&&(i=0),typeof e=="number"&&(e=[e,n,i]);var a=r.transformable;if(!(e[0]===a.origin[0]&&e[1]===a.origin[1]&&e[2]===a.origin[2])){var o=a.origin;o[0]=e[0],o[1]=e[1],o[2]=e[2]||0,this.dirtifyLocal(r,a)}},t.prototype.setLocalEulerAngles=function(r,e,n,i){n===void 0&&(n=0),i===void 0&&(i=0),typeof e=="number"&&(e=_t(e,n,i));var a=r.transformable;vu(a.localRotation,e[0],e[1],e[2]),this.dirtifyLocal(r,a)},t.prototype.scaleLocal=function(r,e){var n=r.transformable;I_(n.localScale,n.localScale,_t(e[0],e[1],e[2]||1)),this.dirtifyLocal(r,n)},t.prototype.setLocalScale=function(r,e){var n=r.transformable,i=_t(e[0],e[1],e[2]||n.localScale[2]);Us(i,n.localScale)||(cn(n.localScale,i),this.dirtifyLocal(r,n))},t.prototype.setLocalRotation=function(r,e,n,i,a){typeof e=="number"&&(e=lh(e,n,i,a));var o=r.transformable;pu(o.localRotation,e),this.dirtifyLocal(r,o)},t.prototype.setLocalSkew=function(r,e,n){typeof e=="number"&&(e=U_(e,n));var i=r.transformable;V_(i.localSkew,e),this.dirtifyLocal(r,i)},t.prototype.dirtifyLocal=function(r,e){e.localDirtyFlag||(e.localDirtyFlag=!0,e.dirtyFlag||this.dirtifyWorld(r,e))},t.prototype.dirtifyWorld=function(r,e){e.dirtyFlag||this.unfreezeParentToRoot(r),this.dirtifyWorldInternal(r,e),this.dirtifyToRoot(r,!0)},t.prototype.triggerPendingEvents=function(){var r=this,e=new Set,n=function(i,a){i.isConnected&&!e.has(i.entity)&&(r.boundsChangedEvent.detail=a,r.boundsChangedEvent.target=i,i.isMutationObserved?i.dispatchEvent(r.boundsChangedEvent):i.ownerDocument.defaultView.dispatchEvent(r.boundsChangedEvent,!0),e.add(i.entity))};this.pendingEvents.forEach(function(i){var a=te(i,2),o=a[0],s=a[1];s.affectChildren?o.forEach(function(l){n(l,s)}):n(o,s)}),this.clearPendingEvents(),e.clear()},t.prototype.clearPendingEvents=function(){this.pendingEvents=[]},t.prototype.dirtifyToRoot=function(r,e){e===void 0&&(e=!1);var n=r;for(n.renderable&&(n.renderable.dirty=!0);n;)fm(n),n=n.parentNode;e&&r.forEach(function(i){fm(i)}),this.informDependentDisplayObjects(r),this.pendingEvents.push([r,{affectChildren:e}])},t.prototype.updateDisplayObjectDependency=function(r,e,n,i){if(e&&e!==n){var a=this.displayObjectDependencyMap.get(e);if(a&&a[r]){var o=a[r].indexOf(i);a[r].splice(o,1)}}if(n){var s=this.displayObjectDependencyMap.get(n);s||(this.displayObjectDependencyMap.set(n,{}),s=this.displayObjectDependencyMap.get(n)),s[r]||(s[r]=[]),s[r].push(i)}},t.prototype.informDependentDisplayObjects=function(r){var e=this,n=this.displayObjectDependencyMap.get(r);n&&Object.keys(n).forEach(function(i){n[i].forEach(function(a){e.dirtifyToRoot(a,!0),a.dispatchEvent(new io(ht.ATTR_MODIFIED,a,e,e,i,io.MODIFICATION,e,e)),a.isCustomElement&&a.isConnected&&a.attributeChangedCallback&&a.attributeChangedCallback(i,e,e)})})},t.prototype.getPosition=function(r){var e=r.transformable;return Zu(e.position,this.getWorldTransform(r,e))},t.prototype.getRotation=function(r){var e=r.transformable;return ju(e.rotation,this.getWorldTransform(r,e))},t.prototype.getScale=function(r){var e=r.transformable;return Qo(e.scaling,this.getWorldTransform(r,e))},t.prototype.getWorldTransform=function(r,e){return e===void 0&&(e=r.transformable),!e.localDirtyFlag&&!e.dirtyFlag||(r.parentNode&&r.parentNode.transformable&&this.getWorldTransform(r.parentNode),this.sync(r,e)),e.worldTransform},t.prototype.getLocalPosition=function(r){return r.transformable.localPosition},t.prototype.getLocalRotation=function(r){return r.transformable.localRotation},t.prototype.getLocalScale=function(r){return r.transformable.localScale},t.prototype.getLocalSkew=function(r){return r.transformable.localSkew},t.prototype.getLocalTransform=function(r){var e=r.transformable;return e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.localTransform},t.prototype.setLocalTransform=function(r,e){var n=Zu(at(),e),i=ju(rr(),e),a=Qo(at(),e);this.setLocalScale(r,a),this.setLocalPosition(r,n),this.setLocalRotation(r,i)},t.prototype.resetLocalTransform=function(r){this.setLocalScale(r,[1,1,1]),this.setLocalPosition(r,[0,0,0]),this.setLocalEulerAngles(r,[0,0,0]),this.setLocalSkew(r,[0,0])},t.prototype.getTransformedGeometryBounds=function(r,e,n){e===void 0&&(e=!1);var i=this.getGeometryBounds(r,e);if(ur.isEmpty(i))return null;var a=n||new ur;return a.setFromTransformedAABB(i,this.getWorldTransform(r)),a},t.prototype.getGeometryBounds=function(r,e){e===void 0&&(e=!1);var n=r.geometry,i=e?n.renderBounds:n.contentBounds||null;return i||new ur},t.prototype.getBounds=function(r,e){var n=this;e===void 0&&(e=!1);var i=r.renderable;if(!i.boundsDirty&&!e&&i.bounds)return i.bounds;if(!i.renderBoundsDirty&&e&&i.renderBounds)return i.renderBounds;var a=e?i.renderBounds:i.bounds,o=this.getTransformedGeometryBounds(r,e,a),s=r.childNodes;if(s.forEach(function(h){var v=n.getBounds(h,e);v&&(o?o.add(v):(o=a||new ur,o.update(v.center,v.halfExtents)))}),o||(o=new ur),e){var l=jy(r);if(l){var u=l.parsedStyle.clipPath.getBounds(e);o?u&&(o=u.intersection(o)):o.update(u.center,u.halfExtents)}}return e?(i.renderBounds=o,i.renderBoundsDirty=!1):(i.bounds=o,i.boundsDirty=!1),o},t.prototype.getLocalBounds=function(r){if(r.parentNode){var e=Ot();r.parentNode.transformable&&(e=Ti(Ot(),this.getWorldTransform(r.parentNode)));var n=this.getBounds(r);if(!ur.isEmpty(n)){var i=new ur;return i.setFromTransformedAABB(n,e),i}}return this.getBounds(r)},t.prototype.getBoundingClientRect=function(r){var e,n,i,a=this.getGeometryBounds(r);ur.isEmpty(a)||(i=new ur,i.setFromTransformedAABB(a,this.getWorldTransform(r)));var o=(n=(e=r.ownerDocument)===null||e===void 0?void 0:e.defaultView)===null||n===void 0?void 0:n.getContextService().getBoundingClientRect();if(i){var s=te(i.getMin(),2),l=s[0],u=s[1],h=te(i.getMax(),2),v=h[0],p=h[1];return new ro(l+((o==null?void 0:o.left)||0),u+((o==null?void 0:o.top)||0),v-l,p-u)}return new ro((o==null?void 0:o.left)||0,(o==null?void 0:o.top)||0,0,0)},t.prototype.dirtifyWorldInternal=function(r,e){var n=this;if(!e.dirtyFlag){e.dirtyFlag=!0,e.frozen=!1,r.childNodes.forEach(function(a){var o=a.transformable;o.dirtyFlag||n.dirtifyWorldInternal(a,o)});var i=r.renderable;i&&(i.renderBoundsDirty=!0,i.boundsDirty=!0,i.dirty=!0)}},t.prototype.syncHierarchy=function(r){var e=r.transformable;if(!e.frozen){e.frozen=!0,(e.localDirtyFlag||e.dirtyFlag)&&this.sync(r,e);for(var n=r.childNodes,i=0;i<n.length;i++)this.syncHierarchy(n[i])}},t.prototype.sync=function(r,e){if(e.localDirtyFlag&&(this.calcLocalTransform(e),e.localDirtyFlag=!1),e.dirtyFlag){var n=r.parentNode,i=n&&n.transformable;n===null||!i?to(e.worldTransform,e.localTransform):Gr(e.worldTransform,i.worldTransform,e.localTransform),e.dirtyFlag=!1}},t.prototype.unfreezeParentToRoot=function(r){for(var e=r.parentNode;e;){var n=e.transformable;n&&(n.frozen=!1),e=e.parentNode}},t}(),Xa={MetricsString:"|q",BaselineSymbol:"M",BaselineMultiplier:1.4,HeightMultiplier:2,Newlines:[10,13],BreakingSpaces:[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288]},hm=/[a-zA-Z0-9\u00C0-\u00D6\u00D8-\u00f6\u00f8-\u00ff!"#$%&'()*+,-./:;]/,gO=/[!%),.:;?\]}'""]/,mO=/[$('"]/,yO=/[!),.:;?\]}'""]/,CO=/[([{'"]/,wO=/[)\]'"?!:;,.]/,xO=/[(['"...]/,bO=/[!%),.:;?\]}'"]/,SO=/[$([{'"#]/,EO=new RegExp("".concat(gO.source,"|").concat(yO.source,"|").concat(wO.source,"|").concat(bO.source)),TO=new RegExp("".concat(mO.source,"|").concat(CO.source,"|").concat(xO.source,"|").concat(SO.source)),_O=function(){function t(r){var e=this;this.runtime=r,this.fontMetricsCache={},this.shouldBreakByKinsokuShorui=function(n,i){return e.isBreakingSpace(i)?!1:!!(n&&(TO.exec(i)||EO.exec(n)))},this.trimByKinsokuShorui=function(n){var i=pe([],te(n),!1),a=i[i.length-2];if(!a)return n;var o=a[a.length-1];return i[i.length-2]=a.slice(0,-1),i[i.length-1]=o+i[i.length-1],i}}return t.prototype.measureFont=function(r,e){if(this.fontMetricsCache[r])return this.fontMetricsCache[r];var n={ascent:0,descent:0,fontSize:0},i=this.runtime.offscreenCanvasCreator.getOrCreateCanvas(e),a=this.runtime.offscreenCanvasCreator.getOrCreateContext(e,{willReadFrequently:!0});a.font=r;var o=Xa.MetricsString+Xa.BaselineSymbol,s=Math.ceil(a.measureText(o).width),l=Math.ceil(a.measureText(Xa.BaselineSymbol).width),u=Xa.HeightMultiplier*l;l=l*Xa.BaselineMultiplier|0,i.width=s,i.height=u,a.fillStyle="#f00",a.fillRect(0,0,s,u),a.font=r,a.textBaseline="alphabetic",a.fillStyle="#000",a.fillText(o,0,l);var h=a.getImageData(0,0,s||1,u||1).data,v=h.length,p=s*4,m=0,C=0,w=!1;for(m=0;m<l;++m){for(var b=0;b<p;b+=4)if(h[C+b]!==255){w=!0;break}if(!w)C+=p;else break}for(n.ascent=l-m,C=v-p,w=!1,m=u;m>l;--m){for(var b=0;b<p;b+=4)if(h[C+b]!==255){w=!0;break}if(!w)C-=p;else break}return n.descent=m-l,n.fontSize=n.ascent+n.descent,this.fontMetricsCache[r]=n,n},t.prototype.measureText=function(r,e,n){var i=e.fontSize,a=e.wordWrap,o=e.lineHeight,s=e.lineWidth,l=e.textBaseline,u=e.textAlign,h=e.letterSpacing,v=e.textPath;e.textPathSide,e.textPathStartOffset;var p=e.leading,m=p===void 0?0:p,C=ZM(e),w=this.measureFont(C,n);w.fontSize===0&&(w.fontSize=i,w.ascent=i);var b=this.runtime.offscreenCanvasCreator.getOrCreateContext(n);b.font=C,e.isOverflowing=!1;var E=a?this.wordWrap(r,e,n):r,R=E.split(/(?:\r\n|\r|\n)/),M=new Array(R.length),k=0;if(v){v.getTotalLength();for(var L=0;L<R.length;L++)var _=b.measureText(R[L]).width+(R[L].length-1)*h}else{for(var L=0;L<R.length;L++){var I=b.measureText(R[L]).width+(R[L].length-1)*h;M[L]=I,k=Math.max(k,I)}var _=k+s,P=o||w.fontSize+s,U=Math.max(P,w.fontSize+s)+(R.length-1)*(P+m);P+=m;var q=0;return l==="middle"?q=-U/2:l==="bottom"||l==="alphabetic"||l==="ideographic"?q=-U:(l==="top"||l==="hanging")&&(q=0),{font:C,width:_,height:U,lines:R,lineWidths:M,lineHeight:P,maxLineWidth:k,fontProperties:w,lineMetrics:M.map(function(J,re){var ne=0;return u==="center"||u==="middle"?ne-=J/2:(u==="right"||u==="end")&&(ne-=J),new ro(ne-s/2,q+re*P,J+s,P)})}}},t.prototype.setGraphemeOnPath=function(){},t.prototype.wordWrap=function(r,e,n){var i=this,a=e.wordWrapWidth,o=a===void 0?0:a,s=e.letterSpacing,l=e.maxLines,u=l===void 0?1/0:l,h=e.textOverflow,v=this.runtime.offscreenCanvasCreator.getOrCreateContext(n),p=o+s,m="";h==="ellipsis"?m="...":h&&h!=="clip"&&(m=h);for(var C=[],w=0,b=0,E={},R=function(ce){return i.getFromCache(ce,s,E,v)},M=Array.from(m).reduce(function(ce,me){return ce+R(me)},0),k=Array.from(r),L=0;L<k.length;L++){var _=k[L],I=r[L-1],P=r[L+1],U=R(_);if(this.isNewline(_)){if(w++,w>=u){e.isOverflowing=!0;break}b=0,C[w]="";continue}if(b>0&&b+U>p){if(w+1>=u){if(e.isOverflowing=!0,M>0&&M<=p){for(var q=C[w].length,Q=0,J=q,re=0;re<q;re++){var ne=R(C[w][re]);if(Q+ne+M>p){J=re;break}Q+=ne}C[w]=(C[w]||"").slice(0,J)+m}break}if(w++,b=0,C[w]="",this.isBreakingSpace(_))continue;this.canBreakInLastChar(_)||(C=this.trimToBreakable(C),b=this.sumTextWidthByCache(C[w]||"",E)),this.shouldBreakByKinsokuShorui(_,P)&&(C=this.trimByKinsokuShorui(C),b+=R(I||""))}b+=U,C[w]=(C[w]||"")+_}return C.join(`
`)},t.prototype.isBreakingSpace=function(r){return typeof r!="string"?!1:Xa.BreakingSpaces.indexOf(r.charCodeAt(0))>=0},t.prototype.isNewline=function(r){return typeof r!="string"?!1:Xa.Newlines.indexOf(r.charCodeAt(0))>=0},t.prototype.trimToBreakable=function(r){var e=pe([],te(r),!1),n=e[e.length-2],i=this.findBreakableIndex(n);if(i===-1||!n)return e;var a=n.slice(i,i+1),o=this.isBreakingSpace(a),s=i+1,l=i+(o?0:1);return e[e.length-1]+=n.slice(s,n.length),e[e.length-2]=n.slice(0,l),e},t.prototype.canBreakInLastChar=function(r){return!(r&&hm.test(r))},t.prototype.sumTextWidthByCache=function(r,e){return r.split("").reduce(function(n,i){if(!e[i])throw Error("cannot count the word without cache");return n+e[i]},0)},t.prototype.findBreakableIndex=function(r){for(var e=r.length-1;e>=0;e--)if(!hm.test(r[e]))return e;return-1},t.prototype.getFromCache=function(r,e,n,i){var a=n[r];if(typeof a!="number"){var o=r.length*e;a=i.measureText(r).width+o,n[r]=a}return a},t}(),ye={},RO=function(){var t,r=new aO,e=new iO;return t={},t[ge.CIRCLE]=new eO,t[ge.ELLIPSE]=new tO,t[ge.RECT]=r,t[ge.IMAGE]=r,t[ge.GROUP]=r,t[ge.LINE]=new rO,t[ge.TEXT]=new oO(ye),t[ge.POLYLINE]=e,t[ge.POLYGON]=e,t[ge.PATH]=new nO,t[ge.HTML]=null,t[ge.MESH]=null,t}(),LO=function(){var t,r=new vM,e=new cv;return t={},t[Fe.PERCENTAGE]=null,t[Fe.NUMBER]=new wM,t[Fe.ANGLE]=new hM,t[Fe.DEFINED_PATH]=new dM,t[Fe.PAINT]=r,t[Fe.COLOR]=r,t[Fe.FILTER]=new pM,t[Fe.LENGTH]=e,t[Fe.LENGTH_PERCENTAGE]=e,t[Fe.LENGTH_PERCENTAGE_12]=new gM,t[Fe.LENGTH_PERCENTAGE_14]=new mM,t[Fe.COORDINATE]=new yM,t[Fe.OFFSET_DISTANCE]=new xM,t[Fe.OPACITY_VALUE]=new bM,t[Fe.PATH]=new SM,t[Fe.LIST_OF_POINTS]=new EM,t[Fe.SHADOW_BLUR]=new TM,t[Fe.TEXT]=new _M,t[Fe.TEXT_TRANSFORM]=new RM,t[Fe.TRANSFORM]=new jM,t[Fe.TRANSFORM_ORIGIN]=new JM,t[Fe.Z_INDEX]=new QM,t[Fe.MARKER]=new CM,t}(),MO=function(){return typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}};ye.CameraContribution=By;ye.AnimationTimeline=null;ye.EasingFunction=null;ye.offscreenCanvasCreator=new cO;ye.sceneGraphSelector=new dO;ye.sceneGraphService=new pO(ye);ye.textService=new _O(ye);ye.geometryUpdaterFactory=RO;ye.CSSPropertySyntaxFactory=LO;ye.styleValueRegistry=new fM(ye);ye.layoutRegistry=null;ye.globalThis=MO();ye.enableCSSParsing=!0;ye.enableDataset=!1;ye.enableStyleSyntax=!0;ye.enableSizeAttenuation=!1;var OO=0,dm=new io(ht.INSERTED,null,"","","",0,"",""),vm=new io(ht.REMOVED,null,"","","",0,"",""),AO=new Sr(ht.DESTROY),NO=function(t){Me(r,t);function r(){var e=t.apply(this,pe([],te(arguments),!1))||this;return e.entity=OO++,e.renderable={bounds:void 0,boundsDirty:!0,renderBounds:void 0,renderBoundsDirty:!0,dirtyRenderBounds:void 0,dirty:!1},e.cullable={strategy:Qh.Standard,visibilityPlaneMask:-1,visible:!0,enable:!0},e.transformable={dirtyFlag:!1,localDirtyFlag:!1,frozen:!1,localPosition:[0,0,0],localRotation:[0,0,0,1],localScale:[1,1,1],localTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],localSkew:[0,0],position:[0,0,0],rotation:[0,0,0,1],scaling:[1,1,1],worldTransform:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],origin:[0,0,0]},e.sortable={dirty:!1,sorted:void 0,renderOrder:0,dirtyChildren:[],dirtyReason:void 0},e.geometry={contentBounds:void 0,renderBounds:void 0},e.rBushNode={aabb:void 0},e.namespaceURI="g",e.scrollLeft=0,e.scrollTop=0,e.clientTop=0,e.clientLeft=0,e.destroyed=!1,e.style={},e.computedStyle=ye.enableCSSParsing?{anchor:Mt,opacity:Mt,fillOpacity:Mt,strokeOpacity:Mt,fill:Mt,stroke:Mt,transform:Mt,transformOrigin:Mt,visibility:Mt,pointerEvents:Mt,lineWidth:Mt,lineCap:Mt,lineJoin:Mt,increasedLineWidthForHitTesting:Mt,fontSize:Mt,fontFamily:Mt,fontStyle:Mt,fontWeight:Mt,fontVariant:Mt,textAlign:Mt,textBaseline:Mt,textTransform:Mt,zIndex:Mt,filter:Mt,shadowType:Mt}:null,e.parsedStyle={},e.attributes={},e}return Object.defineProperty(r.prototype,"className",{get:function(){return this.getAttribute("class")||""},set:function(e){this.setAttribute("class",e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"classList",{get:function(){return this.className.split(" ").filter(function(e){return e!==""})},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"tagName",{get:function(){return this.nodeName},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"parentElement",{get:function(){return this.parentNode},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"nextSibling",{get:function(){if(this.parentNode){var e=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[e+1]||null}return null},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"previousSibling",{get:function(){if(this.parentNode){var e=this.parentNode.childNodes.indexOf(this);return this.parentNode.childNodes[e-1]||null}return null},enumerable:!1,configurable:!0}),r.prototype.cloneNode=function(e){throw new Error(Tt)},r.prototype.appendChild=function(e,n){var i;if(e.destroyed)throw new Error(cL);return ye.sceneGraphService.attach(e,this,n),!((i=this.ownerDocument)===null||i===void 0)&&i.defaultView&&this.ownerDocument.defaultView.mountChildren(e),dm.relatedNode=this,e.dispatchEvent(dm),e},r.prototype.insertBefore=function(e,n){if(!n)this.appendChild(e);else{e.parentElement&&e.parentElement.removeChild(e);var i=this.childNodes.indexOf(n);i===-1?this.appendChild(e):this.appendChild(e,i)}return e},r.prototype.replaceChild=function(e,n){var i=this.childNodes.indexOf(n);return this.removeChild(n),this.appendChild(e,i),n},r.prototype.removeChild=function(e){var n;return vm.relatedNode=this,e.dispatchEvent(vm),!((n=e.ownerDocument)===null||n===void 0)&&n.defaultView&&e.ownerDocument.defaultView.unmountChildren(e),ye.sceneGraphService.detach(e),e},r.prototype.removeChildren=function(){for(var e=this.childNodes.length-1;e>=0;e--){var n=this.childNodes[e];this.removeChild(n)}},r.prototype.destroyChildren=function(){for(var e=this.childNodes.length-1;e>=0;e--){var n=this.childNodes[e];n.childNodes.length&&n.destroyChildren(),n.destroy()}},r.prototype.matches=function(e){return ye.sceneGraphService.matches(e,this)},r.prototype.getElementById=function(e){return ye.sceneGraphService.querySelector("#".concat(e),this)},r.prototype.getElementsByName=function(e){return ye.sceneGraphService.querySelectorAll('[name="'.concat(e,'"]'),this)},r.prototype.getElementsByClassName=function(e){return ye.sceneGraphService.querySelectorAll(".".concat(e),this)},r.prototype.getElementsByTagName=function(e){return ye.sceneGraphService.querySelectorAll(e,this)},r.prototype.querySelector=function(e){return ye.sceneGraphService.querySelector(e,this)},r.prototype.querySelectorAll=function(e){return ye.sceneGraphService.querySelectorAll(e,this)},r.prototype.closest=function(e){var n=this;do{if(ye.sceneGraphService.matches(e,n))return n;n=n.parentElement}while(n!==null);return null},r.prototype.find=function(e){var n=this,i=null;return this.forEach(function(a){return a!==n&&e(a)?(i=a,!0):!1}),i},r.prototype.findAll=function(e){var n=this,i=[];return this.forEach(function(a){a!==n&&e(a)&&i.push(a)}),i},r.prototype.after=function(){for(var e=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this);n.forEach(function(o,s){var l;return(l=e.parentNode)===null||l===void 0?void 0:l.appendChild(o,a+s+1)})}},r.prototype.before=function(){for(var e,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(this.parentNode){var a=this.parentNode.childNodes.indexOf(this),o=te(n),s=o[0],l=o.slice(1);this.parentNode.appendChild(s,a),(e=s).after.apply(e,pe([],te(l),!1))}},r.prototype.replaceWith=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.after.apply(this,pe([],te(e),!1)),this.remove()},r.prototype.append=function(){for(var e=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];n.forEach(function(a){return e.appendChild(a)})},r.prototype.prepend=function(){for(var e=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];n.forEach(function(a,o){return e.appendChild(a,o)})},r.prototype.replaceChildren=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(;this.childNodes.length&&this.firstChild;)this.removeChild(this.firstChild);this.append.apply(this,pe([],te(e),!1))},r.prototype.remove=function(){return this.parentNode?this.parentNode.removeChild(this):this},r.prototype.destroy=function(){this.dispatchEvent(AO),this.remove(),this.emitter.removeAllListeners(),this.destroyed=!0},r.prototype.getGeometryBounds=function(){return ye.sceneGraphService.getGeometryBounds(this)},r.prototype.getRenderBounds=function(){return ye.sceneGraphService.getBounds(this,!0)},r.prototype.getBounds=function(){return ye.sceneGraphService.getBounds(this)},r.prototype.getLocalBounds=function(){return ye.sceneGraphService.getLocalBounds(this)},r.prototype.getBoundingClientRect=function(){return ye.sceneGraphService.getBoundingClientRect(this)},r.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},r.prototype.computedStyleMap=function(){return new Map(Object.entries(this.computedStyle))},r.prototype.getAttributeNames=function(){return Object.keys(this.attributes)},r.prototype.getAttribute=function(e){if(CL(e))return ye.enableCSSParsing?null:void 0;var n=this.attributes[e];if(n===void 0){var i=Kh(e);return n=this.attributes[i],ye.enableCSSParsing&&We(n)?null:n}else return n},r.prototype.hasAttribute=function(e){return this.getAttributeNames().includes(e)},r.prototype.hasAttributes=function(){return!!this.getAttributeNames().length},r.prototype.removeAttribute=function(e){this.setAttribute(e,null),delete this.attributes[e]},r.prototype.setAttribute=function(e,n,i){this.attributes[e]=n},r.prototype.getAttributeNS=function(e,n){throw new Error(Tt)},r.prototype.getAttributeNode=function(e){throw new Error(Tt)},r.prototype.getAttributeNodeNS=function(e,n){throw new Error(Tt)},r.prototype.hasAttributeNS=function(e,n){throw new Error(Tt)},r.prototype.removeAttributeNS=function(e,n){throw new Error(Tt)},r.prototype.removeAttributeNode=function(e){throw new Error(Tt)},r.prototype.setAttributeNS=function(e,n,i){throw new Error(Tt)},r.prototype.setAttributeNode=function(e){throw new Error(Tt)},r.prototype.setAttributeNodeNS=function(e){throw new Error(Tt)},r.prototype.toggleAttribute=function(e,n){throw new Error(Tt)},r}(wr);function pt(t){return!!(t!=null&&t.nodeName)}var ji=new io(ht.ATTR_MODIFIED,null,null,null,null,io.MODIFICATION,null,null),kO={anchor:"",opacity:"",fillOpacity:"",strokeOpacity:"",fill:"",stroke:"",transform:"",transformOrigin:"",visibility:"",pointerEvents:"",lineWidth:"",lineCap:"",lineJoin:"",increasedLineWidthForHitTesting:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",zIndex:"",filter:"",shadowType:""},aC={anchor:[0,0],fill:Jh,stroke:Jh,transform:[],zIndex:0,filter:[],shadowType:"outer",miterLimit:10},IO=Y(Y({},aC),{opacity:1,fillOpacity:1,strokeOpacity:1,visibility:"visible",pointerEvents:"auto",lineWidth:1,lineCap:"butt",lineJoin:"miter",increasedLineWidthForHitTesting:0,fillRule:"nonzero"}),PO=["opacity","fillOpacity","strokeOpacity","transformOrigin","visibility","pointerEvents","lineWidth","lineCap","lineJoin","increasedLineWidthForHitTesting"],DO=pe(pe([],te(PO),!1),["fontSize","fontFamily","fontStyle","fontWeight","fontVariant","textAlign","textBaseline","textTransform"],!1),pm="data-",mn=function(t){Me(r,t);function r(e){var n,i=t.call(this)||this;i.isCustomElement=!1,i.isMutationObserved=!1,i.activeAnimations=[],i.getClip=function(){return this.style.clipPath||null},i.config=e,i.config.interactive=(n=i.config.capture)!==null&&n!==void 0?n:i.config.interactive,i.id=i.config.id||"",i.name=i.config.name||"",(i.config.className||i.config.class)&&(i.className=i.config.className||i.config.class),i.nodeName=i.config.type||ge.GROUP,i.config.style=i.config.style||i.config.attrs||{},Object.assign(i.config.style,i.config.attrs),i.config.visible!=null&&(i.config.style.visibility=i.config.visible===!1?"hidden":"visible"),i.config.interactive!=null&&(i.config.style.pointerEvents=i.config.interactive===!1?"none":"auto"),Object.assign(i.parsedStyle,ye.enableCSSParsing?aC:IO,i.config.initialParsedStyle),ye.enableCSSParsing&&Object.assign(i.attributes,kO),i.initAttributes(i.config.style);var a=ye.globalThis.Proxy?ye.globalThis.Proxy:function(){};return ye.enableDataset&&(i.dataset=new a({},{get:function(o,s){var l="".concat(pm).concat(Jg(s));return o[l]!==void 0?o[l]:i.getAttribute(l)},set:function(o,s,l){return i.setAttribute("".concat(pm).concat(Jg(s)),l),!0}})),ye.enableStyleSyntax&&(i.style=new a({setProperty:function(o,s){i.setAttribute(o,s)},getPropertyValue:function(o){return i.getAttribute(o)},removeProperty:function(o){i.removeAttribute(o)},item:function(){return""}},{get:function(o,s){return o[s]!==void 0?o[s]:i.getAttribute(s)},set:function(o,s,l){return i.setAttribute(s,l),!0}})),i}return r.prototype.destroy=function(){t.prototype.destroy.call(this),this.getAnimations().forEach(function(e){e.cancel()})},r.prototype.cloneNode=function(e,n){var i=Y({},this.attributes);for(var a in i){var o=i[a];pt(o)&&a!=="clipPath"&&a!=="offsetPath"&&a!=="textPath"&&(i[a]=o.cloneNode(e)),n&&(i[a]=n(a,o))}var s=new this.constructor({id:this.id,name:this.name,className:this.name,interactive:this.interactive,style:i});return s.setLocalTransform(this.getLocalTransform()),e&&this.children.forEach(function(l){if(!l.style.isMarker){var u=l.cloneNode(e);s.appendChild(u)}}),s},r.prototype.initAttributes=function(e){e===void 0&&(e={});var n=this.renderable,i={forceUpdateGeometry:!0};ye.enableCSSParsing&&(i.usedAttributes=DO);var a={};for(var o in e){var s=Kh(o);a[s]=e[o]}ye.styleValueRegistry.processProperties(this,a,i),n.dirty=!0},r.prototype.setAttribute=function(e,n,i,a){i===void 0&&(i=!1),a===void 0&&(a=!0);var o=Kh(e);qt(n)||(i||n!==this.attributes[o])&&(this.internalSetAttribute(o,n,{memoize:a}),t.prototype.setAttribute.call(this,o,n))},r.prototype.internalSetAttribute=function(e,n,i){var a;i===void 0&&(i={});var o=this.renderable,s=this.attributes[e],l=this.parsedStyle[e];ye.styleValueRegistry.processProperties(this,(a={},a[e]=n,a),i),o.dirty=!0;var u=this.parsedStyle[e];this.isConnected&&(ji.relatedNode=this,ji.prevValue=s,ji.newValue=n,ji.attrName=e,ji.prevParsedValue=l,ji.newParsedValue=u,this.isMutationObserved?this.dispatchEvent(ji):(ji.target=this,this.ownerDocument.defaultView.dispatchEvent(ji,!0))),(this.isCustomElement&&this.isConnected||!this.isCustomElement)&&this.attributeChangedCallback&&this.attributeChangedCallback(e,s,n,l,u)},r.prototype.getBBox=function(){var e=this.getBounds(),n=te(e.getMin(),2),i=n[0],a=n[1],o=te(e.getMax(),2),s=o[0],l=o[1];return new ro(i,a,s-i,l-a)},r.prototype.setOrigin=function(e,n,i){return n===void 0&&(n=0),i===void 0&&(i=0),ye.sceneGraphService.setOrigin(this,Jr(e,n,i)),this},r.prototype.getOrigin=function(){return ye.sceneGraphService.getOrigin(this)},r.prototype.setPosition=function(e,n,i){return n===void 0&&(n=0),i===void 0&&(i=0),ye.sceneGraphService.setPosition(this,Jr(e,n,i)),this},r.prototype.setLocalPosition=function(e,n,i){return n===void 0&&(n=0),i===void 0&&(i=0),ye.sceneGraphService.setLocalPosition(this,Jr(e,n,i)),this},r.prototype.translate=function(e,n,i){return n===void 0&&(n=0),i===void 0&&(i=0),ye.sceneGraphService.translate(this,Jr(e,n,i)),this},r.prototype.translateLocal=function(e,n,i){return n===void 0&&(n=0),i===void 0&&(i=0),ye.sceneGraphService.translateLocal(this,Jr(e,n,i)),this},r.prototype.getPosition=function(){return ye.sceneGraphService.getPosition(this)},r.prototype.getLocalPosition=function(){return ye.sceneGraphService.getLocalPosition(this)},r.prototype.scale=function(e,n,i){return this.scaleLocal(e,n,i)},r.prototype.scaleLocal=function(e,n,i){return typeof e=="number"&&(n=n||e,i=i||e,e=Jr(e,n,i)),ye.sceneGraphService.scaleLocal(this,e),this},r.prototype.setLocalScale=function(e,n,i){return typeof e=="number"&&(n=n||e,i=i||e,e=Jr(e,n,i)),ye.sceneGraphService.setLocalScale(this,e),this},r.prototype.getLocalScale=function(){return ye.sceneGraphService.getLocalScale(this)},r.prototype.getScale=function(){return ye.sceneGraphService.getScale(this)},r.prototype.getEulerAngles=function(){var e=te(hh(at(),ye.sceneGraphService.getWorldTransform(this)),3),n=e[2];return zn(n)},r.prototype.getLocalEulerAngles=function(){var e=te(hh(at(),ye.sceneGraphService.getLocalRotation(this)),3),n=e[2];return zn(n)},r.prototype.setEulerAngles=function(e){return ye.sceneGraphService.setEulerAngles(this,0,0,e),this},r.prototype.setLocalEulerAngles=function(e){return ye.sceneGraphService.setLocalEulerAngles(this,0,0,e),this},r.prototype.rotateLocal=function(e,n,i){return We(n)&&We(i)?ye.sceneGraphService.rotateLocal(this,0,0,e):ye.sceneGraphService.rotateLocal(this,e,n,i),this},r.prototype.rotate=function(e,n,i){return We(n)&&We(i)?ye.sceneGraphService.rotate(this,0,0,e):ye.sceneGraphService.rotate(this,e,n,i),this},r.prototype.setRotation=function(e,n,i,a){return ye.sceneGraphService.setRotation(this,e,n,i,a),this},r.prototype.setLocalRotation=function(e,n,i,a){return ye.sceneGraphService.setLocalRotation(this,e,n,i,a),this},r.prototype.setLocalSkew=function(e,n){return ye.sceneGraphService.setLocalSkew(this,e,n),this},r.prototype.getRotation=function(){return ye.sceneGraphService.getRotation(this)},r.prototype.getLocalRotation=function(){return ye.sceneGraphService.getLocalRotation(this)},r.prototype.getLocalSkew=function(){return ye.sceneGraphService.getLocalSkew(this)},r.prototype.getLocalTransform=function(){return ye.sceneGraphService.getLocalTransform(this)},r.prototype.getWorldTransform=function(){return ye.sceneGraphService.getWorldTransform(this)},r.prototype.setLocalTransform=function(e){return ye.sceneGraphService.setLocalTransform(this,e),this},r.prototype.resetLocalTransform=function(){ye.sceneGraphService.resetLocalTransform(this)},r.prototype.getAnimations=function(){return this.activeAnimations},r.prototype.animate=function(e,n){var i,a=(i=this.ownerDocument)===null||i===void 0?void 0:i.timeline;return a?a.play(this,e,n):null},r.prototype.isVisible=function(){var e;return((e=this.parsedStyle)===null||e===void 0?void 0:e.visibility)==="visible"},Object.defineProperty(r.prototype,"interactive",{get:function(){return this.isInteractive()},set:function(e){this.style.pointerEvents=e?"auto":"none"},enumerable:!1,configurable:!0}),r.prototype.isInteractive=function(){var e;return((e=this.parsedStyle)===null||e===void 0?void 0:e.pointerEvents)!=="none"},r.prototype.isCulled=function(){return!!(this.cullable&&this.cullable.enable&&!this.cullable.visible)},r.prototype.toFront=function(){return this.parentNode&&(this.style.zIndex=Math.max.apply(Math,pe([],te(this.parentNode.children.map(function(e){return Number(e.style.zIndex)})),!1))+1),this},r.prototype.toBack=function(){return this.parentNode&&(this.style.zIndex=Math.min.apply(Math,pe([],te(this.parentNode.children.map(function(e){return Number(e.style.zIndex)})),!1))-1),this},r.prototype.getConfig=function(){return this.config},r.prototype.attr=function(){for(var e=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var a=te(n,2),o=a[0],s=a[1];return o?Gu(o)?(Object.keys(o).forEach(function(l){e.setAttribute(l,o[l])}),this):n.length===2?(this.setAttribute(o,s),this):this.attributes[o]:this.attributes},r.prototype.getMatrix=function(e){var n=e||this.getWorldTransform(),i=te(Zu(at(),n),2),a=i[0],o=i[1],s=te(Qo(at(),n),2),l=s[0],u=s[1],h=ju(rr(),n),v=te(hh(at(),h),3),p=v[0],m=v[2];return nL(p||m,a,o,l,u)},r.prototype.getLocalMatrix=function(){return this.getMatrix(this.getLocalTransform())},r.prototype.setMatrix=function(e){var n=te($g(e),5),i=n[0],a=n[1],o=n[2],s=n[3],l=n[4];this.setEulerAngles(l).setPosition(i,a).setLocalScale(o,s)},r.prototype.setLocalMatrix=function(e){var n=te($g(e),5),i=n[0],a=n[1],o=n[2],s=n[3],l=n[4];this.setLocalEulerAngles(l).setLocalPosition(i,a).setLocalScale(o,s)},r.prototype.show=function(){ye.enableCSSParsing?this.style.visibility="visible":this.forEach(function(e){e.style.visibility="visible"})},r.prototype.hide=function(){ye.enableCSSParsing?this.style.visibility="hidden":this.forEach(function(e){e.style.visibility="hidden"})},r.prototype.getCount=function(){return this.childElementCount},r.prototype.getParent=function(){return this.parentElement},r.prototype.getChildren=function(){return this.children},r.prototype.getFirst=function(){return this.firstElementChild},r.prototype.getLast=function(){return this.lastElementChild},r.prototype.getChildByIndex=function(e){return this.children[e]||null},r.prototype.add=function(e,n){return this.appendChild(e,n)},r.prototype.setClip=function(e){this.style.clipPath=e},r.prototype.set=function(e,n){this.config[e]=n},r.prototype.get=function(e){return this.config[e]},r.prototype.moveTo=function(e,n,i){return n===void 0&&(n=0),i===void 0&&(i=0),this.setPosition(e,n,i),this},r.prototype.move=function(e,n,i){return n===void 0&&(n=0),i===void 0&&(i=0),this.setPosition(e,n,i),this},r.prototype.setZIndex=function(e){return this.style.zIndex=e,this},r}(NO),oC=function(t){Me(r,t);function r(e){e===void 0&&(e={});var n=e.style,i=nn(e,["style"]);return t.call(this,Y({type:ge.CIRCLE,style:ye.enableCSSParsing?Y({cx:"",cy:"",r:""},n):Y({},n),initialParsedStyle:{anchor:[.5,.5],transformOrigin:ye.enableCSSParsing?null:[tc,tc]}},i))||this}return r}(mn);(function(t){Me(r,t);function r(e){e===void 0&&(e={});var n=this,i=e.style,a=nn(e,["style"]);return n=t.call(this,Y({style:ye.enableCSSParsing?Y({x:"",y:""},i):Y({},i)},a))||this,n.isCustomElement=!0,n}return r})(mn);var BO=function(t){Me(r,t);function r(e){e===void 0&&(e={});var n=e.style,i=nn(e,["style"]);return t.call(this,Y({type:ge.ELLIPSE,style:ye.enableCSSParsing?Y({cx:"",cy:"",rx:"",ry:""},n):Y({},n),initialParsedStyle:{anchor:[.5,.5],transformOrigin:ye.enableCSSParsing?null:[tc,tc]}},i))||this}return r}(mn),Ft=function(t){Me(r,t);function r(e){e===void 0&&(e={});var n=e.style,i=nn(e,["style"]);return t.call(this,Y({type:ge.GROUP,style:ye.enableCSSParsing?Y({x:"",y:"",width:"",height:""},n):Y({},n)},i))||this}return r}(mn),FO=function(t){Me(r,t);function r(e){e===void 0&&(e={});var n=this,i=e.style,a=nn(e,["style"]);return n=t.call(this,Y({type:ge.HTML,style:ye.enableCSSParsing?Y({x:"",y:"",width:"auto",height:"auto",innerHTML:""},i):Y({},i)},a))||this,n.cullable.enable=!1,n}return r.prototype.getDomElement=function(){return this.parsedStyle.$el},r.prototype.getBoundingClientRect=function(){if(this.parsedStyle.$el)return this.parsedStyle.$el.getBoundingClientRect();var e=this.parsedStyle,n=e.x,i=e.y,a=e.width,o=e.height;return new ro(n,i,a,o)},r.prototype.getClientRects=function(){return[this.getBoundingClientRect()]},r.prototype.getBounds=function(){var e,n,i=this.getBoundingClientRect(),a=(n=(e=this.ownerDocument)===null||e===void 0?void 0:e.defaultView)===null||n===void 0?void 0:n.getContextService().getBoundingClientRect(),o=new ur,s=i.left-((a==null?void 0:a.left)||0),l=i.top-((a==null?void 0:a.top)||0);return o.setMinMax([s,l,0],[s+i.width,l+i.height,0]),o},r.prototype.getLocalBounds=function(){if(this.parentNode){var e=Ti(Ot(),this.parentNode.getWorldTransform()),n=this.getBounds();if(!ur.isEmpty(n)){var i=new ur;return i.setFromTransformedAABB(n,e),i}}return this.getBounds()},r}(mn),sC=function(t){Me(r,t);function r(e){e===void 0&&(e={});var n=e.style,i=nn(e,["style"]);return t.call(this,Y({type:ge.IMAGE,style:ye.enableCSSParsing?Y({x:"",y:"",img:"",width:"",height:""},n):Y({},n)},i))||this}return r}(mn),zo=function(t){Me(r,t);function r(e){e===void 0&&(e={});var n=this,i=e.style,a=nn(e,["style"]);n=t.call(this,Y({type:ge.LINE,style:Y({x1:0,y1:0,x2:0,y2:0,z1:0,z2:0},i)},a))||this,n.markerStartAngle=0,n.markerEndAngle=0;var o=n.parsedStyle,s=o.markerStart,l=o.markerEnd;return s&&pt(s)&&(n.markerStartAngle=s.getLocalEulerAngles(),n.appendChild(s)),l&&pt(l)&&(n.markerEndAngle=l.getLocalEulerAngles(),n.appendChild(l)),n.transformMarker(!0),n.transformMarker(!1),n}return r.prototype.attributeChangedCallback=function(e,n,i,a,o){e==="x1"||e==="y1"||e==="x2"||e==="y2"||e==="markerStartOffset"||e==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):e==="markerStart"?(a&&pt(a)&&(this.markerStartAngle=0,a.remove()),o&&pt(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):e==="markerEnd"&&(a&&pt(a)&&(this.markerEndAngle=0,a.remove()),o&&pt(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1)))},r.prototype.transformMarker=function(e){var n=this.parsedStyle,i=n.markerStart,a=n.markerEnd,o=n.markerStartOffset,s=n.markerEndOffset,l=n.x1,u=n.x2,h=n.y1,v=n.y2,p=n.defX,m=n.defY,C=e?i:a;if(!(!C||!pt(C))){var w=0,b,E,R,M,k,L;e?(R=l-p,M=h-m,b=u-l,E=v-h,k=o||0,L=this.markerStartAngle):(R=u-p,M=v-m,b=l-u,E=h-v,k=s||0,L=this.markerEndAngle),w=Math.atan2(E,b),C.setLocalEulerAngles(w*180/Math.PI+L),C.setLocalPosition(R+Math.cos(w)*k,M+Math.sin(w)*k)}},r.prototype.getPoint=function(e,n){n===void 0&&(n=!1);var i=this.parsedStyle,a=i.x1,o=i.y1,s=i.x2,l=i.y2,u=i.defX,h=i.defY,v=Iy(a,o,s,l,e),p=v.x,m=v.y,C=Gn(at(),_t(p-u,m-h,0),n?this.getWorldTransform():this.getLocalTransform());return new Tr(C[0],C[1])},r.prototype.getPointAtLength=function(e,n){return n===void 0&&(n=!1),this.getPoint(e/this.getTotalLength(),n)},r.prototype.getTotalLength=function(){var e=this.parsedStyle,n=e.x1,i=e.y1,a=e.x2,o=e.y2;return ky(n,i,a,o)},r}(mn),od=function(t){Me(r,t);function r(e){e===void 0&&(e={});var n=this,i=e.style,a=nn(e,["style"]);n=t.call(this,Y({type:ge.PATH,style:ye.enableCSSParsing?Y({path:"",miterLimit:""},i):Y({},i),initialParsedStyle:ye.enableCSSParsing?null:{miterLimit:4,path:Y({},Hy)}},a))||this,n.markerStartAngle=0,n.markerEndAngle=0,n.markerMidList=[];var o=n.parsedStyle,s=o.markerStart,l=o.markerEnd,u=o.markerMid;return s&&pt(s)&&(n.markerStartAngle=s.getLocalEulerAngles(),n.appendChild(s)),u&&pt(u)&&n.placeMarkerMid(u),l&&pt(l)&&(n.markerEndAngle=l.getLocalEulerAngles(),n.appendChild(l)),n.transformMarker(!0),n.transformMarker(!1),n}return r.prototype.attributeChangedCallback=function(e,n,i,a,o){e==="path"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):e==="markerStartOffset"||e==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):e==="markerStart"?(a&&pt(a)&&(this.markerStartAngle=0,a.remove()),o&&pt(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):e==="markerEnd"?(a&&pt(a)&&(this.markerEndAngle=0,a.remove()),o&&pt(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):e==="markerMid"&&this.placeMarkerMid(o)},r.prototype.transformMarker=function(e){var n=this.parsedStyle,i=n.markerStart,a=n.markerEnd,o=n.markerStartOffset,s=n.markerEndOffset,l=n.defX,u=n.defY,h=e?i:a;if(!(!h||!pt(h))){var v=0,p,m,C,w,b,E;if(e){var R=te(this.getStartTangent(),2),M=R[0],k=R[1];C=k[0]-l,w=k[1]-u,p=M[0]-k[0],m=M[1]-k[1],b=o||0,E=this.markerStartAngle}else{var L=te(this.getEndTangent(),2),M=L[0],k=L[1];C=k[0]-l,w=k[1]-u,p=M[0]-k[0],m=M[1]-k[1],b=s||0,E=this.markerEndAngle}v=Math.atan2(m,p),h.setLocalEulerAngles(v*180/Math.PI+E),h.setLocalPosition(C+Math.cos(v)*b,w+Math.sin(v)*b)}},r.prototype.placeMarkerMid=function(e){var n=this.parsedStyle,i=n.path.segments,a=n.defX,o=n.defY;if(this.markerMidList.forEach(function(p){p.remove()}),e&&pt(e))for(var s=1;s<i.length-1;s++){var l=te(i[s].currentPoint,2),u=l[0],h=l[1],v=s===1?e:e.cloneNode(!0);this.markerMidList.push(v),this.appendChild(v),v.setLocalPosition(u-a,h-o)}},r.prototype.getTotalLength=function(){return ed(this)},r.prototype.getPointAtLength=function(e,n){n===void 0&&(n=!1);var i=this.parsedStyle,a=i.defX,o=i.defY,s=i.path.absolutePath,l=SR(s,e),u=l.x,h=l.y,v=Gn(at(),_t(u-a,h-o,0),n?this.getWorldTransform():this.getLocalTransform());return new Tr(v[0],v[1])},r.prototype.getPoint=function(e,n){return n===void 0&&(n=!1),this.getPointAtLength(e*ed(this),n)},r.prototype.getStartTangent=function(){var e=this.parsedStyle.path.segments,n=[];if(e.length>1){var i=e[0].currentPoint,a=e[1].currentPoint,o=e[1].startTangent;n=[],o?(n.push([i[0]-o[0],i[1]-o[1]]),n.push([i[0],i[1]])):(n.push([a[0],a[1]]),n.push([i[0],i[1]]))}return n},r.prototype.getEndTangent=function(){var e=this.parsedStyle.path.segments,n=e.length,i=[];if(n>1){var a=e[n-2].currentPoint,o=e[n-1].currentPoint,s=e[n-1].endTangent;i=[],s?(i.push([o[0]-s[0],o[1]-s[1]]),i.push([o[0],o[1]])):(i.push([a[0],a[1]]),i.push([o[0],o[1]]))}return i},r}(mn),hv=function(t){Me(r,t);function r(e){e===void 0&&(e={});var n=this,i=e.style,a=nn(e,["style"]);n=t.call(this,Y({type:ge.POLYGON,style:ye.enableCSSParsing?Y({points:"",miterLimit:"",isClosed:!0},i):Y({},i),initialParsedStyle:ye.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!0}},a))||this,n.markerStartAngle=0,n.markerEndAngle=0,n.markerMidList=[];var o=n.parsedStyle,s=o.markerStart,l=o.markerEnd,u=o.markerMid;return s&&pt(s)&&(n.markerStartAngle=s.getLocalEulerAngles(),n.appendChild(s)),u&&pt(u)&&n.placeMarkerMid(u),l&&pt(l)&&(n.markerEndAngle=l.getLocalEulerAngles(),n.appendChild(l)),n.transformMarker(!0),n.transformMarker(!1),n}return r.prototype.attributeChangedCallback=function(e,n,i,a,o){e==="points"?(this.transformMarker(!0),this.transformMarker(!1),this.placeMarkerMid(this.parsedStyle.markerMid)):e==="markerStartOffset"||e==="markerEndOffset"?(this.transformMarker(!0),this.transformMarker(!1)):e==="markerStart"?(a&&pt(a)&&(this.markerStartAngle=0,a.remove()),o&&pt(o)&&(this.markerStartAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!0))):e==="markerEnd"?(a&&pt(a)&&(this.markerEndAngle=0,a.remove()),o&&pt(o)&&(this.markerEndAngle=o.getLocalEulerAngles(),this.appendChild(o),this.transformMarker(!1))):e==="markerMid"&&this.placeMarkerMid(o)},r.prototype.transformMarker=function(e){var n=this.parsedStyle,i=n.markerStart,a=n.markerEnd,o=n.markerStartOffset,s=n.markerEndOffset,l=n.points,u=n.defX,h=n.defY,v=(l||{}).points,p=e?i:a;if(!(!p||!pt(p)||!v)){var m=0,C,w,b,E,R,M;if(b=v[0][0]-u,E=v[0][1]-h,e)C=v[1][0]-v[0][0],w=v[1][1]-v[0][1],R=o||0,M=this.markerStartAngle;else{var k=v.length;this.parsedStyle.isClosed?(C=v[k-1][0]-v[0][0],w=v[k-1][1]-v[0][1]):(b=v[k-1][0]-u,E=v[k-1][1]-h,C=v[k-2][0]-v[k-1][0],w=v[k-2][1]-v[k-1][1]),R=s||0,M=this.markerEndAngle}m=Math.atan2(w,C),p.setLocalEulerAngles(m*180/Math.PI+M),p.setLocalPosition(b+Math.cos(m)*R,E+Math.sin(m)*R)}},r.prototype.placeMarkerMid=function(e){var n=this.parsedStyle,i=n.points,a=n.defX,o=n.defY,s=(i||{}).points;if(this.markerMidList.forEach(function(p){p.remove()}),this.markerMidList=[],e&&pt(e)&&s)for(var l=1;l<(this.parsedStyle.isClosed?s.length:s.length-1);l++){var u=s[l][0]-a,h=s[l][1]-o,v=l===1?e:e.cloneNode(!0);this.markerMidList.push(v),this.appendChild(v),v.setLocalPosition(u,h)}},r}(mn),lC=function(t){Me(r,t);function r(e){e===void 0&&(e={});var n=e.style,i=nn(e,["style"]);return t.call(this,Y({type:ge.POLYLINE,style:ye.enableCSSParsing?Y({points:"",miterLimit:"",isClosed:!1},n):Y({},n),initialParsedStyle:ye.enableCSSParsing?null:{points:{points:[],totalLength:0,segments:[]},miterLimit:4,isClosed:!1}},i))||this}return r.prototype.getTotalLength=function(){return this.parsedStyle.points.totalLength},r.prototype.getPointAtLength=function(e,n){return n===void 0&&(n=!1),this.getPoint(e/this.getTotalLength(),n)},r.prototype.getPoint=function(e,n){n===void 0&&(n=!1);var i=this.parsedStyle,a=i.defX,o=i.defY,s=i.points,l=s.points,u=s.segments,h=0,v=0;u.forEach(function(b,E){e>=b[0]&&e<=b[1]&&(h=(e-b[0])/(b[1]-b[0]),v=E)});var p=Iy(l[v][0],l[v][1],l[v+1][0],l[v+1][1],h),m=p.x,C=p.y,w=Gn(at(),_t(m-a,C-o,0),n?this.getWorldTransform():this.getLocalTransform());return new Tr(w[0],w[1])},r.prototype.getStartTangent=function(){var e=this.parsedStyle.points.points,n=[];return n.push([e[1][0],e[1][1]]),n.push([e[0][0],e[0][1]]),n},r.prototype.getEndTangent=function(){var e=this.parsedStyle.points.points,n=e.length-1,i=[];return i.push([e[n-1][0],e[n-1][1]]),i.push([e[n][0],e[n][1]]),i},r}(hv),Zt=function(t){Me(r,t);function r(e){e===void 0&&(e={});var n=e.style,i=nn(e,["style"]);return t.call(this,Y({type:ge.RECT,style:ye.enableCSSParsing?Y({x:"",y:"",width:"",height:"",radius:""},n):Y({},n)},i))||this}return r}(mn),dv=function(t){Me(r,t);function r(e){e===void 0&&(e={});var n=e.style,i=nn(e,["style"]);return t.call(this,Y({type:ge.TEXT,style:ye.enableCSSParsing?Y({x:"",y:"",text:"",fontSize:"",fontFamily:"",fontStyle:"",fontWeight:"",fontVariant:"",textAlign:"",textBaseline:"",textTransform:"",fill:"black",letterSpacing:"",lineHeight:"",miterLimit:"",wordWrap:!1,wordWrapWidth:0,leading:0,dx:"",dy:""},n):Y({fill:"black"},n),initialParsedStyle:ye.enableCSSParsing?{}:{x:0,y:0,fontSize:16,fontFamily:"sans-serif",fontStyle:"normal",fontWeight:"normal",fontVariant:"normal",lineHeight:0,letterSpacing:0,textBaseline:"alphabetic",textAlign:"start",wordWrap:!1,wordWrapWidth:0,leading:0,dx:0,dy:0}},i))||this}return r.prototype.getComputedTextLength=function(){var e;return((e=this.parsedStyle.metrics)===null||e===void 0?void 0:e.maxLineWidth)||0},r.prototype.getLineBoundingRects=function(){var e;return((e=this.parsedStyle.metrics)===null||e===void 0?void 0:e.lineMetrics)||[]},r.prototype.isOverflowing=function(){return!!this.parsedStyle.isOverflowing},r}(mn),HO=function(){function t(){this.registry={},this.define(ge.CIRCLE,oC),this.define(ge.ELLIPSE,BO),this.define(ge.RECT,Zt),this.define(ge.IMAGE,sC),this.define(ge.LINE,zo),this.define(ge.GROUP,Ft),this.define(ge.PATH,od),this.define(ge.POLYGON,hv),this.define(ge.POLYLINE,lC),this.define(ge.TEXT,dv),this.define(ge.HTML,FO)}return t.prototype.define=function(r,e){this.registry[r]=e},t.prototype.get=function(r){return this.registry[r]},t}(),zO=function(t){Me(r,t);function r(){var e=t.call(this)||this;e.defaultView=null,e.ownerDocument=null,e.nodeName="document";try{e.timeline=new ye.AnimationTimeline(e)}catch{}var n={};return uv.forEach(function(i){var a=i.n,o=i.inh,s=i.d;o&&s&&(n[a]=Ho(s)?s(ge.GROUP):s)}),e.documentElement=new Ft({id:"g-root",style:n}),e.documentElement.ownerDocument=e,e.documentElement.parentNode=e,e.childNodes=[e.documentElement],e}return Object.defineProperty(r.prototype,"children",{get:function(){return this.childNodes},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"childElementCount",{get:function(){return this.childNodes.length},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"firstElementChild",{get:function(){return this.firstChild},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lastElementChild",{get:function(){return this.lastChild},enumerable:!1,configurable:!0}),r.prototype.createElement=function(e,n){if(e==="svg")return this.documentElement;var i=this.defaultView.customElements.get(e);i||(console.warn("Unsupported tagName: ",e),i=e==="tspan"?dv:Ft);var a=new i(n);return a.ownerDocument=this,a},r.prototype.createElementNS=function(e,n,i){return this.createElement(n,i)},r.prototype.cloneNode=function(e){throw new Error(Tt)},r.prototype.destroy=function(){try{this.documentElement.destroyChildren(),this.timeline.destroy()}catch{}},r.prototype.elementsFromBBox=function(e,n,i,a){var o=this.defaultView.context.rBushRoot,s=o.search({minX:e,minY:n,maxX:i,maxY:a}),l=[];return s.forEach(function(u){var h=u.displayObject,v=h.parsedStyle.pointerEvents,p=["auto","visiblepainted","visiblefill","visiblestroke","visible"].includes(v);(!p||p&&h.isVisible())&&!h.isCulled()&&h.isInteractive()&&l.push(h)}),l.sort(function(u,h){return h.sortable.renderOrder-u.sortable.renderOrder}),l},r.prototype.elementFromPointSync=function(e,n){var i=this.defaultView.canvas2Viewport({x:e,y:n}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,u=s.height;if(a<0||o<0||a>l||o>u)return null;var h=this.defaultView.viewport2Client({x:a,y:o}),v=h.x,p=h.y,m=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!0,position:{x:e,y:n,viewportX:a,viewportY:o,clientX:v,clientY:p},picked:[]}).picked;return m&&m[0]||this.documentElement},r.prototype.elementFromPoint=function(e,n){return Ar(this,void 0,void 0,function(){var i,a,o,s,l,u,h,v,p,m;return Nr(this,function(C){switch(C.label){case 0:return i=this.defaultView.canvas2Viewport({x:e,y:n}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,u=s.height,a<0||o<0||a>l||o>u?[2,null]:(h=this.defaultView.viewport2Client({x:a,y:o}),v=h.x,p=h.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!0,position:{x:e,y:n,viewportX:a,viewportY:o,clientX:v,clientY:p},picked:[]})]);case 1:return m=C.sent().picked,[2,m&&m[0]||this.documentElement]}})})},r.prototype.elementsFromPointSync=function(e,n){var i=this.defaultView.canvas2Viewport({x:e,y:n}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,u=s.height;if(a<0||o<0||a>l||o>u)return[];var h=this.defaultView.viewport2Client({x:a,y:o}),v=h.x,p=h.y,m=this.defaultView.getRenderingService().hooks.pickSync.call({topmost:!1,position:{x:e,y:n,viewportX:a,viewportY:o,clientX:v,clientY:p},picked:[]}).picked;return m[m.length-1]!==this.documentElement&&m.push(this.documentElement),m},r.prototype.elementsFromPoint=function(e,n){return Ar(this,void 0,void 0,function(){var i,a,o,s,l,u,h,v,p,m;return Nr(this,function(C){switch(C.label){case 0:return i=this.defaultView.canvas2Viewport({x:e,y:n}),a=i.x,o=i.y,s=this.defaultView.getConfig(),l=s.width,u=s.height,a<0||o<0||a>l||o>u?[2,[]]:(h=this.defaultView.viewport2Client({x:a,y:o}),v=h.x,p=h.y,[4,this.defaultView.getRenderingService().hooks.pick.promise({topmost:!1,position:{x:e,y:n,viewportX:a,viewportY:o,clientX:v,clientY:p},picked:[]})]);case 1:return m=C.sent().picked,m[m.length-1]!==this.documentElement&&m.push(this.documentElement),[2,m]}})})},r.prototype.appendChild=function(e,n){throw new Error(Io)},r.prototype.insertBefore=function(e,n){throw new Error(Io)},r.prototype.removeChild=function(e,n){throw new Error(Io)},r.prototype.replaceChild=function(e,n,i){throw new Error(Io)},r.prototype.append=function(){throw new Error(Io)},r.prototype.prepend=function(){throw new Error(Io)},r.prototype.getElementById=function(e){return this.documentElement.getElementById(e)},r.prototype.getElementsByName=function(e){return this.documentElement.getElementsByName(e)},r.prototype.getElementsByTagName=function(e){return this.documentElement.getElementsByTagName(e)},r.prototype.getElementsByClassName=function(e){return this.documentElement.getElementsByClassName(e)},r.prototype.querySelector=function(e){return this.documentElement.querySelector(e)},r.prototype.querySelectorAll=function(e){return this.documentElement.querySelectorAll(e)},r.prototype.find=function(e){return this.documentElement.find(e)},r.prototype.findAll=function(e){return this.documentElement.findAll(e)},r}(wr),WO=function(){function t(r){this.strategies=r}return t.prototype.apply=function(r){var e=r.camera,n=r.renderingService,i=r.renderingContext,a=this.strategies;n.hooks.cull.tap(t.tag,function(o){if(o){var s=o.cullable;return a.length===0?s.visible=i.unculledEntities.indexOf(o.entity)>-1:s.visible=a.every(function(l){return l.isVisible(e,o)}),!o.isCulled()&&o.isVisible()?o:(o.dispatchEvent(new Sr(ht.CULLED)),null)}return o}),n.hooks.afterRender.tap(t.tag,function(o){o.cullable.visibilityPlaneMask=-1})},t.tag="Culling",t}(),GO=function(){function t(){var r=this;this.autoPreventDefault=!1,this.rootPointerEvent=new id(null),this.rootWheelEvent=new ad(null),this.onPointerMove=function(e){var n,i,a,o,s=(o=(a=r.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||o===void 0?void 0:o.defaultView;if(!(s.supportsTouchEvents&&e.pointerType==="touch")){var l=r.normalizeToPointerEvent(e,s);try{for(var u=Wr(l),h=u.next();!h.done;h=u.next()){var v=h.value,p=r.bootstrapEvent(r.rootPointerEvent,v,s,e);r.context.eventService.mapEvent(p)}}catch(m){n={error:m}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}r.setCursor(r.context.eventService.cursor)}},this.onClick=function(e){var n,i,a,o,s=(o=(a=r.context.renderingContext.root)===null||a===void 0?void 0:a.ownerDocument)===null||o===void 0?void 0:o.defaultView,l=r.normalizeToPointerEvent(e,s);try{for(var u=Wr(l),h=u.next();!h.done;h=u.next()){var v=h.value,p=r.bootstrapEvent(r.rootPointerEvent,v,s,e);r.context.eventService.mapEvent(p)}}catch(m){n={error:m}}finally{try{h&&!h.done&&(i=u.return)&&i.call(u)}finally{if(n)throw n.error}}r.setCursor(r.context.eventService.cursor)}}return t.prototype.apply=function(r){var e=this;this.context=r;var n=r.renderingService,i=this.context.renderingContext.root.ownerDocument.defaultView;this.context.eventService.setPickHandler(function(a){var o=e.context.renderingService.hooks.pickSync.call({position:a,picked:[],topmost:!0}).picked;return o[0]||null}),n.hooks.pointerWheel.tap(t.tag,function(a){var o=e.normalizeWheelEvent(a);e.context.eventService.mapEvent(o)}),n.hooks.pointerDown.tap(t.tag,function(a){var o,s;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var l=e.normalizeToPointerEvent(a,i);if(e.autoPreventDefault&&l[0].isNormalized){var u=a.cancelable||!("cancelable"in a);u&&a.preventDefault()}try{for(var h=Wr(l),v=h.next();!v.done;v=h.next()){var p=v.value,m=e.bootstrapEvent(e.rootPointerEvent,p,i,a);e.context.eventService.mapEvent(m)}}catch(C){o={error:C}}finally{try{v&&!v.done&&(s=h.return)&&s.call(h)}finally{if(o)throw o.error}}e.setCursor(e.context.eventService.cursor)}}),n.hooks.pointerUp.tap(t.tag,function(a){var o,s;if(!(i.supportsTouchEvents&&a.pointerType==="touch")){var l=e.context.contextService.getDomElement(),u="outside";try{u=l&&a.target&&a.target!==l&&l.contains&&!l.contains(a.target)?"outside":""}catch{}var h=e.normalizeToPointerEvent(a,i);try{for(var v=Wr(h),p=v.next();!p.done;p=v.next()){var m=p.value,C=e.bootstrapEvent(e.rootPointerEvent,m,i,a);C.type+=u,e.context.eventService.mapEvent(C)}}catch(w){o={error:w}}finally{try{p&&!p.done&&(s=v.return)&&s.call(v)}finally{if(o)throw o.error}}e.setCursor(e.context.eventService.cursor)}}),n.hooks.pointerMove.tap(t.tag,this.onPointerMove),n.hooks.pointerOver.tap(t.tag,this.onPointerMove),n.hooks.pointerOut.tap(t.tag,this.onPointerMove),n.hooks.click.tap(t.tag,this.onClick),n.hooks.pointerCancel.tap(t.tag,function(a){var o,s,l=e.normalizeToPointerEvent(a,i);try{for(var u=Wr(l),h=u.next();!h.done;h=u.next()){var v=h.value,p=e.bootstrapEvent(e.rootPointerEvent,v,i,a);e.context.eventService.mapEvent(p)}}catch(m){o={error:m}}finally{try{h&&!h.done&&(s=u.return)&&s.call(u)}finally{if(o)throw o.error}}e.setCursor(e.context.eventService.cursor)})},t.prototype.getViewportXY=function(r){var e,n,i=r.offsetX,a=r.offsetY,o=r.clientX,s=r.clientY;if(this.context.config.supportsCSSTransform&&!We(i)&&!We(a))e=i,n=a;else{var l=this.context.eventService.client2Viewport(new Tr(o,s));e=l.x,n=l.y}return{x:e,y:n}},t.prototype.bootstrapEvent=function(r,e,n,i){r.view=n,r.originalEvent=null,r.nativeEvent=i,r.pointerId=e.pointerId,r.width=e.width,r.height=e.height,r.isPrimary=e.isPrimary,r.pointerType=e.pointerType,r.pressure=e.pressure,r.tangentialPressure=e.tangentialPressure,r.tiltX=e.tiltX,r.tiltY=e.tiltY,r.twist=e.twist,this.transferMouseData(r,e);var a=this.getViewportXY(e),o=a.x,s=a.y;r.viewport.x=o,r.viewport.y=s;var l=this.context.eventService.viewport2Canvas(r.viewport),u=l.x,h=l.y;return r.canvas.x=u,r.canvas.y=h,r.global.copyFrom(r.canvas),r.offset.copyFrom(r.canvas),r.isTrusted=i.isTrusted,r.type==="pointerleave"&&(r.type="pointerout"),r.type.startsWith("mouse")&&(r.type=r.type.replace("mouse","pointer")),r.type.startsWith("touch")&&(r.type=DM[r.type]||r.type),r},t.prototype.normalizeWheelEvent=function(r){var e=this.rootWheelEvent;this.transferMouseData(e,r),e.deltaMode=r.deltaMode,e.deltaX=r.deltaX,e.deltaY=r.deltaY,e.deltaZ=r.deltaZ;var n=this.getViewportXY(r),i=n.x,a=n.y;e.viewport.x=i,e.viewport.y=a;var o=this.context.eventService.viewport2Canvas(e.viewport),s=o.x,l=o.y;return e.canvas.x=s,e.canvas.y=l,e.global.copyFrom(e.canvas),e.offset.copyFrom(e.canvas),e.nativeEvent=r,e.type=r.type,e},t.prototype.transferMouseData=function(r,e){r.isTrusted=e.isTrusted,r.srcElement=e.srcElement,r.timeStamp=nd.now(),r.type=e.type,r.altKey=e.altKey,r.metaKey=e.metaKey,r.shiftKey=e.shiftKey,r.ctrlKey=e.ctrlKey,r.button=e.button,r.buttons=e.buttons,r.client.x=e.clientX,r.client.y=e.clientY,r.movement.x=e.movementX,r.movement.y=e.movementY,r.page.x=e.pageX,r.page.y=e.pageY,r.screen.x=e.screenX,r.screen.y=e.screenY,r.relatedTarget=null},t.prototype.setCursor=function(r){this.context.contextService.applyCursorStyle(r||this.context.config.cursor||"default")},t.prototype.normalizeToPointerEvent=function(r,e){var n=[];if(e.isTouchEvent(r))for(var i=0;i<r.changedTouches.length;i++){var a=r.changedTouches[i];qt(a.button)&&(a.button=0),qt(a.buttons)&&(a.buttons=1),qt(a.isPrimary)&&(a.isPrimary=r.touches.length===1&&r.type==="touchstart"),qt(a.width)&&(a.width=a.radiusX||1),qt(a.height)&&(a.height=a.radiusY||1),qt(a.tiltX)&&(a.tiltX=0),qt(a.tiltY)&&(a.tiltY=0),qt(a.pointerType)&&(a.pointerType="touch"),qt(a.pointerId)&&(a.pointerId=a.identifier||0),qt(a.pressure)&&(a.pressure=a.force||.5),qt(a.twist)&&(a.twist=0),qt(a.tangentialPressure)&&(a.tangentialPressure=0),a.isNormalized=!0,a.type=r.type,n.push(a)}else if(e.isMouseEvent(r)){var o=r;qt(o.isPrimary)&&(o.isPrimary=!0),qt(o.width)&&(o.width=1),qt(o.height)&&(o.height=1),qt(o.tiltX)&&(o.tiltX=0),qt(o.tiltY)&&(o.tiltY=0),qt(o.pointerType)&&(o.pointerType="mouse"),qt(o.pointerId)&&(o.pointerId=PM),qt(o.pressure)&&(o.pressure=.5),qt(o.twist)&&(o.twist=0),qt(o.tangentialPressure)&&(o.tangentialPressure=0),o.isNormalized=!0,n.push(o)}else n.push(r);return n},t.tag="Event",t}(),UO=[ge.CIRCLE,ge.ELLIPSE,ge.IMAGE,ge.RECT,ge.LINE,ge.POLYLINE,ge.POLYGON,ge.TEXT,ge.PATH,ge.HTML],VO=function(){function t(){}return t.prototype.isVisible=function(r,e){var n,i,a=e.cullable;if(!a.enable)return!0;var o=e.getRenderBounds();if(ur.isEmpty(o))return!1;var s=r.getFrustum(),l=(i=(n=e.parentNode)===null||n===void 0?void 0:n.cullable)===null||i===void 0?void 0:i.visibilityPlaneMask;return a.visibilityPlaneMask=this.computeVisibilityWithPlaneMask(e,o,l||ya.INDETERMINATE,s.planes),a.visible=a.visibilityPlaneMask!==ya.OUTSIDE,a.visible},t.prototype.computeVisibilityWithPlaneMask=function(r,e,n,i){if(n===ya.OUTSIDE||n===ya.INSIDE)return n;for(var a=ya.INSIDE,o=UO.indexOf(r.nodeName)>-1,s=0,l=i.length;s<l;++s){var u=1<<s;if(n&u&&!(o&&(s===4||s===5))){var h=i[s],v=h.normal,p=h.distance;if(_i(v,e.getPositiveFarPoint(i[s]))+p<0)return ya.OUTSIDE;_i(v,e.getNegativeFarPoint(i[s]))+p<0&&(a|=u)}}return a},t}(),XO=function(){function t(){this.toSync=new Set}return t.prototype.apply=function(r){var e=this,n=r.renderingService,i=r.renderingContext,a=r.rBushRoot,o=i.root.ownerDocument.defaultView;this.rBush=a;var s=function(v){var p=v.target;p.renderable.dirty=!0,n.dirtify()},l=function(v){var p=v.detail.affectChildren,m=v.target;p&&m.forEach(function(w){e.toSync.add(w)});for(var C=m;C;)C.renderable&&e.toSync.add(C),C=C.parentElement;n.dirtify()},u=function(v){var p=v.target;ye.enableSizeAttenuation&&ye.styleValueRegistry.updateSizeAttenuation(p,o.getCamera().getZoom()),ye.enableCSSParsing&&ye.styleValueRegistry.recalc(p),ye.sceneGraphService.dirtifyToRoot(p),n.dirtify()},h=function(v){var p=v.target,m=p.rBushNode;m.aabb&&e.rBush.remove(m.aabb),e.toSync.delete(p),ye.sceneGraphService.dirtifyToRoot(p),n.dirtify()};n.hooks.init.tap(t.tag,function(){o.addEventListener(ht.MOUNTED,u),o.addEventListener(ht.UNMOUNTED,h),o.addEventListener(ht.ATTR_MODIFIED,s),o.addEventListener(ht.BOUNDS_CHANGED,l)}),n.hooks.destroy.tap(t.tag,function(){o.removeEventListener(ht.MOUNTED,u),o.removeEventListener(ht.UNMOUNTED,h),o.removeEventListener(ht.ATTR_MODIFIED,s),o.removeEventListener(ht.BOUNDS_CHANGED,l),e.toSync.clear()}),n.hooks.endFrame.tap(t.tag,function(){e.syncRTree()})},t.prototype.syncRTree=function(){var r=this,e=[];Array.from(this.toSync).filter(function(n){return n.isConnected}).forEach(function(n){var i=n.rBushNode;i&&i.aabb&&r.rBush.remove(i.aabb);var a=n.getRenderBounds();if(a){var o=te(a.getMin(),2),s=o[0],l=o[1],u=te(a.getMax(),2),h=u[0],v=u[1];i.aabb||(i.aabb={}),i.aabb.displayObject=n,i.aabb.minX=s,i.aabb.minY=l,i.aabb.maxX=h,i.aabb.maxY=v}i.aabb&&!isNaN(i.aabb.maxX)&&!isNaN(i.aabb.maxX)&&!isNaN(i.aabb.minX)&&!isNaN(i.aabb.minY)&&e.push(i.aabb)}),this.rBush.load(e),e.length=0,this.toSync.clear()},t.tag="Prepare",t}(),fn;(function(t){t.READY="ready",t.BEFORE_RENDER="beforerender",t.RERENDER="rerender",t.AFTER_RENDER="afterrender",t.BEFORE_DESTROY="beforedestroy",t.AFTER_DESTROY="afterdestroy",t.RESIZE="resize",t.DIRTY_RECTANGLE="dirtyrectangle",t.RENDERER_CHANGED="rendererchanged"})(fn||(fn={}));var gm=500,YO=.1,$O=1e3,xh=new Sr(ht.MOUNTED),bh=new Sr(ht.UNMOUNTED),qO=new Sr(fn.BEFORE_RENDER),KO=new Sr(fn.RERENDER),ZO=new Sr(fn.AFTER_RENDER),sd=function(t){Me(r,t);function r(e){var n=t.call(this)||this;n.Element=mn,n.inited=!1,n.context={},n.document=new zO,n.document.defaultView=n,n.customElements=new HO;var i=e.container,a=e.canvas,o=e.offscreenCanvas,s=e.width,l=e.height,u=e.devicePixelRatio,h=e.renderer,v=e.background,p=e.cursor,m=e.document,C=e.requestAnimationFrame,w=e.cancelAnimationFrame,b=e.createImage,E=e.supportsPointerEvents,R=e.supportsTouchEvents,M=e.supportsCSSTransform,k=e.supportsMutipleCanvasesInOneContainer,L=e.useNativeClickEvent,_=e.alwaysTriggerPointerEventOnCanvas,I=e.isTouchEvent,P=e.isMouseEvent;k||MM(i,n);var U=s,q=l,Q=u;return a&&(Q=u||kl&&window.devicePixelRatio||1,Q=Q>=1?Math.ceil(Q):1,U=s||kM(a)||a.width/Q,q=l||IM(a)||a.height/Q),o&&(ye.offscreenCanvas=o),n.devicePixelRatio=Q,n.requestAnimationFrame=C??tC.bind(ye.globalThis),n.cancelAnimationFrame=w??rC.bind(ye.globalThis),n.supportsTouchEvents=R??"ontouchstart"in ye.globalThis,n.supportsPointerEvents=E??!!ye.globalThis.PointerEvent,n.isTouchEvent=I??function(J){return n.supportsTouchEvents&&J instanceof ye.globalThis.TouchEvent},n.isMouseEvent=P??function(J){return!ye.globalThis.MouseEvent||J instanceof ye.globalThis.MouseEvent&&(!n.supportsPointerEvents||!(J instanceof ye.globalThis.PointerEvent))},n.initRenderingContext({container:i,canvas:a,width:U,height:q,renderer:h,offscreenCanvas:o,devicePixelRatio:Q,cursor:p||"default",background:v||"transparent",createImage:b,document:m,supportsCSSTransform:M,useNativeClickEvent:L,alwaysTriggerPointerEventOnCanvas:_}),n.initDefaultCamera(U,q,h.clipSpaceNearZ),n.initRenderer(h,!0),n}return r.prototype.initRenderingContext=function(e){this.context.config=e,this.context.renderingContext={root:this.document.documentElement,renderListCurrentFrame:[],unculledEntities:[],renderReasons:new Set,force:!1,dirty:!1}},r.prototype.initDefaultCamera=function(e,n,i){var a=this,o=new ye.CameraContribution;o.clipSpaceNearZ=i,o.setType(Ct.EXPLORING,dl.DEFAULT).setPosition(e/2,n/2,gm).setFocalPoint(e/2,n/2,0).setOrthographic(e/-2,e/2,n/2,n/-2,YO,$O),o.canvas=this,o.eventEmitter.on(Dy.UPDATED,function(){a.context.renderingContext.renderReasons.add(_a.CAMERA_CHANGED),ye.enableSizeAttenuation&&a.getConfig().renderer.getConfig().enableSizeAttenuation&&a.updateSizeAttenuation()}),this.context.camera=o},r.prototype.updateSizeAttenuation=function(){var e=this.getCamera().getZoom();this.document.documentElement.forEach(function(n){ye.styleValueRegistry.updateSizeAttenuation(n,e)})},r.prototype.getConfig=function(){return this.context.config},r.prototype.getRoot=function(){return this.document.documentElement},r.prototype.getCamera=function(){return this.context.camera},r.prototype.getContextService=function(){return this.context.contextService},r.prototype.getEventService=function(){return this.context.eventService},r.prototype.getRenderingService=function(){return this.context.renderingService},r.prototype.getRenderingContext=function(){return this.context.renderingContext},r.prototype.getStats=function(){return this.getRenderingService().getStats()},Object.defineProperty(r.prototype,"ready",{get:function(){var e=this;return this.readyPromise||(this.readyPromise=new Promise(function(n){e.resolveReadyPromise=function(){n(e)}}),this.inited&&this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),r.prototype.destroy=function(e,n){if(e===void 0&&(e=!0),n===void 0&&(n=!1),n||this.dispatchEvent(new Sr(fn.BEFORE_DESTROY)),this.frameId){var i=this.getConfig().cancelAnimationFrame||cancelAnimationFrame;i(this.frameId)}var a=this.getRoot();this.unmountChildren(a),e&&(this.document.destroy(),this.getEventService().destroy()),this.getRenderingService().destroy(),this.getContextService().destroy(),e&&this.context.rBushRoot&&(this.context.rBushRoot.clear(),this.context.rBushRoot=null,this.context.renderingContext.root=null),n||this.dispatchEvent(new Sr(fn.AFTER_DESTROY))},r.prototype.changeSize=function(e,n){this.resize(e,n)},r.prototype.resize=function(e,n){var i=this.context.config;i.width=e,i.height=n,this.getContextService().resize(e,n);var a=this.context.camera,o=a.getProjectionMode();a.setPosition(e/2,n/2,gm).setFocalPoint(e/2,n/2,0),o===un.ORTHOGRAPHIC?a.setOrthographic(e/-2,e/2,n/2,n/-2,a.getNear(),a.getFar()):a.setAspect(e/n),this.dispatchEvent(new Sr(fn.RESIZE,{width:e,height:n}))},r.prototype.appendChild=function(e,n){return this.document.documentElement.appendChild(e,n)},r.prototype.insertBefore=function(e,n){return this.document.documentElement.insertBefore(e,n)},r.prototype.removeChild=function(e){return this.document.documentElement.removeChild(e)},r.prototype.removeChildren=function(){this.document.documentElement.removeChildren()},r.prototype.destroyChildren=function(){this.document.documentElement.destroyChildren()},r.prototype.render=function(){var e=this;this.dispatchEvent(qO);var n=this.getRenderingService();n.render(this.getConfig(),function(){e.dispatchEvent(KO)}),this.dispatchEvent(ZO)},r.prototype.run=function(){var e=this,n=function(){e.render(),e.frameId=e.requestAnimationFrame(n)};n()},r.prototype.initRenderer=function(e,n){var i=this;if(n===void 0&&(n=!1),!e)throw new Error("Renderer is required.");this.inited=!1,this.readyPromise=void 0,this.context.rBushRoot=new ZR,this.context.renderingPlugins=[],this.context.renderingPlugins.push(new GO,new XO,new WO([new VO])),this.loadRendererContainerModule(e),this.context.contextService=new this.context.ContextService(Y(Y({},ye),this.context)),this.context.renderingService=new fO(ye,this.context),this.context.eventService=new uO(ye,this.context),this.context.eventService.init(),this.context.contextService.init?(this.context.contextService.init(),this.initRenderingService(e,n,!0)):this.context.contextService.initAsync().then(function(){i.initRenderingService(e,n)})},r.prototype.initRenderingService=function(e,n,i){var a=this;n===void 0&&(n=!1),i===void 0&&(i=!1),this.context.renderingService.init(function(){a.inited=!0,n?(i?a.requestAnimationFrame(function(){a.dispatchEvent(new Sr(fn.READY))}):a.dispatchEvent(new Sr(fn.READY)),a.readyPromise&&a.resolveReadyPromise()):a.dispatchEvent(new Sr(fn.RENDERER_CHANGED)),n||a.getRoot().forEach(function(o){var s=o.renderable;s&&(s.renderBoundsDirty=!0,s.boundsDirty=!0,s.dirty=!0)}),a.mountChildren(a.getRoot()),e.getConfig().enableAutoRendering&&a.run()})},r.prototype.loadRendererContainerModule=function(e){var n=this,i=e.getPlugins();i.forEach(function(a){a.context=n.context,a.init(ye)})},r.prototype.setRenderer=function(e){var n=this.getConfig();if(n.renderer!==e){var i=n.renderer;n.renderer=e,this.destroy(!1,!0),pe([],te(i==null?void 0:i.getPlugins()),!1).reverse().forEach(function(a){a.destroy(ye)}),this.initRenderer(e)}},r.prototype.setCursor=function(e){var n=this.getConfig();n.cursor=e,this.getContextService().applyCursorStyle(e)},r.prototype.unmountChildren=function(e){var n=this;e.childNodes.forEach(function(i){n.unmountChildren(i)}),this.inited&&(e.isMutationObserved?e.dispatchEvent(bh):(bh.target=e,this.dispatchEvent(bh,!0)),e!==this.document.documentElement&&(e.ownerDocument=null),e.isConnected=!1),e.isCustomElement&&e.disconnectedCallback&&e.disconnectedCallback()},r.prototype.mountChildren=function(e){var n=this;this.inited?e.isConnected||(e.ownerDocument=this.document,e.isConnected=!0,e.isMutationObserved?e.dispatchEvent(xh):(xh.target=e,this.dispatchEvent(xh,!0))):console.warn("[g]: You are trying to call `canvas.appendChild` before canvas' initialization finished. You can either await `canvas.ready` or listen to `CanvasEvent.READY` manually.","appended child: ",e.nodeName),e.childNodes.forEach(function(i){n.mountChildren(i)}),e.isCustomElement&&e.connectedCallback&&e.connectedCallback()},r.prototype.client2Viewport=function(e){return this.getEventService().client2Viewport(e)},r.prototype.viewport2Client=function(e){return this.getEventService().viewport2Client(e)},r.prototype.viewport2Canvas=function(e){return this.getEventService().viewport2Canvas(e)},r.prototype.canvas2Viewport=function(e){return this.getEventService().canvas2Viewport(e)},r.prototype.getPointByClient=function(e,n){return this.client2Viewport({x:e,y:n})},r.prototype.getClientByPoint=function(e,n){return this.viewport2Client({x:e,y:n})},r}(iC),jO=function(t){Me(r,t);function r(){var e=t.apply(this,pe([],te(arguments),!1))||this;return e.landmarks=[],e}return r.prototype.rotate=function(e,n,i){if(this.relElevation=qo(n),this.relAzimuth=qo(e),this.relRoll=qo(i),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===Ct.EXPLORING){var a=xa(rr(),[1,0,0],Vt((this.rotateWorld?1:-1)*this.relElevation)),o=xa(rr(),[0,1,0],Vt((this.rotateWorld?1:-1)*this.relAzimuth)),s=xa(rr(),[0,0,1],Vt(this.relRoll)),l=Ta(rr(),o,a);l=Ta(rr(),l,s);var u=ev(Ot(),l);Ea(this.matrix,this.matrix,[0,0,-this.distance]),Gr(this.matrix,this.matrix,u),Ea(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===Ct.ORBITING||this.type===Ct.EXPLORING?this._getPosition():this.type===Ct.TRACKING&&this._getFocalPoint(),this._update(),this},r.prototype.pan=function(e,n){var i=Jr(e,n,0),a=ea(this.position);return Xo(a,a,Hh(at(),this.right,i[0])),Xo(a,a,Hh(at(),this.up,i[1])),this._setPosition(a),this.triggerUpdate(),this},r.prototype.dolly=function(e){var n=this.forward,i=ea(this.position),a=e*this.dollyingStep,o=this.distance+e*this.dollyingStep;return a=Math.max(Math.min(o,this.maxDistance),this.minDistance)-this.distance,i[0]+=a*n[0],i[1]+=a*n[1],i[2]+=a*n[2],this._setPosition(i),this.type===Ct.ORBITING||this.type===Ct.EXPLORING?this._getDistance():this.type===Ct.TRACKING&&Xo(this.focalPoint,i,this.distanceVector),this.triggerUpdate(),this},r.prototype.cancelLandmarkAnimation=function(){this.landmarkAnimationID!==void 0&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)},r.prototype.createLandmark=function(e,n){var i,a,o,s;n===void 0&&(n={});var l=n.position,u=l===void 0?this.position:l,h=n.focalPoint,v=h===void 0?this.focalPoint:h,p=n.roll,m=n.zoom,C=new ye.CameraContribution;C.setType(this.type,void 0),C.setPosition(u[0],(i=u[1])!==null&&i!==void 0?i:this.position[1],(a=u[2])!==null&&a!==void 0?a:this.position[2]),C.setFocalPoint(v[0],(o=v[1])!==null&&o!==void 0?o:this.focalPoint[1],(s=v[2])!==null&&s!==void 0?s:this.focalPoint[2]),C.setRoll(p??this.roll),C.setZoom(m??this.zoom);var w={name:e,matrix:oy(C.getWorldTransform()),right:ea(C.right),up:ea(C.up),forward:ea(C.forward),position:ea(C.getPosition()),focalPoint:ea(C.getFocalPoint()),distanceVector:ea(C.getDistanceVector()),distance:C.getDistance(),dollyingStep:C.getDollyingStep(),azimuth:C.getAzimuth(),elevation:C.getElevation(),roll:C.getRoll(),relAzimuth:C.relAzimuth,relElevation:C.relElevation,relRoll:C.relRoll,zoom:C.getZoom()};return this.landmarks.push(w),w},r.prototype.gotoLandmark=function(e,n){var i=this;n===void 0&&(n={});var a=kr(e)?this.landmarks.find(function(q){return q.name===e}):e;if(a){var o=li(n)?{duration:n}:n,s=o.easing,l=s===void 0?"linear":s,u=o.duration,h=u===void 0?100:u,v=o.easingFunction,p=v===void 0?void 0:v,m=o.onfinish,C=m===void 0?void 0:m,w=o.onframe,b=w===void 0?void 0:w,E=.01;if(h===0){this.syncFromLandmark(a),C&&C();return}this.cancelLandmarkAnimation();var R=a.position,M=a.focalPoint,k=a.zoom,L=a.roll,_=p||ye.EasingFunction(l),I,P=function(){i.setFocalPoint(M),i.setPosition(R),i.setRoll(L),i.setZoom(k),i.computeMatrix(),i.triggerUpdate(),C&&C()},U=function(q){I===void 0&&(I=q);var Q=q-I;if(Q>h){P();return}var J=_(Q/h),re=at(),ne=at(),ce=1,me=0;zh(re,i.focalPoint,M,J),zh(ne,i.position,R,J),me=i.roll*(1-J)+L*J,ce=i.zoom*(1-J)+k*J,i.setFocalPoint(re),i.setPosition(ne),i.setRoll(me),i.setZoom(ce);var oe=_g(re,M)+_g(ne,R);if(oe<=E&&k==null&&L==null){P();return}i.computeMatrix(),i.triggerUpdate(),Q<h&&(b&&b(J),i.landmarkAnimationID=i.canvas.requestAnimationFrame(U))};this.canvas.requestAnimationFrame(U)}},r.prototype.syncFromLandmark=function(e){this.matrix=to(this.matrix,e.matrix),this.right=cn(this.right,e.right),this.up=cn(this.up,e.up),this.forward=cn(this.forward,e.forward),this.position=cn(this.position,e.position),this.focalPoint=cn(this.focalPoint,e.focalPoint),this.distanceVector=cn(this.distanceVector,e.distanceVector),this.azimuth=e.azimuth,this.elevation=e.elevation,this.roll=e.roll,this.relAzimuth=e.relAzimuth,this.relElevation=e.relElevation,this.relRoll=e.relRoll,this.dollyingStep=e.dollyingStep,this.distance=e.distance,this.zoom=e.zoom},r}(By);ye.CameraContribution=jO;var Sh=function(t){Me(r,t);function r(e,n,i,a){var o=t.call(this,e)||this;return o.currentTime=i,o.timelineTime=a,o.target=n,o.type="finish",o.bubbles=!1,o.currentTarget=n,o.defaultPrevented=!1,o.eventPhase=o.AT_TARGET,o.timeStamp=Date.now(),o.currentTime=i,o.timelineTime=a,o}return r}(Bc),JO=0,QO=function(){function t(r,e){var n;this.currentTimePending=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._playbackRate=1,this._inTimeline=!0,this.effect=r,r.animation=this,this.timeline=e,this.id="".concat(JO++),this._inEffect=!!this.effect.update(0),this._totalDuration=Number((n=this.effect)===null||n===void 0?void 0:n.getComputedTiming().endTime),this._holdTime=0,this._paused=!1,this.oldPlayState="idle",this.updatePromises()}return Object.defineProperty(t.prototype,"pending",{get:function(){return this._startTime===null&&!this._paused&&this.playbackRate!==0||this.currentTimePending},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playState",{get:function(){return this._idle?"idle":this._isFinished?"finished":this._paused?"paused":"running"},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ready",{get:function(){var r=this;return this.readyPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.readyPromise=new Promise(function(e,n){r.resolveReadyPromise=function(){e(r)},r.rejectReadyPromise=function(){n(new Error)}}),this.pending||this.resolveReadyPromise()),this.readyPromise},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"finished",{get:function(){var r=this;return this.finishedPromise||(this.timeline.animationsWithPromises.indexOf(this)===-1&&this.timeline.animationsWithPromises.push(this),this.finishedPromise=new Promise(function(e,n){r.resolveFinishedPromise=function(){e(r)},r.rejectFinishedPromise=function(){n(new Error)}}),this.playState==="finished"&&this.resolveFinishedPromise()),this.finishedPromise},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentTime",{get:function(){return this.updatePromises(),this._idle||this.currentTimePending?null:this._currentTime},set:function(r){var e;r=Number(r),!isNaN(r)&&(this.timeline.restart(),!this._paused&&this._startTime!==null&&(this._startTime=Number((e=this.timeline)===null||e===void 0?void 0:e.currentTime)-r/this.playbackRate),this.currentTimePending=!1,this._currentTime!==r&&(this._idle&&(this._idle=!1,this._paused=!0),this.tickCurrentTime(r,!0),this.timeline.applyDirtiedAnimation(this)))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"startTime",{get:function(){return this._startTime},set:function(r){if(r!==null){if(this.updatePromises(),r=Number(r),isNaN(r)||this._paused||this._idle)return;this._startTime=r,this.tickCurrentTime((Number(this.timeline.currentTime)-this._startTime)*this.playbackRate),this.timeline.applyDirtiedAnimation(this),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playbackRate",{get:function(){return this._playbackRate},set:function(r){if(r!==this._playbackRate){this.updatePromises();var e=this.currentTime;this._playbackRate=r,this.startTime=null,this.playState!=="paused"&&this.playState!=="idle"&&(this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this)),e!==null&&(this.currentTime=e),this.updatePromises()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_isFinished",{get:function(){return!this._idle&&(this._playbackRate>0&&Number(this._currentTime)>=this._totalDuration||this._playbackRate<0&&Number(this._currentTime)<=0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalDuration",{get:function(){return this._totalDuration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_needsTick",{get:function(){return this.pending||this.playState==="running"||!this._finishedFlag},enumerable:!1,configurable:!0}),t.prototype.updatePromises=function(){var r=this.oldPlayState,e=this.pending?"pending":this.playState;return this.readyPromise&&e!==r&&(e==="idle"?(this.rejectReadyPromise(),this.readyPromise=void 0):r==="pending"?this.resolveReadyPromise():e==="pending"&&(this.readyPromise=void 0)),this.finishedPromise&&e!==r&&(e==="idle"?(this.rejectFinishedPromise(),this.finishedPromise=void 0):e==="finished"?this.resolveFinishedPromise():r==="finished"&&(this.finishedPromise=void 0)),this.oldPlayState=e,this.readyPromise||this.finishedPromise},t.prototype.play=function(){this.updatePromises(),this._paused=!1,(this._isFinished||this._idle)&&(this.rewind(),this._startTime=null),this._finishedFlag=!1,this._idle=!1,this.ensureAlive(),this.timeline.applyDirtiedAnimation(this),this.timeline.animations.indexOf(this)===-1&&this.timeline.animations.push(this),this.updatePromises()},t.prototype.pause=function(){this.updatePromises(),this.currentTime&&(this._holdTime=this.currentTime),!this._isFinished&&!this._paused&&!this._idle?this.currentTimePending=!0:this._idle&&(this.rewind(),this._idle=!1),this._startTime=null,this._paused=!0,this.updatePromises()},t.prototype.finish=function(){this.updatePromises(),!this._idle&&(this.currentTime=this._playbackRate>0?this._totalDuration:0,this._startTime=this._totalDuration-this.currentTime,this.currentTimePending=!1,this.timeline.applyDirtiedAnimation(this),this.updatePromises())},t.prototype.cancel=function(){var r=this;if(this.updatePromises(),!!this._inEffect&&(this._inEffect=!1,this._idle=!0,this._paused=!1,this._finishedFlag=!0,this._currentTime=0,this._startTime=null,this.effect.update(null),this.timeline.applyDirtiedAnimation(this),this.updatePromises(),this.oncancel)){var e=new Sh(null,this,this.currentTime,null);setTimeout(function(){r.oncancel(e)})}},t.prototype.reverse=function(){this.updatePromises();var r=this.currentTime;this.playbackRate*=-1,this.play(),r!==null&&(this.currentTime=r),this.updatePromises()},t.prototype.updatePlaybackRate=function(r){this.playbackRate=r},t.prototype.targetAnimations=function(){var r,e=(r=this.effect)===null||r===void 0?void 0:r.target;return e.getAnimations()},t.prototype.markTarget=function(){var r=this.targetAnimations();r.indexOf(this)===-1&&r.push(this)},t.prototype.unmarkTarget=function(){var r=this.targetAnimations(),e=r.indexOf(this);e!==-1&&r.splice(e,1)},t.prototype.tick=function(r,e){!this._idle&&!this._paused&&(this._startTime===null?e&&(this.startTime=r-this._currentTime/this.playbackRate):this._isFinished||this.tickCurrentTime((r-this._startTime)*this.playbackRate)),e&&(this.currentTimePending=!1,this.fireEvents(r))},t.prototype.rewind=function(){if(this.playbackRate>=0)this.currentTime=0;else if(this._totalDuration<1/0)this.currentTime=this._totalDuration;else throw new Error("Unable to rewind negative playback rate animation with infinite duration")},t.prototype.persist=function(){throw new Error(Tt)},t.prototype.addEventListener=function(r,e,n){throw new Error(Tt)},t.prototype.removeEventListener=function(r,e,n){throw new Error(Tt)},t.prototype.dispatchEvent=function(r){throw new Error(Tt)},t.prototype.commitStyles=function(){throw new Error(Tt)},t.prototype.ensureAlive=function(){var r,e;this.playbackRate<0&&this.currentTime===0?this._inEffect=!!(!((r=this.effect)===null||r===void 0)&&r.update(-1)):this._inEffect=!!(!((e=this.effect)===null||e===void 0)&&e.update(this.currentTime)),!this._inTimeline&&(this._inEffect||!this._finishedFlag)&&(this._inTimeline=!0,this.timeline.animations.push(this))},t.prototype.tickCurrentTime=function(r,e){r!==this._currentTime&&(this._currentTime=r,this._isFinished&&!e&&(this._currentTime=this._playbackRate>0?this._totalDuration:0),this.ensureAlive())},t.prototype.fireEvents=function(r){var e=this;if(this._isFinished){if(!this._finishedFlag){if(this.onfinish){var n=new Sh(null,this,this.currentTime,r);setTimeout(function(){e.onfinish&&e.onfinish(n)})}this._finishedFlag=!0}}else{if(this.onframe&&this.playState==="running"){var i=new Sh(null,this,this.currentTime,r);this.onframe(i)}this._finishedFlag=!1}},t}(),eA=4,tA=.001,rA=1e-7,nA=10,Qs=11,xu=1/(Qs-1),iA=typeof Float32Array=="function",uC=function(t,r){return 1-3*r+3*t},cC=function(t,r){return 3*r-6*t},fC=function(t){return 3*t},oc=function(t,r,e){return((uC(r,e)*t+cC(r,e))*t+fC(r))*t},hC=function(t,r,e){return 3*uC(r,e)*t*t+2*cC(r,e)*t+fC(r)},aA=function(t,r,e,n,i){var a,o,s=0;do o=r+(e-r)/2,a=oc(o,n,i)-t,a>0?e=o:r=o;while(Math.abs(a)>rA&&++s<nA);return o},oA=function(t,r,e,n){for(var i=0;i<eA;++i){var a=hC(r,e,n);if(a===0)return r;var o=oc(r,e,n)-t;r-=o/a}return r},vv=function(t,r,e,n){if(!(0<=t&&t<=1&&0<=e&&e<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===r&&e===n)return function(s){return s};for(var i=iA?new Float32Array(Qs):new Array(Qs),a=0;a<Qs;++a)i[a]=oc(a*xu,t,e);var o=function(s){for(var l=0,u=1,h=Qs-1;u!==h&&i[u]<=s;++u)l+=xu;--u;var v=(s-i[u])/(i[u+1]-i[u]),p=l+v*xu,m=hC(p,t,e);return m>=tA?oA(s,p,t,e):m===0?p:aA(s,l,l+xu,t,e)};return function(s){return s===0||s===1?s:oc(o(s),r,n)}},sA=function(t){return t=t.replace(/([A-Z])/g,function(r){return"-".concat(r.toLowerCase())}),t.charAt(0)==="-"?t.substring(1):t},bu=function(t){return Math.pow(t,2)},Su=function(t){return Math.pow(t,3)},Eu=function(t){return Math.pow(t,4)},Tu=function(t){return Math.pow(t,5)},_u=function(t){return Math.pow(t,6)},Ru=function(t){return 1-Math.cos(t*Math.PI/2)},Lu=function(t){return 1-Math.sqrt(1-t*t)},Mu=function(t){return t*t*(3*t-2)},Ou=function(t){for(var r,e=4;t<((r=Math.pow(2,--e))-1)/11;);return 1/Math.pow(4,3-e)-7.5625*Math.pow((r*3-2)/22-t,2)},Au=function(t,r){r===void 0&&(r=[]);var e=te(r,2),n=e[0],i=n===void 0?1:n,a=e[1],o=a===void 0?.5:a,s=Tn(Number(i),1,10),l=Tn(Number(o),.1,2);return t===0||t===1?t:-s*Math.pow(2,10*(t-1))*Math.sin((t-1-l/(Math.PI*2)*Math.asin(1/s))*(Math.PI*2)/l)},Ys=function(t,r,e){r===void 0&&(r=[]);var n=te(r,4),i=n[0],a=i===void 0?1:i,o=n[1],s=o===void 0?100:o,l=n[2],u=l===void 0?10:l,h=n[3],v=h===void 0?0:h;a=Tn(a,.1,1e3),s=Tn(s,.1,1e3),u=Tn(u,.1,1e3),v=Tn(v,.1,1e3);var p=Math.sqrt(s/a),m=u/(2*Math.sqrt(s*a)),C=m<1?p*Math.sqrt(1-m*m):0,w=1,b=m<1?(m*p+-v)/C:-v+p,E=e?e*t/1e3:t;return m<1?E=Math.exp(-E*m*p)*(w*Math.cos(C*E)+b*Math.sin(C*E)):E=(w+b*E)*Math.exp(-E*p),t===0||t===1?t:1-E},Eh=function(t,r){r===void 0&&(r=[]);var e=te(r,2),n=e[0],i=n===void 0?10:n,a=e[1],o=a=="start"?Math.ceil:Math.floor;return o(Tn(t,0,1)*i)/i},mm=function(t,r){r===void 0&&(r=[]);var e=te(r,4),n=e[0],i=e[1],a=e[2],o=e[3];return vv(n,i,a,o)(t)},Nu=vv(.42,0,1,1),Dn=function(t){return function(r,e,n){return e===void 0&&(e=[]),1-t(1-r,e,n)}},Bn=function(t){return function(r,e,n){return e===void 0&&(e=[]),r<.5?t(r*2,e,n)/2:1-t(r*-2+2,e,n)/2}},Fn=function(t){return function(r,e,n){return e===void 0&&(e=[]),r<.5?(1-t(1-r*2,e,n))/2:(t(r*2-1,e,n)+1)/2}},ym={steps:Eh,"step-start":function(t){return Eh(t,[1,"start"])},"step-end":function(t){return Eh(t,[1,"end"])},linear:function(t){return t},"cubic-bezier":mm,ease:function(t){return mm(t,[.25,.1,.25,1])},in:Nu,out:Dn(Nu),"in-out":Bn(Nu),"out-in":Fn(Nu),"in-quad":bu,"out-quad":Dn(bu),"in-out-quad":Bn(bu),"out-in-quad":Fn(bu),"in-cubic":Su,"out-cubic":Dn(Su),"in-out-cubic":Bn(Su),"out-in-cubic":Fn(Su),"in-quart":Eu,"out-quart":Dn(Eu),"in-out-quart":Bn(Eu),"out-in-quart":Fn(Eu),"in-quint":Tu,"out-quint":Dn(Tu),"in-out-quint":Bn(Tu),"out-in-quint":Fn(Tu),"in-expo":_u,"out-expo":Dn(_u),"in-out-expo":Bn(_u),"out-in-expo":Fn(_u),"in-sine":Ru,"out-sine":Dn(Ru),"in-out-sine":Bn(Ru),"out-in-sine":Fn(Ru),"in-circ":Lu,"out-circ":Dn(Lu),"in-out-circ":Bn(Lu),"out-in-circ":Fn(Lu),"in-back":Mu,"out-back":Dn(Mu),"in-out-back":Bn(Mu),"out-in-back":Fn(Mu),"in-bounce":Ou,"out-bounce":Dn(Ou),"in-out-bounce":Bn(Ou),"out-in-bounce":Fn(Ou),"in-elastic":Au,"out-elastic":Dn(Au),"in-out-elastic":Bn(Au),"out-in-elastic":Fn(Au),spring:Ys,"spring-in":Ys,"spring-out":Dn(Ys),"spring-in-out":Bn(Ys),"spring-out-in":Fn(Ys)},lA=function(t){return sA(t).replace(/^ease-/,"").replace(/(\(|\s).+/,"").toLowerCase().trim()},uA=function(t){return ym[lA(t)]||ym.linear},cA=function(t){return t},fA=1,hA=.5,Cm=0;function wm(t,r){return function(e){if(e>=1)return 1;var n=1/t;return e+=r*n,e-e%n}}var ku="\\s*(-?\\d+\\.?\\d*|-?\\.\\d+)\\s*",dA=new RegExp("cubic-bezier\\("+ku+","+ku+","+ku+","+ku+"\\)"),vA=/steps\(\s*(\d+)\s*\)/,pA=/steps\(\s*(\d+)\s*,\s*(start|middle|end)\s*\)/;function pv(t){var r=dA.exec(t);if(r)return vv.apply(void 0,pe([],te(r.slice(1).map(Number)),!1));var e=vA.exec(t);if(e)return wm(Number(e[1]),Cm);var n=pA.exec(t);return n?wm(Number(n[1]),{start:fA,middle:hA,end:Cm}[n[2]]):uA(t)}function gA(t){return Math.abs(mA(t)/(t.playbackRate||1))}function mA(t){var r;return t.duration===0||t.iterations===0?0:(t.duration==="auto"?0:Number(t.duration))*((r=t.iterations)!==null&&r!==void 0?r:1)}var dC=0,gv=1,Fc=2,vC=3;function yA(t,r,e){if(r===null)return dC;var n=e.endTime;return r<Math.min(e.delay,n)?gv:r>=Math.min(e.delay+t+e.endDelay,n)?Fc:vC}function CA(t,r,e,n,i){switch(n){case gv:return r==="backwards"||r==="both"?0:null;case vC:return e-i;case Fc:return r==="forwards"||r==="both"?t:null;case dC:return null}}function wA(t,r,e,n,i){var a=i;return t===0?r!==gv&&(a+=e):a+=n/t,a}function xA(t,r,e,n,i,a){var o=t===1/0?r%1:t%1;return o===0&&e===Fc&&n!==0&&(i!==0||a===0)&&(o=1),o}function bA(t,r,e,n){return t===Fc&&r===1/0?1/0:e===1?Math.floor(n)-1:Math.floor(n)}function SA(t,r,e){var n=t;if(t!=="normal"&&t!=="reverse"){var i=r;t==="alternate-reverse"&&(i+=1),n="normal",i!==1/0&&i%2!==0&&(n="reverse")}return n==="normal"?e:1-e}function EA(t,r,e){var n=yA(t,r,e),i=CA(t,e.fill,r,n,e.delay);if(i===null)return null;var a=e.duration==="auto"?0:e.duration,o=wA(a,n,e.iterations,i,e.iterationStart),s=xA(o,e.iterationStart,n,e.iterations,i,a),l=bA(n,e.iterations,s,o),u=SA(e.direction,l,s);return e.currentIteration=l,e.progress=u,e.easingFunction(u)}function TA(t,r,e){var n=_A(t,r),i=RA(n,e);return function(a,o){if(o!==null)i.filter(function(l){return o>=l.applyFrom&&o<l.applyTo}).forEach(function(l){var u=o-l.startOffset,h=l.endOffset-l.startOffset,v=h===0?0:l.easingFunction(u/h);a.setAttribute(l.property,l.interpolation(v),!1,!1)});else for(var s in n)pC(s)&&a.setAttribute(s,null)}}function pC(t){return t!=="offset"&&t!=="easing"&&t!=="composite"&&t!=="computedOffset"}function _A(t,r){for(var e={},n=0;n<t.length;n++)for(var i in t[n])if(pC(i)){var a={offset:t[n].offset,computedOffset:t[n].computedOffset,easing:t[n].easing,easingFunction:pv(t[n].easing)||r.easingFunction,value:t[n][i]};e[i]=e[i]||[],e[i].push(a)}return e}function RA(t,r){var e=[];for(var n in t)for(var i=t[n],a=0;a<i.length-1;a++){var o=a,s=a+1,l=i[o].computedOffset,u=i[s].computedOffset,h=l,v=u;a===0&&(h=-1/0,u===0&&(s=o)),a===i.length-2&&(v=1/0,l===1&&(o=s)),e.push({applyFrom:h,applyTo:v,startOffset:i[o].computedOffset,endOffset:i[s].computedOffset,easingFunction:i[o].easingFunction,property:n,interpolation:LA(n,i[o].value,i[s].value,r)})}return e.sort(function(p,m){return p.startOffset-m.startOffset}),e}var xm=function(t,r,e){return function(n){var i=gC(t,r,n);return!ye.enableCSSParsing&&li(i)?i:e(i)}};function LA(t,r,e,n){var i=ga[t];if(i&&i.syntax&&i.int){var a=ye.styleValueRegistry.getPropertySyntax(i.syntax);if(a){var o=void 0,s=void 0;if(ye.enableCSSParsing){var l=ye.styleValueRegistry.parseProperty(t,r,n,!1),u=ye.styleValueRegistry.parseProperty(t,e,n,!1);o=ye.styleValueRegistry.computeProperty(t,l,n,!1),s=ye.styleValueRegistry.computeProperty(t,u,n,!1)}else{var h=a.parserWithCSSDisabled;o=h?h(r,n):r,s=h?h(e,n):e}var v=a.mixer(o,s,n);if(v){var p=xm.apply(void 0,pe([],te(v),!1));return function(m){return m===0?r:m===1?e:p(m)}}}}return xm(!1,!0,function(m){return m?e:r})}function gC(t,r,e){if(typeof t=="number"&&typeof r=="number")return t*(1-e)+r*e;if(typeof t=="boolean"&&typeof r=="boolean"||typeof t=="string"&&typeof r=="string")return e<.5?t:r;if(Array.isArray(t)&&Array.isArray(r)){for(var n=t.length,i=r.length,a=Math.max(n,i),o=[],s=0;s<a;s++)o.push(gC(t[s<n?s:n-1],r[s<i?s:i-1],e));return o}throw new Error("Mismatched interpolation arguments "+t+":"+r)}var MA=function(){function t(){this.delay=0,this.direction="normal",this.duration="auto",this._easing="linear",this.easingFunction=cA,this.endDelay=0,this.fill="auto",this.iterationStart=0,this.iterations=1,this.currentIteration=null,this.progress=null}return Object.defineProperty(t.prototype,"easing",{get:function(){return this._easing},set:function(r){this.easingFunction=pv(r),this._easing=r},enumerable:!1,configurable:!0}),t}();function OA(t){var r=[];for(var e in t)if(!(e in["easing","offset","composite"])){var n=t[e];Array.isArray(n)||(n=[n]);for(var i=n.length,a=0;a<i;a++){if(!r[a]){var o={};"offset"in t&&(o.offset=Number(t.offset)),"easing"in t&&(o.easing=t.easing),"composite"in t&&(o.composite=t.composite),r[a]=o}n[a]!==void 0&&n[a]!==null&&(r[a][e]=n[a])}}return r.sort(function(s,l){return(s.computedOffset||0)-(l.computedOffset||0)}),r}function bm(t,r){if(t===null)return[];Array.isArray(t)||(t=OA(t));for(var e=t.map(function(l){var u={};r!=null&&r.composite&&(u.composite="auto");for(var h in l){var v=l[h];if(h==="offset"){if(v!==null){if(v=Number(v),!isFinite(v))throw new Error("Keyframe offsets must be numbers.");if(v<0||v>1)throw new Error("Keyframe offsets must be between 0 and 1.");u.computedOffset=v}}else if(h==="composite"&&["replace","add","accumulate","auto"].indexOf(v)===-1)throw new Error("".concat(v," compositing is not supported"));u[h]=v}return u.offset===void 0&&(u.offset=null),u.easing===void 0&&(u.easing=(r==null?void 0:r.easing)||"linear"),u.composite===void 0&&(u.composite="auto"),u}),n=!0,i=-1/0,a=0;a<e.length;a++){var o=e[a].offset;if(We(o))n=!1;else{if(o<i)throw new TypeError("Keyframes are not loosely sorted by offset. Sort or specify offsets.");i=o}}e=e.filter(function(l){return Number(l.offset)>=0&&Number(l.offset)<=1});function s(){var l,u,h=e.length;e[h-1].computedOffset=Number((l=e[h-1].offset)!==null&&l!==void 0?l:1),h>1&&(e[0].computedOffset=Number((u=e[0].offset)!==null&&u!==void 0?u:0));for(var v=0,p=Number(e[0].computedOffset),m=1;m<h;m++){var C=e[m].computedOffset;if(!We(C)&&!We(p)){for(var w=1;w<m-v;w++)e[v+w].computedOffset=p+(Number(C)-p)*w/(m-v);v=m,p=Number(C)}}}return n||s(),e}var AA="backwards|forwards|both|none".split("|"),NA="reverse|alternate|alternate-reverse".split("|");function kA(t,r){var e=new MA;return typeof t=="number"&&!isNaN(t)?e.duration=t:t!==void 0&&Object.keys(t).forEach(function(n){if(t[n]!==void 0&&t[n]!==null&&t[n]!=="auto"){if((typeof e[n]=="number"||n==="duration")&&(typeof t[n]!="number"||isNaN(t[n]))||n==="fill"&&AA.indexOf(t[n])===-1||n==="direction"&&NA.indexOf(t[n])===-1)return;e[n]=t[n]}}),e}function IA(t,r){return t=PA(t??{duration:"auto"}),kA(t)}function PA(t){return typeof t=="number"&&(isNaN(t)?t={duration:"auto"}:t={duration:t}),t}var DA=function(){function t(r,e,n){var i=this;this.composite="replace",this.iterationComposite="replace",this.target=r,this.timing=IA(n),this.timing.effect=this,this.timing.activeDuration=gA(this.timing),this.timing.endTime=Math.max(0,this.timing.delay+this.timing.activeDuration+this.timing.endDelay),this.normalizedKeyframes=bm(e,this.timing),this.interpolations=TA(this.normalizedKeyframes,this.timing,this.target);var a=ye.globalThis.Proxy;this.computedTiming=a?new a(this.timing,{get:function(o,s){return s==="duration"?o.duration==="auto"?0:o.duration:s==="fill"?o.fill==="auto"?"none":o.fill:s==="localTime"?i.animation&&i.animation.currentTime||null:s==="currentIteration"?!i.animation||i.animation.playState!=="running"?null:o.currentIteration||0:s==="progress"?!i.animation||i.animation.playState!=="running"?null:o.progress||0:o[s]},set:function(){return!0}}):this.timing}return t.prototype.applyInterpolations=function(){this.interpolations(this.target,Number(this.timeFraction))},t.prototype.update=function(r){return r===null?!1:(this.timeFraction=EA(this.timing.activeDuration,r,this.timing),this.timeFraction!==null)},t.prototype.getKeyframes=function(){return this.normalizedKeyframes},t.prototype.setKeyframes=function(r){this.normalizedKeyframes=bm(r)},t.prototype.getComputedTiming=function(){return this.computedTiming},t.prototype.getTiming=function(){return this.timing},t.prototype.updateTiming=function(r){var e=this;Object.keys(r||{}).forEach(function(n){e.timing[n]=r[n]})},t}();function Sm(t,r){return Number(t.id)-Number(r.id)}var BA=function(){function t(r){var e=this;this.document=r,this.animations=[],this.ticking=!1,this.timelineTicking=!1,this.hasRestartedThisFrame=!1,this.animationsWithPromises=[],this.inTick=!1,this.pendingEffects=[],this.currentTime=null,this.rafId=0,this.rafCallbacks=[],this.webAnimationsNextTick=function(n){e.currentTime=n,e.discardAnimations(),e.animations.length===0?e.timelineTicking=!1:e.requestAnimationFrame(e.webAnimationsNextTick)},this.processRafCallbacks=function(n){var i=e.rafCallbacks;e.rafCallbacks=[],n<Number(e.currentTime)&&(n=Number(e.currentTime)),e.animations.sort(Sm),e.animations=e.tick(n,!0,e.animations)[0],i.forEach(function(a){a[1](n)}),e.applyPendingEffects()}}return t.prototype.getAnimations=function(){return this.discardAnimations(),this.animations.slice()},t.prototype.isTicking=function(){return this.inTick},t.prototype.play=function(r,e,n){var i=new DA(r,e,n),a=new QO(i,this);return this.animations.push(a),this.restartWebAnimationsNextTick(),a.updatePromises(),a.play(),a.updatePromises(),a},t.prototype.applyDirtiedAnimation=function(r){var e=this;if(!this.inTick){r.markTarget();var n=r.targetAnimations();n.sort(Sm);var i=this.tick(Number(this.currentTime),!1,n.slice())[1];i.forEach(function(a){var o=e.animations.indexOf(a);o!==-1&&e.animations.splice(o,1)}),this.applyPendingEffects()}},t.prototype.restart=function(){return this.ticking||(this.ticking=!0,this.requestAnimationFrame(function(){}),this.hasRestartedThisFrame=!0),this.hasRestartedThisFrame},t.prototype.destroy=function(){this.document.defaultView.cancelAnimationFrame(this.frameId)},t.prototype.applyPendingEffects=function(){this.pendingEffects.forEach(function(r){r==null||r.applyInterpolations()}),this.pendingEffects=[]},t.prototype.updateAnimationsPromises=function(){this.animationsWithPromises=this.animationsWithPromises.filter(function(r){return r.updatePromises()})},t.prototype.discardAnimations=function(){this.updateAnimationsPromises(),this.animations=this.animations.filter(function(r){return r.playState!=="finished"&&r.playState!=="idle"})},t.prototype.restartWebAnimationsNextTick=function(){this.timelineTicking||(this.timelineTicking=!0,this.requestAnimationFrame(this.webAnimationsNextTick))},t.prototype.rAF=function(r){var e=this.rafId++;return this.rafCallbacks.length===0&&(this.frameId=this.document.defaultView.requestAnimationFrame(this.processRafCallbacks)),this.rafCallbacks.push([e,r]),e},t.prototype.requestAnimationFrame=function(r){var e=this;return this.rAF(function(n){e.updateAnimationsPromises(),r(n),e.updateAnimationsPromises()})},t.prototype.tick=function(r,e,n){var i,a,o=this;this.inTick=!0,this.hasRestartedThisFrame=!1,this.currentTime=r,this.ticking=!1;var s=[],l=[],u=[],h=[];return n.forEach(function(v){v.tick(r,e),v._inEffect?(l.push(v.effect),v.markTarget()):(s.push(v.effect),v.unmarkTarget()),v._needsTick&&(o.ticking=!0);var p=v._inEffect||v._needsTick;v._inTimeline=p,p?u.push(v):h.push(v)}),(i=this.pendingEffects).push.apply(i,pe([],te(s),!1)),(a=this.pendingEffects).push.apply(a,pe([],te(l),!1)),this.ticking&&this.requestAnimationFrame(function(){}),this.inTick=!1,[u,h]},t}();ye.EasingFunction=pv;ye.AnimationTimeline=BA;var sa="$$value$$",it="$$extra$$",ld="$$origin$$",FA="$$extra_column$$",la="$$total$$",Xu="$$multi$$",Rn="$$series_number$$",Il="$$empty_field_value$$",mv="$$empty_extra_placeholder$$",HA="$$null$$",zA="$$undefined$$",Em;(function(t){t.DATA_CELL_CLICK_EVENT="interaction:data-cell-click",t.MERGED_CELLS_CLICK_EVENT="interaction:merged-cells-click",t.CORNER_TEXT_CLICK_EVENT="interaction:corner-cell-text-click",t.ROW_COLUMN_CLICK_EVENT="interaction:row-column-click",t.ROW_TEXT_CLICK_EVENT="interaction:row-text-click",t.HOVER_EVENT="interaction:hover"})(Em||(Em={}));var wt;(function(t){t.MOUSE_DOWN="mousedown",t.MOUSE_MOVE="mousemove",t.MOUSE_UP="mouseup",t.MOUSE_OUT="mouseout",t.MOUSE_LEAVE="mouseleave",t.TOUCH_START="touchstart",t.KEY_DOWN="keydown",t.KEY_UP="keyup",t.CLICK="click",t.HOVER="hover",t.DOUBLE_CLICK="dblclick",t.CONTEXT_MENU="contextmenu",t.POINTER_DOWN="pointerdown",t.POINTER_MOVE="pointermove",t.POINTER_OUT="pointerout",t.POINTER_LEAVE="pointerleave",t.POINTER_UP="pointerup",t.POINTER_CANCEL="pointercancel",t.POINTER_ENTER="pointerenter",t.POINTER_OVER="pointerover"})(wt||(wt={}));var se;(function(t){t.ROW_CELL_HOVER="row-cell:hover",t.ROW_CELL_CLICK="row-cell:click",t.ROW_CELL_DOUBLE_CLICK="row-cell:double-click",t.ROW_CELL_CONTEXT_MENU="row-cell:context-menu",t.ROW_CELL_MOUSE_DOWN="row-cell:mouse-down",t.ROW_CELL_MOUSE_UP="row-cell:mouse-up",t.ROW_CELL_MOUSE_MOVE="row-cell:mouse-move",t.ROW_CELL_SCROLL="row-cell:scroll",t.ROW_CELL_BRUSH_SELECTION="row-cell:brush-selection",t.ROW_CELL_COLLAPSED="row-cell:collapsed",t.ROW_CELL_ALL_COLLAPSED="row-cell:all-collapsed",t.ROW_CELL_RENDER="row-cell:render",t.ROW_CELL_COLLAPSED__PRIVATE="row-cell:collapsed__private",t.ROW_CELL_ALL_COLLAPSED__PRIVATE="row-cell:all-collapsed__private",t.COL_CELL_HOVER="col-cell:hover",t.COL_CELL_CLICK="col-cell:click",t.COL_CELL_DOUBLE_CLICK="col-cell:double-click",t.COL_CELL_CONTEXT_MENU="col-cell:context-menu",t.COL_CELL_MOUSE_DOWN="col-cell:mouse-down",t.COL_CELL_MOUSE_UP="col-cell:mouse-up",t.COL_CELL_MOUSE_MOVE="col-cell:mouse-move",t.COL_CELL_BRUSH_SELECTION="col-cell:brush-selection",t.COL_CELL_EXPANDED="col-cell:expanded",t.COL_CELL_HIDDEN="col-cell:hidden",t.COL_CELL_RENDER="col-cell:render",t.DATA_CELL_HOVER="data-cell:hover",t.DATA_CELL_CLICK="data-cell:click",t.DATA_CELL_DOUBLE_CLICK="data-cell:double-click",t.DATA_CELL_CONTEXT_MENU="data-cell:context-menu",t.DATA_CELL_MOUSE_UP="data-cell:mouse-up",t.DATA_CELL_MOUSE_DOWN="data-cell:mouse-down",t.DATA_CELL_MOUSE_MOVE="data-cell:mouse-move",t.DATA_CELL_BRUSH_SELECTION="data-cell:brush-selection",t.DATA_CELL_SELECT_MOVE="data-cell:select-move",t.DATA_CELL_RENDER="data-cell:render",t.CORNER_CELL_HOVER="corner-cell:hover",t.CORNER_CELL_CLICK="corner-cell:click",t.CORNER_CELL_DOUBLE_CLICK="corner-cell:double-click",t.CORNER_CELL_CONTEXT_MENU="corner-cell:context-menu",t.CORNER_CELL_MOUSE_DOWN="corner-cell:mouse-down",t.CORNER_CELL_MOUSE_UP="corner-cell:mouse-up",t.CORNER_CELL_MOUSE_MOVE="corner-cell:mouse-move",t.CORNER_CELL_RENDER="corner-cell:render",t.MERGED_CELLS_HOVER="merged-cells:hover",t.MERGED_CELLS_CLICK="merged-cells:click",t.MERGED_CELLS_DOUBLE_CLICK="merged-cells:double-click",t.MERGED_CELLS_CONTEXT_MENU="merged-cells:context-menu",t.MERGED_CELLS_MOUSE_DOWN="merged-cells:mouse-down",t.MERGED_CELLS_MOUSE_UP="merged-cells:mouse-up",t.MERGED_CELLS_MOUSE_MOVE="merged-cells:mouse-move",t.MERGED_CELLS_RENDER="merged-cells:render",t.SERIES_NUMBER_CELL_RENDER="series-number-cell:render",t.RANGE_SORT="sort:range-sort",t.RANGE_SORTED="sort:range-sorted",t.RANGE_FILTER="filter:range-filter",t.RANGE_FILTERED="filter:range-filtered",t.LAYOUT_AFTER_HEADER_LAYOUT="layout:after-header-layout",t.LAYOUT_CELL_RENDER="layout:cell-render",t.LAYOUT_PAGINATION="layout:pagination",t.LAYOUT_AFTER_REAL_DATA_CELL_RENDER="layout:after-real-data-cell-render",t.LAYOUT_AFTER_RENDER="layout:after-render",t.LAYOUT_BEFORE_RENDER="layout:before-render",t.LAYOUT_DESTROY="layout:destroy",t.LAYOUT_RESIZE="layout:resize",t.LAYOUT_RESIZE_SERIES_WIDTH="layout:resize-series-width",t.LAYOUT_RESIZE_ROW_WIDTH="layout:resize-row-width",t.LAYOUT_RESIZE_ROW_HEIGHT="layout:resize-row-height",t.LAYOUT_RESIZE_COL_WIDTH="layout:resize-column-width",t.LAYOUT_RESIZE_COL_HEIGHT="layout:resize-column-height",t.LAYOUT_RESIZE_TREE_WIDTH="layout:resize-tree-width",t.LAYOUT_RESIZE_MOUSE_DOWN="layout:resize:mouse-down",t.LAYOUT_RESIZE_MOUSE_MOVE="layout:resize:mouse-move",t.LAYOUT_RESIZE_MOUSE_UP="layout:resize-mouse-up",t.GLOBAL_KEYBOARD_DOWN="global:keyboard-down",t.GLOBAL_KEYBOARD_UP="global:keyboard-up",t.GLOBAL_COPIED="global:copied",t.GLOBAL_MOUSE_UP="global:mouse-up",t.GLOBAL_MOUSE_MOVE="global:mouse-move",t.GLOBAL_ACTION_ICON_CLICK="global:action-icon-click",t.GLOBAL_ACTION_ICON_HOVER="global:action-icon-hover",t.GLOBAL_ACTION_ICON_HOVER_OFF="global:action-icon-hover-off",t.GLOBAL_CONTEXT_MENU="global:context-menu",t.GLOBAL_CLICK="global:click",t.GLOBAL_DOUBLE_CLICK="global:double-click",t.GLOBAL_SELECTED="global:selected",t.GLOBAL_HOVER="global:hover",t.GLOBAL_RESET="global:reset",t.GLOBAL_LINK_FIELD_JUMP="global:link-field-jump",t.GLOBAL_SCROLL="global:scroll"})(se||(se={}));var ud;(function(t){t.RIGHT_MOUSE_UP="rightup"})(ud||(ud={}));var mC=typeof global=="object"&&global&&global.Object===Object&&global,WA=typeof self=="object"&&self&&self.Object===Object&&self,Xn=mC||WA||Function("return this")(),Vn=Xn.Symbol,yC=Object.prototype,GA=yC.hasOwnProperty,UA=yC.toString,$s=Vn?Vn.toStringTag:void 0;function VA(t){var r=GA.call(t,$s),e=t[$s];try{t[$s]=void 0;var n=!0}catch{}var i=UA.call(t);return n&&(r?t[$s]=e:delete t[$s]),i}var XA=Object.prototype,YA=XA.toString;function $A(t){return YA.call(t)}var qA="[object Null]",KA="[object Undefined]",Tm=Vn?Vn.toStringTag:void 0;function hi(t){return t==null?t===void 0?KA:qA:Tm&&Tm in Object(t)?VA(t):$A(t)}function vn(t){return t!=null&&typeof t=="object"}var ZA="[object Symbol]";function ao(t){return typeof t=="symbol"||vn(t)&&hi(t)==ZA}function ni(t,r){for(var e=-1,n=t==null?0:t.length,i=Array(n);++e<n;)i[e]=r(t[e],e,t);return i}var vt=Array.isArray,jA=1/0,_m=Vn?Vn.prototype:void 0,Rm=_m?_m.toString:void 0;function Hc(t){if(typeof t=="string")return t;if(vt(t))return ni(t,Hc)+"";if(ao(t))return Rm?Rm.call(t):"";var r=t+"";return r=="0"&&1/t==-jA?"-0":r}var JA=/\s/;function QA(t){for(var r=t.length;r--&&JA.test(t.charAt(r)););return r}var eN=/^\s+/;function tN(t){return t&&t.slice(0,QA(t)+1).replace(eN,"")}function Lr(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}var Lm=NaN,rN=/^[-+]0x[0-9a-f]+$/i,nN=/^0b[01]+$/i,iN=/^0o[0-7]+$/i,aN=parseInt;function Ai(t){if(typeof t=="number")return t;if(ao(t))return Lm;if(Lr(t)){var r=typeof t.valueOf=="function"?t.valueOf():t;t=Lr(r)?r+"":r}if(typeof t!="string")return t===0?t:+t;t=tN(t);var e=nN.test(t);return e||iN.test(t)?aN(t.slice(2),e?2:8):rN.test(t)?Lm:+t}var Mm=1/0,oN=17976931348623157e292;function Zo(t){if(!t)return t===0?t:0;if(t=Ai(t),t===Mm||t===-Mm){var r=t<0?-1:1;return r*oN}return t===t?t:0}function Oa(t){var r=Zo(t),e=r%1;return r===r?e?r-e:r:0}function Ia(t){return t}var sN="[object AsyncFunction]",lN="[object Function]",uN="[object GeneratorFunction]",cN="[object Proxy]";function ui(t){if(!Lr(t))return!1;var r=hi(t);return r==lN||r==uN||r==sN||r==cN}var Th=Xn["__core-js_shared__"],Om=function(){var t=/[^.]+$/.exec(Th&&Th.keys&&Th.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function fN(t){return!!Om&&Om in t}var hN=Function.prototype,dN=hN.toString;function po(t){if(t!=null){try{return dN.call(t)}catch{}try{return t+""}catch{}}return""}var vN=/[\\^$.*+?()[\]{}|]/g,pN=/^\[object .+?Constructor\]$/,gN=Function.prototype,mN=Object.prototype,yN=gN.toString,CN=mN.hasOwnProperty,wN=RegExp("^"+yN.call(CN).replace(vN,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function xN(t){if(!Lr(t)||fN(t))return!1;var r=ui(t)?wN:pN;return r.test(po(t))}function bN(t,r){return t==null?void 0:t[r]}function go(t,r){var e=bN(t,r);return xN(e)?e:void 0}var cd=go(Xn,"WeakMap"),Am=Object.create,SN=function(){function t(){}return function(r){if(!Lr(r))return{};if(Am)return Am(r);t.prototype=r;var e=new t;return t.prototype=void 0,e}}();function EN(t,r,e){switch(e.length){case 0:return t.call(r);case 1:return t.call(r,e[0]);case 2:return t.call(r,e[0],e[1]);case 3:return t.call(r,e[0],e[1],e[2])}return t.apply(r,e)}function TN(){}function yv(t,r){var e=-1,n=t.length;for(r||(r=Array(n));++e<n;)r[e]=t[e];return r}var _N=800,RN=16,LN=Date.now;function MN(t){var r=0,e=0;return function(){var n=LN(),i=RN-(n-e);if(e=n,i>0){if(++r>=_N)return arguments[0]}else r=0;return t.apply(void 0,arguments)}}function ON(t){return function(){return t}}var sc=function(){try{var t=go(Object,"defineProperty");return t({},"",{}),t}catch{}}(),AN=sc?function(t,r){return sc(t,"toString",{configurable:!0,enumerable:!1,value:ON(r),writable:!0})}:Ia,NN=AN,CC=MN(NN);function wC(t,r){for(var e=-1,n=t==null?0:t.length;++e<n&&r(t[e],e,t)!==!1;);return t}function Cv(t,r,e,n){for(var i=t.length,a=e+(n?1:-1);n?a--:++a<i;)if(r(t[a],a,t))return a;return-1}function kN(t){return t!==t}function IN(t,r,e){for(var n=e-1,i=t.length;++n<i;)if(t[n]===r)return n;return-1}function wv(t,r,e){return r===r?IN(t,r,e):Cv(t,kN,e)}function xv(t,r){var e=t==null?0:t.length;return!!e&&wv(t,r,0)>-1}var PN=9007199254740991,DN=/^(?:0|[1-9]\d*)$/;function zc(t,r){var e=typeof t;return r=r??PN,!!r&&(e=="number"||e!="symbol"&&DN.test(t))&&t>-1&&t%1==0&&t<r}function Pl(t,r,e){r=="__proto__"&&sc?sc(t,r,{configurable:!0,enumerable:!0,value:e,writable:!0}):t[r]=e}function Dl(t,r){return t===r||t!==t&&r!==r}var BN=Object.prototype,FN=BN.hasOwnProperty;function Wc(t,r,e){var n=t[r];(!(FN.call(t,r)&&Dl(n,e))||e===void 0&&!(r in t))&&Pl(t,r,e)}function mo(t,r,e,n){var i=!e;e||(e={});for(var a=-1,o=r.length;++a<o;){var s=r[a],l=void 0;l===void 0&&(l=t[s]),i?Pl(e,s,l):Wc(e,s,l)}return e}var Nm=Math.max;function xC(t,r,e){return r=Nm(r===void 0?t.length-1:r,0),function(){for(var n=arguments,i=-1,a=Nm(n.length-r,0),o=Array(a);++i<a;)o[i]=n[r+i];i=-1;for(var s=Array(r+1);++i<r;)s[i]=n[i];return s[r]=e(o),EN(t,this,s)}}function Pa(t,r){return CC(xC(t,r,Ia),t+"")}var HN=9007199254740991;function bv(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=HN}function di(t){return t!=null&&bv(t.length)&&!ui(t)}function ns(t,r,e){if(!Lr(e))return!1;var n=typeof r;return(n=="number"?di(e)&&zc(r,e.length):n=="string"&&r in e)?Dl(e[r],t):!1}function Sv(t){return Pa(function(r,e){var n=-1,i=e.length,a=i>1?e[i-1]:void 0,o=i>2?e[2]:void 0;for(a=t.length>3&&typeof a=="function"?(i--,a):void 0,o&&ns(e[0],e[1],o)&&(a=i<3?void 0:a,i=1),r=Object(r);++n<i;){var s=e[n];s&&t(r,s,n,a)}return r})}var zN=Object.prototype;function Bl(t){var r=t&&t.constructor,e=typeof r=="function"&&r.prototype||zN;return t===e}function bC(t,r){for(var e=-1,n=Array(t);++e<t;)n[e]=r(e);return n}var WN="[object Arguments]";function km(t){return vn(t)&&hi(t)==WN}var SC=Object.prototype,GN=SC.hasOwnProperty,UN=SC.propertyIsEnumerable,is=km(function(){return arguments}())?km:function(t){return vn(t)&&GN.call(t,"callee")&&!UN.call(t,"callee")};function VN(){return!1}var EC=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Im=EC&&typeof module=="object"&&module&&!module.nodeType&&module,XN=Im&&Im.exports===EC,Pm=XN?Xn.Buffer:void 0,YN=Pm?Pm.isBuffer:void 0,$N=YN||VN,as=$N,qN="[object Arguments]",KN="[object Array]",ZN="[object Boolean]",jN="[object Date]",JN="[object Error]",QN="[object Function]",ek="[object Map]",tk="[object Number]",rk="[object Object]",nk="[object RegExp]",ik="[object Set]",ak="[object String]",ok="[object WeakMap]",sk="[object ArrayBuffer]",lk="[object DataView]",uk="[object Float32Array]",ck="[object Float64Array]",fk="[object Int8Array]",hk="[object Int16Array]",dk="[object Int32Array]",vk="[object Uint8Array]",pk="[object Uint8ClampedArray]",gk="[object Uint16Array]",mk="[object Uint32Array]",zt={};zt[uk]=zt[ck]=zt[fk]=zt[hk]=zt[dk]=zt[vk]=zt[pk]=zt[gk]=zt[mk]=!0;zt[qN]=zt[KN]=zt[sk]=zt[ZN]=zt[lk]=zt[jN]=zt[JN]=zt[QN]=zt[ek]=zt[tk]=zt[rk]=zt[nk]=zt[ik]=zt[ak]=zt[ok]=!1;function yk(t){return vn(t)&&bv(t.length)&&!!zt[hi(t)]}function ps(t){return function(r){return t(r)}}var TC=typeof exports=="object"&&exports&&!exports.nodeType&&exports,sl=TC&&typeof module=="object"&&module&&!module.nodeType&&module,Ck=sl&&sl.exports===TC,_h=Ck&&mC.process,Aa=function(){try{var t=sl&&sl.require&&sl.require("util").types;return t||_h&&_h.binding&&_h.binding("util")}catch{}}(),Dm=Aa&&Aa.isTypedArray,wk=Dm?ps(Dm):yk,Gc=wk,xk=Object.prototype,bk=xk.hasOwnProperty;function _C(t,r){var e=vt(t),n=!e&&is(t),i=!e&&!n&&as(t),a=!e&&!n&&!i&&Gc(t),o=e||n||i||a,s=o?bC(t.length,String):[],l=s.length;for(var u in t)(r||bk.call(t,u))&&!(o&&(u=="length"||i&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||zc(u,l)))&&s.push(u);return s}function RC(t,r){return function(e){return t(r(e))}}var Sk=RC(Object.keys,Object),Ek=Object.prototype,Tk=Ek.hasOwnProperty;function Ev(t){if(!Bl(t))return Sk(t);var r=[];for(var e in Object(t))Tk.call(t,e)&&e!="constructor"&&r.push(e);return r}function pn(t){return di(t)?_C(t):Ev(t)}var _k=Object.prototype,Rk=_k.hasOwnProperty,Lk=Sv(function(t,r){if(Bl(r)||di(r)){mo(r,pn(r),t);return}for(var e in r)Rk.call(r,e)&&Wc(t,e,r[e])});function Mk(t){var r=[];if(t!=null)for(var e in Object(t))r.push(e);return r}var Ok=Object.prototype,Ak=Ok.hasOwnProperty;function Nk(t){if(!Lr(t))return Mk(t);var r=Bl(t),e=[];for(var n in t)n=="constructor"&&(r||!Ak.call(t,n))||e.push(n);return e}function gs(t){return di(t)?_C(t,!0):Nk(t)}var kk=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ik=/^\w*$/;function Tv(t,r){if(vt(t))return!1;var e=typeof t;return e=="number"||e=="symbol"||e=="boolean"||t==null||ao(t)?!0:Ik.test(t)||!kk.test(t)||r!=null&&t in Object(r)}var gl=go(Object,"create");function Pk(){this.__data__=gl?gl(null):{},this.size=0}function Dk(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}var Bk="__lodash_hash_undefined__",Fk=Object.prototype,Hk=Fk.hasOwnProperty;function zk(t){var r=this.__data__;if(gl){var e=r[t];return e===Bk?void 0:e}return Hk.call(r,t)?r[t]:void 0}var Wk=Object.prototype,Gk=Wk.hasOwnProperty;function Uk(t){var r=this.__data__;return gl?r[t]!==void 0:Gk.call(r,t)}var Vk="__lodash_hash_undefined__";function Xk(t,r){var e=this.__data__;return this.size+=this.has(t)?0:1,e[t]=gl&&r===void 0?Vk:r,this}function oo(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}oo.prototype.clear=Pk;oo.prototype.delete=Dk;oo.prototype.get=zk;oo.prototype.has=Uk;oo.prototype.set=Xk;function Yk(){this.__data__=[],this.size=0}function Uc(t,r){for(var e=t.length;e--;)if(Dl(t[e][0],r))return e;return-1}var $k=Array.prototype,qk=$k.splice;function Kk(t){var r=this.__data__,e=Uc(r,t);if(e<0)return!1;var n=r.length-1;return e==n?r.pop():qk.call(r,e,1),--this.size,!0}function Zk(t){var r=this.__data__,e=Uc(r,t);return e<0?void 0:r[e][1]}function jk(t){return Uc(this.__data__,t)>-1}function Jk(t,r){var e=this.__data__,n=Uc(e,t);return n<0?(++this.size,e.push([t,r])):e[n][1]=r,this}function ua(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}ua.prototype.clear=Yk;ua.prototype.delete=Kk;ua.prototype.get=Zk;ua.prototype.has=jk;ua.prototype.set=Jk;var ml=go(Xn,"Map");function Qk(){this.size=0,this.__data__={hash:new oo,map:new(ml||ua),string:new oo}}function eI(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}function Vc(t,r){var e=t.__data__;return eI(r)?e[typeof r=="string"?"string":"hash"]:e.map}function tI(t){var r=Vc(this,t).delete(t);return this.size-=r?1:0,r}function rI(t){return Vc(this,t).get(t)}function nI(t){return Vc(this,t).has(t)}function iI(t,r){var e=Vc(this,t),n=e.size;return e.set(t,r),this.size+=e.size==n?0:1,this}function ca(t){var r=-1,e=t==null?0:t.length;for(this.clear();++r<e;){var n=t[r];this.set(n[0],n[1])}}ca.prototype.clear=Qk;ca.prototype.delete=tI;ca.prototype.get=rI;ca.prototype.has=nI;ca.prototype.set=iI;var aI="Expected a function";function Fl(t,r){if(typeof t!="function"||r!=null&&typeof r!="function")throw new TypeError(aI);var e=function(){var n=arguments,i=r?r.apply(this,n):n[0],a=e.cache;if(a.has(i))return a.get(i);var o=t.apply(this,n);return e.cache=a.set(i,o)||a,o};return e.cache=new(Fl.Cache||ca),e}Fl.Cache=ca;var oI=500;function sI(t){var r=Fl(t,function(n){return e.size===oI&&e.clear(),n}),e=r.cache;return r}var lI=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,uI=/\\(\\)?/g,cI=sI(function(t){var r=[];return t.charCodeAt(0)===46&&r.push(""),t.replace(lI,function(e,n,i,a){r.push(i?a.replace(uI,"$1"):n||e)}),r});function Pi(t){return t==null?"":Hc(t)}function ms(t,r){return vt(t)?t:Tv(t,r)?[t]:cI(Pi(t))}var fI=1/0;function ys(t){if(typeof t=="string"||ao(t))return t;var r=t+"";return r=="0"&&1/t==-fI?"-0":r}function Hl(t,r){r=ms(r,t);for(var e=0,n=r.length;t!=null&&e<n;)t=t[ys(r[e++])];return e&&e==n?t:void 0}function dt(t,r,e){var n=t==null?void 0:Hl(t,r);return n===void 0?e:n}function Xc(t,r){for(var e=-1,n=r.length,i=t.length;++e<n;)t[i+e]=r[e];return t}var Bm=Vn?Vn.isConcatSpreadable:void 0;function hI(t){return vt(t)||is(t)||!!(Bm&&t&&t[Bm])}function yo(t,r,e,n,i){var a=-1,o=t.length;for(e||(e=hI),i||(i=[]);++a<o;){var s=t[a];e(s)?Xc(i,s):n||(i[i.length]=s)}return i}function dI(t){var r=t==null?0:t.length;return r?yo(t):[]}function LC(t){return CC(xC(t,void 0,dI),t+"")}var _v=RC(Object.getPrototypeOf,Object),vI="[object Object]",pI=Function.prototype,gI=Object.prototype,MC=pI.toString,mI=gI.hasOwnProperty,yI=MC.call(Object);function Yc(t){if(!vn(t)||hi(t)!=vI)return!1;var r=_v(t);if(r===null)return!0;var e=mI.call(r,"constructor")&&r.constructor;return typeof e=="function"&&e instanceof e&&MC.call(e)==yI}function Rv(t,r,e){var n=-1,i=t.length;r<0&&(r=-r>i?0:i+r),e=e>i?i:e,e<0&&(e+=i),i=r>e?0:e-r>>>0,r>>>=0;for(var a=Array(i);++n<i;)a[n]=t[n+r];return a}function CI(t,r,e){var n=t.length;return e=e===void 0?n:e,!r&&e>=n?t:Rv(t,r,e)}var wI="\\ud800-\\udfff",xI="\\u0300-\\u036f",bI="\\ufe20-\\ufe2f",SI="\\u20d0-\\u20ff",EI=xI+bI+SI,TI="\\ufe0e\\ufe0f",_I="\\u200d",RI=RegExp("["+_I+wI+EI+TI+"]");function Lv(t){return RI.test(t)}function LI(t){return t.split("")}var OC="\\ud800-\\udfff",MI="\\u0300-\\u036f",OI="\\ufe20-\\ufe2f",AI="\\u20d0-\\u20ff",NI=MI+OI+AI,kI="\\ufe0e\\ufe0f",II="["+OC+"]",fd="["+NI+"]",hd="\\ud83c[\\udffb-\\udfff]",PI="(?:"+fd+"|"+hd+")",AC="[^"+OC+"]",NC="(?:\\ud83c[\\udde6-\\uddff]){2}",kC="[\\ud800-\\udbff][\\udc00-\\udfff]",DI="\\u200d",IC=PI+"?",PC="["+kI+"]?",BI="(?:"+DI+"(?:"+[AC,NC,kC].join("|")+")"+PC+IC+")*",FI=PC+IC+BI,HI="(?:"+[AC+fd+"?",fd,NC,kC,II].join("|")+")",zI=RegExp(hd+"(?="+hd+")|"+HI+FI,"g");function WI(t){return t.match(zI)||[]}function GI(t){return Lv(t)?WI(t):LI(t)}function DC(t,r,e,n){var i=-1,a=t==null?0:t.length;for(n&&a&&(e=t[++i]);++i<a;)e=r(e,t[i],i,t);return e}function BC(t){return function(r){return t==null?void 0:t[r]}}var UI={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},VI=BC(UI),XI=VI,YI=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,$I="\\u0300-\\u036f",qI="\\ufe20-\\ufe2f",KI="\\u20d0-\\u20ff",ZI=$I+qI+KI,jI="["+ZI+"]",JI=RegExp(jI,"g");function QI(t){return t=Pi(t),t&&t.replace(YI,XI).replace(JI,"")}var eP=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function tP(t){return t.match(eP)||[]}var rP=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function nP(t){return rP.test(t)}var FC="\\ud800-\\udfff",iP="\\u0300-\\u036f",aP="\\ufe20-\\ufe2f",oP="\\u20d0-\\u20ff",sP=iP+aP+oP,HC="\\u2700-\\u27bf",zC="a-z\\xdf-\\xf6\\xf8-\\xff",lP="\\xac\\xb1\\xd7\\xf7",uP="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",cP="\\u2000-\\u206f",fP=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",WC="A-Z\\xc0-\\xd6\\xd8-\\xde",hP="\\ufe0e\\ufe0f",GC=lP+uP+cP+fP,UC="[']",Fm="["+GC+"]",dP="["+sP+"]",VC="\\d+",vP="["+HC+"]",XC="["+zC+"]",YC="[^"+FC+GC+VC+HC+zC+WC+"]",pP="\\ud83c[\\udffb-\\udfff]",gP="(?:"+dP+"|"+pP+")",mP="[^"+FC+"]",$C="(?:\\ud83c[\\udde6-\\uddff]){2}",qC="[\\ud800-\\udbff][\\udc00-\\udfff]",Bo="["+WC+"]",yP="\\u200d",Hm="(?:"+XC+"|"+YC+")",CP="(?:"+Bo+"|"+YC+")",zm="(?:"+UC+"(?:d|ll|m|re|s|t|ve))?",Wm="(?:"+UC+"(?:D|LL|M|RE|S|T|VE))?",KC=gP+"?",ZC="["+hP+"]?",wP="(?:"+yP+"(?:"+[mP,$C,qC].join("|")+")"+ZC+KC+")*",xP="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",bP="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",SP=ZC+KC+wP,EP="(?:"+[vP,$C,qC].join("|")+")"+SP,TP=RegExp([Bo+"?"+XC+"+"+zm+"(?="+[Fm,Bo,"$"].join("|")+")",CP+"+"+Wm+"(?="+[Fm,Bo+Hm,"$"].join("|")+")",Bo+"?"+Hm+"+"+zm,Bo+"+"+Wm,bP,xP,VC,EP].join("|"),"g");function _P(t){return t.match(TP)||[]}function RP(t,r,e){return t=Pi(t),r=r,r===void 0?nP(t)?_P(t):tP(t):t.match(r)||[]}var LP="[']",MP=RegExp(LP,"g");function OP(t){return function(r){return DC(RP(QI(r).replace(MP,"")),t,"")}}var AP=Xn.isFinite,NP=Math.min;function kP(t){var r=Math[t];return function(e,n){if(e=Ai(e),n=n==null?0:NP(Oa(n),292),n&&AP(e)){var i=(Pi(e)+"e").split("e"),a=r(i[0]+"e"+(+i[1]+n));return i=(Pi(a)+"e").split("e"),+(i[0]+"e"+(+i[1]-n))}return r(e)}}function jC(t,r,e){return t===t&&(e!==void 0&&(t=t<=e?t:e),r!==void 0&&(t=t>=r?t:r)),t}function lc(t,r,e){return e===void 0&&(e=r,r=void 0),e!==void 0&&(e=Ai(e),e=e===e?e:0),r!==void 0&&(r=Ai(r),r=r===r?r:0),jC(Ai(t),r,e)}function IP(){this.__data__=new ua,this.size=0}function PP(t){var r=this.__data__,e=r.delete(t);return this.size=r.size,e}function DP(t){return this.__data__.get(t)}function BP(t){return this.__data__.has(t)}var FP=200;function HP(t,r){var e=this.__data__;if(e instanceof ua){var n=e.__data__;if(!ml||n.length<FP-1)return n.push([t,r]),this.size=++e.size,this;e=this.__data__=new ca(n)}return e.set(t,r),this.size=e.size,this}function ii(t){var r=this.__data__=new ua(t);this.size=r.size}ii.prototype.clear=IP;ii.prototype.delete=PP;ii.prototype.get=DP;ii.prototype.has=BP;ii.prototype.set=HP;function zP(t,r){return t&&mo(r,pn(r),t)}function WP(t,r){return t&&mo(r,gs(r),t)}var JC=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Gm=JC&&typeof module=="object"&&module&&!module.nodeType&&module,GP=Gm&&Gm.exports===JC,Um=GP?Xn.Buffer:void 0,Vm=Um?Um.allocUnsafe:void 0;function QC(t,r){if(r)return t.slice();var e=t.length,n=Vm?Vm(e):new t.constructor(e);return t.copy(n),n}function Mv(t,r){for(var e=-1,n=t==null?0:t.length,i=0,a=[];++e<n;){var o=t[e];r(o,e,t)&&(a[i++]=o)}return a}function ew(){return[]}var UP=Object.prototype,VP=UP.propertyIsEnumerable,Xm=Object.getOwnPropertySymbols,Ov=Xm?function(t){return t==null?[]:(t=Object(t),Mv(Xm(t),function(r){return VP.call(t,r)}))}:ew;function XP(t,r){return mo(t,Ov(t),r)}var YP=Object.getOwnPropertySymbols,tw=YP?function(t){for(var r=[];t;)Xc(r,Ov(t)),t=_v(t);return r}:ew;function $P(t,r){return mo(t,tw(t),r)}function rw(t,r,e){var n=r(t);return vt(t)?n:Xc(n,e(t))}function dd(t){return rw(t,pn,Ov)}function Av(t){return rw(t,gs,tw)}var vd=go(Xn,"DataView"),pd=go(Xn,"Promise"),jo=go(Xn,"Set"),Ym="[object Map]",qP="[object Object]",$m="[object Promise]",qm="[object Set]",Km="[object WeakMap]",Zm="[object DataView]",KP=po(vd),ZP=po(ml),jP=po(pd),JP=po(jo),QP=po(cd),$a=hi;(vd&&$a(new vd(new ArrayBuffer(1)))!=Zm||ml&&$a(new ml)!=Ym||pd&&$a(pd.resolve())!=$m||jo&&$a(new jo)!=qm||cd&&$a(new cd)!=Km)&&($a=function(t){var r=hi(t),e=r==qP?t.constructor:void 0,n=e?po(e):"";if(n)switch(n){case KP:return Zm;case ZP:return Ym;case jP:return $m;case JP:return qm;case QP:return Km}return r});var so=$a,e3=Object.prototype,t3=e3.hasOwnProperty;function r3(t){var r=t.length,e=new t.constructor(r);return r&&typeof t[0]=="string"&&t3.call(t,"index")&&(e.index=t.index,e.input=t.input),e}var n3=Xn.Uint8Array,uc=n3;function Nv(t){var r=new t.constructor(t.byteLength);return new uc(r).set(new uc(t)),r}function i3(t,r){var e=r?Nv(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.byteLength)}var a3=/\w*$/;function o3(t){var r=new t.constructor(t.source,a3.exec(t));return r.lastIndex=t.lastIndex,r}var jm=Vn?Vn.prototype:void 0,Jm=jm?jm.valueOf:void 0;function s3(t){return Jm?Object(Jm.call(t)):{}}function nw(t,r){var e=r?Nv(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}var l3="[object Boolean]",u3="[object Date]",c3="[object Map]",f3="[object Number]",h3="[object RegExp]",d3="[object Set]",v3="[object String]",p3="[object Symbol]",g3="[object ArrayBuffer]",m3="[object DataView]",y3="[object Float32Array]",C3="[object Float64Array]",w3="[object Int8Array]",x3="[object Int16Array]",b3="[object Int32Array]",S3="[object Uint8Array]",E3="[object Uint8ClampedArray]",T3="[object Uint16Array]",_3="[object Uint32Array]";function R3(t,r,e){var n=t.constructor;switch(r){case g3:return Nv(t);case l3:case u3:return new n(+t);case m3:return i3(t,e);case y3:case C3:case w3:case x3:case b3:case S3:case E3:case T3:case _3:return nw(t,e);case c3:return new n;case f3:case v3:return new n(t);case h3:return o3(t);case d3:return new n;case p3:return s3(t)}}function iw(t){return typeof t.constructor=="function"&&!Bl(t)?SN(_v(t)):{}}var L3="[object Map]";function M3(t){return vn(t)&&so(t)==L3}var Qm=Aa&&Aa.isMap,O3=Qm?ps(Qm):M3,A3="[object Set]";function N3(t){return vn(t)&&so(t)==A3}var e1=Aa&&Aa.isSet,k3=e1?ps(e1):N3,I3=1,P3=2,D3=4,aw="[object Arguments]",B3="[object Array]",F3="[object Boolean]",H3="[object Date]",z3="[object Error]",ow="[object Function]",W3="[object GeneratorFunction]",G3="[object Map]",U3="[object Number]",sw="[object Object]",V3="[object RegExp]",X3="[object Set]",Y3="[object String]",$3="[object Symbol]",q3="[object WeakMap]",K3="[object ArrayBuffer]",Z3="[object DataView]",j3="[object Float32Array]",J3="[object Float64Array]",Q3="[object Int8Array]",e4="[object Int16Array]",t4="[object Int32Array]",r4="[object Uint8Array]",n4="[object Uint8ClampedArray]",i4="[object Uint16Array]",a4="[object Uint32Array]",Dt={};Dt[aw]=Dt[B3]=Dt[K3]=Dt[Z3]=Dt[F3]=Dt[H3]=Dt[j3]=Dt[J3]=Dt[Q3]=Dt[e4]=Dt[t4]=Dt[G3]=Dt[U3]=Dt[sw]=Dt[V3]=Dt[X3]=Dt[Y3]=Dt[$3]=Dt[r4]=Dt[n4]=Dt[i4]=Dt[a4]=!0;Dt[z3]=Dt[ow]=Dt[q3]=!1;function Jo(t,r,e,n,i,a){var o,s=r&I3,l=r&P3,u=r&D3;if(e&&(o=i?e(t,n,i,a):e(t)),o!==void 0)return o;if(!Lr(t))return t;var h=vt(t);if(h){if(o=r3(t),!s)return yv(t,o)}else{var v=so(t),p=v==ow||v==W3;if(as(t))return QC(t,s);if(v==sw||v==aw||p&&!i){if(o=l||p?{}:iw(t),!s)return l?$P(t,WP(o,t)):XP(t,zP(o,t))}else{if(!Dt[v])return i?t:{};o=R3(t,v,s)}}a||(a=new ii);var m=a.get(t);if(m)return m;a.set(t,o),k3(t)?t.forEach(function(b){o.add(Jo(b,r,e,b,t,a))}):O3(t)&&t.forEach(function(b,E){o.set(E,Jo(b,r,e,E,t,a))});var C=u?l?Av:dd:l?gs:pn,w=h?void 0:C(t);return wC(w||t,function(b,E){w&&(E=b,b=t[E]),Wc(o,E,Jo(b,r,e,E,t,a))}),o}var o4=4;function $c(t){return Jo(t,o4)}var s4=1,l4=4;function t1(t){return Jo(t,s4|l4)}function ai(t){for(var r=-1,e=t==null?0:t.length,n=0,i=[];++r<e;){var a=t[r];a&&(i[n++]=a)}return i}function Ra(){var t=arguments.length;if(!t)return[];for(var r=Array(t-1),e=arguments[0],n=t;n--;)r[n-1]=arguments[n];return Xc(vt(e)?yv(e):[e],yo(r))}var u4="__lodash_hash_undefined__";function c4(t){return this.__data__.set(t,u4),this}function f4(t){return this.__data__.has(t)}function lo(t){var r=-1,e=t==null?0:t.length;for(this.__data__=new ca;++r<e;)this.add(t[r])}lo.prototype.add=lo.prototype.push=c4;lo.prototype.has=f4;function lw(t,r){for(var e=-1,n=t==null?0:t.length;++e<n;)if(r(t[e],e,t))return!0;return!1}function yl(t,r){return t.has(r)}var h4=1,d4=2;function uw(t,r,e,n,i,a){var o=e&h4,s=t.length,l=r.length;if(s!=l&&!(o&&l>s))return!1;var u=a.get(t),h=a.get(r);if(u&&h)return u==r&&h==t;var v=-1,p=!0,m=e&d4?new lo:void 0;for(a.set(t,r),a.set(r,t);++v<s;){var C=t[v],w=r[v];if(n)var b=o?n(w,C,v,r,t,a):n(C,w,v,t,r,a);if(b!==void 0){if(b)continue;p=!1;break}if(m){if(!lw(r,function(E,R){if(!yl(m,R)&&(C===E||i(C,E,e,n,a)))return m.push(R)})){p=!1;break}}else if(!(C===w||i(C,w,e,n,a))){p=!1;break}}return a.delete(t),a.delete(r),p}function v4(t){var r=-1,e=Array(t.size);return t.forEach(function(n,i){e[++r]=[i,n]}),e}function kv(t){var r=-1,e=Array(t.size);return t.forEach(function(n){e[++r]=n}),e}var p4=1,g4=2,m4="[object Boolean]",y4="[object Date]",C4="[object Error]",w4="[object Map]",x4="[object Number]",b4="[object RegExp]",S4="[object Set]",E4="[object String]",T4="[object Symbol]",_4="[object ArrayBuffer]",R4="[object DataView]",r1=Vn?Vn.prototype:void 0,Rh=r1?r1.valueOf:void 0;function L4(t,r,e,n,i,a,o){switch(e){case R4:if(t.byteLength!=r.byteLength||t.byteOffset!=r.byteOffset)return!1;t=t.buffer,r=r.buffer;case _4:return!(t.byteLength!=r.byteLength||!a(new uc(t),new uc(r)));case m4:case y4:case x4:return Dl(+t,+r);case C4:return t.name==r.name&&t.message==r.message;case b4:case E4:return t==r+"";case w4:var s=v4;case S4:var l=n&p4;if(s||(s=kv),t.size!=r.size&&!l)return!1;var u=o.get(t);if(u)return u==r;n|=g4,o.set(t,r);var h=uw(s(t),s(r),n,i,a,o);return o.delete(t),h;case T4:if(Rh)return Rh.call(t)==Rh.call(r)}return!1}var M4=1,O4=Object.prototype,A4=O4.hasOwnProperty;function N4(t,r,e,n,i,a){var o=e&M4,s=dd(t),l=s.length,u=dd(r),h=u.length;if(l!=h&&!o)return!1;for(var v=l;v--;){var p=s[v];if(!(o?p in r:A4.call(r,p)))return!1}var m=a.get(t),C=a.get(r);if(m&&C)return m==r&&C==t;var w=!0;a.set(t,r),a.set(r,t);for(var b=o;++v<l;){p=s[v];var E=t[p],R=r[p];if(n)var M=o?n(R,E,p,r,t,a):n(E,R,p,t,r,a);if(!(M===void 0?E===R||i(E,R,e,n,a):M)){w=!1;break}b||(b=p=="constructor")}if(w&&!b){var k=t.constructor,L=r.constructor;k!=L&&"constructor"in t&&"constructor"in r&&!(typeof k=="function"&&k instanceof k&&typeof L=="function"&&L instanceof L)&&(w=!1)}return a.delete(t),a.delete(r),w}var k4=1,n1="[object Arguments]",i1="[object Array]",Iu="[object Object]",I4=Object.prototype,a1=I4.hasOwnProperty;function P4(t,r,e,n,i,a){var o=vt(t),s=vt(r),l=o?i1:so(t),u=s?i1:so(r);l=l==n1?Iu:l,u=u==n1?Iu:u;var h=l==Iu,v=u==Iu,p=l==u;if(p&&as(t)){if(!as(r))return!1;o=!0,h=!1}if(p&&!h)return a||(a=new ii),o||Gc(t)?uw(t,r,e,n,i,a):L4(t,r,l,e,n,i,a);if(!(e&k4)){var m=h&&a1.call(t,"__wrapped__"),C=v&&a1.call(r,"__wrapped__");if(m||C){var w=m?t.value():t,b=C?r.value():r;return a||(a=new ii),i(w,b,e,n,a)}}return p?(a||(a=new ii),N4(t,r,e,n,i,a)):!1}function qc(t,r,e,n,i){return t===r?!0:t==null||r==null||!vn(t)&&!vn(r)?t!==t&&r!==r:P4(t,r,e,n,qc,i)}var D4=1,B4=2;function F4(t,r,e,n){var i=e.length,a=i;if(t==null)return!a;for(t=Object(t);i--;){var o=e[i];if(o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++i<a;){o=e[i];var s=o[0],l=t[s],u=o[1];if(o[2]){if(l===void 0&&!(s in t))return!1}else{var h=new ii,v;if(!(v===void 0?qc(u,l,D4|B4,n,h):v))return!1}}return!0}function cw(t){return t===t&&!Lr(t)}function H4(t){for(var r=pn(t),e=r.length;e--;){var n=r[e],i=t[n];r[e]=[n,i,cw(i)]}return r}function fw(t,r){return function(e){return e==null?!1:e[t]===r&&(r!==void 0||t in Object(e))}}function z4(t){var r=H4(t);return r.length==1&&r[0][2]?fw(r[0][0],r[0][1]):function(e){return e===t||F4(e,t,r)}}function W4(t,r){return t!=null&&r in Object(t)}function hw(t,r,e){r=ms(r,t);for(var n=-1,i=r.length,a=!1;++n<i;){var o=ys(r[n]);if(!(a=t!=null&&e(t,o)))break;t=t[o]}return a||++n!=i?a:(i=t==null?0:t.length,!!i&&bv(i)&&zc(o,i)&&(vt(t)||is(t)))}function os(t,r){return t!=null&&hw(t,r,W4)}var G4=1,U4=2;function V4(t,r){return Tv(t)&&cw(r)?fw(ys(t),r):function(e){var n=dt(e,t);return n===void 0&&n===r?os(e,t):qc(r,n,G4|U4)}}function Iv(t){return function(r){return r==null?void 0:r[t]}}function X4(t){return function(r){return Hl(r,t)}}function Y4(t){return Tv(t)?Iv(ys(t)):X4(t)}function an(t){return typeof t=="function"?t:t==null?Ia:typeof t=="object"?vt(t)?V4(t[0],t[1]):z4(t):Y4(t)}function $4(t,r,e,n){for(var i=-1,a=t==null?0:t.length;++i<a;){var o=t[i];r(n,o,e(o),t)}return n}function q4(t){return function(r,e,n){for(var i=-1,a=Object(r),o=n(r),s=o.length;s--;){var l=o[++i];if(e(a[l],l,a)===!1)break}return r}}var Pv=q4();function dw(t,r){return t&&Pv(t,r,pn)}function K4(t,r){return function(e,n){if(e==null)return e;if(!di(e))return t(e,n);for(var i=e.length,a=-1,o=Object(e);++a<i&&n(o[a],a,o)!==!1;);return e}}var Z4=K4(dw),Co=Z4;function j4(t,r,e,n){return Co(t,function(i,a,o){r(n,i,e(i),o)}),n}function J4(t,r){return function(e,n){var i=vt(e)?$4:j4,a={};return i(e,t,an(n),a)}}var Lh=function(){return Xn.Date.now()},Q4="Expected a function",e5=Math.max,t5=Math.min;function cc(t,r,e){var n,i,a,o,s,l,u=0,h=!1,v=!1,p=!0;if(typeof t!="function")throw new TypeError(Q4);r=Ai(r)||0,Lr(e)&&(h=!!e.leading,v="maxWait"in e,a=v?e5(Ai(e.maxWait)||0,r):a,p="trailing"in e?!!e.trailing:p);function m(_){var I=n,P=i;return n=i=void 0,u=_,o=t.apply(P,I),o}function C(_){return u=_,s=setTimeout(E,r),h?m(_):o}function w(_){var I=_-l,P=_-u,U=r-I;return v?t5(U,a-P):U}function b(_){var I=_-l,P=_-u;return l===void 0||I>=r||I<0||v&&P>=a}function E(){var _=Lh();if(b(_))return R(_);s=setTimeout(E,w(_))}function R(_){return s=void 0,p&&n?m(_):(n=i=void 0,o)}function M(){s!==void 0&&clearTimeout(s),u=0,n=l=i=s=void 0}function k(){return s===void 0?o:R(Lh())}function L(){var _=Lh(),I=b(_);if(n=arguments,i=this,l=_,I){if(s===void 0)return C(l);if(v)return clearTimeout(s),s=setTimeout(E,r),m(l)}return s===void 0&&(s=setTimeout(E,r)),o}return L.cancel=M,L.flush=k,L}function gd(t,r,e){(e!==void 0&&!Dl(t[r],e)||e===void 0&&!(r in t))&&Pl(t,r,e)}function Ni(t){return vn(t)&&di(t)}function md(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}function r5(t){return mo(t,gs(t))}function n5(t,r,e,n,i,a,o){var s=md(t,e),l=md(r,e),u=o.get(l);if(u){gd(t,e,u);return}var h=a?a(s,l,e+"",t,r,o):void 0,v=h===void 0;if(v){var p=vt(l),m=!p&&as(l),C=!p&&!m&&Gc(l);h=l,p||m||C?vt(s)?h=s:Ni(s)?h=yv(s):m?(v=!1,h=QC(l,!0)):C?(v=!1,h=nw(l,!0)):h=[]:Yc(l)||is(l)?(h=s,is(s)?h=r5(s):(!Lr(s)||ui(s))&&(h=iw(l))):v=!1}v&&(o.set(l,h),i(h,l,n,a,o),o.delete(l)),gd(t,e,h)}function Dv(t,r,e,n,i){t!==r&&Pv(r,function(a,o){if(i||(i=new ii),Lr(a))n5(t,r,o,e,Dv,n,i);else{var s=n?n(md(t,o),a,o+"",t,r,i):void 0;s===void 0&&(s=a),gd(t,o,s)}},gs)}var i5=Sv(function(t,r,e,n){Dv(t,r,e,n)}),a5="Expected a function";function o5(t,r,e){if(typeof t!="function")throw new TypeError(a5);return setTimeout(function(){t.apply(void 0,e)},r)}var s5=Pa(function(t,r,e){return o5(t,Ai(r)||0,e)});function l5(t,r,e){for(var n=-1,i=t==null?0:t.length;++n<i;)if(e(r,t[n]))return!0;return!1}var u5=200;function vw(t,r,e,n){var i=-1,a=xv,o=!0,s=t.length,l=[],u=r.length;if(!s)return l;n?(a=l5,o=!1):r.length>=u5&&(a=yl,o=!1,r=new lo(r));e:for(;++i<s;){var h=t[i],v=h;if(h=n||h!==0?h:0,o&&v===v){for(var p=u;p--;)if(r[p]===v)continue e;l.push(h)}else a(r,v,n)||l.push(h)}return l}var c5=Pa(function(t,r){return Ni(t)?vw(t,yo(r,1,Ni,!0)):[]});function mr(t){var r=t==null?0:t.length;return r?t[r-1]:void 0}var f5=Pa(function(t,r){var e=mr(r);return Ni(e)&&(e=void 0),Ni(t)?vw(t,yo(r,1,Ni,!0),void 0,e):[]});function pw(t){return typeof t=="function"?t:Ia}function tt(t,r){var e=vt(t)?wC:Co;return e(t,pw(r))}function h5(t,r,e){t=Pi(t),r=Hc(r);var n=t.length;e=e===void 0?n:jC(Oa(e),0,n);var i=e;return e-=r.length,e>=0&&t.slice(e,i)==r}var d5={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},v5=BC(d5),p5=v5,gw=/[&<>"']/g,g5=RegExp(gw.source);function m5(t){return t=Pi(t),t&&g5.test(t)?t.replace(gw,p5):t}function y5(t,r){for(var e=-1,n=t==null?0:t.length;++e<n;)if(!r(t[e],e,t))return!1;return!0}function C5(t,r){var e=!0;return Co(t,function(n,i,a){return e=!!r(n,i,a),e}),e}function Bv(t,r,e){var n=vt(t)?y5:C5;return n(t,an(r))}function w5(t,r){var e=[];return Co(t,function(n,i,a){r(n,i,a)&&e.push(n)}),e}function ci(t,r){var e=vt(t)?Mv:w5;return e(t,an(r))}function mw(t){return function(r,e,n){var i=Object(r);if(!di(r)){var a=an(e);r=pn(r),e=function(s){return a(i[s],s,i)}}var o=t(r,e,n);return o>-1?i[a?r[o]:o]:void 0}}var x5=Math.max;function Cl(t,r,e){var n=t==null?0:t.length;if(!n)return-1;var i=e==null?0:Oa(e);return i<0&&(i=x5(n+i,0)),Cv(t,an(r),i)}var Rr=mw(Cl),b5=Math.max,S5=Math.min;function E5(t,r,e){var n=t==null?0:t.length;if(!n)return-1;var i=n-1;return e!==void 0&&(i=Oa(e),i=e<0?b5(n+i,0):S5(i,n-1)),Cv(t,an(r),i,!0)}var Fv=mw(E5);function Kc(t){return t&&t.length?t[0]:void 0}function yw(t,r){var e=-1,n=di(t)?Array(t.length):[];return Co(t,function(i,a,o){n[++e]=r(i,a,o)}),n}function ct(t,r){var e=vt(t)?ni:yw;return e(t,an(r))}function zl(t,r){return yo(ct(t,r))}var T5=kP("floor");function _5(t,r){return t==null?t:Pv(t,pw(r),gs)}var R5=Object.prototype,L5=R5.hasOwnProperty,Hv=J4(function(t,r,e){L5.call(t,e)?t[e].push(r):Pl(t,e,[r])});function Cw(t,r){return t>r}var M5=Object.prototype,O5=M5.hasOwnProperty;function A5(t,r){return t!=null&&O5.call(t,r)}function o1(t,r){return t!=null&&hw(t,r,A5)}var N5=Math.max,k5=Math.min;function I5(t,r,e){return t>=k5(r,e)&&t<N5(r,e)}function s1(t,r,e){return r=Zo(r),e===void 0?(e=r,r=0):e=Zo(e),t=Ai(t),I5(t,r,e)}var P5="[object String]";function oa(t){return typeof t=="string"||!vt(t)&&vn(t)&&hi(t)==P5}function D5(t,r){return ni(r,function(e){return t[e]})}function zv(t){return t==null?[]:D5(t,pn(t))}var B5=Math.max;function hn(t,r,e,n){t=di(t)?t:zv(t),e=e&&!n?Oa(e):0;var i=t.length;return e<0&&(e=B5(i+e,0)),oa(t)?e<=i&&t.indexOf(r,e)>-1:!!i&&wv(t,r,e)>-1}function Zc(t,r,e){var n=t==null?0:t.length;if(!n)return-1;var i=0;return wv(t,r,i)}var F5=Math.min;function H5(t,r,e){for(var n=xv,i=t[0].length,a=t.length,o=a,s=Array(a),l=1/0,u=[];o--;){var h=t[o];o&&r&&(h=ni(h,ps(r))),l=F5(h.length,l),s[o]=i>=120&&h.length>=120?new lo(o&&h):void 0}h=t[0];var v=-1,p=s[0];e:for(;++v<i&&u.length<l;){var m=h[v],C=m;if(m=m!==0?m:0,!(p?yl(p,C):n(u,C))){for(o=a;--o;){var w=s[o];if(!(w?yl(w,C):n(t[o],C)))continue e}p&&p.push(C),u.push(m)}}return u}function z5(t){return Ni(t)?t:[]}var W5=Pa(function(t){var r=ni(t,z5);return r.length&&r[0]===t[0]?H5(r):[]});function G5(t,r){return r.length<2?t:Hl(t,Rv(r,0,-1))}var U5="[object Boolean]";function na(t){return t===!0||t===!1||vn(t)&&hi(t)==U5}var V5="[object Map]",X5="[object Set]",Y5=Object.prototype,$5=Y5.hasOwnProperty;function ke(t){if(t==null)return!0;if(di(t)&&(vt(t)||typeof t=="string"||typeof t.splice=="function"||as(t)||Gc(t)||is(t)))return!t.length;var r=so(t);if(r==V5||r==X5)return!t.size;if(Bl(t))return!Ev(t).length;for(var e in t)if($5.call(t,e))return!1;return!0}function tn(t,r){return qc(t,r)}var q5="[object Number]";function Wn(t){return typeof t=="number"||vn(t)&&hi(t)==q5}function nr(t){return t==null}function ww(t){return t===null}var K5="[object RegExp]";function Z5(t){return vn(t)&&hi(t)==K5}var l1=Aa&&Aa.isRegExp,j5=l1?ps(l1):Z5;function xw(t){return t===void 0}var bw=OP(function(t,r,e){return t+(e?" ":"")+r.toLowerCase()});function J5(t,r){return t<r}function Q5(t,r){var e={};return r=an(r),dw(t,function(n,i,a){Pl(e,r(n,i,a),n)}),e}function Wv(t,r,e){for(var n=-1,i=t.length;++n<i;){var a=t[n],o=r(a);if(o!=null&&(s===void 0?o===o&&!ao(o):e(o,s)))var s=o,l=a}return l}function uo(t){return t&&t.length?Wv(t,Ia,Cw):void 0}function Gv(t,r){return t&&t.length?Wv(t,an(r),Cw):void 0}function eD(t,r){for(var e,n=-1,i=t.length;++n<i;){var a=r(t[n]);a!==void 0&&(e=e===void 0?a:e+a)}return e}var Wl=Sv(function(t,r,e){Dv(t,r,e)});function Sw(t){return t&&t.length?Wv(t,Ia,J5):void 0}function Ew(t,r){return r=ms(r,t),t=G5(t,r),t==null||delete t[ys(mr(r))]}function tD(t){return Yc(t)?void 0:t}var rD=1,nD=2,iD=4,Tw=LC(function(t,r){var e={};if(t==null)return e;var n=!1;r=ni(r,function(a){return a=ms(a,t),n||(n=a.length>1),a}),mo(t,Av(t),e),n&&(e=Jo(e,rD|nD|iD,tD));for(var i=r.length;i--;)Ew(e,r[i]);return e});function _w(t,r,e,n){if(!Lr(t))return t;r=ms(r,t);for(var i=-1,a=r.length,o=a-1,s=t;s!=null&&++i<a;){var l=ys(r[i]),u=e;if(l==="__proto__"||l==="constructor"||l==="prototype")return t;if(i!=o){var h=s[l];u=void 0,u===void 0&&(u=Lr(h)?h:zc(r[i+1])?[]:{})}Wc(s,l,u),s=s[l]}return t}function Rw(t,r,e){for(var n=-1,i=r.length,a={};++n<i;){var o=r[n],s=Hl(t,o);e(s,o)&&_w(a,ms(o,t),s)}return a}function aD(t,r){if(t==null)return{};var e=ni(Av(t),function(n){return[n]});return r=an(r),Rw(t,e,function(n,i){return r(n,i[0])})}function oD(t,r){var e=t.length;for(t.sort(r);e--;)t[e]=t[e].value;return t}function sD(t,r){if(t!==r){var e=t!==void 0,n=t===null,i=t===t,a=ao(t),o=r!==void 0,s=r===null,l=r===r,u=ao(r);if(!s&&!u&&!a&&t>r||a&&o&&l&&!s&&!u||n&&o&&l||!e&&l||!i)return 1;if(!n&&!a&&!u&&t<r||u&&e&&i&&!n&&!a||s&&e&&i||!o&&i||!l)return-1}return 0}function lD(t,r,e){for(var n=-1,i=t.criteria,a=r.criteria,o=i.length,s=e.length;++n<o;){var l=sD(i[n],a[n]);if(l){if(n>=s)return l;var u=e[n];return l*(u=="desc"?-1:1)}}return t.index-r.index}function Lw(t,r,e){r.length?r=ni(r,function(a){return vt(a)?function(o){return Hl(o,a.length===1?a[0]:a)}:a}):r=[Ia];var n=-1;r=ni(r,ps(an));var i=yw(t,function(a,o,s){var l=ni(r,function(u){return u(a)});return{criteria:l,index:++n,value:a}});return oD(i,function(a,o){return lD(a,o,e)})}function uD(t,r,e,n){return t==null?[]:(vt(r)||(r=r==null?[]:[r]),e=e,vt(e)||(e=e==null?[]:[e]),Lw(t,r,e))}var cD=9007199254740991,fD=Math.floor;function hD(t,r){var e="";if(!t||r<1||r>cD)return e;do r%2&&(e+=t),r=fD(r/2),r&&(t+=t);while(r);return e}var dD=Iv("length"),Mw="\\ud800-\\udfff",vD="\\u0300-\\u036f",pD="\\ufe20-\\ufe2f",gD="\\u20d0-\\u20ff",mD=vD+pD+gD,yD="\\ufe0e\\ufe0f",CD="["+Mw+"]",yd="["+mD+"]",Cd="\\ud83c[\\udffb-\\udfff]",wD="(?:"+yd+"|"+Cd+")",Ow="[^"+Mw+"]",Aw="(?:\\ud83c[\\udde6-\\uddff]){2}",Nw="[\\ud800-\\udbff][\\udc00-\\udfff]",xD="\\u200d",kw=wD+"?",Iw="["+yD+"]?",bD="(?:"+xD+"(?:"+[Ow,Aw,Nw].join("|")+")"+Iw+kw+")*",SD=Iw+kw+bD,ED="(?:"+[Ow+yd+"?",yd,Aw,Nw,CD].join("|")+")",u1=RegExp(Cd+"(?="+Cd+")|"+ED+SD,"g");function TD(t){for(var r=u1.lastIndex=0;u1.test(t);)++r;return r}function _D(t){return Lv(t)?TD(t):dD(t)}function RD(t,r){return Rw(t,r,function(e,n){return os(t,n)})}var LD=LC(function(t,r){return t==null?{}:RD(t,r)}),MD=Math.ceil,OD=Math.max;function AD(t,r,e,n){for(var i=-1,a=OD(MD((r-t)/(e||1)),0),o=Array(a);a--;)o[++i]=t,t+=e;return o}function ND(t){return function(r,e,n){return n&&typeof n!="number"&&ns(r,e,n)&&(e=n=void 0),r=Zo(r),e===void 0?(e=r,r=0):e=Zo(e),n=n===void 0?r<e?1:-1:Zo(n),AD(r,e,n)}}var ll=ND();function kD(t,r,e,n,i){return i(t,function(a,o,s){e=n?(n=!1,a):r(e,a,o,s)}),e}function Pw(t,r,e){var n=vt(t)?DC:kD,i=arguments.length<3;return n(t,an(r),e,i,Co)}function ID(t,r,e){return r===void 0?r=1:r=Oa(r),hD(Pi(t),r)}function wd(t,r,e){return t==null?t:_w(t,r,e)}var PD="[object Map]",DD="[object Set]";function Wo(t){if(t==null)return 0;if(di(t))return oa(t)?_D(t):t.length;var r=so(t);return r==PD||r==DD?t.size:Ev(t).length}function BD(t,r,e){var n=t==null?0:t.length;return n?(e&&typeof e!="number"&&ns(t,r,e)?(r=0,e=n):(r=r==null?0:Oa(r),e=e===void 0?n:Oa(e)),Rv(t,r,e)):[]}function FD(t,r){var e;return Co(t,function(n,i,a){return e=r(n,i,a),!e}),!!e}function xd(t,r,e){var n=vt(t)?lw:FD;return n(t,an(r))}var Uv=Pa(function(t,r){if(t==null)return[];var e=r.length;return e>1&&ns(t,r[0],r[1])?r=[]:e>2&&ns(r[0],r[1],r[2])&&(r=[r[0]]),Lw(t,yo(r),[])}),HD=4294967295;function zD(t,r,e){return e&&typeof e!="number"&&ns(t,r,e)&&(r=e=void 0),e=e===void 0?HD:e>>>0,e?(t=Pi(t),t&&(typeof r=="string"||r!=null&&!j5(r))&&(r=Hc(r),!r&&Lv(t))?CI(GI(t),0,e):t.split(r,e)):[]}function co(t,r){return t&&t.length?eD(t,an(r)):0}var WD="Expected a function";function Dw(t,r,e){var n=!0,i=!0;if(typeof t!="function")throw new TypeError(WD);return Lr(e)&&(n="leading"in e?!!e.leading:n,i="trailing"in e?!!e.trailing:i),cc(t,r,{leading:n,maxWait:r,trailing:i})}function fc(t){return Pi(t).toUpperCase()}var GD=1/0,UD=jo&&1/kv(new jo([,-0]))[1]==GD?function(t){return new jo(t)}:TN,VD=200;function Bw(t,r,e){var n=-1,i=xv,a=t.length,o=!0,s=[],l=s;if(a>=VD){var u=r?null:UD(t);if(u)return kv(u);o=!1,i=yl,l=new lo}else l=r?[]:s;e:for(;++n<a;){var h=t[n],v=r?r(h):h;if(h=h!==0?h:0,o&&v===v){for(var p=l.length;p--;)if(l[p]===v)continue e;r&&l.push(v),s.push(h)}else i(l,v,e)||(l!==s&&l.push(v),s.push(h))}return s}var XD=Pa(function(t){var r=mr(t);return Ni(r)&&(r=void 0),Bw(yo(t,1,Ni,!0),an(r))});function wa(t){return t&&t.length?Bw(t):[]}function c1(t,r){return t==null?!0:Ew(t,r)}var YD=Math.max;function $D(t){if(!(t&&t.length))return[];var r=0;return t=Mv(t,function(e){if(Ni(e))return r=YD(e.length,r),!0}),bC(r,function(e){return ni(t,Iv(e))})}var Fw=Pa($D),qD={:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"",:"","":""},KD={:"Total",:"Total",:"(SUM)",:"items",:"selected",:"Index",:"Measure",:"Measure",:"Total",:"",:"Hide",:"Group ASC",:"Group DESC",:"ASC",:"DESC",:"No order","":", "},ZD="zh_CN",Hw=ZD,jD={zh_CN:qD,en_US:KD},JD=function(t){Hw=t},gr=function(t,r){return r===void 0&&(r=t),dt(jD,[Hw,t],r)},QD=0,eB=3,zw=3,wl=4,tB=5,rB=5,nB=1,iB=1,aB=2,oB=3,sB=4,lB="backGroundGroup",uB="foreGroundGroup",cB="panelGroup",fB="panelScrollGroup",f1="mergedCellsGroup",hB="frozenRowGroup",dB="frozenColGroup",vB="frozenTrailingRowGroup",pB="frozenTrailingColGroup",gB="frozenTopGroup",mB="frozenBottomGroup",ss="rowResizeAreaGroup",bd="rowFrozenResizeAreaGroup",hc="frozenSplitLine",h1="rowIndexResizeAreaGroup",Sd="cornerResizeAreaGroup",Ww="colResizeAreaGroup",Gw="colFrozenResizeAreaGroup",yB="colScrollGroup",CB="colFrozenGroup",wB="colFrozenTrailingGroup",xB="gridGroup",bB="rowScrollGroup",SB="rowHeaderFrozenGroup",Uw="horizontal-resize-area-",ls="-",Vw=16,EB=.5,Mh=50,us;(function(t){t.Line="line",t.Bar="bar",t.Bullet="bullet"})(us||(us={}));var jc=function(t){return t??gr("")},TB=function(){return gr("")},_B="antv-s2",dc="valueRanges",Vv={},Xw="#000000",Ed="#FFFFFF",RB={data:[],fields:{rows:[],columns:[],values:[],valueInCols:!0},meta:[],sortParams:[],filterParams:[]},Ji,cr;(function(t){t.ROW="row",t.COL="col",t.TRAILING_ROW="trailingRow",t.TRAILING_COL="trailingCol",t.SCROLL="scroll",t.TOP="top",t.BOTTOM="bottom"})(cr||(cr={}));var Bt;(function(t){t.FROZEN_COL="frozenCol",t.FROZEN_ROW="frozenRow",t.FROZEN_TRAILING_COL="frozenTrailingCol",t.FROZEN_TRAILING_ROW="frozenTrailingRow"})(Bt||(Bt={}));var d1=(Ji={},Ji[cr.ROW]="frozenRowGroup",Ji[cr.COL]="frozenColGroup",Ji[cr.TRAILING_COL]="frozenTrailingColGroup",Ji[cr.TRAILING_ROW]="frozenTrailingRowGroup",Ji[cr.SCROLL]="panelScrollGroup",Ji[cr.TOP]="frozenTopGroup",Ji[cr.BOTTOM]="frozenBottomGroup",Ji),jr;(function(t){t.CORNER_CELL_CLICK="cornerCellClick",t.DATA_CELL_CLICK="dataCellClick",t.MERGED_CELLS_CLICK="mergedCellsClick",t.ROW_COLUMN_CLICK="rowColumnClick",t.ROW_TEXT_CLICK="rowTextClick",t.HOVER="hover",t.DATA_CELL_BRUSH_SELECTION="dataCellBrushSelection",t.ROW_CELL_BRUSH_SELECTION="rowCellBrushSelection",t.COL_CELL_BRUSH_SELECTION="colCellBrushSelection",t.COL_ROW_RESIZE="rowColResize",t.DATA_CELL_MULTI_SELECTION="dataCellMultiSelection",t.RANGE_SELECTION="rangeSelection",t.SELECTED_CELL_MOVE="selectedCellMove"})(jr||(jr={}));var Xe;(function(t){t.ALL_SELECTED="allSelected",t.SELECTED="selected",t.ROW_CELL_BRUSH_SELECTED="rowCellBrushSelected",t.COL_CELL_BRUSH_SELECTED="colCellBrushSelected",t.DATA_CELL_BRUSH_SELECTED="dataCellBrushSelected",t.UNSELECTED="unselected",t.HOVER="hover",t.HOVER_FOCUS="hoverFocus",t.HIGHLIGHT="highlight",t.SEARCH_RESULT="searchResult",t.PREPARE_SELECT="prepareSelect"})(Xe||(Xe={}));var Le;(function(t){t.DATA_CELL="dataCell",t.ROW_CELL="rowCell",t.COL_CELL="colCell",t.SERIES_NUMBER_CELL="seriesNumberCell",t.CORNER_CELL="cornerCell",t.MERGED_CELL="mergedCell"})(Le||(Le={}));var Td=800,xn={textOpacity:"fillOpacity",backgroundOpacity:"fillOpacity",backgroundColor:"fill",borderOpacity:"strokeOpacity",borderColor:"stroke",borderWidth:"lineWidth",opacity:"opacity"},LB={textShape:["textOpacity"],textShapes:["textOpacity"],linkFieldShape:["opacity"],interactiveBgShape:["backgroundColor","backgroundOpacity"],interactiveBorderShape:["borderColor","borderOpacity","borderWidth"]},_d="interactionStateInfo",Hr;(function(t){t.CLICK="click",t.UN_DRAGGED="unDragged",t.DRAGGED="dragged"})(Hr||(Hr={}));var Ur;(function(t){t.SHIFT="Shift",t.COPY="c",t.ESC="Escape",t.META="Meta",t.CONTROL="Control",t.ARROW_UP="ArrowUp",t.ARROW_DOWN="ArrowDown",t.ARROW_LEFT="ArrowLeft",t.ARROW_RIGHT="ArrowRight"})(Ur||(Ur={}));var v1;(function(t){t.ASC="ASC",t.DESC="DESC"})(v1||(v1={}));var Qe;(function(t){t.HOVER="hover",t.CLICK="click",t.DATA_CELL_BRUSH_SELECTION="dataCellBrushSelection",t.ROW_CELL_BRUSH_SELECTION="rowCellBrushSelection",t.COL_CELL_BRUSH_SELECTION="colCellBrushSelection",t.MULTI_SELECTION="multiSelection",t.RESIZE="resize"})(Qe||(Qe={}));var p1={x:{value:0,scroll:!1},y:{value:0,scroll:!1}},vc;(function(t){t.CONTENT="content",t.CANVAS="canvas"})(vc||(vc={}));var br;(function(t){t.SCROLL_UP="scrollUp",t.SCROLL_DOWN="scrollDown"})(br||(br={}));var pc;(function(t){t[t.SCROLL_UP=-1]="SCROLL_UP",t[t.SCROLL_DOWN=1]="SCROLL_DOWN"})(pc||(pc={}));var MB="RESIZE_START_GUIDE_LINE",OB="RESIZE_END_GUIDE_LINE",AB="RESIZE_MASK",Yw=20,$w=20,zr;(function(t){t.Horizontal="col",t.Vertical="row"})(zr||(zr={}));var Qr;(function(t){t.Field="field",t.Cell="cell",t.Tree="tree",t.Series="series"})(Qr||(Qr={}));var bi;(function(t){t.ALL="all",t.CURRENT="current",t.SELECTED="selected"})(bi||(bi={}));var gc;(function(t){t.PC="pc",t.MOBILE="mobile"})(gc||(gc={}));var NB=1,Na;(function(t){t.Adaptive="adaptive",t.ColAdaptive="colAdaptive",t.Compact="compact"})(Na||(Na={}));var mc=1,g1=120,qs={wordWrap:!0,maxLines:1,textOverflow:"ellipsis"},kB={layoutWidthType:Na.Adaptive,seriesNumberCell:qs,cornerCell:qs,rowCell:Y(Y({},qs),{showTreeLeafNodeAlignDot:!1,widthByField:null,heightByField:null}),colCell:Y(Y({},qs),{height:30,widthByField:null,heightByField:null}),dataCell:Y(Y({},qs),{width:96,height:30})},IB={width:600,height:480,debug:!1,hierarchyType:"grid",device:gc.PC,conditions:{},totals:{},tooltip:{enable:!1,autoAdjustBoundary:"body",operation:{hiddenColumns:!1,sort:!1,menu:{items:[]}}},interaction:{copy:{enable:!0,withFormat:!0,withHeader:!1},linkFields:[],hiddenColumnFields:[],selectedCellsSpotlight:!1,hoverHighlight:!0,hoverFocus:{duration:Td},scrollSpeedRatio:{horizontal:1,vertical:1},autoResetSheetStyle:!0,brushSelection:{dataCell:!0,rowCell:!0,colCell:!0},multiSelection:!0,rangeSelection:!0,scrollbarPosition:vc.CONTENT,resize:{rowCellVertical:!0,cornerCellHorizontal:!0,colCellHorizontal:!0,colCellVertical:!0,rowResizeType:bi.CURRENT,colResizeType:bi.CURRENT,minCellWidth:Yw,minCellHeight:$w},eventListenerOptions:!1,selectedCellHighlight:!1,overscrollBehavior:"auto"},seriesNumber:{enable:!1},customSVGIcons:[],showDefaultHeaderActionIcon:!1,headerActionIcons:[],style:kB,frozen:{rowHeader:!0,rowCount:0,colCount:0,trailingRowCount:0,trailingColCount:0},hd:!0,cornerText:"",cornerExtraFieldText:"",placeholder:ls};function yc(t){"@babel/helpers - typeof";return yc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},yc(t)}var PB=/^\s+/,DB=/\s+$/;function $e(t,r){if(t=t||"",r=r||{},t instanceof $e)return t;if(!(this instanceof $e))return new $e(t,r);var e=BB(t);this._originalInput=t,this._r=e.r,this._g=e.g,this._b=e.b,this._a=e.a,this._roundA=Math.round(100*this._a)/100,this._format=r.format||e.format,this._gradientType=r.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=e.ok}$e.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var r=this.toRgb();return(r.r*299+r.g*587+r.b*114)/1e3},getLuminance:function(){var r=this.toRgb(),e,n,i,a,o,s;return e=r.r/255,n=r.g/255,i=r.b/255,e<=.03928?a=e/12.92:a=Math.pow((e+.055)/1.055,2.4),n<=.03928?o=n/12.92:o=Math.pow((n+.055)/1.055,2.4),i<=.03928?s=i/12.92:s=Math.pow((i+.055)/1.055,2.4),.2126*a+.7152*o+.0722*s},setAlpha:function(r){return this._a=qw(r),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var r=y1(this._r,this._g,this._b);return{h:r.h*360,s:r.s,v:r.v,a:this._a}},toHsvString:function(){var r=y1(this._r,this._g,this._b),e=Math.round(r.h*360),n=Math.round(r.s*100),i=Math.round(r.v*100);return this._a==1?"hsv("+e+", "+n+"%, "+i+"%)":"hsva("+e+", "+n+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var r=m1(this._r,this._g,this._b);return{h:r.h*360,s:r.s,l:r.l,a:this._a}},toHslString:function(){var r=m1(this._r,this._g,this._b),e=Math.round(r.h*360),n=Math.round(r.s*100),i=Math.round(r.l*100);return this._a==1?"hsl("+e+", "+n+"%, "+i+"%)":"hsla("+e+", "+n+"%, "+i+"%, "+this._roundA+")"},toHex:function(r){return C1(this._r,this._g,this._b,r)},toHexString:function(r){return"#"+this.toHex(r)},toHex8:function(r){return WB(this._r,this._g,this._b,this._a,r)},toHex8String:function(r){return"#"+this.toHex8(r)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Ut(this._r,255)*100)+"%",g:Math.round(Ut(this._g,255)*100)+"%",b:Math.round(Ut(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Ut(this._r,255)*100)+"%, "+Math.round(Ut(this._g,255)*100)+"%, "+Math.round(Ut(this._b,255)*100)+"%)":"rgba("+Math.round(Ut(this._r,255)*100)+"%, "+Math.round(Ut(this._g,255)*100)+"%, "+Math.round(Ut(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:QB[C1(this._r,this._g,this._b,!0)]||!1},toFilter:function(r){var e="#"+w1(this._r,this._g,this._b,this._a),n=e,i=this._gradientType?"GradientType = 1, ":"";if(r){var a=$e(r);n="#"+w1(a._r,a._g,a._b,a._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+e+",endColorstr="+n+")"},toString:function(r){var e=!!r;r=r||this._format;var n=!1,i=this._a<1&&this._a>=0,a=!e&&i&&(r==="hex"||r==="hex6"||r==="hex3"||r==="hex4"||r==="hex8"||r==="name");return a?r==="name"&&this._a===0?this.toName():this.toRgbString():(r==="rgb"&&(n=this.toRgbString()),r==="prgb"&&(n=this.toPercentageRgbString()),(r==="hex"||r==="hex6")&&(n=this.toHexString()),r==="hex3"&&(n=this.toHexString(!0)),r==="hex4"&&(n=this.toHex8String(!0)),r==="hex8"&&(n=this.toHex8String()),r==="name"&&(n=this.toName()),r==="hsl"&&(n=this.toHslString()),r==="hsv"&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return $e(this.toString())},_applyModification:function(r,e){var n=r.apply(null,[this].concat([].slice.call(e)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(XB,arguments)},brighten:function(){return this._applyModification(YB,arguments)},darken:function(){return this._applyModification($B,arguments)},desaturate:function(){return this._applyModification(GB,arguments)},saturate:function(){return this._applyModification(UB,arguments)},greyscale:function(){return this._applyModification(VB,arguments)},spin:function(){return this._applyModification(qB,arguments)},_applyCombination:function(r,e){return r.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(jB,arguments)},complement:function(){return this._applyCombination(KB,arguments)},monochromatic:function(){return this._applyCombination(JB,arguments)},splitcomplement:function(){return this._applyCombination(ZB,arguments)},triad:function(){return this._applyCombination(x1,[3])},tetrad:function(){return this._applyCombination(x1,[4])}};$e.fromRatio=function(t,r){if(yc(t)=="object"){var e={};for(var n in t)t.hasOwnProperty(n)&&(n==="a"?e[n]=t[n]:e[n]=el(t[n]));t=e}return $e(t,r)};function BB(t){var r={r:0,g:0,b:0},e=1,n=null,i=null,a=null,o=!1,s=!1;return typeof t=="string"&&(t=n6(t)),yc(t)=="object"&&(Qi(t.r)&&Qi(t.g)&&Qi(t.b)?(r=FB(t.r,t.g,t.b),o=!0,s=String(t.r).substr(-1)==="%"?"prgb":"rgb"):Qi(t.h)&&Qi(t.s)&&Qi(t.v)?(n=el(t.s),i=el(t.v),r=zB(t.h,n,i),o=!0,s="hsv"):Qi(t.h)&&Qi(t.s)&&Qi(t.l)&&(n=el(t.s),a=el(t.l),r=HB(t.h,n,a),o=!0,s="hsl"),t.hasOwnProperty("a")&&(e=t.a)),e=qw(e),{ok:o,format:t.format||s,r:Math.min(255,Math.max(r.r,0)),g:Math.min(255,Math.max(r.g,0)),b:Math.min(255,Math.max(r.b,0)),a:e}}function FB(t,r,e){return{r:Ut(t,255)*255,g:Ut(r,255)*255,b:Ut(e,255)*255}}function m1(t,r,e){t=Ut(t,255),r=Ut(r,255),e=Ut(e,255);var n=Math.max(t,r,e),i=Math.min(t,r,e),a,o,s=(n+i)/2;if(n==i)a=o=0;else{var l=n-i;switch(o=s>.5?l/(2-n-i):l/(n+i),n){case t:a=(r-e)/l+(r<e?6:0);break;case r:a=(e-t)/l+2;break;case e:a=(t-r)/l+4;break}a/=6}return{h:a,s:o,l:s}}function HB(t,r,e){var n,i,a;t=Ut(t,360),r=Ut(r,100),e=Ut(e,100);function o(u,h,v){return v<0&&(v+=1),v>1&&(v-=1),v<1/6?u+(h-u)*6*v:v<1/2?h:v<2/3?u+(h-u)*(2/3-v)*6:u}if(r===0)n=i=a=e;else{var s=e<.5?e*(1+r):e+r-e*r,l=2*e-s;n=o(l,s,t+1/3),i=o(l,s,t),a=o(l,s,t-1/3)}return{r:n*255,g:i*255,b:a*255}}function y1(t,r,e){t=Ut(t,255),r=Ut(r,255),e=Ut(e,255);var n=Math.max(t,r,e),i=Math.min(t,r,e),a,o,s=n,l=n-i;if(o=n===0?0:l/n,n==i)a=0;else{switch(n){case t:a=(r-e)/l+(r<e?6:0);break;case r:a=(e-t)/l+2;break;case e:a=(t-r)/l+4;break}a/=6}return{h:a,s:o,v:s}}function zB(t,r,e){t=Ut(t,360)*6,r=Ut(r,100),e=Ut(e,100);var n=Math.floor(t),i=t-n,a=e*(1-r),o=e*(1-i*r),s=e*(1-(1-i)*r),l=n%6,u=[e,o,a,a,s,e][l],h=[s,e,e,o,a,a][l],v=[a,a,s,e,e,o][l];return{r:u*255,g:h*255,b:v*255}}function C1(t,r,e,n){var i=[ti(Math.round(t).toString(16)),ti(Math.round(r).toString(16)),ti(Math.round(e).toString(16))];return n&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function WB(t,r,e,n,i){var a=[ti(Math.round(t).toString(16)),ti(Math.round(r).toString(16)),ti(Math.round(e).toString(16)),ti(Kw(n))];return i&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)&&a[3].charAt(0)==a[3].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0)+a[3].charAt(0):a.join("")}function w1(t,r,e,n){var i=[ti(Kw(n)),ti(Math.round(t).toString(16)),ti(Math.round(r).toString(16)),ti(Math.round(e).toString(16))];return i.join("")}$e.equals=function(t,r){return!t||!r?!1:$e(t).toRgbString()==$e(r).toRgbString()};$e.random=function(){return $e.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function GB(t,r){r=r===0?0:r||10;var e=$e(t).toHsl();return e.s-=r/100,e.s=Jc(e.s),$e(e)}function UB(t,r){r=r===0?0:r||10;var e=$e(t).toHsl();return e.s+=r/100,e.s=Jc(e.s),$e(e)}function VB(t){return $e(t).desaturate(100)}function XB(t,r){r=r===0?0:r||10;var e=$e(t).toHsl();return e.l+=r/100,e.l=Jc(e.l),$e(e)}function YB(t,r){r=r===0?0:r||10;var e=$e(t).toRgb();return e.r=Math.max(0,Math.min(255,e.r-Math.round(255*-(r/100)))),e.g=Math.max(0,Math.min(255,e.g-Math.round(255*-(r/100)))),e.b=Math.max(0,Math.min(255,e.b-Math.round(255*-(r/100)))),$e(e)}function $B(t,r){r=r===0?0:r||10;var e=$e(t).toHsl();return e.l-=r/100,e.l=Jc(e.l),$e(e)}function qB(t,r){var e=$e(t).toHsl(),n=(e.h+r)%360;return e.h=n<0?360+n:n,$e(e)}function KB(t){var r=$e(t).toHsl();return r.h=(r.h+180)%360,$e(r)}function x1(t,r){if(isNaN(r)||r<=0)throw new Error("Argument to polyad must be a positive number");for(var e=$e(t).toHsl(),n=[$e(t)],i=360/r,a=1;a<r;a++)n.push($e({h:(e.h+a*i)%360,s:e.s,l:e.l}));return n}function ZB(t){var r=$e(t).toHsl(),e=r.h;return[$e(t),$e({h:(e+72)%360,s:r.s,l:r.l}),$e({h:(e+216)%360,s:r.s,l:r.l})]}function jB(t,r,e){r=r||6,e=e||30;var n=$e(t).toHsl(),i=360/e,a=[$e(t)];for(n.h=(n.h-(i*r>>1)+720)%360;--r;)n.h=(n.h+i)%360,a.push($e(n));return a}function JB(t,r){r=r||6;for(var e=$e(t).toHsv(),n=e.h,i=e.s,a=e.v,o=[],s=1/r;r--;)o.push($e({h:n,s:i,v:a})),a=(a+s)%1;return o}$e.mix=function(t,r,e){e=e===0?0:e||50;var n=$e(t).toRgb(),i=$e(r).toRgb(),a=e/100,o={r:(i.r-n.r)*a+n.r,g:(i.g-n.g)*a+n.g,b:(i.b-n.b)*a+n.b,a:(i.a-n.a)*a+n.a};return $e(o)};$e.readability=function(t,r){var e=$e(t),n=$e(r);return(Math.max(e.getLuminance(),n.getLuminance())+.05)/(Math.min(e.getLuminance(),n.getLuminance())+.05)};$e.isReadable=function(t,r,e){var n=$e.readability(t,r),i,a;switch(a=!1,i=i6(e),i.level+i.size){case"AAsmall":case"AAAlarge":a=n>=4.5;break;case"AAlarge":a=n>=3;break;case"AAAsmall":a=n>=7;break}return a};$e.mostReadable=function(t,r,e){var n=null,i=0,a,o,s,l;e=e||{},o=e.includeFallbackColors,s=e.level,l=e.size;for(var u=0;u<r.length;u++)a=$e.readability(t,r[u]),a>i&&(i=a,n=$e(r[u]));return $e.isReadable(t,n,{level:s,size:l})||!o?n:(e.includeFallbackColors=!1,$e.mostReadable(t,["#fff","#000"],e))};var Rd=$e.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},QB=$e.hexNames=e6(Rd);function e6(t){var r={};for(var e in t)t.hasOwnProperty(e)&&(r[t[e]]=e);return r}function qw(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Ut(t,r){t6(t)&&(t="100%");var e=r6(t);return t=Math.min(r,Math.max(0,parseFloat(t))),e&&(t=parseInt(t*r,10)/100),Math.abs(t-r)<1e-6?1:t%r/parseFloat(r)}function Jc(t){return Math.min(1,Math.max(0,t))}function Cn(t){return parseInt(t,16)}function t6(t){return typeof t=="string"&&t.indexOf(".")!=-1&&parseFloat(t)===1}function r6(t){return typeof t=="string"&&t.indexOf("%")!=-1}function ti(t){return t.length==1?"0"+t:""+t}function el(t){return t<=1&&(t=t*100+"%"),t}function Kw(t){return Math.round(parseFloat(t)*255).toString(16)}function b1(t){return Cn(t)/255}var jn=function(){var t="[-\\+]?\\d+%?",r="[-\\+]?\\d*\\.\\d+%?",e="(?:"+r+")|(?:"+t+")",n="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?",i="[\\s|\\(]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")[,|\\s]+("+e+")\\s*\\)?";return{CSS_UNIT:new RegExp(e),rgb:new RegExp("rgb"+n),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+n),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+n),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Qi(t){return!!jn.CSS_UNIT.exec(t)}function n6(t){t=t.replace(PB,"").replace(DB,"").toLowerCase();var r=!1;if(Rd[t])t=Rd[t],r=!0;else if(t=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var e;return(e=jn.rgb.exec(t))?{r:e[1],g:e[2],b:e[3]}:(e=jn.rgba.exec(t))?{r:e[1],g:e[2],b:e[3],a:e[4]}:(e=jn.hsl.exec(t))?{h:e[1],s:e[2],l:e[3]}:(e=jn.hsla.exec(t))?{h:e[1],s:e[2],l:e[3],a:e[4]}:(e=jn.hsv.exec(t))?{h:e[1],s:e[2],v:e[3]}:(e=jn.hsva.exec(t))?{h:e[1],s:e[2],v:e[3],a:e[4]}:(e=jn.hex8.exec(t))?{r:Cn(e[1]),g:Cn(e[2]),b:Cn(e[3]),a:b1(e[4]),format:r?"name":"hex8"}:(e=jn.hex6.exec(t))?{r:Cn(e[1]),g:Cn(e[2]),b:Cn(e[3]),format:r?"name":"hex"}:(e=jn.hex4.exec(t))?{r:Cn(e[1]+""+e[1]),g:Cn(e[2]+""+e[2]),b:Cn(e[3]+""+e[3]),a:b1(e[4]+""+e[4]),format:r?"name":"hex8"}:(e=jn.hex3.exec(t))?{r:Cn(e[1]+""+e[1]),g:Cn(e[2]+""+e[2]),b:Cn(e[3]+""+e[3]),format:r?"name":"hex"}:!1}function i6(t){var r,e;return t=t||{level:"AA",size:"small"},r=(t.level||"AA").toUpperCase(),e=(t.size||"small").toLowerCase(),r!=="AA"&&r!=="AAA"&&(r="AA"),e!=="small"&&e!=="large"&&(e="small"),{level:r,size:e}}var a6="#FFFFFF",o6="#000000",s6=[95,85,75,30,15,0,15,30,45,60,80],l6=15,Zw=function(t){return $e(t).getLuminance()<=.5},u6=[{fontColorIndex:0,bgColorIndex:3},{fontColorIndex:13,bgColorIndex:8},{fontColorIndex:14,bgColorIndex:1}],c6=function(t){for(var r=[],e=0;e<11;e++){var n=s6[e];r.push(fc(n===0?t:$e.mix(t,e<5?a6:o6,n).toHexString()))}return r},Xv=function(t){t===void 0&&(t={});var r=Array.from(Array(l6)).fill(Ed),e=t.basicColorRelations,n=e===void 0?[]:e,i=t.brandColor,a=c6(i);return n.forEach(function(o){r[o.basicColorIndex]=a[o.standardColorIndex]}),u6.forEach(function(o){var s=o.fontColorIndex,l=o.bgColorIndex;r[s]=Zw(r[l])?Ed:Xw}),Y(Y({},t),{basicColors:r})},f6={brandColor:"#3471F9",semanticColors:{red:"#FF4D4F",green:"#29A294",yellow:"#FAAD14"},others:{highlight:"#87B5FF",results:"#F0F7FF"},basicColorRelations:[{basicColorIndex:1,standardColorIndex:0},{basicColorIndex:2,standardColorIndex:1},{basicColorIndex:3,standardColorIndex:5},{basicColorIndex:4,standardColorIndex:6},{basicColorIndex:5,standardColorIndex:6},{basicColorIndex:6,standardColorIndex:6},{basicColorIndex:7,standardColorIndex:5},{basicColorIndex:9,standardColorIndex:1},{basicColorIndex:10,standardColorIndex:4},{basicColorIndex:11,standardColorIndex:4},{basicColorIndex:12,standardColorIndex:5}]},h6=Xv(f6),d6={brandColor:"#326EF4",semanticColors:{red:"#FF4D4F",green:"#29A294",yellow:"#FAAD14"},others:{highlight:"#87B5FF",results:"#F0F7FF"},basicColorRelations:[{basicColorIndex:1,standardColorIndex:0},{basicColorIndex:2,standardColorIndex:1},{basicColorIndex:3,standardColorIndex:1},{basicColorIndex:4,standardColorIndex:2},{basicColorIndex:5,standardColorIndex:7},{basicColorIndex:6,standardColorIndex:5},{basicColorIndex:7,standardColorIndex:5},{basicColorIndex:9,standardColorIndex:1},{basicColorIndex:10,standardColorIndex:2},{basicColorIndex:11,standardColorIndex:5},{basicColorIndex:12,standardColorIndex:5}]},v6=Xv(d6),p6={brandColor:"#9DA7B6",semanticColors:{red:"#FF4D4F",green:"#29A294",yellow:"#FAAD14"},others:{highlight:"#87B5FF",results:"#F0F7FF"},basicColorRelations:[{basicColorIndex:1,standardColorIndex:0},{basicColorIndex:2,standardColorIndex:1},{basicColorIndex:3,standardColorIndex:1},{basicColorIndex:4,standardColorIndex:2},{basicColorIndex:5,standardColorIndex:7},{basicColorIndex:6,standardColorIndex:8},{basicColorIndex:7,standardColorIndex:5},{basicColorIndex:9,standardColorIndex:1},{basicColorIndex:10,standardColorIndex:2},{basicColorIndex:11,standardColorIndex:3},{basicColorIndex:12,standardColorIndex:3}]},g6=Xv(p6),m6={brandColor:"#255dff",semanticColors:{red:"#FF4D4F",green:"#29A294",yellow:"#FAAD14"},basicColors:["#ffffff","#151a27","#213f94","#133aad","#213f94","#255dff","#4b91ff","#4b91ff","#191919","#1e2436","#0647b1","#7899ff","#7899ff","#f0f0f0","#dcdcdc"],basicColorRelations:[]},y6={default:v6,colorful:h6,gray:g6,dark:m6},Zn="Roboto, PingFangSC, Microsoft YaHei, Arial, sans-serif",C6=12,w6="antv-s2-core-vars",x6={default:"light",colorful:"light",gray:"light",dark:"dark"},b6="".concat(_B,"-tooltip"),Yv="".concat(b6,"-container"),S6="".concat(Yv,"-show"),E6="".concat(Yv,"-hide"),S1={x:15,y:10},T6=function(){return{key:"hiddenColumns",label:gr(""),icon:"EyeOutlined"}},_6=function(){return[{key:"asc",icon:"groupAsc",label:gr("")},{key:"desc",icon:"groupDesc",label:gr("")},{key:"none",label:gr("")}]},R6=function(){return[{key:"asc",icon:"groupAsc",label:gr("")},{key:"desc",icon:"groupDesc",label:gr("")},{key:"none",label:gr("")}]},E1;(function(t){t[t.ALL=0]="ALL",t[t.COL=1]="COL",t[t.ROW=2]="ROW"})(E1||(E1={}));var L6=`\r
`,$v="	",jw=5e3,Ld=1,ul="root",rn="[&]",ki;(function(t){t.All="all",t.DetailOnly="detailOnly"})(ki||(ki={}));var M6="Transform Data",O6="Header Layout",A6="Data Cell Render",Li=function(){function t(){var r=this;this.debug=!1,this.debugCallback=function(e,n){if(r.debug){var i=performance.now();n();var a=performance.now();console.log(e,"".concat(a-i," ms"))}else n()},this.logger=function(e){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];r.debug&&console.log.apply(console,pe([e],te(n),!1))}}return t.getInstance=function(){return t.instance||(t.instance=new t),t.instance},t.prototype.setDebug=function(r){this.debug=r},t}(),N6=`
<svg width="10px" height="10px" viewBox="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" font-family="Roboto, PingFangSC, BlinkMacSystemFont, Microsoft YaHei, Arial, sans-serif" font-size="12" font-weight="bold">
    <text id="" fill="#29A294">
        <tspan x="-0.225097656" y="8.5"></tspan>
    </text>
</g>
</svg>`,k6=`<svg width="10px" height="10px" viewBox="0 0 10 10" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" font-family="Roboto, PingFangSC, BlinkMacSystemFont, Microsoft YaHei, Arial, sans-serif" font-size="12" font-weight="bold">
    <text id="" fill="#FF4D4F">
        <tspan x="-0.225097656" y="8.5"></tspan>
    </text>
</g>
</svg>
`,I6=`<?xml version="1.0" encoding="UTF-8"?>
<svg width="7px" height="9px" viewBox="0 0 7 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <!-- Generator: Sketch 58 (84663) - https://sketch.com -->
    <title>down</title>
    <desc>Created with Sketch.</desc>
    <g id="" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <polygon id="down" fill="#58AE57" transform="translate(3.500000, 4.500000) scale(1, -1) translate(-3.500000, -4.500000) " points="3.5 0 7 9 0 9"></polygon>
    </g>
</svg>`,P6=`<?xml version="1.0" encoding="UTF-8"?>
<svg width="7px" height="9px" viewBox="0 0 7 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <!-- Generator: Sketch 58 (84663) - https://sketch.com -->
    <title>up</title>
    <desc>Created with Sketch.</desc>
    <g id="" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <polygon id="up" fill="#F46649" points="3.5 0 7 9 0 9"></polygon>
    </g>
</svg> `,D6=`<svg t="1557124621626" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
xmlns="http://www.w3.org/2000/svg" p-id="17452"
xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14">
<defs>
  <style type="text/css"></style>
</defs>
<path d="M182.272 167.04a8 8 0 0 0-12.544 0L57.728 309.056A8 8 0 0 0 64 321.984h76.032v530.048c0 4.352 3.584 7.936 7.936 7.936h56.064a8 8 0 0 0 7.936-7.936V321.92H288a8 8 0 0 0 6.272-12.992l-112-141.888z m209.728 626.944h176c4.416 0 8 3.584 8 8v56a8 8 0 0 1-8 8h-176A8 8 0 0 1 384 857.984v-56c0-4.416 3.584-8 8-8z m0-424h368c4.416 0 8 3.648 8 8v56a8 8 0 0 1-8 8h-368A8 8 0 0 1 384 433.984v-56c0-4.352 3.584-8 8-8z m528-139.968h-528A8 8 0 0 1 384 222.016v-56c0-4.416 3.584-8 8-8h528c4.416 0 8 3.584 8 8v56a8 8 0 0 1-8 8z m-256 424h-272A8 8 0 0 1 384 646.016v-56c0-4.416 3.584-8 8-8h272c4.416 0 8 3.584 8 8v56a8 8 0 0 1-8 8z" p-id="17453"></path>
</svg>`,B6=`<svg t="1557124685600" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" p-id="17561"
  xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path d="M182.272 856.96a8 8 0 0 1-12.544 0l-112-141.952A8 8 0 0 1 64 702.08h76.032V172.032c0-4.416 3.584-8 7.936-8h56.064c4.352 0 7.936 3.584 7.936 8v529.984H288c6.72 0 10.496 7.808 6.272 12.992l-112 141.888z m209.728-626.944h176A8 8 0 0 0 576 222.016v-56a8 8 0 0 0-8-8h-176A8 8 0 0 0 384 166.016v56c0 4.416 3.584 8 8 8z m0 424h368a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8h-368A8 8 0 0 0 384 590.016v56c0 4.416 3.584 8 8 8z m528 139.968h-528a8 8 0 0 0-8 8v56c0 4.416 3.584 8 8 8h528a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z m-256-424h-272A8 8 0 0 0 384 377.984v56c0 4.416 3.584 8 8 8h272a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z" p-id="17562"></path>
</svg>`,F6=`<svg t="1557124695786" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" p-id="17670"
  xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path d="M182.272 167.04a8 8 0 0 0-12.544 0L57.728 309.056A8 8 0 0 0 64 321.984h76.032v530.048c0 4.352 3.584 7.936 7.936 7.936h56.064a8 8 0 0 0 7.936-7.936V321.92H288a8 8 0 0 0 6.272-12.992l-112-141.888z m209.728 62.976h304A8 8 0 0 0 704 222.016v-56a8 8 0 0 0-8-8h-304A8 8 0 0 0 384 166.016v56c0 4.416 3.584 8 8 8z m0 424h304a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8h-304A8 8 0 0 0 384 590.016v56c0 4.416 3.584 8 8 8z m528 139.968h-528a8 8 0 0 0-8 8v56c0 4.416 3.584 8 8 8h528a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z m0-424h-528A8 8 0 0 0 384 377.984v56c0 4.416 3.584 8 8 8h528a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z" p-id="17671"></path>
</svg>`,H6=`<svg t="1557124710652" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
  xmlns="http://www.w3.org/2000/svg" p-id="17779"
  xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path d="M182.272 856.96a8 8 0 0 1-12.544 0l-112-141.952A8 8 0 0 1 64 702.08h76.032V172.032c0-4.416 3.584-8 7.936-8h56.064c4.352 0 7.936 3.584 7.936 8v529.984H288c6.72 0 10.496 7.808 6.272 12.992l-112 141.888z m209.728-626.944h304A8 8 0 0 0 704 222.016v-56a8 8 0 0 0-8-8h-304A8 8 0 0 0 384 166.016v56c0 4.416 3.584 8 8 8z m0 424h304a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8h-304A8 8 0 0 0 384 590.016v56c0 4.416 3.584 8 8 8z m528 139.968h-528a8 8 0 0 0-8 8v56c0 4.416 3.584 8 8 8h528a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z m0-424h-528A8 8 0 0 0 384 377.984v56c0 4.416 3.584 8 8 8h528a8 8 0 0 0 8-8v-56a8 8 0 0 0-8-8z" p-id="17780"></path>
</svg>`,z6=`<svg width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="" stroke="none" stroke-width="1" fill-opacity="0.25" fill-rule="evenodd">
    <g id="--" transform="translate(-3275.000000, -724.000000)" fill-rule="nonzero">
        <g id="-39" transform="translate(3064.500000, 667.000000)">
            <g id="-36" transform="translate(80.500000, 44.000000)">
                <g id="" transform="translate(130.000000, 13.000000)">
                    <path d="M12.0009375,12.40625 C12.0696875,12.40625 12.1259375,12.4625 12.1259375,12.53125 L12.1259375,12.53125 L12.1259375,13.40625 C12.1259375,13.475 12.0696875,13.53125 12.0009375,13.53125 L12.0009375,13.53125 L6.25093747,13.53125 C6.18218747,13.53125 6.12593747,13.475 6.12593747,13.40625 L6.12593747,13.40625 L6.12593747,12.53125 C6.12593747,12.4625 6.18218747,12.40625 6.25093747,12.40625 L6.25093747,12.40625 Z M2.93949997,2.5801875 L2.97437497,2.6109375 L4.72437497,4.828125 C4.78062497,4.89776786 4.74503823,4.99725765 4.66779698,5.02426203 L4.62593747,5.03125 L3.438,5.03089062 L3.43843747,10.9691406 L4.62593747,10.9691406 C4.73062497,10.9691406 4.78999997,11.0910156 4.72437497,11.1722656 L2.97437497,13.3894531 C2.92437497,13.4535156 2.82749997,13.4535156 2.77749997,13.3894531 L1.02749997,11.1722656 C0.961874969,11.0894531 1.02124997,10.9691406 1.12593747,10.9691406 L2.31343747,10.9691406 L2.313,5.03089062 L1.12593747,5.03125 C1.03620533,5.03125 0.979764,4.94285714 1.00679571,4.8654519 L1.02749997,4.828125 L2.77749997,2.6109375 C2.81749997,2.5596875 2.88749997,2.5494375 2.93949997,2.5801875 Z M10.5009375,9.09375 C10.5696875,9.09375 10.6259375,9.15 10.6259375,9.21875 L10.6259375,9.21875 L10.6259375,10.09375 C10.6259375,10.1625 10.5696875,10.21875 10.5009375,10.21875 L10.5009375,10.21875 L6.25093747,10.21875 C6.18218747,10.21875 6.12593747,10.1625 6.12593747,10.09375 L6.12593747,10.09375 L6.12593747,9.21875 C6.12593747,9.15 6.18218747,9.09375 6.25093747,9.09375 L6.25093747,9.09375 Z M14.5009375,5.78125 C14.5696875,5.78125 14.6259375,5.8375 14.6259375,5.90625 L14.6259375,5.90625 L14.6259375,6.78125 C14.6259375,6.85 14.5696875,6.90625 14.5009375,6.90625 L14.5009375,6.90625 L6.25093747,6.90625 C6.18218747,6.90625 6.12593747,6.85 6.12593747,6.78125 L6.12593747,6.78125 L6.12593747,5.90625 C6.12593747,5.8375 6.18218747,5.78125 6.25093747,5.78125 L6.25093747,5.78125 Z M9.00093747,2.46875 C9.06968747,2.46875 9.12593747,2.525 9.12593747,2.59375 L9.12593747,2.59375 L9.12593747,3.46875 C9.12593747,3.5375 9.06968747,3.59375 9.00093747,3.59375 L9.00093747,3.59375 L6.25093747,3.59375 C6.18218747,3.59375 6.12593747,3.5375 6.12593747,3.46875 L6.12593747,3.46875 L6.12593747,2.59375 C6.12593747,2.525 6.18218747,2.46875 6.25093747,2.46875 L6.25093747,2.46875 Z" id=""></path>
                </g>
            </g>
        </g>
    </g>q
</g>
</svg>`,W6='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1590389330617" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="19656" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><defs><style type="text/css"></style></defs><path d="M512 64c-247.4 0-448 200.6-448 448s200.6 448 448 448 448-200.6 448-448-200.6-448-448-448z m0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" fill="" p-id="19657"></path><path d="M464 336c0 26.5 21.5 48 48 48s48-21.5 48-48-21.5-48-48-48-48 21.5-48 48zM536 448h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-272c0-4.4-3.6-8-8-8z" fill="" p-id="19658"></path></svg>',G6=`<?xml version="1.0" encoding="UTF-8"?>
<svg width="23px" height="12px" viewBox="0 0 23 12" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    <title> 8 3</title>
    <g id="----" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="" transform="translate(-275.000000, -824.000000)">
            <rect fill="#FFFFFF" x="0" y="0" width="1333" height="1167"></rect>
            <g id="-8-3" transform="translate(275.000000, 824.000000)">
                <rect id="" stroke-opacity="0.25" stroke="#000000" fill="#F7F7F7" x="0.5" y="0.5" width="11" height="11"></rect>
                <rect id="-9" stroke-opacity="0.25" stroke="#000000" fill="#F7F7F7" x="11.5" y="0.5" width="11" height="11"></rect>
                <g id="7.Icon/arrow/15.down/fill" transform="translate(6.000000, 6.000000) rotate(90.000000) translate(-6.000000, -6.000000) " fill="#000000" fill-rule="nonzero" opacity="0.65">
                    <path d="M7.25020811,6.37218077 L4.91348936,8.20968077 C4.82677061,8.27764952 4.69903624,8.21671202 4.69903624,8.10655577 L4.69903624,4.43272764 C4.69903624,4.32257139 4.82677061,4.26046202 4.91348936,4.32960264 L7.25020811,6.16593077 C7.31700499,6.21866514 7.31700499,6.31944639 7.25020811,6.37218077 Z" id="fill" transform="translate(5.999671, 6.269385) rotate(90.000000) translate(-5.999671, -6.269385) "></path>
                </g>
                <g id="7.Icon/arrow/15.down/fill" transform="translate(17.000000, 6.000000) rotate(270.000000) translate(-17.000000, -6.000000) translate(11.000000, 0.000000)" fill="#000000" fill-rule="nonzero" opacity="0.65">
                    <path d="M7.25020811,6.37218077 L4.91348936,8.20968077 C4.82677061,8.27764952 4.69903624,8.21671202 4.69903624,8.10655577 L4.69903624,4.43272764 C4.69903624,4.32257139 4.82677061,4.26046202 4.91348936,4.32960264 L7.25020811,6.16593077 C7.31700499,6.21866514 7.31700499,6.31944639 7.25020811,6.37218077 Z" id="fill" transform="translate(5.999671, 6.269385) rotate(90.000000) translate(-5.999671, -6.269385) "></path>
                </g>
            </g>
            <line x1="286.5" y1="813" x2="286.5" y2="864.5" id="-2-3" stroke="#000000" opacity="0.25"></line>
        </g>
    </g>
</svg>`,U6=`<svg t="1557140120188" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
xmlns="http://www.w3.org/2000/svg" p-id="16909" xmlns:xlink="http://www.w3.org/1999/xlink"
width="200" height="200">
	<defs>
		<style type="text/css">
		</style>
	</defs>
	<path d="M328 544h368c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"
	p-id="16910">
	</path>
	<path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32z m-40 728H184V184h656v656z"
	p-id="16911">
	</path>
</svg>`,V6=`<svg t="1557140186692" class="icon" style="" viewBox="0 0 1024 1024" version="1.1"
xmlns="http://www.w3.org/2000/svg" p-id="17025" xmlns:xlink="http://www.w3.org/1999/xlink"
width="200" height="200">
	<defs>
		<style type="text/css">
		</style>
	</defs>
	<path d="M328 544h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"
	p-id="17026">
	</path>
	<path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32z m-40 728H184V184h656v656z"
	p-id="17027">
	</path>
</svg>`,X6=`<svg t="1565940955886" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
     p-id="17472" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path
    d="M948 392.992l-403.008 488.99200001Q532 896 512.992 896t-32-14.016L76 392.992q-18.016-20.992-7.008-46.016T108 321.98400001L916 321.98400001q28 0 39.008 24.99199999T948 392.992z"
    p-id="17473" data-spm-anchor-id="a313x.7781069.0.i2" class="selected"></path>
</svg>
`,Y6=`<svg t="1565940955886" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
     p-id="17472" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path
    fill-opacity="0.45"
    d="M948 392.992l-403.008 488.99200001Q532 896 512.992 896t-32-14.016L76 392.992q-18.016-20.992-7.008-46.016T108 321.98400001L916 321.98400001q28 0 39.008 24.99199999T948 392.992z"
    p-id="17473" data-spm-anchor-id="a313x.7781069.0.i2" class="selected"></path>
</svg>
`,$6=`<svg t="1565940979768" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
p-id="17620" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">
<defs>
<style type="text/css"></style>
</defs>
<path
d="M76 631.008l403.008-488.99200001Q492 128 511.008 128t32 14.016L948 631.008q18.016 20.992 7.008 46.016T916 702.01599999L108 702.01599999q-28 0-39.008-24.99199999T76 631.008z"
p-id="17621"></path>
</svg>
`,q6=`<svg t="1565940979768" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg"
     p-id="17620" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200">
  <defs>
    <style type="text/css"></style>
  </defs>
  <path
    fill-opacity="0.45"
    d="M76 631.008l403.008-488.99200001Q492 128 511.008 128t32 14.016L948 631.008q18.016 20.992 7.008 46.016T916 702.01599999L108 702.01599999q-28 0-39.008-24.99199999T76 631.008z"
    p-id="17621"></path>
</svg>
`,K6='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1596433821690" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="20229" width="16" height="16" xmlns:xlink="http://www.w3.org/1999/xlink"><defs><style type="text/css"></style></defs><path d="M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM305.8 637.7c3.1 3.1 8.1 3.1 11.3 0l138.3-137.6L583 628.5c3.1 3.1 8.2 3.1 11.3 0l275.4-275.3c3.1-3.1 3.1-8.2 0-11.3l-39.6-39.6c-3.1-3.1-8.2-3.1-11.3 0l-230 229.9L461.4 404c-3.1-3.1-8.2-3.1-11.3 0L266.3 586.7c-3.1 3.1-3.1 8.2 0 11.3l39.5 39.7z" p-id="20230"></path></svg>',Z6=`<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1608030723688" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="21482" xmlns:xlink="http://www.w3.org/1999/xlink" width="16" height="16"><defs><style type="text/css"></style></defs><path d="M547.648 696a32 32 0 0 1 31.488 26.24l0.512 5.76v151.68l145.216-144.512a32 32 0 0 1 40.832-3.648l4.416 3.712a32 32 0 0 1 3.584 40.832l-3.712 4.48-203.072 202.24a32 32 0 0 1-40.768 3.648l-4.416-3.712-202.24-202.24a32 32 0 0 1 40.832-48.96l4.416 3.712 150.912 150.912v-158.144a32 32 0 0 1 32-32z m194.56-529.28l4.928 3.072 233.792 180.224a32 32 0 0 1 1.728 49.28l-4.864 3.52-409.792 245.568a32 32 0 0 1-27.328 2.624l-5.184-2.432-422.4-245.568a32 32 0 0 1-7.552-49.28l4.544-4.032 242.816-180.288a32 32 0 0 1 42.432 47.552l-4.288 3.84-203.84 151.296 364.16 211.648 353.28-211.712-196.608-151.552a32 32 0 0 1-8.896-40l3.136-4.864a32 32 0 0 1 40-8.96zM547.712 28.672a32 32 0 0 1 31.488 26.24l0.512 5.76v396.992a32 32 0 0 1-63.488 5.76l-0.512-5.76V60.736a32 32 0 0 1 32-32z" p-id="21483" fill="currentColor"></path></svg>
`,j6='<svg viewBox="64 64 896 896" focusable="false" data-icon="eye" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258c161.3 0 279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766zm-4-430c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"></path></svg>',T1=Object.freeze({__proto__:null,ArrowDown:N6,ArrowUp:k6,CellDown:I6,CellUp:P6,DrillDownIcon:Z6,ExpandColIcon:G6,EyeOutlined:j6,GlobalAsc:D6,GlobalDesc:B6,GroupAsc:F6,GroupDesc:H6,GroupNone:z6,InfoCircle:W6,Minus:U6,Plus:V6,SortDown:Y6,SortDownSelected:X6,SortUp:q6,SortUpSelected:$6,Trend:K6}),Jw={},Qw=function(t,r){Jw[bw(t)]=r},J6=function(t){return Jw[bw(t)]};pn(T1).forEach(function(t){var r=dt(T1,t);Qw(t,r)});var ex=function(t){Me(r,t);function r(e,n){var i=t.call(this,n)||this;return i.imgType=e,i}return r}(sC),cs=function(t){Me(r,t);function r(e,n){var i=t.call(this,e)||this;return i.appendInfo=n,i}return r}(Zt),_1="<svg",R1="data:image/svg+xml",L1={},qv=function(t){Me(r,t);function r(e){var n=t.call(this,{name:e.name})||this;return n.isOnlineLink=function(i){return/^(?:https?:)?(?:\/\/)/.test(i)},n.cfg=e,n.render(),n}return r.prototype.getCfg=function(){return this.cfg},r.prototype.getImage=function(e,n,i){var a=this;return new Promise(function(o,s){var l=J6(e);if(l){var u=new Image;u.onload=function(){L1[n]=u,o(u)},u.onerror=s,l&&(l.includes(R1)||a.isOnlineLink(l))?(u.src=l,u.crossOrigin="anonymous"):(i&&(l=l.replace(/fill=[\'\"]#?\w+[\'\"]/g,""),l=l.replace(/fill>/g,">")),l=l.replace(_1,"".concat(_1,' fill="').concat(i,'"')),u.src="".concat(R1,";utf-8,").concat(encodeURIComponent(l)))}})},r.prototype.render=function(){var e=this.cfg,n=e.name,i=e.fill,a=$c(this.cfg),o=new ex(r.type,{style:Tw(a,"fill")});this.iconImageShape=o,this.setImageAttrs({name:n,fill:i})},r.prototype.setImageAttrs=function(e){var n=this,i=e.name,a=e.fill,o=this.iconImageShape;i=i||this.cfg.name,a=a||this.cfg.fill;var s="".concat(i,"-").concat(a),l=L1[s];l?(o.attr("img",l),this.appendChild(o)):this.getImage(i,s,a).then(function(u){if(n.destroyed){Li.getInstance().logger("GuiIcon ".concat(i," destroyed."));return}o.attr("img",u),n.appendChild(o)}).catch(function(u){if(u instanceof TypeError){console.warn("GuiIcon ".concat(i," destroyed:"),u);return}console.error("GuiIcon ".concat(i," load failed:"),u)})},r.type="__GUI_ICON__",r}(Ft),At;(function(t){t.TOP="TOP",t.BOTTOM="BOTTOM",t.LEFT="LEFT",t.RIGHT="RIGHT"})(At||(At={}));var Qt;(function(t){t.BORDER_BOX="borderBox",t.PADDING_BOX="paddingBox",t.CONTENT_BOX="contentBox"})(Qt||(Qt={}));var Go;(function(t){t.SUM="SUM",t.MIN="MIN",t.MAX="MAX",t.AVG="AVG"})(Go||(Go={}));var en;(function(t){t.Row="row",t.Col="col",t.Series="series"})(en||(en={}));var Er;(function(t){t.PLAIN="text/plain",t.HTML="text/html"})(Er||(Er={}));var Q6=function(){function t(){this.store=new Map}return t.prototype.set=function(r,e){return this.store.set(r,e)},t.prototype.get=function(r,e){var n,i=this.store.get(r);return(n=i)!==null&&n!==void 0?n:e},t.prototype.clear=function(){this.store.clear()},t.prototype.size=function(){return this.store.size},t}();function tr(t){return t===gc.MOBILE?!0:/(?:iPhone|iPad|SymbianOS|Windows Phone|iPod|iOS|Android)/i.test(navigator.userAgent)}function tx(){return/windows/i.test(navigator.userAgent)}var eF=`:root {
  --antv-s2-background: #000;
  --antv-s2-tooltip-background: rgba(43, 43, 43, 0.95);
  --antv-s2-tooltip-operator-background: rgba(43, 43, 43, 0.95);
}
`,tF=eF,rF=function(t,r){r===void 0&&(r="");var e=document.getElementById(t);return e||(e=document.createElement("style"),e.id=t,document.head.appendChild(e)),e.innerHTML=r,e},nF=function(t){var r=t||"default";return y6[r]},iF=function(t){rF(w6,t==="dark"?tF:"")},aF=function(t){var r,e,n,i,a,o=(t==null?void 0:t.palette)||nF(t==null?void 0:t.name),s=o.basicColors,l=o.semanticColors,u=o.others,h=(r=t==null?void 0:t.spreadsheet)===null||r===void 0?void 0:r.isTableMode(),v=tx()?"bold":700,p=function(){var m,C;return{bolderText:{fontFamily:Zn,fontSize:12,fontWeight:v,fill:s[13],opacity:1,textAlign:"right",textBaseline:"middle",linkTextFill:s[6]},text:{fontFamily:Zn,fontSize:12,fontWeight:"normal",fill:s[13],opacity:1,textAlign:"right",textBaseline:"middle",linkTextFill:s[6]},cell:{crossBackgroundColor:s[1],backgroundColor:s[8],backgroundColorOpacity:1,horizontalBorderColor:s[9],horizontalBorderColorOpacity:1,verticalBorderColor:s[9],verticalBorderColorOpacity:1,horizontalBorderWidth:1,verticalBorderWidth:1,padding:{top:8,right:8,bottom:8,left:8},interactionState:{hover:{backgroundColor:s[2],backgroundOpacity:.6},hoverFocus:{backgroundColor:s[2],backgroundOpacity:.6,borderColor:s[14],borderWidth:1,borderOpacity:1},selected:{backgroundColor:s[2],backgroundOpacity:.6},unselected:{backgroundOpacity:.3,textOpacity:.3,opacity:.3},searchResult:{backgroundColor:(m=u==null?void 0:u.results)!==null&&m!==void 0?m:s[2],backgroundOpacity:1},highlight:{backgroundColor:(C=u==null?void 0:u.highlight)!==null&&C!==void 0?C:s[6],backgroundOpacity:1},prepareSelect:{borderColor:s[14],borderOpacity:1,borderWidth:1}}},miniChart:{line:{point:{size:2.2,fill:s[6],opacity:1},linkLine:{size:1.5,fill:s[6],opacity:.6}},bar:{intervalPadding:4,fill:s[6],opacity:1},bullet:{progressBar:{widthPercent:.6,height:10,innerHeight:6},comparativeMeasure:{width:1,height:12,fill:s[13],opacity:.25},rangeColors:{good:l==null?void 0:l.green,satisfactory:l.yellow,bad:l.red},backgroundColor:"#E9E9E9"},interval:{height:C6,fill:s[7]}},icon:{fill:s[13],size:10,margin:{right:4,left:4}}}};return{cornerCell:{text:{fontFamily:Zn,fontSize:12,fontWeight:v,fill:s[0],opacity:1,textAlign:h?"center":"left",textBaseline:"middle"},bolderText:{fontFamily:Zn,fontSize:12,fontWeight:v,fill:s[0],opacity:1,textAlign:h?"center":"right",textBaseline:"middle"},cell:{backgroundColor:s[3],backgroundColorOpacity:1,horizontalBorderColor:s[10],horizontalBorderColorOpacity:1,verticalBorderColor:s[10],verticalBorderColorOpacity:1,horizontalBorderWidth:1,verticalBorderWidth:1,borderDash:[],padding:{top:4,right:8,bottom:4,left:8}},icon:{fill:s[0],size:10,margin:{right:4,left:4}}},rowCell:{seriesText:{fontFamily:Zn,fontSize:12,fontWeight:"normal",fill:s[14],linkTextFill:s[6],opacity:1,textBaseline:"middle",textAlign:"center"},measureText:{fontFamily:Zn,fontSize:12,fontWeight:"normal",fill:s[14],linkTextFill:s[6],opacity:1,textAlign:h?"center":"left",textBaseline:"middle"},bolderText:{fontFamily:Zn,fontSize:12,fontWeight:v,fill:s[14],linkTextFill:s[6],opacity:1,textAlign:h?"center":"left",textBaseline:"middle"},text:{fontFamily:Zn,fontSize:12,fontWeight:"normal",fill:s[14],linkTextFill:s[6],opacity:1,textBaseline:"middle",textAlign:h?"center":"left"},cell:{backgroundColor:s[1],backgroundColorOpacity:1,horizontalBorderColor:s[9],horizontalBorderColorOpacity:1,verticalBorderColor:s[9],verticalBorderColorOpacity:1,horizontalBorderWidth:1,verticalBorderWidth:1,borderDash:[],padding:{top:4,right:8,bottom:4,left:8},interactionState:{hover:{backgroundColor:s[2],backgroundOpacity:.6},selected:{backgroundColor:s[2],backgroundOpacity:.6},unselected:{backgroundOpacity:.3,textOpacity:.3,opacity:.3},prepareSelect:{borderColor:s[14],borderOpacity:1,borderWidth:1},searchResult:{backgroundColor:(e=u==null?void 0:u.results)!==null&&e!==void 0?e:s[2],backgroundOpacity:1},highlight:{backgroundColor:(n=u==null?void 0:u.highlight)!==null&&n!==void 0?n:s[6],backgroundOpacity:1}}},icon:{fill:s[14],size:10,margin:{right:4,left:4}},seriesNumberWidth:80},colCell:{measureText:{fontFamily:Zn,fontSize:12,fontWeight:"normal",fill:s[0],opacity:1,textAlign:"right",textBaseline:"middle"},bolderText:{fontFamily:Zn,fontSize:12,fontWeight:v,fill:s[0],opacity:1,textAlign:"center",textBaseline:"middle"},text:{fontFamily:Zn,fontSize:12,fontWeight:"normal",fill:s[0],opacity:1,textAlign:"center",textBaseline:"middle"},cell:{backgroundColor:s[3],backgroundColorOpacity:1,horizontalBorderColor:s[10],horizontalBorderColorOpacity:1,verticalBorderColor:s[10],verticalBorderColorOpacity:1,horizontalBorderWidth:1,verticalBorderWidth:1,borderDash:[],padding:{top:4,right:8,bottom:4,left:8},interactionState:{hover:{backgroundColor:s[4],backgroundOpacity:.6},selected:{backgroundColor:s[4],backgroundOpacity:.6},unselected:{backgroundOpacity:.3,textOpacity:.3,opacity:.3},prepareSelect:{borderColor:s[14],borderOpacity:1,borderWidth:1},searchResult:{backgroundColor:(i=u==null?void 0:u.results)!==null&&i!==void 0?i:s[2],backgroundOpacity:1},highlight:{backgroundColor:(a=u==null?void 0:u.highlight)!==null&&a!==void 0?a:s[6],backgroundOpacity:1}}},icon:{fill:s[0],size:10,margin:{top:6,right:4,bottom:6,left:4}}},dataCell:p(),mergedCell:p(),resizeArea:{size:3,background:s[7],backgroundOpacity:0,guideLineColor:s[7],guideLineDisableColor:"rgba(0,0,0,0.25)",guideLineDash:[3,3],interactionState:{hover:{backgroundColor:s[7],backgroundOpacity:1}}},scrollBar:{trackColor:"rgba(0,0,0,0.01)",thumbHoverColor:"rgba(0,0,0,0.25)",thumbColor:"rgba(0,0,0,0.15)",thumbHorizontalMinSize:32,thumbVerticalMinSize:32,size:tr()?3:6,hoverSize:tr()?4:8,lineCap:"round"},splitLine:{horizontalBorderColor:s[12],horizontalBorderColorOpacity:.2,horizontalBorderWidth:2,verticalBorderColor:s[11],verticalBorderColorOpacity:.25,verticalBorderWidth:2,showShadow:!0,shadowWidth:8,shadowColors:{left:"rgba(0,0,0,0.1)",right:"rgba(0,0,0,0)"},borderDash:[]},prepareSelectMask:{backgroundColor:s[5],backgroundOpacity:.3},background:{color:s[8],opacity:1}}},pr=function(){function t(r){this.x=0,this.y=0,this.width=0,this.height=0,this.colIndex=-1,this.level=0,this.isLeaf=!1,this.children=[],this.padding=0;var e=r.id,n=r.field,i=r.value,a=r.parent,o=r.level,s=r.rowIndex,l=r.isTotals,u=r.isGrandTotals,h=r.isSubTotals,v=r.isCollapsed,p=r.isTotalRoot,m=r.hierarchy,C=r.isPivotMode,w=r.seriesNumberWidth,b=r.spreadsheet,E=r.query,R=r.belongsCell,M=r.inCollapseNode,k=r.isTotalMeasure,L=r.isLeaf,_=r.extra;this.id=e,this.field=n,this.value=i,this.parent=a,this.level=o,this.rowIndex=s,this.isTotals=l,this.isCollapsed=v,this.hierarchy=m,this.isPivotMode=C,this.seriesNumberWidth=w,this.spreadsheet=b,this.query=E,this.inCollapseNode=M,this.isTotalMeasure=k,this.isLeaf=L,this.isGrandTotals=u,this.isSubTotals=h,this.belongsCell=R,this.isTotalRoot=p,this.extra=_}return t.getFieldPath=function(r,e){if(r&&!r.isTotals||r&&e){for(var n=r.parent,i=[r.field];n&&n.id!==ul;)i.push(n.field),n=n.parent;return i.reverse()}return[]},t.getAllLeaveNodes=function(r){var e=[];if(r.isLeaf)return[r];for(var n=pe([],te(r.children||[]),!1),i=n.shift();i;)i.isLeaf?e.push(i):n.unshift.apply(n,pe([],te(i.children),!1)),i=n.shift();return e},t.getAllChildrenNodes=function(r){var e=[];if(r.isLeaf)return[r];for(var n=pe([],te(r.children||[]),!1),i=n.shift();i;)e.push(i),n.unshift.apply(n,pe([],te(i.children),!1)),i=n.shift();return e},t.getBranchNodes=function(r){if(r&&!r.isTotals){for(var e=r.parent,n=[r];e&&e.id!==ul;)n.push(e),e=e.parent;return n.reverse()}return[]},t.blankNode=function(){return new t({id:"",field:"",value:""})},t.rootNode=function(){return new t({id:ul,field:"",value:""})},t.prototype.getHeadLeafChild=function(){for(var r=this;!ke(r==null?void 0:r.children);)r=Kc(r==null?void 0:r.children);return r},t.prototype.getTotalHeightForTreeHierarchy=function(){return this.height===0||ke(this.children)?this.height:this.children.reduce(function(r,e){return r+e.getTotalHeightForTreeHierarchy()},this.height)},t.prototype.isSeriesNumberNode=function(){return this.field===Rn},t}(),rx=function(){function t(){this.width=0,this.height=0,this.maxLevel=-1,this.sampleNodesForAllLevels=[],this.sampleNodeForLastLevel=null,this.allNodesWithoutRoot=[],this.indexNode=[]}return t.prototype.getLeaves=function(){return this.allNodesWithoutRoot.filter(function(r){return r.isLeaf})},t.prototype.getNodes=function(r){return r!==void 0?this.allNodesWithoutRoot.filter(function(e){return e.level===r}):this.allNodesWithoutRoot},t.prototype.getNodesLessThanLevel=function(r){return this.allNodesWithoutRoot.filter(function(e){return e.level<=r})},t.prototype.pushNode=function(r,e){e===void 0&&(e=-1),e===-1?this.allNodesWithoutRoot.push(r):this.allNodesWithoutRoot.splice(e,0,r)},t.prototype.pushIndexNode=function(r){this.indexNode.push(r)},t.prototype.getIndexNodes=function(){return this.indexNode},t}(),fs=function(){function t(r){var e=r.label,n=r.isSubTotals,i=r.isGrandTotals,a=r.isTotalRoot,o=a===void 0?!1:a;this.label=e,this.isSubTotals=n,this.isGrandTotals=i,this.isTotalRoot=o}return t}(),oF=function(t){var r,e=t.isFirstField,n=t.currentField,i=t.fieldValues,a=t.spreadsheet,o=t.lastField,s=a.getTotalsConfig(e?n:o),l,u;e?s!=null&&s.showGrandTotals&&(l=s.reverseGrandTotalsLayout?"unshift":"push",u=new fs({label:s.grandTotalsLabel,isSubTotals:!1,isGrandTotals:!0,isTotalRoot:!0})):s!=null&&s.showSubTotals&&(Wo(i)>1||dt(s,"showSubTotals.always")!==!1)&&n!==it&&(l=s.reverseSubTotalsLayout?"unshift":"push",u=new fs({label:s.subTotalsLabel,isSubTotals:!0,isGrandTotals:!1,isTotalRoot:!0})),l&&((r=i[l])===null||r===void 0||r.call(i,u))};function Md(t,r){for(var e={},n=t;n&&n.field;)(!n.isTotalRoot||r)&&n.value!==Il&&(e[n.field]=n.value),n=n.parent;return e}var Yu=function(t){var r,e,n,i,a=t.spreadsheet,o=t.level,s=t.fields,l=a.options,u=a.dataSet,h=u.moreThanOneValue(),v=(e=(r=a.dataCfg.fields)===null||r===void 0?void 0:r.valueInCols)!==null&&e!==void 0?e:!0,p=((i=(n=l==null?void 0:l.style)===null||n===void 0?void 0:n.colCell)===null||i===void 0?void 0:i.hideValue)&&v&&!h&&hn(s,it),m=p?2:1;return o===s.length-m},nx=function(t,r,e,n){return t.options.layoutArrange?t.options.layoutArrange(t,e,n,r):r},Kv=function(t,r,e,n){var i,a,o,s,l=(i=t==null?void 0:t.facet)===null||i===void 0?void 0:i.getHiddenColumnsInfo(e);if(l&&(!((s=(o=(a=t==null?void 0:t.dataSet)===null||a===void 0?void 0:a.fields)===null||o===void 0?void 0:o.columns)===null||s===void 0)&&s.find(function(E){return E===(e==null?void 0:e.field)})))return!1;var u=!0,h=function(E,R,M){R===void 0&&(R=-1),M===void 0&&(M=-1),R===-1?(r.children.push(E),n.pushNode(E)):(r.children.splice(R,0,E),n.pushNode(E,M))};if(t.options.layoutHierarchy){var v=t.options.layoutHierarchy(t,e);if(v){var p=na(v==null?void 0:v.delete)?v==null?void 0:v.delete:!1;u=!p;var m=v.push,C=v.unshift,w=r.children.length,b=n.getNodes().length;ke(C)||(tt(C,function(E){h(E)}),w=r.children.length,b=n.getNodes().length),ke(m)||tt(m,function(E){h(E)}),p||h(e,w,b)}else h(e)}else h(e);return u},Od=function(t,r,e){var n,i;!((n=t.options)===null||n===void 0)&&n.layoutCoordinate&&(r!=null&&r.isLeaf||e!=null&&e.isLeaf)&&((i=t.options)===null||i===void 0||i.layoutCoordinate(t,r,e))},ix=function(){function t(r){this.label=r}return t}(),sF=function(t,r,e){return t.sort(function(n,i){var a=r.indexOf(n),o=r.indexOf(i);return a===-1&&o===-1?0:a===-1?1:o===-1?-1:a-o})},Zv=function(t){return t===void 0&&(t=[]),t.filter(function(r){return r!==la&&r!==mv})},lF=function(t,r){var e;return(e=t==null?void 0:t.filter(function(n){return!(r!=null&&r.includes(n))}))===null||e===void 0?void 0:e.concat(r)};function uF(t,r){var e=t.isRowTotal,n=t.isRowSubTotal,i=t.isColTotal,a=t.isColSubTotal,o=r||{},s=o.row,l=o.col,u=s||{},h=u.calcGrandTotals,v=h===void 0?{}:h,p=u.calcSubTotals,m=p===void 0?{}:p,C=l||{},w=C.calcGrandTotals,b=w===void 0?{}:w,E=C.calcSubTotals,R=E===void 0?{}:E,M=function(k,L){if((k.aggregation||k.calcFunc)&&L)return{aggregation:k.aggregation,calcFunc:k.calcFunc}};return M(b,i)||M(R,a)||M(v,e)||M(m,n)}var ax=function(t){var r=t.addTotalMeasureInTotal,e=t.parentNode,n=t.currentField,i=t.fields,a=t.hierarchy,o=t.spreadsheet,s=i.indexOf(n),l=o.dataSet,u=l.fields.values,h=u===void 0?[]:u,v=[],p={},m=o.getTotalsConfig(n),C=e.isGrandTotals?m.grandTotalsGroupDimensions:m.subTotalsGroupDimensions;if(C!=null&&C.includes(n)){p=Md(e);var w=l.getDimensionValues(n,p);v.push.apply(v,pe([],te((w||[]).map(function(E){return new fs({label:E,isSubTotals:e.isSubTotals,isGrandTotals:e.isGrandTotals,isTotalRoot:!1})})),!1)),ke(v)&&n&&v.push(Il)}else if(r&&n===it)p=Md(e),v.push.apply(v,pe([],te(h.map(function(E){return new ix(E)})),!1));else if(Yu({spreadsheet:o,level:s,fields:i})){e.isLeaf=!0,a.pushIndexNode(e),e.rowIndex=a.getIndexNodes().length-1;return}else{ax(Y(Y({},t),{currentField:i[s+1]}));return}var b=Zv(v);jv(Y(Y({},t),{fieldValues:b,level:s,parentNode:e,query:p}))},cF=function(t){var r=t.parentNode,e=t.currentField,n=t.fields,i=t.spreadsheet,a=i.dataSet,o=a.fields.values,s=o===void 0?[]:o,l=n.indexOf(e),u=[],h={};h=Md(r,!0);var v=a.getDimensionValues(e,h),p=nx(i,v,r,e);u.push.apply(u,pe([],te(p||[]),!1)),ke(u)&&e&&(e===it?u.push.apply(u,pe([],te(s),!1)):u.push(Il)),oF({currentField:e,lastField:n[l-1],isFirstField:l===0,fieldValues:u,spreadsheet:i});var m=Zv(u);jv(Y(Y({},t),{fieldValues:m,level:l,parentNode:r,query:h}))},ox=function(t){t.parentNode.isTotals?ax(t):cF(t)},xl=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.map(function(e){return xw(e)?zA:ww(e)?HA:String(e)}).join(rn)},jv=function(t){var r,e,n,i,a,o,s,l,u,h,v=t.currentField,p=t.fields,m=t.fieldValues,C=t.hierarchy,w=t.parentNode,b=t.level,E=t.query,R=t.addMeasureInTotalQuery,M=t.addTotalMeasureInTotal,k=t.spreadsheet,L=k.isTableMode();try{for(var _=Wr(m.entries()),I=_.next();!I.done;I=_.next()){var P=te(I.value,2),U=P[0],q=P[1],Q=q instanceof fs,J=q instanceof ix,re=void 0,ne=void 0,ce=!1,me=!1,oe=!1,Se=!1,Te=v;if(Q){var Ie=q;me=Ie.isGrandTotals,oe=Ie.isSubTotals,Se=Ie.isTotalRoot,re=gr(q.label),Se?ne=E:ne=Y(Y({},E),(n={},n[v]=re,n)),R&&(ne[it]=(s=k==null?void 0:k.dataSet)===null||s===void 0?void 0:s.fields.values[0]),ce=Yu({spreadsheet:k,level:b,fields:p})}else J?(re=gr(q.label),ne=Y(Y({},E),(i={},i[it]=re,i)),Te=it,me=w.isGrandTotals,oe=w.isSubTotals,ce=Yu({spreadsheet:k,level:b,fields:p})):L?(re=q,Te=p[U],ne=Y(Y({},E),(a={},a[Te]=re,a)),ce=!0):(re=q,ne=re===Il?Y({},E):Y(Y({},E),(o={},o[v]=re,o)),ce=Yu({spreadsheet:k,level:b,fields:p}));var je=L?Te:re,Be=xl(w.id,je);if(!Be)return;var rt=!1,ut=new pr({id:Be,value:re,level:b,field:Te,parent:w,isTotals:Q||J,isGrandTotals:me,isSubTotals:oe,isTotalMeasure:J,isCollapsed:rt,isTotalRoot:Se,hierarchy:C,query:ne,spreadsheet:k,isLeaf:ce||rt}),St=Kv(k,w,ut,C),st=(l=k==null?void 0:k.facet)===null||l===void 0?void 0:l.getHiddenColumnsInfo(ut);b>C.maxLevel&&!me&&!w.isGrandTotals&&!w.isSubTotals&&!ut.isSubTotals&&(C.sampleNodesForAllLevels.push(ut),C.maxLevel=b,C.sampleNodeForLastLevel=st?((u=st==null?void 0:st.displaySiblingNode)===null||u===void 0?void 0:u.next)||((h=st==null?void 0:st.displaySiblingNode)===null||h===void 0?void 0:h.prev):ut);var fr=ce||rt||!St;fr?(ut.isLeaf=!0,C.pushIndexNode(ut),ut.rowIndex=C.getIndexNodes().length-1):ox({addTotalMeasureInTotal:M,addMeasureInTotalQuery:R,parentNode:ut,currentField:p[b+1],fields:p,hierarchy:C,spreadsheet:k})}}catch(Pr){r={error:Pr}}finally{try{I&&!I.done&&(e=_.return)&&e.call(_)}finally{if(r)throw r.error}}},fF=function(t){var r,e=t.spreadsheet,n=t.rootNode,i=t.fields,a=t.hierarchy,o=e.dataSet.fields.columns,s=o===void 0?[]:o,l=(r=e.options.seriesNumber)!==null&&r!==void 0?r:{},u=l.enable,h=l.text,v=jc(h),p=s.map(function(m){return m===Rn?v:e.dataSet.getFieldName(m)});u&&!i.includes(Rn)&&(i.unshift(Rn),p.unshift(v)),jv({spreadsheet:e,currentField:i[0],fields:i,fieldValues:p,hierarchy:a,parentNode:n,level:0,query:{},addMeasureInTotalQuery:!1,addTotalMeasureInTotal:!1})},Uo=function(t){return Number.parseFloat((Ai(t)||0).toPrecision(Vw))},hF=function(t){try{return JSON.parse(t)}catch{return null}},bl=function(t,r,e){if(e===void 0&&(e=0),!Object.values(t).find(function(o){return o>0}))return t;var n=Y({},t);n.colCount>=r&&(n.colCount=r);var i=r-n.colCount;n.trailingColCount>i&&(n.trailingColCount=i),n.rowCount>=e&&(n.rowCount=e);var a=e-n.rowCount;return n.trailingRowCount>a&&(n.trailingRowCount=a),n},dF=function(t){Me(r,t);function r(e,n){var i=t.call(this,e)||this;return i.appendInfo=n,i}return r}(dv);function La(t,r){return t==null?void 0:t.appendChild(new Zt({style:r}))}function vF(t,r){return t==null?void 0:t.appendChild(new hv({style:r}))}function pF(t,r){return t==null?void 0:t.appendChild(new lC({style:r}))}function sx(t,r){return t==null?void 0:t.appendChild(new oC({style:r}))}function gF(t){var r=t.group,e=t.textShape,n=t.style,i=t.appendInfo;return e&&r&&r.contains(e)&&r.removeChild(e),r==null?void 0:r.appendChild(new dF({style:Y({fontVariant:"normal",fontStyle:"normal",lineWidth:1},n)},i||{}))}function _r(t,r){return t==null?void 0:t.appendChild(new zo({style:Y({zIndex:100},r)}))}function Hn(t,r,e){if(!ke(t)){var n=vt(t)?t:[t];n.forEach(function(i){var a;(a=i==null?void 0:i.style)===null||a===void 0||a.setProperty(r,e)})}}function Gl(t,r){var e=new qv(r);return t==null||t.appendChild(e),e}function lx(t){var r=t.group,e=t.iconCfg,n=t.isCollapsed,i=t.onClick,a=Gl(r,Y(Y({},e),{name:n?"Plus":"Minus",cursor:"pointer"}));return ui(i)&&a.addEventListener("click",i),a}var mF=function(t,r){return r===void 0&&(r="right"),t.map(function(e){return typeof e=="string"?{name:e,position:r}:e})},yF=function(t){return t===void 0&&(t=[]),t.map(function(r){return Y(Y({},r),{icons:mF(r.icons)})})},CF=function(t,r,e){if(!t)return!1;var n=t.icons,i=t.displayCondition,a=t.belongsCell;return ke(n)||a!==e?!1:n.some(function(o){var s,l,u;return(u=(l=(s=o.displayCondition)===null||s===void 0?void 0:s.call(o,r,o.name))!==null&&l!==void 0?l:i==null?void 0:i(r,o.name))!==null&&u!==void 0?u:!0})},Jv=function(t,r,e){t===void 0&&(t=[]);var n=yF(t),i=Rr(n,function(o){return CF(o,r,e)});if(i){var a=i.icons.filter(function(o){var s,l,u,h;return(h=(l=(s=o.displayCondition)===null||s===void 0?void 0:s.call(o,r,o.name))!==null&&l!==void 0?l:(u=i.displayCondition)===null||u===void 0?void 0:u.call(i,r,o.name))!==null&&h!==void 0?h:!0});return Y(Y({},i),{icons:a})}},cl=function(t,r){if(t===void 0&&(t=[]),ke(t))return 0;var e=r.margin,n=r.size;return t.reduce(function(i,a){var o=a.position;return i+n+(o==="left"?e.right:e.left)},0)},ux=function(t,r){t===void 0&&(t=[]);var e=Wl({left:[],right:[]},Hv(t,"position"));return r&&(r.position==="left"?e.left.push(r):e.right.unshift(r)),e},cx=function(t,r){var e=t.value,n=t.field;return tn(n,it)?{formattedValue:r||e,value:e}:{formattedValue:e,value:e}},Sl=function(t,r){var e=t.y,n=t.height;switch(r){case"top":return e;case"middle":return e+n/2;default:return e+n}},Ul=function(t,r,e,n){var i=(e-t)/2;switch(n){case"top":return r+i;case"middle":return r-t/2;default:return r-i-t}},Cs=function(t){var r=t.bbox,e=t.textWidth,n=t.textAlign,i=t.groupedIcons,a=t.iconStyle,o=r.x,s=r.width,l=cl(i.left,a),u=cl(i.right,a),h,v,p;switch(n){case"left":v=o,h=o+l,p=h+e+(u&&a.margin.left);break;case"right":h=o+s-u,v=h-e-l,p=o+s-u+(u&&a.margin.left);break;default:var m=l+e+u;v=o+s/2-m/2,h=v+l+e/2,p=v+l+e+(u&&a.margin.left);break}return{textX:h,leftIconX:v,rightIconX:p}},wF=function(t,r,e,n){if(n===Qt.BORDER_BOX)return t;var i=t.x,a=t.y,o=t.width,s=t.height,l=e.padding,u=e.horizontalBorderWidth,h=u===void 0?0:u,v=e.verticalBorderWidth,p=v===void 0?0:v;return r.forEach(function(m){var C=[At.BOTTOM,At.TOP].includes(m)?h:p;switch(m){case At.TOP:a+=C,s-=C;break;case At.BOTTOM:s-=C;break;case At.LEFT:i+=C,o-=C;break;default:o-=C;break}}),n===Qt.CONTENT_BOX&&(i+=l==null?void 0:l.left,a+=l==null?void 0:l.top,o-=(l==null?void 0:l.left)+(l==null?void 0:l.right),s-=(l==null?void 0:l.top)+(l==null?void 0:l.bottom)),{x:i,y:a,width:o,height:s}},Ad=function(t,r,e){var n=r.x,i=r.y,a=r.width,o=r.height,s=e.horizontalBorderWidth,l=s===void 0?0:s,u=e.horizontalBorderColorOpacity,h=e.horizontalBorderColor,v=e.verticalBorderWidth,p=v===void 0?0:v,m=e.verticalBorderColor,C=e.verticalBorderColorOpacity,w=e.borderDash,b=ke(w)?"":w,E=[At.TOP,At.BOTTOM].includes(t)?{lineWidth:l,stroke:h,strokeOpacity:u,lineDash:b}:{lineWidth:p,stroke:m,strokeOpacity:C,lineDash:b},R=0,M=0,k=0,L=0;if(t===At.TOP||t===At.BOTTOM){var _=i;t===At.TOP?_=i+l/2:_=i+o-l/2,M=_,L=_,R=n,k=n+a}if(t===At.LEFT||t===At.RIGHT){var I=n;t===At.LEFT?I=n+p/2:I=n+a-p/2,R=I,k=I,M=i,L=i+o}return{position:{x1:R,x2:k,y1:M,y2:L},style:E}},Qv=function(t){var r;return(r=t==null?void 0:t.position)!==null&&r!==void 0?r:"right"},xF=function(t,r){t===void 0&&(t=0),r===void 0&&(r=0),t=Uo(t),r=Uo(r);var e=t>=0,n=r>=0&&t<=0,i=e?t:r,a=n?0:i,o=r-t;return function(s){var l=e?0:1,u=n?lc(Math.abs(0-t)/o,0,1):l,h=lc((s-a)/o,-1,1);return{zeroScale:u,scale:h}}},fx=function(t,r){var e,n,i=t.data,a=t.encode,o=t.type,s=r.getMeta(),l=s.x,u=s.y,h=s.height,v=s.width,p=r.getStyle(Le.DATA_CELL),m=p.cell,C=p.miniChart,w=[],b=ct(i,function(Be){return w.push(Be==null?void 0:Be[a.y]),{x:Be[a.x],y:Be[a.y]}}),E=uo(w)||0,R=Sw(w)||0,M=E-R,k=m.padding,L=k.left,_=L===void 0?0:L,I=k.right,P=I===void 0?0:I,U=k.top,q=U===void 0?0:U,Q=k.bottom,J=Q===void 0?0:Q,re=l+_,ne=l+v-P,ce=u+q,me=u+h-J,oe=me-ce,Se=(e=C==null?void 0:C.bar)===null||e===void 0?void 0:e.intervalPadding,Te=o===us.Bar?(ne-re-(w.length-1)*Se)/w.length+Se:(n=(ne-re)/(w.length-1))!==null&&n!==void 0?n:0,Ie=[],je=ct(b,function(Be,rt){var ut=re+rt*Te,St;if(M!==0?St=me-((Be==null?void 0:Be.y)-R)/M*oe:St=R>0?ce:me,o===us.Bar){var st=void 0,fr=void 0;R<0&&E>0&&M!==0?(st=me-(0-R)/M*oe,fr=Math.abs(St-st),(Be==null?void 0:Be.y)<0&&(St=st)):(st=R<0?ce:me,M=uo([Math.abs(E),Math.abs(R)]),fr=M===0?oe:Math.abs((Be==null?void 0:Be.y)-0)/M*oe,St=st);var Pr=Te-Se;Ie.push([Pr,fr])}return[ut,St]});return{points:je,box:Ie}},bF=function(t,r){if(!(ke(t==null?void 0:t.data)||ke(r))){var e=r.getStyle(Le.DATA_CELL),n=e.miniChart,i=n==null?void 0:n.line,a=i.point,o=i.linkLine,s=fx(t,r).points;pF(r,{points:s,stroke:o==null?void 0:o.fill,lineWidth:o==null?void 0:o.size,opacity:o==null?void 0:o.opacity});for(var l=0;l<s.length;l++)sx(r,{cx:s[l][0],cy:s[l][1],r:a.size,fill:a.fill,fillOpacity:a==null?void 0:a.opacity})}},SF=function(t,r){if(!(ke(t==null?void 0:t.data)||ke(r)))for(var e=r.getStyle(Le.DATA_CELL),n=e.miniChart,i=n.bar,a=fx(t,r),o=a.points,s=a.box,l=0;l<o.length;l++)La(r,{x:o[l][0],y:o[l][1],width:s[l][0],height:s[l][1],fill:i.fill,fillOpacity:i.opacity})},EF=function(t,r,e){var n=Number(r)-Number(t);return Number.isNaN(n)||Number(t)<0?e.bad:n<=.1?e.good:n>.1&&n<=.2?e.satisfactory:e.bad},TF=function(t,r){var e,n,i=Number(t);if(Number.isNaN(i))return t;var a=(e=r.min)!==null&&e!==void 0?e:r,o=(n=r.max)!==null&&n!==void 0?n:r,s=new Intl.NumberFormat("en-US",{minimumFractionDigits:a,maximumFractionDigits:o,useGrouping:!1,style:"percent"});return s.format(i)},_F=function(t){var r,e,n,i,a,o;if(!ke(t)){var s=t.getBBoxByType(Qt.PADDING_BOX),l=s.x,u=s.y,h=s.height,v=s.width,p=t.findFieldCondition((r=t.cellConditions)===null||r===void 0?void 0:r.interval);if(p!=null&&p.mapping){var m=t.mappingValue(p);if(!m)return;var C=m.isCompare?m:t.valueRangeByField,w=Uo(C.minValue),b=Uo(C.maxValue),E=nr(m==null?void 0:m.fieldValue)?Uo(t.getMeta().fieldValue):Uo(m==null?void 0:m.fieldValue);if(E<w||E>b)return;var R=t.getStyle(),M=(n=(e=R==null?void 0:R.miniChart)===null||e===void 0?void 0:e.interval)===null||n===void 0?void 0:n.height,k=(a=(i=R==null?void 0:R.miniChart)===null||i===void 0?void 0:i.interval)===null||a===void 0?void 0:a.fill,L=xF(w,b),_=L(E),I=_.zeroScale,P=_.scale,U=(o=m.fill)!==null&&o!==void 0?o:k;return La(t,{x:l+v*I,y:u+h/2-M/2,width:v*P,height:M,fill:U})}}},RF=function(t,r){var e=r.getStyle(Le.DATA_CELL),n=r.getMeta(),i=n.x,a=n.y,o=n.height,s=n.width;if(ke(t)){r.renderTextShape(Y(Y({},e.text),{x:i+s-e.cell.padding.right,y:a+o/2,text:""}));return}var l=e.miniChart.bullet,u=l.progressBar,h=l.comparativeMeasure,v=l.rangeColors,p=l.backgroundColor,m=t.measure,C=t.target,w=Math.max(Number(m),0),b=Math.max(Number(C),0),E=TF(m,2),R=(u==null?void 0:u.widthPercent)>1?(u==null?void 0:u.widthPercent)/100:u==null?void 0:u.widthPercent,M=e.cell.padding,k=s-M.left-M.right,L=R*k,_=k-L,I=i+s-M.right-L,P=a+o/2-u.height/2;La(r,{x:I,y:P,width:L,height:u.height,fill:p});var U=Math.max(Math.min(L*w,L),0);La(r,{x:I,y:P+(u.height-u.innerHeight)/2,width:U,height:u.innerHeight,fill:EF(w,b,v)});var q=I+L*b;_r(r,{x1:q,y1:a+(o-h.height)/2,x2:q,y2:a+(o-h.height)/2+h.height,stroke:h==null?void 0:h.fill,lineWidth:h.width,opacity:h==null?void 0:h.opacity});var Q=_-M.right;r.renderTextShape(Y(Y({},e.text),{x:I-M.right,y:a+o/2,text:E,wordWrapWidth:Q}))},LF=function(t,r){switch(r==null?void 0:r.type){case us.Line:bF(r,t);break;case us.Bar:SF(r,t);break;default:RF(r,t);break}},MF=function(t,r){var e=r??ls,n=nr(t)||t===""||t===Il;return n?e:"".concat(t)},OF=function(t,r,e,n){var i=r.right,a=i===void 0?0:i,o=e||0;return t+a/2+o},AF=function(t){var r,e,n=t.getMeta().isTotals,i=(e=(r=t).isMeasureField)===null||e===void 0?void 0:e.call(r),a=t.getStyle(t.cellType||Le.DATA_CELL),o;return i?o=a==null?void 0:a.measureText:n?o=a==null?void 0:a.bolderText:o=a==null?void 0:a.text,{cellStyle:a,textStyle:o}},NF=function(t){var r,e=t.rowIndex,n=t.colIndex,i=t.meta,a=t.data,o=t.textStyle,s=t.textCondition,l=(r=s==null?void 0:s.mapping)===null||r===void 0?void 0:r.call(s,a,{rowIndex:e,colIndex:n,meta:i});return Y(Y({},o),l)},hx=function(t,r){return ui(r)?r(t):r},kF=function(t,r,e){for(var n=t.x,i=t.y,a=t.width,o=t.height,s=o/Wo(r),l=[],u,h,v,p=0,m=ct(e,function(E){return E>1?E/100:E}),C=0;C<Wo(r);C++){h=i+s*C;var w=[];u=n,p=0;for(var b=0;b<Wo(r[C]);b++)v=ke(m)?a/Wo(r[0]):a*m[b],u=OF(n,{left:0,right:0},p),p+=v,w.push({x:u,y:h,width:v,height:s});l.push(w)}return l},IF=function(t,r,e){var n,i,a,o,s,l,u,h;e===void 0&&(e=!0);var v=t.getBBoxByType(Qt.CONTENT_BOX),p=v.x,m=v.y,C=v.height,w=v.width,b=t.getMeta(),E=b.fieldValue,R=E.values,M=b.spreadsheet.options,k=(i=(n=M==null?void 0:M.conditions)===null||n===void 0?void 0:n.text)===null||i===void 0?void 0:i[0],L=(o=(a=M==null?void 0:M.conditions)===null||a===void 0?void 0:a.icon)===null||o===void 0?void 0:o[0];if(!vt(R)){LF(t,R);return}var _=(u=(l=(s=M.style)===null||s===void 0?void 0:s.dataCell)===null||l===void 0?void 0:l.valuesCfg)===null||u===void 0?void 0:u.widthPercent,I=0;if(E!=null&&E.label){var P=t.getStyle(Le.DATA_CELL),U=P.bolderText;I=C/(R.length+1),t.renderTextShape(Y(Y({},U),{x:p,y:m+I/2,text:E.label,maxLines:1,wordWrapWidth:w,wordWrap:!0,textOverflow:"ellipsis"}),{shallowRender:!0})}for(var q=AF(t),Q=q.cellStyle,J=q.textStyle,re=Q==null?void 0:Q.icon,ne=L&&L.mapping&&{name:"",size:re==null?void 0:re.size,margin:re==null?void 0:re.margin,position:Qv(L)},ce,me=kF({x:p,y:m+I,height:C-I,width:w},R,_),oe=0;oe<R.length;oe++)for(var Se=$c(R[oe]),Te=0;Te<Se.length;Te++){ce=Se[Te];var Ie=e?NF({rowIndex:oe,colIndex:Te,meta:b,data:ce,textStyle:J,textCondition:k}):J,je=me[oe][Te].width-re.size-((ne==null?void 0:ne.position)==="left"?re.margin.right:re.margin.left),Be={left:[],right:[]};ne&&Be[ne.position].push(ne),t.renderTextShape(Y(Y({},Ie),{x:0,y:0,maxLines:1,text:ce,wordWrapWidth:je}),{shallowRender:!0});var rt=t.getActualTextWidth(),ut=Cs({bbox:me[oe][Te],textAlign:Ie.textAlign,textWidth:rt,iconStyle:re,groupedIcons:Be}),St=ut.textX,st=ut.leftIconX,fr=ut.rightIconX,Pr=Sl(me[oe][Te],Ie.textBaseline);if(t.updateTextPosition({x:St,y:Pr}),L&&e){var Ln=(h=L==null?void 0:L.mapping)===null||h===void 0?void 0:h.call(L,ce,{rowIndex:oe,colIndex:Te,meta:t==null?void 0:t.getMeta()}),Xr=(ne==null?void 0:ne.position)==="left"?st:fr,mt=Ul(re.size,Pr,Ie.fontSize,Ie.textBaseline);if(Ln){var fa=Gl(t,{x:Xr,y:mt,name:Ln.icon,width:re==null?void 0:re.size,height:re==null?void 0:re.size,fill:Ln.fill});t.addConditionIconShape(fa)}}}},Oh=function(t,r){return r===void 0&&(r=1),(t==null?void 0:t.width)*r},Pu,dx=function(t,r){return r===void 0&&(r=$v),{type:Er.PLAIN,content:ct(t,function(e){return e.join(r)}).join(L6)}},vx=function(t){function r(i,a){return i.map(function(o){return"<".concat(a,">").concat(m5(o),"</").concat(a,">")}).join("")}function e(i,a){return i.map(function(o){return"<".concat(a,">").concat(r(o,"td"),"</").concat(a,">")}).join("")}var n=e(t,"tr");return{type:Er.HTML,content:'<meta charset="utf-8"><table><tbody>'.concat(n,"</tbody></table>")}},Du=(Pu={},Pu[Er.PLAIN]=dx,Pu[Er.HTML]=vx,Pu);function $u(t,r,e){return r===void 0&&(r=!1),r?e.getFieldFormatter(t):function(n){return n}}var Ka=function(t){var r,e,n,i,a,o,s=t.rowMatrix,l=t.colMatrix,u=t.dataMatrix,h=t.cornerMatrix,v=(e=(r=s==null?void 0:s[0])===null||r===void 0?void 0:r.length)!==null&&e!==void 0?e:0,p=(n=l==null?void 0:l.length)!==null&&n!==void 0?n:0,m=(a=(i=u[0])===null||i===void 0?void 0:i.length)!==null&&a!==void 0?a:0,C=(o=u.length)!==null&&o!==void 0?o:0,w=v+m,b=p+C,E=Array.from(Array(b),function(){return new Array(w)});return E=ct(E,function(R,M){return ct(R,function(k,L){var _,I;if(L>=0&&L<v&&M>=0&&M<p)return(I=(_=h==null?void 0:h[M])===null||_===void 0?void 0:_[L])!==null&&I!==void 0?I:"";if(L>=v&&L<=w&&M>=0&&M<p)return l[M][L-v];if(L>=0&&L<v&&M>=p&&M<b)return s==null?void 0:s[M-p][L];if(L>=v&&L<=w&&M>=p&&M<b)return u[M-p][L-v]})}),E};function Nd(t){var r;return(r=uo(ct(t,function(e){return e.length})))!==null&&r!==void 0?r:0}function PF(t){var r=Nd(t);return ct(t,function(e){var n=r-e.length;return n?pe(pe([],te(e),!1),te(new Array(n).fill("")),!1):e})}var DF=function(t){var r,e;return typeof t=="object"?{formatHeader:(r=t.formatHeader)!==null&&r!==void 0?r:!1,formatData:(e=t.formatData)!==null&&e!==void 0?e:!1}:{formatHeader:t??!1,formatData:t??!1}};function BF(t){var r;if(!t)return Du;var e=t(Du);return r={},r[Er.PLAIN]=e[Er.PLAIN]||Du[Er.PLAIN],r[Er.HTML]=e[Er.HTML]||Du[Er.HTML],r}function FF(t){var r,e,n=t.spreadsheet.options.interaction,i=t.config,a=i.formatOptions,o=a===void 0?!1:a,s=i.separator,l=s===void 0?$v:s,u=i.selectedCells,h=u===void 0?[]:u,v=i.customTransformer,p=i.isAsyncExport,m=p===void 0?!1:p,C=t.isExport,w=n.copy,b=C?DF(o):{formatData:(r=w==null?void 0:w.withFormat)!==null&&r!==void 0?r:!1,formatHeader:(e=w==null?void 0:w.withFormat)!==null&&e!==void 0?e:!1},E=b.formatData,R=b.formatHeader,M=BF(C?v:w==null?void 0:w.customTransformer);return{separator:l,selectedCells:h,transformers:M,formatData:E,formatHeader:R,isAsyncExport:m}}var HF=function(t){var r,e,n,i,a=(n=(e=(r=t.spreadsheet)===null||r===void 0?void 0:r.dataSet)===null||e===void 0?void 0:e.getFieldFormatter)===null||n===void 0?void 0:n.call(e,t.field);return(i=a==null?void 0:a(t.value))!==null&&i!==void 0?i:t.value},M1=function(t){var r=[],e=function(n){if(n.id!==ul){var i=HF(n);if(r.unshift(i),n!=null&&n.parent)return e(n.parent)}};return e(t),r};function O1(t,r){return!t||!r?!1:String(t).toLowerCase()===String(r).toLowerCase()}var px=function(t){return/\n/.test(t)?'"'.concat(t.replace(/\r\n?/g,`
`).replace(/"/g,"'"),'"'):t};function zF(t){var r=new Set;return tt(t,function(e){var n=e.getMeta().level;r.has(n)||r.add(n)}),r}var kd=function(t,r){return ct(t,function(e){return r.dataSet.getFieldName(e)})},Id=function(t,r){var e=t.split(rn);return r?e.slice(e.length-r):(e.shift(),e)},gx=function(t,r){return t()?r==null?void 0:r.value:r==null?void 0:r.field},e0=function(t){return t.filter(function(r){var e=r.type;return e===Le.COL_CELL})},t0=function(t){return t.filter(function(r){var e=r.type;return e===Le.ROW_CELL})};function WF(t,r){return ci(t,function(e){var n=e.getMeta(),i=n.level===r,a=n.isTotals&&ke(n.children);return i||a})}function GF(t,r,e){return ct(t,function(n){var i=n.getMeta(),a=i.id,o=i.value,s=i.isTotals,l=i.level,u=i.spreadsheet,h=a;return s&&l!==r&&(h=a+rn+ID(o,r-l)),kd(Id(h,e.size),u)})}function UF(t){var r,e=zF(t),n=(r=uo(Array.from(e)))!==null&&r!==void 0?r:0,i=WF(t,n),a=t[0].cellType===Le.COL_CELL,o=GF(i,n,e),s=a?Fw.apply(void 0,pe([],te(o),!1)):o;return[dx(s),vx(s)]}var mx=function(){function t(r){var e=this;this.matrixHtmlTransformer=function(s){return e.config.transformers[Er.HTML](s)};var n=r.spreadsheet,i=r.isExport,a=i===void 0?!1:i,o=r.config;this.spreadsheet=n,this.config=FF({config:o,spreadsheet:n,isExport:a})}return t.prototype.matrixPlainTextTransformer=function(r,e){return this.config.transformers[Er.PLAIN](r,e)},t.prototype.matrixTransformer=function(r,e){return e===void 0&&(e=$v),[this.matrixPlainTextTransformer(r,e),this.matrixHtmlTransformer(r)]},t}(),yx=function(t){Me(r,t);function r(e){var n=t.call(this,e)||this;return n.leafRowNodes=[],n.leafColNodes=[],n.compatibleHideMeasureColumn=function(){var i,a,o,s,l,u=((s=(o=(a=n.spreadsheet.options)===null||a===void 0?void 0:a.style)===null||o===void 0?void 0:o.colCell)===null||s===void 0?void 0:s.hideValue)&&n.spreadsheet.isValueInCols();return u?(i={},i[it]=(l=n.spreadsheet.dataCfg.fields.values)===null||l===void 0?void 0:l[0],i):{}},n.getDataMatrixByHeaderNode=function(){var i=n.compatibleHideMeasureColumn();return ct(n.leafRowNodes,function(a){return n.leafColNodes.map(function(o){return n.getDataCellValue({rowNode:a,colNode:o,config:{measureQuery:i,isPivotMode:n.spreadsheet.isPivotMode,dataSet:n.spreadsheet.dataSet}})})})},n.getDataMatrixByHeaderNodeRIC=function(){var i=[],a=0,o=n.compatibleHideMeasureColumn();return new Promise(function(s,l){try{var u=function(h){for(var v=jw,p=n.leafRowNodes.length;h.timeRemaining()>0&&a<p-1&&v>0;)for(var m=a;m<p&&v>0;m++){for(var C=[],w=n.leafRowNodes[m],b=0;b<n.leafColNodes.length;b++){var E=n.leafColNodes[b],R=n.getDataCellValue({rowNode:w,colNode:E,config:{isPivotMode:n.spreadsheet.isPivotMode,dataSet:n.spreadsheet.dataSet,measureQuery:o}});C.push(R)}a=m,i.push(C),v--}a===p-1?s(i):requestIdleCallback(u)};requestIdleCallback(u)}catch(h){l(h)}})},n.getDataCellValue=function(i){var a,o=i.rowNode,s=i.colNode,l=i.config,u=l.isPivotMode,h=l.dataSet,v=l.measureQuery,p=h.getCellData({query:Y(Y(Y({},o.query),s.query),v),rowNode:o,isTotals:o.isTotals||o.isTotalMeasure||s.isTotals||s.isTotalMeasure}),m=n.spreadsheet.isValueInCols()?s:o,C=(a=gx(u,m))!==null&&a!==void 0?a:"",w=n.spreadsheet.dataCfg.fields.values;C=w!=null&&w.includes(C)?C:w==null?void 0:w[0];var b=$u(C??s.field,n.config.formatData,h),E=p==null?void 0:p[sa],R=Yc(E==null?void 0:E.values),M=R?"":E;return b(M??"")},n.getCustomRowCornerMatrix=function(i){var a=Nd(i??[]),o=n.spreadsheet.facet.getCornerNodes(),s=Uv(o,function(l){return l.cornerType===en.Col?0:1});return n.spreadsheet.isHierarchyTreeType()?ct(s,function(l){var u=new Array(a).fill("");return u[a-1]=l.value,u}):Object.values(Hv(s,"y")).map(function(l){var u=new Array(a-l.length).fill(""),h=l.map(function(v){return v.value});return pe(pe([],te(u),!1),te(h),!1)})},n.getCornerMatrix=function(i){if(n.spreadsheet.isCustomRowFields())return n.getCustomRowCornerMatrix(i);var a=n.spreadsheet.dataCfg.fields,o=a.columns,s=o===void 0?[]:o,l=a.rows,u=l===void 0?[]:l,h=pe(pe([],te(s),!1),[""],!1),v=n.spreadsheet.isHierarchyTreeType()?Nd(i??[]):u.length,p=BD(u,0,v);return ct(h,function(m,C){return ct(p,function(w,b){return C===h.length-1?n.spreadsheet.dataSet.getFieldName(w):b===v-1?n.spreadsheet.dataSet.getFieldName(m):""})})},n.getDataMatrixByDataCell=function(i){var a=n.spreadsheet.options.interaction.copy,o=n.compatibleHideMeasureColumn(),s=ct(i,function(h){return ct(h,function(v){var p=te(wx(v,n.spreadsheet),2),m=p[0],C=p[1],w=n.getDataCellValue({rowNode:m,colNode:C,config:{isPivotMode:n.spreadsheet.isPivotMode,dataSet:n.spreadsheet.dataSet,measureQuery:o}});return px(w)})});if(!(a!=null&&a.withHeader))return n.matrixTransformer(s,n.config.separator);var l=n.getRowMatrix(),u=n.getColMatrix();return n.matrixTransformer(Ka({rowMatrix:l,colMatrix:u,dataMatrix:s}),n.config.separator)},n.getAsyncAllPivotCopyData=function(){return Ar(n,void 0,void 0,function(){var i,a,o,s,l;return Nr(this,function(u){switch(u.label){case 0:return i=this.getRowMatrix(),a=this.getColMatrix(),o=this.getCornerMatrix(i),s=[],this.config.isAsyncExport?[4,this.getDataMatrixByHeaderNodeRIC()]:[3,2];case 1:return s=u.sent(),[3,4];case 2:return[4,Promise.resolve(this.getDataMatrixByHeaderNode())];case 3:s=u.sent(),u.label=4;case 4:return l=this.matrixTransformer(Ka({rowMatrix:i,colMatrix:a,dataMatrix:s,cornerMatrix:o}),this.config.separator),[2,l]}})})},n.getPivotAllCopyData=function(){var i=n.getRowMatrix(),a=n.getColMatrix(),o=n.getCornerMatrix(i),s=n.getDataMatrixByHeaderNode(),l=n.matrixTransformer(Ka({rowMatrix:i,colMatrix:a,dataMatrix:s,cornerMatrix:o}),n.config.separator);return l},n.leafRowNodes=n.getLeafRowNodes(),n.leafColNodes=n.getLeafColNodes(),n}return r.prototype.getLeafRowNodes=function(){var e=this.spreadsheet.facet.getRowLeafNodes(),n=t0(this.config.selectedCells),i=this.spreadsheet.isHierarchyTreeType();return ke(n)?e:this.getSelectedNode(n,e,i)},r.prototype.getLeafColNodes=function(){var e=this.spreadsheet.facet.getColLeafNodes(),n=e0(this.config.selectedCells);return ke(n)?e:this.getSelectedNode(n,e)},r.prototype.getSelectedNode=function(e,n,i){return i===void 0&&(i=!1),e.reduce(function(a,o){var s=n.filter(function(l){return i?l.id===o.id:l.id.startsWith(o.id)});return a.push.apply(a,pe([],te(s),!1)),a},[])},r.prototype.getColMatrix=function(){var e=this;return Fw.apply(void 0,pe([],te(ct(this.leafColNodes,function(n){return e.config.formatHeader?M1(n):kd(Id(n.id),n.spreadsheet)})),!1))},r.prototype.getRowMatrix=function(){var e=this,n=ct(this.leafRowNodes,function(i){return e.config.formatHeader?M1(i):kd(Id(i.id),i.spreadsheet)});return PF(n)},r.prototype.getPivotCopyData=function(){var e=this.spreadsheet.options.interaction.copy,n=this.getDataMatrixByHeaderNode();if(!(e!=null&&e.withHeader))return this.matrixTransformer(n,this.config.separator);var i=this.getRowMatrix(),a=this.getColMatrix();return this.matrixTransformer(Ka({rowMatrix:i,colMatrix:a,dataMatrix:n}),this.config.separator)},r}(mx);function VF(t,r){var e=new yx({spreadsheet:t,config:{selectedCells:r}});return e.getPivotCopyData()}var XF=function(t){var r=t.spreadsheet,e=t.selectedCells,n=t.headerSelectedCells,i=new yx({spreadsheet:r,config:{selectedCells:n,formatOptions:!0}});return i.getDataMatrixByDataCell(e)},Cx=function(t){Me(r,t);function r(e){var n=t.call(this,e)||this;return n.getValueFromMeta=function(i){var a,o=te(wx(i,n.spreadsheet),2),s=o[1],l=gx(n.spreadsheet.isPivotMode,s),u=n.isSeriesNumberField(l)?i.rowIndex+1:(a=n.displayData[i.rowIndex])===null||a===void 0?void 0:a[l],h=$u(l,n.config.formatData,n.spreadsheet.dataSet);return h(u)},n.displayData=n.getSelectedDisplayData(),n.columnNodes=n.getSelectedColNodes(),n}return r.prototype.getSelectedColNodes=function(){var e=e0(this.config.selectedCells),n=this.spreadsheet.facet.getColNodes();return e.length===0?n:ct(e,function(i){return n[i.colIndex]})},r.prototype.getSelectedDisplayData=function(){var e=t0(this.config.selectedCells),n=this.spreadsheet.dataSet.getDisplayDataSet();return e.length===0?n:ct(e,function(i){return n[i.rowIndex]})},r.prototype.getDataMatrix=function(){var e=this,n=this.spreadsheet.options.seriesNumber;return this.displayData.map(function(i,a){return e.columnNodes.map(function(o){var s=o==null?void 0:o.field;if(Rn===s&&(n!=null&&n.enable))return(a+1).toString();var l=$u(s,e.config.formatData,e.spreadsheet.dataSet),u=i==null?void 0:i[s];return l(u)})})},r.prototype.getDataMatrixRIC=function(){var e=this,n=this.spreadsheet.options.seriesNumber,i=[],a=0;return new Promise(function(o,s){try{var l=function(u){for(var h=jw,v=e.displayData.length;u.timeRemaining()>0&&h>0&&a<v-1;)for(var p=a;p<v&&h>0;p++){for(var m=e.displayData[p],C=[],w=0;w<e.columnNodes.length;w++){var b=e.columnNodes[w],E=b.field;if(Rn===E&&(n!=null&&n.enable)){C.push((p+1).toString());continue}var R=$u(E,e.config.formatData,e.spreadsheet.dataSet),M=m[E],k=R(M);C.push(k)}a=p,i.push(C),h--}a===v-1?o(i):requestIdleCallback(l)};requestIdleCallback(l)}catch(u){s(u)}})},r.prototype.isSeriesNumberField=function(e){var n=this.spreadsheet.options.seriesNumber;return Rn===e&&(n==null?void 0:n.enable)},r.prototype.getColMatrix=function(){var e=this,n=this.config.formatHeader;return this.columnNodes.map(function(i){var a=i.field;return n?e.isSeriesNumberField(a)?jc():e.spreadsheet.dataSet.getFieldName(a):a})},r.prototype.getDataMatrixByDataCell=function(e){var n=this,i=this.spreadsheet.options.interaction.copy,a=ct(e,function(s){return ct(s,function(l){return px(n.getValueFromMeta(l))})});if(!(i!=null&&i.withHeader))return this.matrixTransformer(a,this.config.separator);var o=this.getColMatrix();return this.matrixTransformer(Ka({colMatrix:[o],dataMatrix:a}),this.config.separator)},r.prototype.processSelectedTable=function(e){e===void 0&&(e=!1);var n=this.getDataMatrix();if(!e)return this.matrixTransformer(n,this.config.separator);var i=this.getColMatrix();return this.matrixTransformer(Ka({colMatrix:[i],dataMatrix:n}),this.config.separator)},r.prototype.asyncProcessSelectedTable=function(e){return e===void 0&&(e=!1),Ar(this,void 0,void 0,function(){var n,i,a;return Nr(this,function(o){switch(o.label){case 0:return this.config.isAsyncExport?[4,this.getDataMatrixRIC()]:[3,2];case 1:return i=o.sent(),[3,4];case 2:return[4,Promise.resolve(this.getDataMatrix())];case 3:i=o.sent(),o.label=4;case 4:return n=i,e?(a=this.getColMatrix(),[2,this.matrixTransformer(Ka({colMatrix:[a],dataMatrix:n}),this.config.separator)]):[2,this.matrixTransformer(n,this.config.separator)]}})})},r}(mx),YF=function(t,r){var e=new Cx({spreadsheet:t,config:{selectedCells:r}});return e.processSelectedTable()},$F=function(t){var r=t.spreadsheet,e=t.selectedCells,n=t.headerSelectedCells,i=new Cx({spreadsheet:r,config:{selectedCells:n,formatOptions:!0}});return i.getDataMatrixByDataCell(e)},wx=function(t,r){var e=t.rowIndex,n=t.colIndex,i=r.facet;return[i.getRowNodeByIndex(e),i.getColNodeByIndex(n)]},qF=function(t){if(!(t!=null&&t.length))return[];var r=te([{row:1/0,col:1/0},{row:0,col:0}],2),e=r[0],n=r[1];t.forEach(function(l){var u=l.rowIndex,h=l.colIndex;e.col=Math.min(h,e.col),e.row=Math.min(u,e.row),n.col=Math.max(h,n.col),n.row=Math.max(u,n.row)});var i=te([n.row-e.row+1,n.col-e.col+1],2),a=i[0],o=i[1],s=new Array(a).fill("").map(function(){return new Array(o).fill("")});return t.forEach(function(l){var u=l.rowIndex,h=l.colIndex,v=te([u-e.row,h-e.col],2),p=v[0],m=v[1];s[p][m]=l}),s},Ah=function(t,r){return t.isPivotMode()?VF(t,r):YF(t,r)};function KF(t){return ke(t)?!1:Bv(t,function(r){return r.cellType===Le.ROW_CELL||r.cellType===Le.COL_CELL})}function ZF(t,r,e,n){return n.isPivotMode()?XF({spreadsheet:n,selectedCells:t,headerSelectedCells:Ra(r,e)}):$F({spreadsheet:n,selectedCells:t,headerSelectedCells:r})}function jF(t,r){var e,n=e0(r),i=t0(r);if(t.interaction.getCurrentStateName()===Xe.ALL_SELECTED)e=Ah(t,[]);else if(n.length)e=Ah(t,n);else if(i.length)e=Ah(t,i);else{if(!r.length)return[{type:Er.PLAIN,content:""},{type:Er.HTML,content:""}];var a=qF(r),o=a[0].map(function(l){var u,h,v;return Y(Y({},l),{id:(v=(h=(u=l==null?void 0:l.id)===null||u===void 0?void 0:u.split(ls))===null||h===void 0?void 0:h[1])!==null&&v!==void 0?v:"",type:Le.COL_CELL})}),s=a.map(function(l){var u,h,v,p;return Y(Y({},l[0]),{id:(p=(v=(h=(u=l[0])===null||u===void 0?void 0:u.id)===null||h===void 0?void 0:h.split(ls))===null||v===void 0?void 0:v[0])!==null&&p!==void 0?p:"",type:Le.ROW_CELL})});e=ZF(a,o,s,t)}return e}var JF=function(t){var r,e=t.interaction,n=e.getState().cells||[],i=(r=e.getInteractedCells())!==null&&r!==void 0?r:[],a=KF(i),o=a?UF(i):jF(t,n);return o&&e8(o),o},xx=function(t){return new Promise(function(r,e){var n;Array.isArray(t)?n=dt(t.filter(function(o){return o.type===Er.PLAIN}),"[0].content",""):n=t.content||"";var i=document.createElement("textarea");i.value=n,document.body.appendChild(i),i.focus({preventScroll:!0}),i.select();var a=document.execCommand("copy");document.body.removeChild(i),a?r():e()})},QF=function(t){return navigator.clipboard.write([new ClipboardItem(Ra(t).reduce(function(r,e){var n,i=e.type,a=e.content,o=a.replace(/\x00/g,"");return Y(Y({},r),(n={},n[i]=new Blob([o],{type:i}),n))},{}))]).catch(function(){return xx(t)})},e8=function(t,r){r===void 0&&(r=!1);var e;return typeof t=="string"?e={content:t,type:Er.PLAIN}:e=t,!navigator.clipboard||!window.ClipboardItem||r?xx(e):QF(e)},bx=function(t){return!t||!("appendInfo"in t)?{}:t.appendInfo},r0=function(t,r,e){var n,i=t.split(rn);if(e)n=[t];else{n=[xl(i[0],i[1])];for(var a=2;a<i.length;a+=1)n.push(xl(n[a-2],i[a]))}var o=ci(r,function(s){var l;return n.includes((l=s.getMeta())===null||l===void 0?void 0:l.id)});return o},t8=function(t,r,e){if(t){var n=r0(t,r);tt(n,function(i){i.updateByState(e)})}},r8=function(t,r){return typeof t=="function"?t(r):t.some(function(e){return e===r.field||e===r.id||e===r.valueField})},Qc=function(t){Me(r,t);function r(e,n){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var o=t.call(this,{})||this;return o.textShapes=[],o.conditionIconShapes=[],o.stateShapes=new Map,o.meta=e,o.spreadsheet=n,o.theme=n.theme,o.conditions=o.spreadsheet.options.conditions,o.groupedIcons={left:[],right:[]},o.handleRestOptions.apply(o,pe([],te(i),!1)),o.shouldInit()&&o.initCell(),o}return r.prototype.handleRestOptions=function(){},r.prototype.getMeta=function(){return this.meta},r.prototype.setMeta=function(e){this.meta=e},r.prototype.getIconStyle=function(){var e;return(e=this.theme[this.cellType])===null||e===void 0?void 0:e.icon},r.prototype.isShallowRender=function(){return!1},r.prototype.getCellTextWordWrapStyle=function(e){var n,i,a=((i=(n=this.spreadsheet.options)===null||n===void 0?void 0:n.style)===null||i===void 0?void 0:i[e||this.cellType])||{},o=a.wordWrap,s=a.maxLines,l=a.textOverflow;return{wordWrap:o,maxLines:s,textOverflow:l}},r.prototype.getActualText=function(){return this.actualText},r.prototype.getActualTextWidth=function(){var e;return((e=this.textShape)===null||e===void 0?void 0:e.getComputedTextLength())||0},r.prototype.getActualTextHeight=function(){return this.getMultiLineActualTextHeight()},r.prototype.getMultiLineActualTexts=function(){var e,n;return((n=(e=this.textShape)===null||e===void 0?void 0:e.parsedStyle.metrics)===null||n===void 0?void 0:n.lines)||[]},r.prototype.getMultiLineActualTextWidth=function(){return co(this.getTextLineBoundingRects(),"width")||0},r.prototype.getMultiLineActualTextHeight=function(){return co(this.getTextLineBoundingRects(),"height")||0},r.prototype.getOriginalText=function(){return this.originalText},r.prototype.isTextOverflowing=function(){var e;return(e=this.textShape)===null||e===void 0?void 0:e.isOverflowing()},r.prototype.isMultiLineText=function(){return this.getTextLineBoundingRects().length>1},r.prototype.getEmptyPlaceholder=function(){var e=this.spreadsheet.options.placeholder;return hx(this,e)},r.prototype.getTextLineBoundingRects=function(){var e;return((e=this.textShape)===null||e===void 0?void 0:e.getLineBoundingRects())||[]},r.prototype.getFieldValue=function(){return this.getFormattedFieldValue().formattedValue},r.prototype.shouldInit=function(){var e=this.meta,n=e.width,i=e.height;return n>0&&i>0},r.prototype.getStyle=function(e){return dt(this.theme,e||this.cellType)},r.prototype.getLinkFieldShape=function(){return this.linkFieldShape},r.prototype.getBackgroundShape=function(){return this.backgroundShape},r.prototype.getStateShapes=function(){return this.stateShapes},r.prototype.getResizeAreaStyle=function(){return this.getStyle("resizeArea")},r.prototype.shouldDrawResizeAreaByType=function(e,n){var i=this.spreadsheet.options.interaction.resize;return na(i)?i:ui(i==null?void 0:i.visible)?i==null?void 0:i.visible(n):i==null?void 0:i[e]},r.prototype.getBBoxByType=function(e){e===void 0&&(e=Qt.BORDER_BOX);var n={x:this.meta.x,y:this.meta.y,height:this.meta.height,width:this.meta.width},i=this.getStyle()||this.theme.dataCell;return wF(n,this.getBorderPositions(),i==null?void 0:i.cell,e)},r.prototype.drawBorders=function(){var e=this;this.getBorderPositions().forEach(function(n){var i,a=Ad(n,e.getBBoxByType(),(i=e.getStyle())===null||i===void 0?void 0:i.cell),o=a.position,s=a.style;_r(e,Y(Y({},o),s))})},r.prototype.drawInteractiveBorderShape=function(){this.stateShapes.set("interactiveBorderShape",La(this,Y(Y({},this.getBBoxByType(Qt.PADDING_BOX)),{visibility:"hidden",pointerEvents:"none"})))},r.prototype.drawInteractiveBgShape=function(){this.stateShapes.set("interactiveBgShape",La(this,Y(Y({},this.getBBoxByType()),{visibility:"hidden",pointerEvents:"none"})))},r.prototype.drawBackgroundShape=function(){var e=this.getBackgroundColor(),n=e.backgroundColor,i=e.backgroundColorOpacity;this.backgroundShape=La(this,Y(Y({},this.getBBoxByType()),{fill:n,fillOpacity:i}))},r.prototype.renderTextShape=function(e,n){var i=MF(e.text,this.getEmptyPlaceholder()),a=(n==null?void 0:n.shallowRender)||this.isShallowRender();if(this.textShape=gF({group:this,textShape:a?void 0:this.textShape,style:Y(Y({},e),{text:i})}),this.addTextShape(this.textShape),a)return this.textShape;var o=this.getMultiLineActualTexts().join("");return this.actualText=o,this.originalText=i,this.textShape},r.prototype.updateTextPosition=function(e){var n,i,a,o,s=this.getTextPosition();(n=this.textShape)===null||n===void 0||n.attr("x",(i=e==null?void 0:e.x)!==null&&i!==void 0?i:s==null?void 0:s.x),(a=this.textShape)===null||a===void 0||a.attr("y",(o=e==null?void 0:e.y)!==null&&o!==void 0?o:s==null?void 0:s.y)},r.prototype.drawTextShape=function(){var e=Math.max(this.getMaxTextWidth(),0),n=this.getTextStyle();this.renderTextShape(Y(Y({},n),{x:0,y:0,text:this.getFieldValue(),wordWrapWidth:e})),!this.isShallowRender()&&this.updateTextPosition()},r.prototype.drawLinkFieldShape=function(e,n){if(e){var i=this.spreadsheet.options.device;if(!tr(i)){var a=this.getTextStyle(),o=this.getTextPosition(),s=this.getActualTextWidth(),l=o.x;a.textAlign==="center"?l-=s/2:a.textAlign==="right"&&(l-=s);var u=this.textShape.getBBox().bottom;this.linkFieldShape=_r(this,{x1:l,y1:u+1,x2:l+s,y2:u+1,stroke:n,lineWidth:1})}this.textShape.style.fill=n,this.textShape.style.cursor="pointer",this.textShape.appendInfo={isLinkFieldText:!0,cellData:this.meta}}},r.prototype.getLinkFieldStyle=function(){return this.getTextStyle().linkTextFill},r.prototype.drawLinkField=function(e){var n=this.spreadsheet.options.interaction.linkFields,i=n===void 0?[]:n,a=this.getLinkFieldStyle(),o=r8(i,e);this.drawLinkFieldShape(o,a)},r.prototype.updateByState=function(e,n){var i=this;this.spreadsheet.interaction.setInteractedCells(n);var a=dt(this.theme,"".concat(this.cellType,".cell.interactionState.").concat(e));tt(a,function(o,s){var l=pn(aD(LB,function(u){return hn(u,s)}));l.forEach(function(u){var h=i.stateShapes.has(u),v=h?i.stateShapes.get(u):i[u],p=vt(v)?v:[v];if(h&&p.forEach(function(C){C.setAttribute("visibility","visible")}),u==="interactiveBorderShape"&&s==="borderWidth"&&Wn(o)){var m=i.getInteractiveBorderShapeStyle(o);tt(m,function(C,w){Hn(p,w,C)})}Hn(p,xn[s],o)})})},r.prototype.getInteractiveBorderShapeStyle=function(e){var n=this.getBBoxByType(Qt.PADDING_BOX),i=n.x,a=n.y,o=n.height,s=n.width,l=e/2;return{x:i+l,y:a+l,width:s-e,height:o-e}},r.prototype.hideInteractionShape=function(){this.stateShapes.forEach(function(e){Hn(e,xn.backgroundOpacity,0),Hn(e,xn.backgroundColor,"transparent"),Hn(e,xn.borderOpacity,0),Hn(e,xn.borderWidth,1),Hn(e,xn.borderColor,"transparent")})},r.prototype.clearUnselectedState=function(){Hn(this.backgroundShape,xn.backgroundOpacity,1),Hn(this.textShapes,xn.textOpacity,1),Hn(this.linkFieldShape,xn.opacity,1)},r.prototype.getTextShape=function(){return this.textShape},r.prototype.getTextShapes=function(){return this.textShapes||[this.textShape]},r.prototype.addTextShape=function(e){e&&this.textShapes.push(e)},r.prototype.getConditionIconShape=function(){return this.conditionIconShape},r.prototype.getConditionIconShapes=function(){return this.conditionIconShapes||[this.conditionIconShape]},r.prototype.addConditionIconShape=function(e){e&&this.conditionIconShapes.push(e)},r.prototype.resetTextAndConditionIconShapes=function(){this.textShapes=[],this.conditionIconShapes=[]},Object.defineProperty(r.prototype,"cellConditions",{get:function(){return this.conditions},enumerable:!1,configurable:!0}),r.prototype.drawConditionIconShapes=function(){var e=this.getIconConditionResult();if(e){var n=this.getIconPosition(),i=this.getStyle().icon.size;this.conditionIconShape=Gl(this,Y(Y({},n),{name:e==null?void 0:e.name,width:i,height:i,fill:e==null?void 0:e.fill})),this.addConditionIconShape(this.conditionIconShape)}},r.prototype.getTextConditionMappingResult=function(){var e,n=this.findFieldCondition((e=this.conditions)===null||e===void 0?void 0:e.text);return n!=null&&n.mapping?this.mappingValue(n):null},r.prototype.getContainConditionMappingResultTextStyle=function(e){var n=this.getDefaultTextFill(e.fill),i=this.getTextConditionMappingResult();return Y(Y(Y({},e),i),{fill:(i==null?void 0:i.fill)||n})},r.prototype.getDefaultTextFill=function(e){var n=this.getBackgroundColor(),i=n.backgroundColor,a=n.intelligentReverseTextColor;return Zw(i)&&e===Xw&&a&&(e=Ed),e||""},r.prototype.getBackgroundConditionFill=function(){var e,n=this.findFieldCondition((e=this.conditions)===null||e===void 0?void 0:e.background);if(n!=null&&n.mapping){var i=this.mappingValue(n);if(i)return{backgroundColor:i.fill,intelligentReverseTextColor:i.intelligentReverseTextColor||!1}}return{intelligentReverseTextColor:!1}},r.prototype.getIconConditionResult=function(){var e,n=this.findFieldCondition((e=this.conditions)===null||e===void 0?void 0:e.icon);if(n!=null&&n.mapping){var i=this.mappingValue(n);if(i&&i.icon)return{name:i.icon,position:Qv(n),fill:i.fill,isConditionIcon:!0}}},r.prototype.getActionAndConditionIconWidth=function(e){var n=this.groupedIcons,i=n.left,a=n.right,o=this.getStyle().icon;return e?cl(this.groupedIcons[e],o):cl(i,o)+cl(a,o)},r.prototype.getCrossBackgroundColor=function(e){var n=this.getStyle().cell,i=n.crossBackgroundColor,a=n.backgroundColorOpacity;return i&&e%2===0?{backgroundColorOpacity:a,backgroundColor:i}:{backgroundColorOpacity:a,backgroundColor:this.getStyle().cell.backgroundColor}},r}(Ft),oi=function(){function t(r,e){this.raw=r,this.extraField=e}return t.getCellData=function(r,e){return new t(r,e)},t.getCellDataList=function(r,e){return e.map(function(n){return t.getCellData(r,n)})},t.getFieldValue=function(r,e){return e===void 0&&(e=""),r instanceof t?e?r.getValueByField(e):r[ld]:r==null?void 0:r[e]},Object.defineProperty(t.prototype,ld,{get:function(){return this.raw},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,it,{get:function(){return this.extraField},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,sa,{get:function(){return this.raw[this.extraField]},enumerable:!1,configurable:!0}),t.prototype.getValueByField=function(r){return r===sa||r===it?this[r]:this.raw[r]},t}(),Za=function(t,r){var e=r.getMeta().id;return t.some(function(n){return tn(n.id,e)})},ef=function(t,r){return"".concat(t).concat(ls).concat(r)},n8=function(t){var r=t.interaction.getSelectedCellHighlight(),e=r.currentRow,n=r.currentCol,i=r.rowHeader,a=r.colHeader;return e||n||i||a},n0=function(t){return t.type===Le.DATA_CELL},i8=function(t,r){tt(t,function(e){n0(e)&&e.rowIndex===r.getMeta().rowIndex&&r.updateByState(Xe.SELECTED)})},a8=function(t,r){tt(t,function(e){n0(e)&&e.colIndex===r.getMeta().colIndex&&r.updateByState(Xe.SELECTED)})},o8=function(t,r){tt(t,function(e){n0(e)&&e.rowIndex===r.getMeta().rowIndex&&e.colIndex===r.getMeta().colIndex&&r.updateByState(Xe.SELECTED)})},s8=function(t,r,e){var n,i=e.interaction.getSelectedCellHighlight(),a=i.rowHeader,o=i.colHeader,s=i.currentRow,l=i.currentCol,u=r.cellType===Le.ROW_CELL,h=e.isTableMode()&&((n=e.options.seriesNumber)===null||n===void 0?void 0:n.enable)&&a&&u;(s||h)&&i8(t,r),l&&a8(t,r),(a||o)&&o8(t,r)},Di=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return Object.defineProperty(r.prototype,"cellType",{get:function(){return Le.DATA_CELL},enumerable:!1,configurable:!0}),r.prototype.isMultiData=function(){var e=this.getFieldValue();return Lr(e)},r.prototype.isChartData=function(){var e=this.getFieldValue();return Yc(e==null?void 0:e.values)},r.prototype.getRenderChartData=function(){var e=this.meta.fieldValue;return e==null?void 0:e.values},r.prototype.getRenderChartOptions=function(){var e=this.getRenderChartData(),n=this.getBBoxByType(Qt.CONTENT_BOX),i=this.spreadsheet.getThemeName();return Y(Y({autoFit:!0,theme:{type:x6[i]}},n),e)},r.prototype.getBorderPositions=function(){return[At.BOTTOM,At.RIGHT]},Object.defineProperty(r.prototype,"valueRangeByField",{get:function(){return this.spreadsheet.dataSet.getValueRangeByField(this.meta.valueField)},enumerable:!1,configurable:!0}),r.prototype.handleByStateName=function(e,n){Za(e,this)&&this.updateByState(n)},r.prototype.handleSearchResult=function(e){if(Za(e,this)){var n=Rr(e,function(i){return i==null?void 0:i.isTarget});n.id===this.getMeta().id?this.updateByState(Xe.HIGHLIGHT):this.updateByState(Xe.SEARCH_RESULT)}},r.prototype.handleSelect=function(e){var n,i,a=(n=e==null?void 0:e[0])===null||n===void 0?void 0:n.type;switch(a){case Le.COL_CELL:this.changeRowColSelectState("colIndex");break;case Le.ROW_CELL:this.changeRowColSelectState("rowIndex");break;case Le.DATA_CELL:n8(this.spreadsheet)?s8(e,this,this.spreadsheet):Za(e,this)?this.updateByState(Xe.SELECTED):!((i=this.spreadsheet.options.interaction)===null||i===void 0)&&i.selectedCellsSpotlight&&this.updateByState(Xe.UNSELECTED);break}},r.prototype.isDisableHover=function(e){return e.type!==Le.DATA_CELL},r.prototype.handleHover=function(e){var n=Kc(e);if(this.isDisableHover(n)){this.hideInteractionShape();return}var i=this.spreadsheet.interaction.getHoverHighlight(),a=i.currentRow,o=i.currentCol;if(a||o){var s=this.meta.colIndex,l=this.meta.rowIndex;o&&s===(n==null?void 0:n.colIndex)||a&&l===(n==null?void 0:n.rowIndex)?this.updateByState(Xe.HOVER):this.hideInteractionShape()}var u=this.getMeta(),h=u.id,v=u.rowIndex,p=u.colIndex;tn(n.id,h)&&tn(n.rowIndex,v)&&tn(n.colIndex,p)&&this.updateByState(Xe.HOVER_FOCUS)},r.prototype.update=function(){var e=this.spreadsheet.interaction.getCurrentStateName(),n=this.spreadsheet.interaction.getCells();if(e===Xe.ALL_SELECTED){this.updateByState(Xe.SELECTED);return}if(!(ke(n)||!e))switch(e){case Xe.SELECTED:case Xe.DATA_CELL_BRUSH_SELECTED:this.handleSelect(n);break;case Xe.HOVER_FOCUS:case Xe.HOVER:this.handleHover(n);break;case Xe.SEARCH_RESULT:this.handleSearchResult(n);break;default:this.handleByStateName(n,e);break}},r.prototype.setMeta=function(e){t.prototype.setMeta.call(this,e),this.initCell()},r.prototype.drawTextShape=function(){t.prototype.drawTextShape.call(this),this.isShallowRender()||this.drawLinkField(this.meta)},r.prototype.initCell=function(){this.resetTextAndConditionIconShapes(),this.generateIconConfig(),this.drawBackgroundShape(),this.drawInteractiveBgShape(),this.shouldHideRowSubtotalData()||this.drawConditionIntervalShape(),this.shouldHideRowSubtotalData()||(this.drawTextShape(),this.drawConditionIconShapes()),this.drawBorders(),this.drawInteractiveBorderShape(),this.update()},r.prototype.generateIconConfig=function(){var e,n=this.findFieldCondition((e=this.conditions)===null||e===void 0?void 0:e.icon),i=n&&n.mapping&&{name:"",position:Qv(n)};this.groupedIcons=ux([],i)},r.prototype.getTextStyle=function(){var e=this.getCellTextWordWrapStyle(),n=this.meta.isTotals,i=this.theme.dataCell,a=n?i==null?void 0:i.bolderText:i==null?void 0:i.text;return this.getContainConditionMappingResultTextStyle(Y(Y({},e),a))},r.prototype.drawConditionIntervalShape=function(){this.conditionIntervalShape=_F(this)},r.prototype.shouldHideRowSubtotalData=function(){var e,n,i=this.meta,a=i.rowId,o=i.rowIndex,s=this.spreadsheet.store.get("drillDownIdPathMap");if(s!=null&&s.has(a))return!1;var l=((e=this.spreadsheet.options.totals)!==null&&e!==void 0?e:{}).row,u=l===void 0?{}:l,h=(n=this.spreadsheet.facet)===null||n===void 0?void 0:n.getRowLeafNodeByIndex(o),v=!(h!=null&&h.isGrandTotals)&&(h==null?void 0:h.isTotals);return this.spreadsheet.isHierarchyTreeType()&&!u.showSubTotals&&v},r.prototype.getFormattedFieldValue=function(){var e;if(this.shouldHideRowSubtotalData())return{value:null,formattedValue:ls};var n=this.meta,i=n.rowId,a=n.valueField,o=n.fieldValue,s=n.data,l=n.id,u=(e=this.spreadsheet.dataSet.displayFormattedValueMap)===null||e===void 0?void 0:e.get(l),h=this.spreadsheet.dataSet.getFieldMeta(i),v=h?i:a,p=this.spreadsheet.dataSet.getFieldFormatter(v),m=u??p(o,s,this.meta);return{value:o,formattedValue:m}},r.prototype.getMaxTextWidth=function(){var e=this.getBBoxByType(Qt.CONTENT_BOX).width;return e-this.getActionAndConditionIconWidth()},r.prototype.getTextPosition=function(){var e=this.getBBoxByType(Qt.CONTENT_BOX),n=this.getTextStyle(),i=this.getIconStyle(),a=Cs({bbox:e,iconStyle:i,textWidth:this.getActualTextWidth(),textAlign:n.textAlign,groupedIcons:this.groupedIcons}),o=a.textX,s=a.leftIconX,l=a.rightIconX,u=Sl(e,n.textBaseline),h=Ul(i.size,u,n.fontSize,n.textBaseline);return this.iconPosition={x:ke(this.groupedIcons.left)?l:s,y:h},{x:o,y:u}},r.prototype.getIconPosition=function(){return this.iconPosition},r.prototype.getBackgroundColor=function(){var e=this.getCrossBackgroundColor(this.meta.rowIndex),n=e.backgroundColor,i=e.backgroundColorOpacity;return this.shouldHideRowSubtotalData()?{backgroundColor:n,backgroundColorOpacity:i,intelligentReverseTextColor:!1}:Wl({backgroundColor:n,backgroundColorOpacity:i},this.getBackgroundConditionFill())},r.prototype.changeRowColSelectState=function(e){var n,i=this.spreadsheet.interaction,a=dt(this.meta,e),o=i.getState(),s=o.nodes,l=s===void 0?[]:s,u=o.cells,h=u===void 0?[]:u,v=!1;if(this.spreadsheet.isTableMode()&&l.length){var p=l[0].hierarchy.getLeaves();v=p.some(function(m,C){return l.some(function(w){return w===m})?C===a:!1})}else v=pe(pe([],te(l),!1),te(h),!1).some(function(m){return dt(m,e)===a});v?this.updateByState(Xe.SELECTED):!((n=this.spreadsheet.options.interaction)===null||n===void 0)&&n.selectedCellsSpotlight?this.updateByState(Xe.UNSELECTED):this.hideInteractionShape()},r.prototype.drawBorders=function(){},r.prototype.findFieldCondition=function(e){var n=this;return e===void 0&&(e=[]),Fv(e,function(i){return i.field instanceof RegExp?i.field.test(n.meta.valueField):i.field===n.meta.valueField})},r.prototype.mappingValue=function(e){var n=this.meta.fieldValue,i=this.spreadsheet.isTableMode()?this.spreadsheet.dataSet.getCellData({query:{rowIndex:this.meta.rowIndex}}):oi.getFieldValue(this.meta.data);return e.mapping(n,i,this)},r.prototype.updateByState=function(e){if(t.prototype.updateByState.call(this,e,this),e===Xe.UNSELECTED){var n=dt(this.theme,"".concat(this.cellType,".cell.interactionState.").concat(e));n&&this.toggleConditionIntervalShapeOpacity(n.opacity)}},r.prototype.clearUnselectedState=function(){t.prototype.clearUnselectedState.call(this),this.toggleConditionIntervalShapeOpacity(1)},r.prototype.toggleConditionIntervalShapeOpacity=function(e){Hn(this.conditionIntervalShape,xn.backgroundOpacity,e),Hn(this.conditionIconShapes,xn.opacity,e)},r}(Qc),Sx=function(t){Me(r,t);function r(e,n,i){return t.call(this,i,e,n)||this}return Object.defineProperty(r.prototype,"cellType",{get:function(){return Le.MERGED_CELL},enumerable:!1,configurable:!0}),r.prototype.handleRestOptions=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=te(e,1),a=i[0];this.cells=a},r.prototype.update=function(){},r.prototype.initCell=function(){this.resetTextAndConditionIconShapes(),this.drawBackgroundShape(),this.drawTextShape(),this.drawBorders()},r.prototype.drawBackgroundShape=function(){var e=f8(this.cells),n=this.theme.dataCell.cell;this.backgroundShape=vF(this,{points:e,fill:n.backgroundColor})},r.prototype.drawTextShape=function(){if(!ke(this.meta)){if(this.isMultiData())return IF(this);t.prototype.drawTextShape.call(this)}},r.prototype.drawBorders=function(){var e=this,n=h8(this.cells),i=n.right,a=n.bottom,o=n.bottomRightCornerCell;i.forEach(function(s){var l,u=Ad(At.RIGHT,s.getBBoxByType(),(l=s.getStyle())===null||l===void 0?void 0:l.cell),h=u.position,v=u.style;_r(e,Y(Y({},h),v))}),a.forEach(function(s){var l,u=Ad(At.BOTTOM,s.getBBoxByType(),(l=s.getStyle())===null||l===void 0?void 0:l.cell),h=u.position,v=u.style;_r(e,Y(Y({},h),v))}),o.forEach(function(s){var l,u=s.getBBoxByType(),h=u.x,v=u.y,p=u.width,m=u.height,C=(l=s.getStyle())===null||l===void 0?void 0:l.cell,w=C.horizontalBorderWidth,b=w===void 0?0:w,E=C.verticalBorderWidth,R=E===void 0?0:E,M=C.verticalBorderColor,k=h+p-R/2,L=k,_=v+m-b,I=v+m;_r(e,{x1:k,x2:L,y1:_,y2:I,lineWidth:R,stroke:M,strokeOpacity:R})})},r}(Di),l8=function(t,r,e,n){var i=[t,r],a=[t+e,r],o=[t+e,r+n],s=[t,r+n];return[[i,a],[a,o],[o,s],[s,i]]},u8=function(t){var r=[];return tt(t,function(e){var n=[e[1],e[0]];JSON.stringify(t).includes(JSON.stringify(n))||r.push(e)}),r},c8=function(t,r){return Rr(r,function(e){return tn(e[0],t[1])})},f8=function(t){var r=[];t.forEach(function(o){var s=o.getMeta(),l=s.x,u=s.y,h=s.width,v=s.height;r=r.concat(l8(l,u,h,v))}),r=u8(r);for(var e=[],n=r[0],i=n,a=[];!tn(n,a);)e=e.concat(i),a=c8(i,r),i=a;return e},h8=function(t){var r=[],e=[],n=[];return t.forEach(function(i){var a=te(i.position,2),o=a[0],s=a[1];Rr(t,function(l){return l.position[0]===o+1&&l.position[1]===s})||e.push(i),Rr(t,function(l){return l.position[1]===s+1&&l.position[0]===o})||r.push(i)}),r.forEach(function(i){var a=te(i.position,2),o=a[0],s=a[1],l=Rr(t,function(u){return u.position[0]===o-1&&u.position[1]===s});l&&!hn(r,l)&&n.push(l)}),{bottom:e,right:r,bottomRightCornerCell:n}},d8=function(t,r){var e=[],n;return tt(t,function(i){var a,o,s,l=(a=r==null?void 0:r.facet)===null||a===void 0?void 0:a.getCellMeta(i.rowIndex,i.colIndex);if(l){var u=(s=(o=r==null?void 0:r.options)===null||o===void 0?void 0:o.dataCell)===null||s===void 0?void 0:s.call(o,l);n=i!=null&&i.showText?l:n,e.push(u)}}),{cells:e,cellsMeta:n}},v8=function(t,r){var e=[],n=[],i;return tt(t,function(a){var o=Rr(r,function(s){var l,u=(l=s==null?void 0:s.getMeta)===null||l===void 0?void 0:l.call(s);if((u==null?void 0:u.colIndex)===(a==null?void 0:a.colIndex)&&(u==null?void 0:u.rowIndex)===(a==null?void 0:a.rowIndex))return s});o?(e.push(o),i=a!=null&&a.showText?o==null?void 0:o.getMeta():i):n.push(a)}),{cells:e,invisibleCellInfo:n,cellsMeta:i}},Ex=function(t,r,e){var n;e===void 0&&(e=[]);var i=v8(e,t),a=i.cellsMeta,o=i.cells,s=i.invisibleCellInfo,l=a,u=o,h=(s==null?void 0:s.length)>0&&s.length<e.length;if(h){var v=d8(s,r),p=v.cells,m=v.cellsMeta;l=l||m,u=o.concat(p)}return!ke(o)&&!l&&(l=(n=u[0])===null||n===void 0?void 0:n.getMeta()),{cells:u,viewMeta:l}},p8=function(t){var r=t.interaction,e=r.getActiveCells(),n=[];return tt(e,function(i,a){var o=i.getMeta(),s=a===0?{showText:!0}:{};n.push(Y(Y({},s),{colIndex:o==null?void 0:o.colIndex,rowIndex:o==null?void 0:o.rowIndex}))}),n},Tx=function(t,r,e){return t.options.mergedCell?t.options.mergedCell(t,r,e):new Sx(t,r,e)},g8=function(t,r,e){var n,i=r||p8(t);if((i==null?void 0:i.length)<=1){console.error("then merged cells must be more than one");return}var a=t.facet.getDataCells(),o=Ex(a,t,i),s=o.cells,l=o.viewMeta;if(!ke(s)){var u=((n=t.options)===null||n===void 0?void 0:n.mergedCellsInfo)||[];u.push(i),t.setOptions({mergedCellsInfo:u});var h=e?void 0:l;t.facet.panelScrollGroup.addMergeCell(Tx(t,s,h))}},m8=function(t,r){var e=ct(t.cells,function(n){return{colIndex:n.getMeta().colIndex,rowIndex:n.getMeta().rowIndex}});return ci(r,function(n){var i=n.map(function(a){return a.showText?{colIndex:a.colIndex,rowIndex:a.rowIndex}:a});return!tn(i,e)})},y8=function(t,r){var e,n,i;if(!r||r.cellType!==Le.MERGED_CELL){console.error("unmergeCell: the ".concat(r," is not a MergedCell"));return}var a=m8(r,((e=t.options)===null||e===void 0?void 0:e.mergedCellsInfo)||[]);(a==null?void 0:a.length)!==((i=(n=t.options)===null||n===void 0?void 0:n.mergedCellsInfo)===null||i===void 0?void 0:i.length)&&(t.setOptions({mergedCellsInfo:a}),r.remove())},C8=function(t){return ct(t,function(r){return{cells:r.cells,viewMeta:r.getMeta()}})},A1=function(t,r){return f5(t,r,function(e,n){return tn(e.viewMeta.id,n.viewMeta.id)})},w8=function(t,r){var e,n=(e=t.options)===null||e===void 0?void 0:e.mergedCellsInfo;if(!ke(n)){var i=t.facet.getDataCells();if(!ke(i)){var a=[];n.forEach(function(h){var v=Ex(i,t,h);v.cells.length>0&&a.push(v)});var o=r.children,s=C8(o),l=A1(s,a),u=A1(a,s);tt(l,function(h){var v=Rr(o,function(p){return tn(p.getMeta().id,h.viewMeta.id)});v==null||v.remove()}),tt(u,function(h){var v=h.cells,p=h.viewMeta;r.appendChild(Tx(t,v,p))})}}},Ei;(function(t){t[t.Start=0]="Start",t[t.Center=1]="Center",t[t.End=2]="End"})(Ei||(Ei={}));var i0=function(t){return["left","top"].includes(t)?Ei.Start:["center","middle"].includes(t)?Ei.Center:Ei.End},a0=function(t,r,e){var n=e.align,i=e.size,a=e.padding,o=i.textSize,s=i.iconStartSize,l=s===void 0?0:s,u=i.iconEndSize,h=u===void 0?0:u,v=a.betweenTextAndEndIcon,p=v===void 0?0:v;p=h?p:0;var m=o+l+h,C={start:r.start-a.start,size:r.size+a.start+a.end},w=C.start+C.size,b=r.start+r.size,E=t.start+t.size;function R(P){switch(n){case Ei.Start:return{iconStart:P.start,textStart:P.start+l,iconEnd:P.start+l+o+p};case Ei.Center:var U=P.start+P.size/2-m/2;return{iconStart:U,textStart:U+l+o/2,iconEnd:U+l+o+p};default:var q=P.start+P.size;return{iconStart:q-h-o-l,textStart:q-h,iconEnd:q-h+p}}}if(C.start>=t.start&&w<=E)return R(r);if(C.start<t.start&&w<=E){var M={start:t.start+(n!==Ei.End?a.start:0),size:r.size-(t.start-r.start)-(n!==Ei.End?a.start:0)};return M.size<m&&(M.size=m,M.start=b-m),R(M)}if(C.start>=t.start&&w>E){var k={start:r.start,size:r.size-(b-E)-(n!==Ei.Start?a.end:0)};return k.size<m&&(k.size=m,k.start=r.start),R(k)}var L={start:t.start+a.start,size:t.size-a.start-a.end};if(L.size<m){var _=r.start+r.size/2-m/2,I=_+m;_>L.start||(I>L.start+L.size?L.start=_:L.start-=m-L.size),L.size=m}return R(L)},El=function(t,r){return r>0&&t<r},Tl=function(t,r,e){return r>0&&t>=e-r},tf=function(t,r,e){return e>0&&t<r+e},Vl=function(t,r,e){return e>0&&t>=r+1-e},_x=function(t){var r=t.scrollX,e=t.scrollY,n=t.widths,i=t.heights,a=t.viewport,o=t.rowRemainWidth,s=Cl(n,function(p,m){var C=r-(nr(o)?0:o)+a.x;return C>=p&&C<n[m+1]},0);s=Math.max(s,0);var l=Cl(n,function(p,m){var C=a.width+r+a.x;return C>=p&&C<n[m+1]},s);l=Math.min(l===-1?1/0:l,n.length-2);var u=i.getIndexRange(e+a.y,a.height+e+a.y),h=u.start,v=u.end;return[s,l,h,v]},x8=function(t,r,e){var n=2,i=Math.abs(t/r),a=i<=1/n?0:t,o=i>n?0:r;return[a*e.horizontal,o*e.vertical]},Qn=function(t,r,e){if(t){var n=te(t.getPosition(),2),i=n[0],a=n[1];t.translate(r-i,e-a)}},Cc=function(t,r){if(t){var e=te(t.getPosition(),1),n=e[0];t.translate(r-n,0)}},b8=function(t,r,e,n){var i=r.colCount,a=i===void 0?0:i,o=r.rowCount,s=o===void 0?0:o,l=r.trailingColCount,u=l===void 0?0:l,h=r.trailingRowCount,v=h===void 0?0:h,p=t.colIndex,m=t.rowIndex;return tf(m,n.start,s)?cr.ROW:Vl(m,n.end,v)?cr.TRAILING_ROW:El(p,a)?cr.COL:Tl(p,u,e)?cr.TRAILING_COL:cr.SCROLL},S8=function(t,r,e){for(var n,i=t.colCount,a=i===void 0?0:i,o=t.rowCount,s=o===void 0?0:o,l=t.trailingColCount,u=l===void 0?0:l,h=t.trailingRowCount,v=h===void 0?0:h,p=(n={},n[cr.TOP]=[],n[cr.BOTTOM]=[],n),m=0;m<a;m++){for(var C=e.start;C<e.start+s;C++)p[cr.TOP].push({x:m,y:C});if(v>0)for(var C=0;C<v;C++){var w=e.end-C;p[cr.BOTTOM].push({x:m,y:w})}}for(var m=0;m<u;m++){for(var b=r-1-m,C=e.start;C<e.start+s;C++)p[cr.TOP].push({x:b,y:C});if(v>0)for(var C=0;C<v;C++){var w=e.end-C;p[cr.BOTTOM].push({x:b,y:w})}}return p},E8=function(t,r,e,n){var i=r.colCount,a=i===void 0?0:i,o=r.rowCount,s=o===void 0?0:o,l=r.trailingColCount,u=l===void 0?0:l,h=r.trailingRowCount,v=h===void 0?0:h,p=pe([],te(t),!1);El(p[0],a)&&(p[0]=a),Tl(p[1],u,e)&&(p[1]=e-u-1),tf(p[2],n.start,s)&&(p[2]=n.start+s),Vl(p[3],n.end,v)&&(p[3]=n.end-v);var m=pe([],te(p),!1);m[2]=n.start,m[3]=n.start+s-1;var C=pe([],te(p),!1);C[0]=0,C[1]=a-1;var w=pe([],te(p),!1);w[2]=n.end+1-v,w[3]=n.end;var b=pe([],te(p),!1);return b[0]=e-u,b[1]=e-1,{center:p,frozenRow:m,frozenCol:C,frozenTrailingCol:b,frozenTrailingRow:w}},T8=function(t,r){var e=t,n=0,i=e.getTotalLength()-1;if(r){var a=r.current,o=a===void 0?Ld:a,s=r.pageSize;n=Math.max((o-1)*s,0),i=Math.min(o*s-1,e.getTotalLength()-1)}return{start:n,end:i}},wc=function(t,r,e){var n=function(i){return i.isLeaf?1:i.children?i.children.reduce(function(a,o){return a+=n(o),a},0):0};return r&&(r=t.slice(0,r).reduce(function(i,a){return i+=n(a),i},0)),e&&(e=t.slice(t.length-e).reduce(function(i,a){return i+=n(a),i},0)),{colCount:r,trailingColCount:e}},_8=function(t){var r=[],e=function(n){n.forEach(function(i){typeof i=="string"||!i.children?r.push(i):e(i.children)})};return e(t),r},Xl=function(t){t===void 0&&(t=[]);var r=_8(t);return r.map(function(e){return typeof e=="string"?e:e.field})},Rx=function(t){var r=t.children[0];return r?r.isLeaf?r:Rx(r):t},R8=function(t){return ke(t.rows)&&ke(t.columns)&&ke(t.values)},Lx=function(t,r){var e,n=t.pagination,i=t.frozen,a=t.hierarchyType,o=t.seriesNumber,s=n&&n.pageSize,l=!1,u=r==null?void 0:r[0];if(!s&&!(o!=null&&o.enable)&&(i!=null&&i.firstRow)){var h=a==="tree";l=h||((e=u==null?void 0:u.children)===null||e===void 0?void 0:e.length)===0}var v=l&&!!u;return{rowCount:v?1:0,colCount:0,trailingColCount:0,trailingRowCount:0,firstRow:l,rowHeight:v?u.height:0}},rf=function(t){Me(r,t);function r(e){var n=t.call(this)||this;return n.isHeaderCellInViewport=function(i){var a=i.cellPosition,o=i.cellSize,s=i.viewportPosition,l=i.viewportSize;return a+o>=s&&s+l>=a},n.headerConfig=e,n}return r.prototype.getHeaderConfig=function(){return this.headerConfig||{}},r.prototype.clearResizeAreaGroup=function(e){var n=this.parentNode,i=n==null?void 0:n.getElementById(e);i==null||i.removeChildren()},r.prototype.render=function(e){this.clearResizeAreaGroup(e),this.clear(),this.layout(),this.offset(),this.clip()},r.prototype.onScrollXY=function(e,n,i){this.headerConfig.scrollX=e,this.headerConfig.scrollY=n,this.render(i)},r.prototype.onRowScrollX=function(e,n){this.headerConfig.scrollX=e,this.render(n)},r.prototype.clear=function(){t.prototype.removeChildren.call(this)},r}(Ft),Mx=function(t){Me(r,t);function r(e){var n=t.call(this,e)||this;return n.initScrollGroup(),n}return r.prototype.getCellInstance=function(e){var n=this.getHeaderConfig(),i=this.getHeaderConfig().spreadsheet,a=i.options.colCell;return(a==null?void 0:a(e,i,n))||new $l(e,i,n)},r.prototype.initScrollGroup=function(){this.scrollGroup=this.appendChild(new Ft({name:yB,style:{zIndex:zw}}))},r.prototype.onColScroll=function(e,n){this.headerConfig.scrollX!==e&&(this.headerConfig.scrollX=e,this.render(n))},r.prototype.clip=function(){var e=this.getHeaderConfig(),n=e.height,i=e.width,a=e.spreadsheet,o=e.position,s=a.isFrozenRowHeader();this.scrollGroup.style.clipPath=new Zt({style:{x:s?o.x:0,y:s?o.y:0,width:s?i:o.x+i,height:n}})},r.prototype.clear=function(){var e;(e=this.scrollGroup)===null||e===void 0||e.removeChildren()},r.prototype.getCellGroup=function(e){return this.scrollGroup},r.prototype.isColCellInRect=function(e){var n=this.getHeaderConfig(),i=n.spreadsheet,a=n.cornerWidth,o=n.width,s=n.scrollX,l=s===void 0?0:s;return o+l>e.x&&l-(i.isFrozenRowHeader()?0:a)<e.x+e.width},r.prototype.layout=function(){var e=this,n=this.getHeaderConfig(),i=n.nodes,a=n.spreadsheet;tt(i,function(o){if(e.isColCellInRect(o)){var s=e.getCellGroup(o);o.isFrozen=s!==e.scrollGroup;var l=e.getCellInstance(o);o.belongsCell=l,s==null||s.appendChild(l),a.emit(se.COL_CELL_RENDER,l),a.emit(se.LAYOUT_CELL_RENDER,l)}})},r.prototype.offset=function(){var e=this.getHeaderConfig(),n=e.position,i=e.scrollX,a=i===void 0?0:i;Cc(this.scrollGroup,n.x-a)},r}(rf),_l=function(t){var r=t.type,e=t.theme,n=t.width,i=t.height,a=nn(t,["type","theme","width","height"]),o=r===zr.Horizontal?e.size:void 0,s=r===zr.Vertical?e.size:void 0;return{style:{fill:e.background,fillOpacity:e.backgroundOpacity,cursor:"".concat(r,"-resize"),width:o,height:s},appendInfo:Y(Y({},a),{isResizeArea:!0,type:r,width:n,height:i,size:e.size})}},Qa=function(t,r){var e;if(!((e=t.facet)===null||e===void 0)&&e.foregroundGroup){var n=t.facet.foregroundGroup.getElementById(r);return n||t.facet.foregroundGroup.appendChild(new Ft({id:r,style:{zIndex:tB}}))}},Yl=function(t,r,e){var n=e??{},i=n.scrollX,a=i===void 0?0:i,o=n.scrollY,s=o===void 0?0:o,l=!(t.x-a>r.x+r.width||t.x+t.width-a<r.x),u=!(t.y-s>r.y+r.height||t.y+t.height-s<r.y);return l&&u};function xc(t){return t===void 0&&(t=[]),t.filter(function(r){return r!==it})}function Rl(t){return t===Xu}function qa(t,r,e){return t===void 0&&(t={}),r===void 0&&(r=[]),e===void 0&&(e=la),r.reduce(function(n,i){var a=t[i];return i in t?n.push(String(a)):n.push(e),n},[])}function Ox(t,r){var e=r.filter(function(n){return n in t});return ke(e)&&e.push(mv),e}function N1(t,r,e){t===void 0&&(t={}),r===void 0&&(r=[]);var n=[];function i(a,o,s){return o.reduce(function(l,u){var h=a[u];return u in a?l.push(String(h)):u===it&&s?l.push(s):l.push(la),l},[])}return e?e.forEach(function(a){n.push(i(t,r,a))}):n.push(i(t,r)),n}function L8(t,r,e){var n;r===void 0&&(r=[]);var i=r.slice(0,r.indexOf(t)+1);return(n=e.map(function(a){return i.map(function(o){return a.getValueByField(o)}).join("".concat(rn))}))===null||n===void 0?void 0:n.filter(Boolean)}function bc(t,r){return t.concat(r).filter(function(e){return e!==it}).join(rn)}function Sc(t){var r=t.rowDimensionValues,e=t.colDimensionValues,n=t.isFirstCreate,i=t.onFirstCreate,a=t.rowFields,o=t.colFields,s=t.rowPivotMeta,l=t.colPivotMeta,u=t.prefix,h=u===void 0?"":u,v=function(C,w,b,E){for(var R=b,M=[],k=0;k<w.length;k++){var L=w[k];if(n&&R&&!(R!=null&&R.has(L))){var _=w.slice(0,k+1).map(function(J){return String(J)}),I=_.join(rn),P=L===la,U=void 0;P?U=0:R.has(la)?U=R.size:U=R.size+1,R.set(L,{id:I,dimensions:_,value:L,level:U,children:new Map}),i==null||i({dimension:C==null?void 0:C[k],dimensionPath:I,careRepeated:E})}var q=R==null?void 0:R.get(L);if(M.push(Rl(L)?L:q==null?void 0:q.level),q){var Q=C==null?void 0:C[k+1];n&&q.childField!==Q&&(q.childField=Q),R=q==null?void 0:q.children}}return M},p=v(a,r,s,!1),m=v(o,e,l,!0);return pe(pe([h],te(p),!1),te(m),!1)}function M8(t){var r=t.rows,e=t.columns,n=t.values,i=t.valueInCols,a=t.data,o=a===void 0?[]:a,s=t.indexesData,l=s===void 0?{}:s,u=t.sortedDimensionValues,h=t.rowPivotMeta,v=t.colPivotMeta,p=t.getExistValuesByDataItem,m=[],C=new Set(W5(r,e)),w=function(E){var R=E.dimension,M=E.dimensionPath,k=E.careRepeated,L=k===void 0?!0:k;L&&C.has(R)||(u[R]||(u[R]=[])).push(M)},b=bc(r,e);return o.forEach(function(E){var R,M,k,L;if(!(!E||ke(E))){var _=p?p(E,n):Ox(E,n),I=N1(E,r,i?null:_),P=N1(E,e,i?_:null);try{for(var U=Wr(I),q=U.next();!q.done;q=U.next()){var Q=q.value;try{for(var J=(k=void 0,Wr(P)),re=J.next();!re.done;re=J.next()){var ne=re.value,ce=Sc({rowDimensionValues:Q,colDimensionValues:ne,rowPivotMeta:h,colPivotMeta:v,rowFields:r,colFields:e,isFirstCreate:!0,onFirstCreate:w,prefix:b});m.push(ce),wd(l,ce,E)}}catch(me){k={error:me}}finally{try{re&&!re.done&&(L=J.return)&&L.call(J)}finally{if(k)throw k.error}}}}catch(me){R={error:me}}finally{try{q&&!q.done&&(M=U.return)&&M.call(U)}finally{if(R)throw R.error}}}}),{paths:m,indexesData:l,rowPivotMeta:h,colPivotMeta:v,sortedDimensionValues:u}}function k1(t,r){if(!(!t||!r)){var e=r.split(rn),n=mr(e),i=t;tt(e,function(a,o){var s=i.get(a);return s?(a===n?(s.children=new Map,s.childField=void 0):i=s.children,!0):o===0&&a===ul})}}function O8(t,r,e){var n=function(o){var s=Rr(t,function(l){var u=l.field;return u===o});return dt(s,"name",o)},i=r||e,a={field:it,name:i,formatter:function(o){return n(o)}};return a}function A8(t){for(var r=null,e=0;e<t.length;e++){var n=t[e];if(Rl(n))r=e;else if(!ww(r)&&r<e)return!0}return!1}function Ax(t){var r=t.pivotMeta,e=t.dimensionValues,n=t.fieldIdx,i=t.queryType,a=t.fields,o=t.sortedDimensionValues,s={children:r},l=[s];function u(p,m){var C,w=zl(p,function(E){var R=pe([],te(E.children.values()),!1);return R.filter(function(M){return M.value!==mv&&(i===ki.All?!0:M.value!==la)})});if(p.length>1){var b=(C=o[m])!==null&&C!==void 0?C:[];return Uv(w,function(E){return Zc(b,E.id)})}return w}for(var h=function(p){var m=e[p],C=a[p];Rl(m)?l=u(l,C):l=l.map(function(w){return w.children.get(m)}).filter(Boolean)},v=0;v<=n;v++)h(v);return l}function I1(t){var r=t.dimensionValues,e=t.pivotMeta,n=t.fields,i=t.sortedDimensionValues,a=t.queryType,o=a===void 0?ki.All:a;if(!A8(r))return[r];var s=Ax({pivotMeta:e,dimensionValues:r,fieldIdx:r.length-1,queryType:o,fields:n,sortedDimensionValues:i});return s.map(function(l){return l.dimensions})}function N8(t){var r=t.rowFields,e=t.rowDimensionValues,n=t.rowPivotMeta,i=t.colFields,a=t.colDimensionValues,o=t.colPivotMeta,s=t.queryType,l=t.sortedDimensionValues,u=I1({dimensionValues:e,pivotMeta:n,fields:r,sortedDimensionValues:l,queryType:s}),h=I1({dimensionValues:a,pivotMeta:o,fields:i,sortedDimensionValues:l,queryType:s});return{rowQueries:u,colQueries:h}}function k8(t,r){return t?vt(t)?zl(t,function(e){if(!vt(e))return ai([e]);var n=r===ki.DetailOnly?1:0;return ai(e.slice(n))}):ai([t]):[]}/*!
 *  decimal.js v10.4.3
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2022 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var Vo=9e15,Da=1e9,Pd="0123456789abcdef",Ec="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Tc="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Dd={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Vo,maxE:Vo,crypto:!1},Nx,ia,Je=!0,nf="[DecimalError] ",ka=nf+"Invalid argument: ",kx=nf+"Precision limit exceeded",Ix=nf+"crypto unavailable",Px="[object Decimal]",Vr=Math.floor,vr=Math.pow,I8=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,P8=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,D8=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Dx=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,si=1e7,Ke=7,B8=9007199254740991,F8=Ec.length-1,Bd=Tc.length-1,_e={toStringTag:Px};_e.absoluteValue=_e.abs=function(){var t=new this.constructor(this);return t.s<0&&(t.s=1),qe(t)};_e.ceil=function(){return qe(new this.constructor(this),this.e+1,2)};_e.clampedTo=_e.clamp=function(t,r){var e,n=this,i=n.constructor;if(t=new i(t),r=new i(r),!t.s||!r.s)return new i(NaN);if(t.gt(r))throw Error(ka+r);return e=n.cmp(t),e<0?t:n.cmp(r)>0?r:new i(n)};_e.comparedTo=_e.cmp=function(t){var r,e,n,i,a=this,o=a.d,s=(t=new a.constructor(t)).d,l=a.s,u=t.s;if(!o||!s)return!l||!u?NaN:l!==u?l:o===s?0:!o^l<0?1:-1;if(!o[0]||!s[0])return o[0]?l:s[0]?-u:0;if(l!==u)return l;if(a.e!==t.e)return a.e>t.e^l<0?1:-1;for(n=o.length,i=s.length,r=0,e=n<i?n:i;r<e;++r)if(o[r]!==s[r])return o[r]>s[r]^l<0?1:-1;return n===i?0:n>i^l<0?1:-1};_e.cosine=_e.cos=function(){var t,r,e=this,n=e.constructor;return e.d?e.d[0]?(t=n.precision,r=n.rounding,n.precision=t+Math.max(e.e,e.sd())+Ke,n.rounding=1,e=H8(n,Wx(n,e)),n.precision=t,n.rounding=r,qe(ia==2||ia==3?e.neg():e,t,r,!0)):new n(1):new n(NaN)};_e.cubeRoot=_e.cbrt=function(){var t,r,e,n,i,a,o,s,l,u,h=this,v=h.constructor;if(!h.isFinite()||h.isZero())return new v(h);for(Je=!1,a=h.s*vr(h.s*h,1/3),!a||Math.abs(a)==1/0?(e=Or(h.d),t=h.e,(a=(t-e.length+1)%3)&&(e+=a==1||a==-2?"0":"00"),a=vr(e,1/3),t=Vr((t+1)/3)-(t%3==(t<0?-1:2)),a==1/0?e="5e"+t:(e=a.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),n=new v(e),n.s=h.s):n=new v(a.toString()),o=(t=v.precision)+3;;)if(s=n,l=s.times(s).times(s),u=l.plus(h),n=Nt(u.plus(h).times(s),u.plus(l),o+2,1),Or(s.d).slice(0,o)===(e=Or(n.d)).slice(0,o))if(e=e.slice(o-3,o+1),e=="9999"||!i&&e=="4999"){if(!i&&(qe(s,t+1,0),s.times(s).times(s).eq(h))){n=s;break}o+=4,i=1}else{(!+e||!+e.slice(1)&&e.charAt(0)=="5")&&(qe(n,t+1,1),r=!n.times(n).times(n).eq(h));break}return Je=!0,qe(n,t,v.rounding,r)};_e.decimalPlaces=_e.dp=function(){var t,r=this.d,e=NaN;if(r){if(t=r.length-1,e=(t-Vr(this.e/Ke))*Ke,t=r[t],t)for(;t%10==0;t/=10)e--;e<0&&(e=0)}return e};_e.dividedBy=_e.div=function(t){return Nt(this,new this.constructor(t))};_e.dividedToIntegerBy=_e.divToInt=function(t){var r=this,e=r.constructor;return qe(Nt(r,new e(t),0,1,1),e.precision,e.rounding)};_e.equals=_e.eq=function(t){return this.cmp(t)===0};_e.floor=function(){return qe(new this.constructor(this),this.e+1,3)};_e.greaterThan=_e.gt=function(t){return this.cmp(t)>0};_e.greaterThanOrEqualTo=_e.gte=function(t){var r=this.cmp(t);return r==1||r===0};_e.hyperbolicCosine=_e.cosh=function(){var t,r,e,n,i,a=this,o=a.constructor,s=new o(1);if(!a.isFinite())return new o(a.s?1/0:NaN);if(a.isZero())return s;e=o.precision,n=o.rounding,o.precision=e+Math.max(a.e,a.sd())+4,o.rounding=1,i=a.d.length,i<32?(t=Math.ceil(i/3),r=(1/of(4,t)).toString()):(t=16,r="2.3283064365386962890625e-10"),a=hs(o,1,a.times(r),new o(1),!0);for(var l,u=t,h=new o(8);u--;)l=a.times(a),a=s.minus(l.times(h.minus(l.times(h))));return qe(a,o.precision=e,o.rounding=n,!0)};_e.hyperbolicSine=_e.sinh=function(){var t,r,e,n,i=this,a=i.constructor;if(!i.isFinite()||i.isZero())return new a(i);if(r=a.precision,e=a.rounding,a.precision=r+Math.max(i.e,i.sd())+4,a.rounding=1,n=i.d.length,n<3)i=hs(a,2,i,i,!0);else{t=1.4*Math.sqrt(n),t=t>16?16:t|0,i=i.times(1/of(5,t)),i=hs(a,2,i,i,!0);for(var o,s=new a(5),l=new a(16),u=new a(20);t--;)o=i.times(i),i=i.times(s.plus(o.times(l.times(o).plus(u))))}return a.precision=r,a.rounding=e,qe(i,r,e,!0)};_e.hyperbolicTangent=_e.tanh=function(){var t,r,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+7,n.rounding=1,Nt(e.sinh(),e.cosh(),n.precision=t,n.rounding=r)):new n(e.s)};_e.inverseCosine=_e.acos=function(){var t,r=this,e=r.constructor,n=r.abs().cmp(1),i=e.precision,a=e.rounding;return n!==-1?n===0?r.isNeg()?ri(e,i,a):new e(0):new e(NaN):r.isZero()?ri(e,i+4,a).times(.5):(e.precision=i+6,e.rounding=1,r=r.asin(),t=ri(e,i+4,a).times(.5),e.precision=i,e.rounding=a,t.minus(r))};_e.inverseHyperbolicCosine=_e.acosh=function(){var t,r,e=this,n=e.constructor;return e.lte(1)?new n(e.eq(1)?0:NaN):e.isFinite()?(t=n.precision,r=n.rounding,n.precision=t+Math.max(Math.abs(e.e),e.sd())+4,n.rounding=1,Je=!1,e=e.times(e).minus(1).sqrt().plus(e),Je=!0,n.precision=t,n.rounding=r,e.ln()):new n(e)};_e.inverseHyperbolicSine=_e.asinh=function(){var t,r,e=this,n=e.constructor;return!e.isFinite()||e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+2*Math.max(Math.abs(e.e),e.sd())+6,n.rounding=1,Je=!1,e=e.times(e).plus(1).sqrt().plus(e),Je=!0,n.precision=t,n.rounding=r,e.ln())};_e.inverseHyperbolicTangent=_e.atanh=function(){var t,r,e,n,i=this,a=i.constructor;return i.isFinite()?i.e>=0?new a(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(t=a.precision,r=a.rounding,n=i.sd(),Math.max(n,t)<2*-i.e-1?qe(new a(i),t,r,!0):(a.precision=e=n-i.e,i=Nt(i.plus(1),new a(1).minus(i),e+t,1),a.precision=t+4,a.rounding=1,i=i.ln(),a.precision=t,a.rounding=r,i.times(.5))):new a(NaN)};_e.inverseSine=_e.asin=function(){var t,r,e,n,i=this,a=i.constructor;return i.isZero()?new a(i):(r=i.abs().cmp(1),e=a.precision,n=a.rounding,r!==-1?r===0?(t=ri(a,e+4,n).times(.5),t.s=i.s,t):new a(NaN):(a.precision=e+6,a.rounding=1,i=i.div(new a(1).minus(i.times(i)).sqrt().plus(1)).atan(),a.precision=e,a.rounding=n,i.times(2)))};_e.inverseTangent=_e.atan=function(){var t,r,e,n,i,a,o,s,l,u=this,h=u.constructor,v=h.precision,p=h.rounding;if(u.isFinite()){if(u.isZero())return new h(u);if(u.abs().eq(1)&&v+4<=Bd)return o=ri(h,v+4,p).times(.25),o.s=u.s,o}else{if(!u.s)return new h(NaN);if(v+4<=Bd)return o=ri(h,v+4,p).times(.5),o.s=u.s,o}for(h.precision=s=v+10,h.rounding=1,e=Math.min(28,s/Ke+2|0),t=e;t;--t)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(Je=!1,r=Math.ceil(s/Ke),n=1,l=u.times(u),o=new h(u),i=u;t!==-1;)if(i=i.times(l),a=o.minus(i.div(n+=2)),i=i.times(l),o=a.plus(i.div(n+=2)),o.d[r]!==void 0)for(t=r;o.d[t]===a.d[t]&&t--;);return e&&(o=o.times(2<<e-1)),Je=!0,qe(o,h.precision=v,h.rounding=p,!0)};_e.isFinite=function(){return!!this.d};_e.isInteger=_e.isInt=function(){return!!this.d&&Vr(this.e/Ke)>this.d.length-2};_e.isNaN=function(){return!this.s};_e.isNegative=_e.isNeg=function(){return this.s<0};_e.isPositive=_e.isPos=function(){return this.s>0};_e.isZero=function(){return!!this.d&&this.d[0]===0};_e.lessThan=_e.lt=function(t){return this.cmp(t)<0};_e.lessThanOrEqualTo=_e.lte=function(t){return this.cmp(t)<1};_e.logarithm=_e.log=function(t){var r,e,n,i,a,o,s,l,u=this,h=u.constructor,v=h.precision,p=h.rounding,m=5;if(t==null)t=new h(10),r=!0;else{if(t=new h(t),e=t.d,t.s<0||!e||!e[0]||t.eq(1))return new h(NaN);r=t.eq(10)}if(e=u.d,u.s<0||!e||!e[0]||u.eq(1))return new h(e&&!e[0]?-1/0:u.s!=1?NaN:e?0:1/0);if(r)if(e.length>1)a=!0;else{for(i=e[0];i%10===0;)i/=10;a=i!==1}if(Je=!1,s=v+m,o=ba(u,s),n=r?_c(h,s+10):ba(t,s),l=Nt(o,n,s,1),Ll(l.d,i=v,p))do if(s+=10,o=ba(u,s),n=r?_c(h,s+10):ba(t,s),l=Nt(o,n,s,1),!a){+Or(l.d).slice(i+1,i+15)+1==1e14&&(l=qe(l,v+1,0));break}while(Ll(l.d,i+=10,p));return Je=!0,qe(l,v,p)};_e.minus=_e.sub=function(t){var r,e,n,i,a,o,s,l,u,h,v,p,m=this,C=m.constructor;if(t=new C(t),!m.d||!t.d)return!m.s||!t.s?t=new C(NaN):m.d?t.s=-t.s:t=new C(t.d||m.s!==t.s?m:NaN),t;if(m.s!=t.s)return t.s=-t.s,m.plus(t);if(u=m.d,p=t.d,s=C.precision,l=C.rounding,!u[0]||!p[0]){if(p[0])t.s=-t.s;else if(u[0])t=new C(m);else return new C(l===3?-0:0);return Je?qe(t,s,l):t}if(e=Vr(t.e/Ke),h=Vr(m.e/Ke),u=u.slice(),a=h-e,a){for(v=a<0,v?(r=u,a=-a,o=p.length):(r=p,e=h,o=u.length),n=Math.max(Math.ceil(s/Ke),o)+2,a>n&&(a=n,r.length=1),r.reverse(),n=a;n--;)r.push(0);r.reverse()}else{for(n=u.length,o=p.length,v=n<o,v&&(o=n),n=0;n<o;n++)if(u[n]!=p[n]){v=u[n]<p[n];break}a=0}for(v&&(r=u,u=p,p=r,t.s=-t.s),o=u.length,n=p.length-o;n>0;--n)u[o++]=0;for(n=p.length;n>a;){if(u[--n]<p[n]){for(i=n;i&&u[--i]===0;)u[i]=si-1;--u[i],u[n]+=si}u[n]-=p[n]}for(;u[--o]===0;)u.pop();for(;u[0]===0;u.shift())--e;return u[0]?(t.d=u,t.e=af(u,e),Je?qe(t,s,l):t):new C(l===3?-0:0)};_e.modulo=_e.mod=function(t){var r,e=this,n=e.constructor;return t=new n(t),!e.d||!t.s||t.d&&!t.d[0]?new n(NaN):!t.d||e.d&&!e.d[0]?qe(new n(e),n.precision,n.rounding):(Je=!1,n.modulo==9?(r=Nt(e,t.abs(),0,3,1),r.s*=t.s):r=Nt(e,t,0,n.modulo,1),r=r.times(t),Je=!0,e.minus(r))};_e.naturalExponential=_e.exp=function(){return Fd(this)};_e.naturalLogarithm=_e.ln=function(){return ba(this)};_e.negated=_e.neg=function(){var t=new this.constructor(this);return t.s=-t.s,qe(t)};_e.plus=_e.add=function(t){var r,e,n,i,a,o,s,l,u,h,v=this,p=v.constructor;if(t=new p(t),!v.d||!t.d)return!v.s||!t.s?t=new p(NaN):v.d||(t=new p(t.d||v.s===t.s?v:NaN)),t;if(v.s!=t.s)return t.s=-t.s,v.minus(t);if(u=v.d,h=t.d,s=p.precision,l=p.rounding,!u[0]||!h[0])return h[0]||(t=new p(v)),Je?qe(t,s,l):t;if(a=Vr(v.e/Ke),n=Vr(t.e/Ke),u=u.slice(),i=a-n,i){for(i<0?(e=u,i=-i,o=h.length):(e=h,n=a,o=u.length),a=Math.ceil(s/Ke),o=a>o?a+1:o+1,i>o&&(i=o,e.length=1),e.reverse();i--;)e.push(0);e.reverse()}for(o=u.length,i=h.length,o-i<0&&(i=o,e=h,h=u,u=e),r=0;i;)r=(u[--i]=u[i]+h[i]+r)/si|0,u[i]%=si;for(r&&(u.unshift(r),++n),o=u.length;u[--o]==0;)u.pop();return t.d=u,t.e=af(u,n),Je?qe(t,s,l):t};_e.precision=_e.sd=function(t){var r,e=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(ka+t);return e.d?(r=Bx(e.d),t&&e.e+1>r&&(r=e.e+1)):r=NaN,r};_e.round=function(){var t=this,r=t.constructor;return qe(new r(t),t.e+1,r.rounding)};_e.sine=_e.sin=function(){var t,r,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+Math.max(e.e,e.sd())+Ke,n.rounding=1,e=W8(n,Wx(n,e)),n.precision=t,n.rounding=r,qe(ia>2?e.neg():e,t,r,!0)):new n(NaN)};_e.squareRoot=_e.sqrt=function(){var t,r,e,n,i,a,o=this,s=o.d,l=o.e,u=o.s,h=o.constructor;if(u!==1||!s||!s[0])return new h(!u||u<0&&(!s||s[0])?NaN:s?o:1/0);for(Je=!1,u=Math.sqrt(+o),u==0||u==1/0?(r=Or(s),(r.length+l)%2==0&&(r+="0"),u=Math.sqrt(r),l=Vr((l+1)/2)-(l<0||l%2),u==1/0?r="5e"+l:(r=u.toExponential(),r=r.slice(0,r.indexOf("e")+1)+l),n=new h(r)):n=new h(u.toString()),e=(l=h.precision)+3;;)if(a=n,n=a.plus(Nt(o,a,e+2,1)).times(.5),Or(a.d).slice(0,e)===(r=Or(n.d)).slice(0,e))if(r=r.slice(e-3,e+1),r=="9999"||!i&&r=="4999"){if(!i&&(qe(a,l+1,0),a.times(a).eq(o))){n=a;break}e+=4,i=1}else{(!+r||!+r.slice(1)&&r.charAt(0)=="5")&&(qe(n,l+1,1),t=!n.times(n).eq(o));break}return Je=!0,qe(n,l,h.rounding,t)};_e.tangent=_e.tan=function(){var t,r,e=this,n=e.constructor;return e.isFinite()?e.isZero()?new n(e):(t=n.precision,r=n.rounding,n.precision=t+10,n.rounding=1,e=e.sin(),e.s=1,e=Nt(e,new n(1).minus(e.times(e)).sqrt(),t+10,0),n.precision=t,n.rounding=r,qe(ia==2||ia==4?e.neg():e,t,r,!0)):new n(NaN)};_e.times=_e.mul=function(t){var r,e,n,i,a,o,s,l,u,h=this,v=h.constructor,p=h.d,m=(t=new v(t)).d;if(t.s*=h.s,!p||!p[0]||!m||!m[0])return new v(!t.s||p&&!p[0]&&!m||m&&!m[0]&&!p?NaN:!p||!m?t.s/0:t.s*0);for(e=Vr(h.e/Ke)+Vr(t.e/Ke),l=p.length,u=m.length,l<u&&(a=p,p=m,m=a,o=l,l=u,u=o),a=[],o=l+u,n=o;n--;)a.push(0);for(n=u;--n>=0;){for(r=0,i=l+n;i>n;)s=a[i]+m[n]*p[i-n-1]+r,a[i--]=s%si|0,r=s/si|0;a[i]=(a[i]+r)%si|0}for(;!a[--o];)a.pop();return r?++e:a.shift(),t.d=a,t.e=af(a,e),Je?qe(t,v.precision,v.rounding):t};_e.toBinary=function(t,r){return o0(this,2,t,r)};_e.toDecimalPlaces=_e.toDP=function(t,r){var e=this,n=e.constructor;return e=new n(e),t===void 0?e:(gn(t,0,Da),r===void 0?r=n.rounding:gn(r,0,8),qe(e,t+e.e+1,r))};_e.toExponential=function(t,r){var e,n=this,i=n.constructor;return t===void 0?e=Bi(n,!0):(gn(t,0,Da),r===void 0?r=i.rounding:gn(r,0,8),n=qe(new i(n),t+1,r),e=Bi(n,!0,t+1)),n.isNeg()&&!n.isZero()?"-"+e:e};_e.toFixed=function(t,r){var e,n,i=this,a=i.constructor;return t===void 0?e=Bi(i):(gn(t,0,Da),r===void 0?r=a.rounding:gn(r,0,8),n=qe(new a(i),t+i.e+1,r),e=Bi(n,!1,t+n.e+1)),i.isNeg()&&!i.isZero()?"-"+e:e};_e.toFraction=function(t){var r,e,n,i,a,o,s,l,u,h,v,p,m=this,C=m.d,w=m.constructor;if(!C)return new w(m);if(u=e=new w(1),n=l=new w(0),r=new w(n),a=r.e=Bx(C)-m.e-1,o=a%Ke,r.d[0]=vr(10,o<0?Ke+o:o),t==null)t=a>0?r:u;else{if(s=new w(t),!s.isInt()||s.lt(u))throw Error(ka+s);t=s.gt(r)?a>0?r:u:s}for(Je=!1,s=new w(Or(C)),h=w.precision,w.precision=a=C.length*Ke*2;v=Nt(s,r,0,1,1),i=e.plus(v.times(n)),i.cmp(t)!=1;)e=n,n=i,i=u,u=l.plus(v.times(i)),l=i,i=r,r=s.minus(v.times(i)),s=i;return i=Nt(t.minus(e),n,0,1,1),l=l.plus(i.times(u)),e=e.plus(i.times(n)),l.s=u.s=m.s,p=Nt(u,n,a,1).minus(m).abs().cmp(Nt(l,e,a,1).minus(m).abs())<1?[u,n]:[l,e],w.precision=h,Je=!0,p};_e.toHexadecimal=_e.toHex=function(t,r){return o0(this,16,t,r)};_e.toNearest=function(t,r){var e=this,n=e.constructor;if(e=new n(e),t==null){if(!e.d)return e;t=new n(1),r=n.rounding}else{if(t=new n(t),r===void 0?r=n.rounding:gn(r,0,8),!e.d)return t.s?e:t;if(!t.d)return t.s&&(t.s=e.s),t}return t.d[0]?(Je=!1,e=Nt(e,t,0,r,1).times(t),Je=!0,qe(e)):(t.s=e.s,e=t),e};_e.toNumber=function(){return+this};_e.toOctal=function(t,r){return o0(this,8,t,r)};_e.toPower=_e.pow=function(t){var r,e,n,i,a,o,s=this,l=s.constructor,u=+(t=new l(t));if(!s.d||!t.d||!s.d[0]||!t.d[0])return new l(vr(+s,u));if(s=new l(s),s.eq(1))return s;if(n=l.precision,a=l.rounding,t.eq(1))return qe(s,n,a);if(r=Vr(t.e/Ke),r>=t.d.length-1&&(e=u<0?-u:u)<=B8)return i=Fx(l,s,e,n),t.s<0?new l(1).div(i):qe(i,n,a);if(o=s.s,o<0){if(r<t.d.length-1)return new l(NaN);if(t.d[r]&1||(o=1),s.e==0&&s.d[0]==1&&s.d.length==1)return s.s=o,s}return e=vr(+s,u),r=e==0||!isFinite(e)?Vr(u*(Math.log("0."+Or(s.d))/Math.LN10+s.e+1)):new l(e+"").e,r>l.maxE+1||r<l.minE-1?new l(r>0?o/0:0):(Je=!1,l.rounding=s.s=1,e=Math.min(12,(r+"").length),i=Fd(t.times(ba(s,n+e)),n),i.d&&(i=qe(i,n+5,1),Ll(i.d,n,a)&&(r=n+10,i=qe(Fd(t.times(ba(s,r+e)),r),r+5,1),+Or(i.d).slice(n+1,n+15)+1==1e14&&(i=qe(i,n+1,0)))),i.s=o,Je=!0,l.rounding=a,qe(i,n,a))};_e.toPrecision=function(t,r){var e,n=this,i=n.constructor;return t===void 0?e=Bi(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(gn(t,1,Da),r===void 0?r=i.rounding:gn(r,0,8),n=qe(new i(n),t,r),e=Bi(n,t<=n.e||n.e<=i.toExpNeg,t)),n.isNeg()&&!n.isZero()?"-"+e:e};_e.toSignificantDigits=_e.toSD=function(t,r){var e=this,n=e.constructor;return t===void 0?(t=n.precision,r=n.rounding):(gn(t,1,Da),r===void 0?r=n.rounding:gn(r,0,8)),qe(new n(e),t,r)};_e.toString=function(){var t=this,r=t.constructor,e=Bi(t,t.e<=r.toExpNeg||t.e>=r.toExpPos);return t.isNeg()&&!t.isZero()?"-"+e:e};_e.truncated=_e.trunc=function(){return qe(new this.constructor(this),this.e+1,1)};_e.valueOf=_e.toJSON=function(){var t=this,r=t.constructor,e=Bi(t,t.e<=r.toExpNeg||t.e>=r.toExpPos);return t.isNeg()?"-"+e:e};function Or(t){var r,e,n,i=t.length-1,a="",o=t[0];if(i>0){for(a+=o,r=1;r<i;r++)n=t[r]+"",e=Ke-n.length,e&&(a+=Ca(e)),a+=n;o=t[r],n=o+"",e=Ke-n.length,e&&(a+=Ca(e))}else if(o===0)return"0";for(;o%10===0;)o/=10;return a+o}function gn(t,r,e){if(t!==~~t||t<r||t>e)throw Error(ka+t)}function Ll(t,r,e,n){var i,a,o,s;for(a=t[0];a>=10;a/=10)--r;return--r<0?(r+=Ke,i=0):(i=Math.ceil((r+1)/Ke),r%=Ke),a=vr(10,Ke-r),s=t[i]%a|0,n==null?r<3?(r==0?s=s/100|0:r==1&&(s=s/10|0),o=e<4&&s==99999||e>3&&s==49999||s==5e4||s==0):o=(e<4&&s+1==a||e>3&&s+1==a/2)&&(t[i+1]/a/100|0)==vr(10,r-2)-1||(s==a/2||s==0)&&(t[i+1]/a/100|0)==0:r<4?(r==0?s=s/1e3|0:r==1?s=s/100|0:r==2&&(s=s/10|0),o=(n||e<4)&&s==9999||!n&&e>3&&s==4999):o=((n||e<4)&&s+1==a||!n&&e>3&&s+1==a/2)&&(t[i+1]/a/1e3|0)==vr(10,r-3)-1,o}function qu(t,r,e){for(var n,i=[0],a,o=0,s=t.length;o<s;){for(a=i.length;a--;)i[a]*=r;for(i[0]+=Pd.indexOf(t.charAt(o++)),n=0;n<i.length;n++)i[n]>e-1&&(i[n+1]===void 0&&(i[n+1]=0),i[n+1]+=i[n]/e|0,i[n]%=e)}return i.reverse()}function H8(t,r){var e,n,i;if(r.isZero())return r;n=r.d.length,n<32?(e=Math.ceil(n/3),i=(1/of(4,e)).toString()):(e=16,i="2.3283064365386962890625e-10"),t.precision+=e,r=hs(t,1,r.times(i),new t(1));for(var a=e;a--;){var o=r.times(r);r=o.times(o).minus(o).times(8).plus(1)}return t.precision-=e,r}var Nt=function(){function t(n,i,a){var o,s=0,l=n.length;for(n=n.slice();l--;)o=n[l]*i+s,n[l]=o%a|0,s=o/a|0;return s&&n.unshift(s),n}function r(n,i,a,o){var s,l;if(a!=o)l=a>o?1:-1;else for(s=l=0;s<a;s++)if(n[s]!=i[s]){l=n[s]>i[s]?1:-1;break}return l}function e(n,i,a,o){for(var s=0;a--;)n[a]-=s,s=n[a]<i[a]?1:0,n[a]=s*o+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,o,s,l){var u,h,v,p,m,C,w,b,E,R,M,k,L,_,I,P,U,q,Q,J,re=n.constructor,ne=n.s==i.s?1:-1,ce=n.d,me=i.d;if(!ce||!ce[0]||!me||!me[0])return new re(!n.s||!i.s||(ce?me&&ce[0]==me[0]:!me)?NaN:ce&&ce[0]==0||!me?ne*0:ne/0);for(l?(m=1,h=n.e-i.e):(l=si,m=Ke,h=Vr(n.e/m)-Vr(i.e/m)),Q=me.length,U=ce.length,E=new re(ne),R=E.d=[],v=0;me[v]==(ce[v]||0);v++);if(me[v]>(ce[v]||0)&&h--,a==null?(_=a=re.precision,o=re.rounding):s?_=a+(n.e-i.e)+1:_=a,_<0)R.push(1),C=!0;else{if(_=_/m+2|0,v=0,Q==1){for(p=0,me=me[0],_++;(v<U||p)&&_--;v++)I=p*l+(ce[v]||0),R[v]=I/me|0,p=I%me|0;C=p||v<U}else{for(p=l/(me[0]+1)|0,p>1&&(me=t(me,p,l),ce=t(ce,p,l),Q=me.length,U=ce.length),P=Q,M=ce.slice(0,Q),k=M.length;k<Q;)M[k++]=0;J=me.slice(),J.unshift(0),q=me[0],me[1]>=l/2&&++q;do p=0,u=r(me,M,Q,k),u<0?(L=M[0],Q!=k&&(L=L*l+(M[1]||0)),p=L/q|0,p>1?(p>=l&&(p=l-1),w=t(me,p,l),b=w.length,k=M.length,u=r(w,M,b,k),u==1&&(p--,e(w,Q<b?J:me,b,l))):(p==0&&(u=p=1),w=me.slice()),b=w.length,b<k&&w.unshift(0),e(M,w,k,l),u==-1&&(k=M.length,u=r(me,M,Q,k),u<1&&(p++,e(M,Q<k?J:me,k,l))),k=M.length):u===0&&(p++,M=[0]),R[v++]=p,u&&M[0]?M[k++]=ce[P]||0:(M=[ce[P]],k=1);while((P++<U||M[0]!==void 0)&&_--);C=M[0]!==void 0}R[0]||R.shift()}if(m==1)E.e=h,Nx=C;else{for(v=1,p=R[0];p>=10;p/=10)v++;E.e=v+h*m-1,qe(E,s?a+E.e+1:a,o,C)}return E}}();function qe(t,r,e,n){var i,a,o,s,l,u,h,v,p,m=t.constructor;e:if(r!=null){if(v=t.d,!v)return t;for(i=1,s=v[0];s>=10;s/=10)i++;if(a=r-i,a<0)a+=Ke,o=r,h=v[p=0],l=h/vr(10,i-o-1)%10|0;else if(p=Math.ceil((a+1)/Ke),s=v.length,p>=s)if(n){for(;s++<=p;)v.push(0);h=l=0,i=1,a%=Ke,o=a-Ke+1}else break e;else{for(h=s=v[p],i=1;s>=10;s/=10)i++;a%=Ke,o=a-Ke+i,l=o<0?0:h/vr(10,i-o-1)%10|0}if(n=n||r<0||v[p+1]!==void 0||(o<0?h:h%vr(10,i-o-1)),u=e<4?(l||n)&&(e==0||e==(t.s<0?3:2)):l>5||l==5&&(e==4||n||e==6&&(a>0?o>0?h/vr(10,i-o):0:v[p-1])%10&1||e==(t.s<0?8:7)),r<1||!v[0])return v.length=0,u?(r-=t.e+1,v[0]=vr(10,(Ke-r%Ke)%Ke),t.e=-r||0):v[0]=t.e=0,t;if(a==0?(v.length=p,s=1,p--):(v.length=p+1,s=vr(10,Ke-a),v[p]=o>0?(h/vr(10,i-o)%vr(10,o)|0)*s:0),u)for(;;)if(p==0){for(a=1,o=v[0];o>=10;o/=10)a++;for(o=v[0]+=s,s=1;o>=10;o/=10)s++;a!=s&&(t.e++,v[0]==si&&(v[0]=1));break}else{if(v[p]+=s,v[p]!=si)break;v[p--]=0,s=1}for(a=v.length;v[--a]===0;)v.pop()}return Je&&(t.e>m.maxE?(t.d=null,t.e=NaN):t.e<m.minE&&(t.e=0,t.d=[0])),t}function Bi(t,r,e){if(!t.isFinite())return zx(t);var n,i=t.e,a=Or(t.d),o=a.length;return r?(e&&(n=e-o)>0?a=a.charAt(0)+"."+a.slice(1)+Ca(n):o>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(t.e<0?"e":"e+")+t.e):i<0?(a="0."+Ca(-i-1)+a,e&&(n=e-o)>0&&(a+=Ca(n))):i>=o?(a+=Ca(i+1-o),e&&(n=e-i-1)>0&&(a=a+"."+Ca(n))):((n=i+1)<o&&(a=a.slice(0,n)+"."+a.slice(n)),e&&(n=e-o)>0&&(i+1===o&&(a+="."),a+=Ca(n))),a}function af(t,r){var e=t[0];for(r*=Ke;e>=10;e/=10)r++;return r}function _c(t,r,e){if(r>F8)throw Je=!0,e&&(t.precision=e),Error(kx);return qe(new t(Ec),r,1,!0)}function ri(t,r,e){if(r>Bd)throw Error(kx);return qe(new t(Tc),r,e,!0)}function Bx(t){var r=t.length-1,e=r*Ke+1;if(r=t[r],r){for(;r%10==0;r/=10)e--;for(r=t[0];r>=10;r/=10)e++}return e}function Ca(t){for(var r="";t--;)r+="0";return r}function Fx(t,r,e,n){var i,a=new t(1),o=Math.ceil(n/Ke+4);for(Je=!1;;){if(e%2&&(a=a.times(r),D1(a.d,o)&&(i=!0)),e=Vr(e/2),e===0){e=a.d.length-1,i&&a.d[e]===0&&++a.d[e];break}r=r.times(r),D1(r.d,o)}return Je=!0,a}function P1(t){return t.d[t.d.length-1]&1}function Hx(t,r,e){for(var n,i=new t(r[0]),a=0;++a<r.length;)if(n=new t(r[a]),n.s)i[e](n)&&(i=n);else{i=n;break}return i}function Fd(t,r){var e,n,i,a,o,s,l,u=0,h=0,v=0,p=t.constructor,m=p.rounding,C=p.precision;if(!t.d||!t.d[0]||t.e>17)return new p(t.d?t.d[0]?t.s<0?0:1/0:1:t.s?t.s<0?0:t:NaN);for(r==null?(Je=!1,l=C):l=r,s=new p(.03125);t.e>-2;)t=t.times(s),v+=5;for(n=Math.log(vr(2,v))/Math.LN10*2+5|0,l+=n,e=a=o=new p(1),p.precision=l;;){if(a=qe(a.times(t),l,1),e=e.times(++h),s=o.plus(Nt(a,e,l,1)),Or(s.d).slice(0,l)===Or(o.d).slice(0,l)){for(i=v;i--;)o=qe(o.times(o),l,1);if(r==null)if(u<3&&Ll(o.d,l-n,m,u))p.precision=l+=10,e=a=s=new p(1),h=0,u++;else return qe(o,p.precision=C,m,Je=!0);else return p.precision=C,o}o=s}}function ba(t,r){var e,n,i,a,o,s,l,u,h,v,p,m=1,C=10,w=t,b=w.d,E=w.constructor,R=E.rounding,M=E.precision;if(w.s<0||!b||!b[0]||!w.e&&b[0]==1&&b.length==1)return new E(b&&!b[0]?-1/0:w.s!=1?NaN:b?0:w);if(r==null?(Je=!1,h=M):h=r,E.precision=h+=C,e=Or(b),n=e.charAt(0),Math.abs(a=w.e)<15e14){for(;n<7&&n!=1||n==1&&e.charAt(1)>3;)w=w.times(t),e=Or(w.d),n=e.charAt(0),m++;a=w.e,n>1?(w=new E("0."+e),a++):w=new E(n+"."+e.slice(1))}else return u=_c(E,h+2,M).times(a+""),w=ba(new E(n+"."+e.slice(1)),h-C).plus(u),E.precision=M,r==null?qe(w,M,R,Je=!0):w;for(v=w,l=o=w=Nt(w.minus(1),w.plus(1),h,1),p=qe(w.times(w),h,1),i=3;;){if(o=qe(o.times(p),h,1),u=l.plus(Nt(o,new E(i),h,1)),Or(u.d).slice(0,h)===Or(l.d).slice(0,h))if(l=l.times(2),a!==0&&(l=l.plus(_c(E,h+2,M).times(a+""))),l=Nt(l,new E(m),h,1),r==null)if(Ll(l.d,h-C,R,s))E.precision=h+=C,u=o=w=Nt(v.minus(1),v.plus(1),h,1),p=qe(w.times(w),h,1),i=s=1;else return qe(l,E.precision=M,R,Je=!0);else return E.precision=M,l;l=u,i+=2}}function zx(t){return String(t.s*t.s/0)}function Hd(t,r){var e,n,i;for((e=r.indexOf("."))>-1&&(r=r.replace(".","")),(n=r.search(/e/i))>0?(e<0&&(e=n),e+=+r.slice(n+1),r=r.substring(0,n)):e<0&&(e=r.length),n=0;r.charCodeAt(n)===48;n++);for(i=r.length;r.charCodeAt(i-1)===48;--i);if(r=r.slice(n,i),r){if(i-=n,t.e=e=e-n-1,t.d=[],n=(e+1)%Ke,e<0&&(n+=Ke),n<i){for(n&&t.d.push(+r.slice(0,n)),i-=Ke;n<i;)t.d.push(+r.slice(n,n+=Ke));r=r.slice(n),n=Ke-r.length}else n-=i;for(;n--;)r+="0";t.d.push(+r),Je&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function z8(t,r){var e,n,i,a,o,s,l,u,h;if(r.indexOf("_")>-1){if(r=r.replace(/(\d)_(?=\d)/g,"$1"),Dx.test(r))return Hd(t,r)}else if(r==="Infinity"||r==="NaN")return+r||(t.s=NaN),t.e=NaN,t.d=null,t;if(P8.test(r))e=16,r=r.toLowerCase();else if(I8.test(r))e=2;else if(D8.test(r))e=8;else throw Error(ka+r);for(a=r.search(/p/i),a>0?(l=+r.slice(a+1),r=r.substring(2,a)):r=r.slice(2),a=r.indexOf("."),o=a>=0,n=t.constructor,o&&(r=r.replace(".",""),s=r.length,a=s-a,i=Fx(n,new n(e),a,a*2)),u=qu(r,e,si),h=u.length-1,a=h;u[a]===0;--a)u.pop();return a<0?new n(t.s*0):(t.e=af(u,h),t.d=u,Je=!1,o&&(t=Nt(t,i,s*4)),l&&(t=t.times(Math.abs(l)<54?vr(2,l):fi.pow(2,l))),Je=!0,t)}function W8(t,r){var e,n=r.d.length;if(n<3)return r.isZero()?r:hs(t,2,r,r);e=1.4*Math.sqrt(n),e=e>16?16:e|0,r=r.times(1/of(5,e)),r=hs(t,2,r,r);for(var i,a=new t(5),o=new t(16),s=new t(20);e--;)i=r.times(r),r=r.times(a.plus(i.times(o.times(i).minus(s))));return r}function hs(t,r,e,n,i){var a,o,s,l,u=t.precision,h=Math.ceil(u/Ke);for(Je=!1,l=e.times(e),s=new t(n);;){if(o=Nt(s.times(l),new t(r++*r++),u,1),s=i?n.plus(o):n.minus(o),n=Nt(o.times(l),new t(r++*r++),u,1),o=s.plus(n),o.d[h]!==void 0){for(a=h;o.d[a]===s.d[a]&&a--;);if(a==-1)break}a=s,s=n,n=o,o=a}return Je=!0,o.d.length=h+1,o}function of(t,r){for(var e=t;--r;)e*=t;return e}function Wx(t,r){var e,n=r.s<0,i=ri(t,t.precision,1),a=i.times(.5);if(r=r.abs(),r.lte(a))return ia=n?4:1,r;if(e=r.divToInt(i),e.isZero())ia=n?3:2;else{if(r=r.minus(e.times(i)),r.lte(a))return ia=P1(e)?n?2:3:n?4:1,r;ia=P1(e)?n?1:4:n?3:2}return r.minus(i).abs()}function o0(t,r,e,n){var i,a,o,s,l,u,h,v,p,m=t.constructor,C=e!==void 0;if(C?(gn(e,1,Da),n===void 0?n=m.rounding:gn(n,0,8)):(e=m.precision,n=m.rounding),!t.isFinite())h=zx(t);else{for(h=Bi(t),o=h.indexOf("."),C?(i=2,r==16?e=e*4-3:r==8&&(e=e*3-2)):i=r,o>=0&&(h=h.replace(".",""),p=new m(1),p.e=h.length-o,p.d=qu(Bi(p),10,i),p.e=p.d.length),v=qu(h,10,i),a=l=v.length;v[--l]==0;)v.pop();if(!v[0])h=C?"0p+0":"0";else{if(o<0?a--:(t=new m(t),t.d=v,t.e=a,t=Nt(t,p,e,n,0,i),v=t.d,a=t.e,u=Nx),o=v[e],s=i/2,u=u||v[e+1]!==void 0,u=n<4?(o!==void 0||u)&&(n===0||n===(t.s<0?3:2)):o>s||o===s&&(n===4||u||n===6&&v[e-1]&1||n===(t.s<0?8:7)),v.length=e,u)for(;++v[--e]>i-1;)v[e]=0,e||(++a,v.unshift(1));for(l=v.length;!v[l-1];--l);for(o=0,h="";o<l;o++)h+=Pd.charAt(v[o]);if(C){if(l>1)if(r==16||r==8){for(o=r==16?4:3,--l;l%o;l++)h+="0";for(v=qu(h,i,r),l=v.length;!v[l-1];--l);for(o=1,h="1.";o<l;o++)h+=Pd.charAt(v[o])}else h=h.charAt(0)+"."+h.slice(1);h=h+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)h="0"+h;h="0."+h}else if(++a>l)for(a-=l;a--;)h+="0";else a<l&&(h=h.slice(0,a)+"."+h.slice(a))}h=(r==16?"0x":r==2?"0b":r==8?"0o":"")+h}return t.s<0?"-"+h:h}function D1(t,r){if(t.length>r)return t.length=r,!0}function G8(t){return new this(t).abs()}function U8(t){return new this(t).acos()}function V8(t){return new this(t).acosh()}function X8(t,r){return new this(t).plus(r)}function Y8(t){return new this(t).asin()}function $8(t){return new this(t).asinh()}function q8(t){return new this(t).atan()}function K8(t){return new this(t).atanh()}function Z8(t,r){t=new this(t),r=new this(r);var e,n=this.precision,i=this.rounding,a=n+4;return!t.s||!r.s?e=new this(NaN):!t.d&&!r.d?(e=ri(this,a,1).times(r.s>0?.25:.75),e.s=t.s):!r.d||t.isZero()?(e=r.s<0?ri(this,n,i):new this(0),e.s=t.s):!t.d||r.isZero()?(e=ri(this,a,1).times(.5),e.s=t.s):r.s<0?(this.precision=a,this.rounding=1,e=this.atan(Nt(t,r,a,1)),r=ri(this,a,1),this.precision=n,this.rounding=i,e=t.s<0?e.minus(r):e.plus(r)):e=this.atan(Nt(t,r,a,1)),e}function j8(t){return new this(t).cbrt()}function J8(t){return qe(t=new this(t),t.e+1,2)}function Q8(t,r,e){return new this(t).clamp(r,e)}function e9(t){if(!t||typeof t!="object")throw Error(nf+"Object expected");var r,e,n,i=t.defaults===!0,a=["precision",1,Da,"rounding",0,8,"toExpNeg",-Vo,0,"toExpPos",0,Vo,"maxE",0,Vo,"minE",-Vo,0,"modulo",0,9];for(r=0;r<a.length;r+=3)if(e=a[r],i&&(this[e]=Dd[e]),(n=t[e])!==void 0)if(Vr(n)===n&&n>=a[r+1]&&n<=a[r+2])this[e]=n;else throw Error(ka+e+": "+n);if(e="crypto",i&&(this[e]=Dd[e]),(n=t[e])!==void 0)if(n===!0||n===!1||n===0||n===1)if(n)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[e]=!0;else throw Error(Ix);else this[e]=!1;else throw Error(ka+e+": "+n);return this}function t9(t){return new this(t).cos()}function r9(t){return new this(t).cosh()}function Gx(t){var r,e,n;function i(a){var o,s,l,u=this;if(!(u instanceof i))return new i(a);if(u.constructor=i,B1(a)){u.s=a.s,Je?!a.d||a.e>i.maxE?(u.e=NaN,u.d=null):a.e<i.minE?(u.e=0,u.d=[0]):(u.e=a.e,u.d=a.d.slice()):(u.e=a.e,u.d=a.d?a.d.slice():a.d);return}if(l=typeof a,l==="number"){if(a===0){u.s=1/a<0?-1:1,u.e=0,u.d=[0];return}if(a<0?(a=-a,u.s=-1):u.s=1,a===~~a&&a<1e7){for(o=0,s=a;s>=10;s/=10)o++;Je?o>i.maxE?(u.e=NaN,u.d=null):o<i.minE?(u.e=0,u.d=[0]):(u.e=o,u.d=[a]):(u.e=o,u.d=[a]);return}else if(a*0!==0){a||(u.s=NaN),u.e=NaN,u.d=null;return}return Hd(u,a.toString())}else if(l!=="string")throw Error(ka+a);return(s=a.charCodeAt(0))===45?(a=a.slice(1),u.s=-1):(s===43&&(a=a.slice(1)),u.s=1),Dx.test(a)?Hd(u,a):z8(u,a)}if(i.prototype=_e,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=e9,i.clone=Gx,i.isDecimal=B1,i.abs=G8,i.acos=U8,i.acosh=V8,i.add=X8,i.asin=Y8,i.asinh=$8,i.atan=q8,i.atanh=K8,i.atan2=Z8,i.cbrt=j8,i.ceil=J8,i.clamp=Q8,i.cos=t9,i.cosh=r9,i.div=n9,i.exp=i9,i.floor=a9,i.hypot=o9,i.ln=s9,i.log=l9,i.log10=c9,i.log2=u9,i.max=f9,i.min=h9,i.mod=d9,i.mul=v9,i.pow=p9,i.random=g9,i.round=m9,i.sign=y9,i.sin=C9,i.sinh=w9,i.sqrt=x9,i.sub=b9,i.sum=S9,i.tan=E9,i.tanh=T9,i.trunc=_9,t===void 0&&(t={}),t&&t.defaults!==!0)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],r=0;r<n.length;)t.hasOwnProperty(e=n[r++])||(t[e]=this[e]);return i.config(t),i}function n9(t,r){return new this(t).div(r)}function i9(t){return new this(t).exp()}function a9(t){return qe(t=new this(t),t.e+1,3)}function o9(){var t,r,e=new this(0);for(Je=!1,t=0;t<arguments.length;)if(r=new this(arguments[t++]),r.d)e.d&&(e=e.plus(r.times(r)));else{if(r.s)return Je=!0,new this(1/0);e=r}return Je=!0,e.sqrt()}function B1(t){return t instanceof fi||t&&t.toStringTag===Px||!1}function s9(t){return new this(t).ln()}function l9(t,r){return new this(t).log(r)}function u9(t){return new this(t).log(2)}function c9(t){return new this(t).log(10)}function f9(){return Hx(this,arguments,"lt")}function h9(){return Hx(this,arguments,"gt")}function d9(t,r){return new this(t).mod(r)}function v9(t,r){return new this(t).mul(r)}function p9(t,r){return new this(t).pow(r)}function g9(t){var r,e,n,i,a=0,o=new this(1),s=[];if(t===void 0?t=this.precision:gn(t,1,Da),n=Math.ceil(t/Ke),this.crypto)if(crypto.getRandomValues)for(r=crypto.getRandomValues(new Uint32Array(n));a<n;)i=r[a],i>=429e7?r[a]=crypto.getRandomValues(new Uint32Array(1))[0]:s[a++]=i%1e7;else if(crypto.randomBytes){for(r=crypto.randomBytes(n*=4);a<n;)i=r[a]+(r[a+1]<<8)+(r[a+2]<<16)+((r[a+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(r,a):(s.push(i%1e7),a+=4);a=n/4}else throw Error(Ix);else for(;a<n;)s[a++]=Math.random()*1e7|0;for(n=s[--a],t%=Ke,n&&t&&(i=vr(10,Ke-t),s[a]=(n/i|0)*i);s[a]===0;a--)s.pop();if(a<0)e=0,s=[0];else{for(e=-1;s[0]===0;e-=Ke)s.shift();for(n=1,i=s[0];i>=10;i/=10)n++;n<Ke&&(e-=Ke-n)}return o.e=e,o.d=s,o}function m9(t){return qe(t=new this(t),t.e+1,this.rounding)}function y9(t){return t=new this(t),t.d?t.d[0]?t.s:0*t.s:t.s||NaN}function C9(t){return new this(t).sin()}function w9(t){return new this(t).sinh()}function x9(t){return new this(t).sqrt()}function b9(t,r){return new this(t).sub(r)}function S9(){var t=0,r=arguments,e=new this(r[t]);for(Je=!1;e.s&&++t<r.length;)e=e.plus(r[t]);return Je=!0,qe(e,this.precision,this.rounding)}function E9(t){return new this(t).tan()}function T9(t){return new this(t).tanh()}function _9(t){return qe(t=new this(t),t.e+1,1)}_e[Symbol.for("nodejs.util.inspect.custom")]=_e.toString;_e[Symbol.toStringTag]="Decimal";var fi=_e.constructor=Gx(Dd);Ec=new fi(Ec);Tc=new fi(Tc);var Po,s0=function(t){return typeof t=="number"?Number.isNaN(t):t&&typeof t=="string"?Number.isNaN(Number(t)):!0},F1=function(t){return!s0(t)},l0=function(t,r,e){return e===void 0&&(e=!1),t!=null&&t.length?t.reduce(function(n,i){var a=oi.getFieldValue(i,r),o=s0(a);if(e&&o)return n;var s=o?0:a;return n.push(new fi(s)),n},[]):[]},Ux=function(t,r){var e=l0(t,r);return e.length?fi.sum.apply(fi,pe([],te(e),!1)).toNumber():0},H1=function(t,r,e){var n=l0(r,e,!0);if(n!=null&&n.length)return fi[t].apply(fi,pe([],te(n),!1)).toNumber()},R9=function(t,r){var e=l0(t,r);return e!=null&&e.length?fi.sum.apply(fi,pe([],te(e),!1)).dividedBy(e.length).toNumber():0},L9=(Po={},Po[Go.SUM]=Ux,Po[Go.MIN]=function(t,r){return H1("min",t,r)},Po[Go.MAX]=function(t,r){return H1("max",t,r)},Po[Go.AVG]=R9,Po),ws=function(t){return fc(t)==="ASC"},u0=function(t){return fc(t)==="DESC"},z1=function(t,r,e){var n=ws(r)?1:-1,i=["-",void 0];return t==null?void 0:t.sort(function(a,o){var s=a,l=o;if(e){if(s=a.getValueByField(e),l=o.getValueByField(e),F1(s)&&F1(l))return(Number(s)-Number(l))*n;if(s&&(i!=null&&i.includes(s==null?void 0:s.toString())))return-n;if(Number(s)&&(i!=null&&i.includes(l==null?void 0:l.toString())))return n}return!nr(s)&&!nr(l)?s.toString().localeCompare(l.toString(),"zh")*n:s?n:-n})},Vx=function(t,r,e){return e?lF(r,wa(t)):pe([],te(new Set(pe(pe([],te(t),!1),te(r),!1))),!1)},Xx=function(t){var r=t.sortByValues,e=r===void 0?[]:r,n=t.originValues,i=n===void 0?[]:n,a=i.filter(function(u){return e.find(function(h){return h5(u,h)})}),o=a.map(function(u){var h=u.split(rn);if(h.length>1){var v=h.slice(0,h.length-1).join(rn);return[v,h[h.length-1]]}return h}),s=Array.from(new Set(o.map(function(u){return u[0]})));o.sort(function(u,h){var v=u.slice(0,u.length-1),p=h.slice(0,h.length-1);if(v.join()!==p.join()){var m=s.indexOf(v[0]),C=s.indexOf(p[0]);return m-C}var w=e.indexOf(u[u.length-1]),b=e.indexOf(h[h.length-1]);return w-b});var l=o.map(function(u){return u.join(rn)});return sF(i,l)},M9=function(t){var r=t.originValues,e=r===void 0?[]:r,n=t.measureValues,i=t.sortParam,a=t.dataSet,o=i,s=o.sortFunc,l=o.sortFieldId,u=o.sortMethod,h=s==null?void 0:s(Y({data:n},i));return h!=null&&h.length?(a.fields.rows.indexOf(l)>0||a.fields.columns.indexOf(l)>0)&&!hn(h[0],rn)?Xx({sortByValues:h,originValues:e}):Vx(h,e,ws(u)):e},O9=function(t){var r=t.sortParam,e=t.measureValues,n=t.originValues,i=t.dataSet,a=r,o=a.sortByMeasure,s=a.query,l=a.sortFieldId,u=a.sortMethod,h=i.fields,v=h.rows,p=v===void 0?[]:v,m=h.columns,C=m===void 0?[]:m,w=p==null?void 0:p.includes(l),b;if(o){var E=z1(e,u,o===la?s==null?void 0:s[it]:o),R=w?p:Xl(C);b=L8(l,R,E)}else b=z1(e,u);return Vx(b,n,ws(u))},A9=function(t){var r=t.sortParam,e=t.originValues,n=e===void 0?[]:e,i=t.measureValues,a=t.dataSet,o=r,s=o.sortFunc,l=o.sortMethod,u=o.sortBy,h=n,v={originValues:n,measureValues:i,sortParam:r,dataSet:a};return s?h=M9(v):u?h=Xx({sortByValues:u,originValues:n}):(ws(l)||u0(l))&&(h=O9(v)),h},N9=function(t,r,e){var n,i={},a=hn(t,rn);if(a)for(var o=zD(t,rn),s=!((n=r==null?void 0:r.rows)===null||n===void 0)&&n.includes(e)?r.rows:Xl(r.columns),l=0;l<=Zc(s,e);l++)i[s[l]]=o[l];else i[e]=t;return i},k9=function(t){var r=t.dataSet,e=t.sortParam,n=t.originValues,i=r.fields,a=e,o=a.sortByMeasure,s=a.query,l=a.sortFieldId;if(o!==la){var u=r.getCellMultiData({query:s,queryType:ki.DetailOnly});return u}var h=r.getCellMultiData({query:s,queryType:ki.All}),v=Xl(i.columns),p=hn(i.rows,l),m=xc(p?i.rows:v),C=xc(p?v:i.rows),w=m[m.indexOf(l)+1],b=pn(s),E=C.filter(function(M){return!b.includes(M)}),R=h.filter(function(M){var k=new Set(pn(M[ld]));if(!k.has(l)||k.has(w))return!1;var L=E.every(function(_){return!k.has(_)});return L});return ke(R)?ai(ct(n,function(M){var k=N9(M,i,l);return r.getTotalValue(Y(Y({},s),k))})):R},I9=function(t){var r=t.dataSet,e=t.sortParam,n=t.originValues,i=t.isSortByMeasure,a;return i?a=k9(t):a=n,A9({sortParam:e,originValues:n,measureValues:a,dataSet:r})},Yx=function(t,r){if(t!=null&&t.sortMethod){if(ws(t==null?void 0:t.sortMethod))return"groupAsc";if(u0(t==null?void 0:t.sortMethod))return"groupDesc"}if(r)return"SortDown"},W1=function(t){var r,e,n=t.pivotMeta,i=t.dimensions,a=t.sortedDimensionValues,o=t.sortFieldId,s={children:n},l=[s];try{for(var u=Wr(i),h=u.next();!h.done;h=u.next()){var v=h.value;if(v!==o)l=zl(l,function(p){return pe([],te(p.children.values()),!1)});else{l.forEach(function(p){var m=pe([],te(p.children.values()),!1),C=Uv(m,function(w){return Zc(a,w.id)}).map(function(w){return[w.value,w]});p.children=new Map(C)});break}}}catch(p){r={error:p}}finally{try{h&&!h.done&&(e=u.return)&&e.call(u)}finally{if(r)throw r.error}}return s.children},sf=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.getHeaderConfig=function(){return this.headerConfig||{}},r.prototype.isShallowRender=function(){return this.headerConfig.shallowRender},r.prototype.shouldInit=function(){return t.prototype.shouldInit.call(this)&&!this.isShallowRender()},r.prototype.handleRestOptions=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=te(e,1),a=i[0];this.headerConfig=Y({},a);var o=this.meta,s=o.value,l=o.query,u=this.spreadsheet.dataCfg.sortParams||[],h=this.isSortCell(),v=Rr(pe([],te(u),!1).reverse(),function(m){return h&&(m==null?void 0:m.sortByMeasure)===s&&tn(dt(m,"query"),l)}),p=Yx(v,h);this.headerConfig.sortParam=Y(Y(Y({},this.headerConfig.sortParam),v||{query:l}),{type:p})},r.prototype.initCell=function(){this.resetTextAndConditionIconShapes(),this.actionIcons=[],this.hasDefaultHiddenIcon=!1,this.generateIconConfig()},r.prototype.generateIconConfig=function(){var e,n;this.conditionIconMappingResult=this.getIconConditionResult();var i=this.getHeaderConfig().sortParam;this.showSortIcon()?this.actionIconConfig={icons:[{name:dt(i,"type","none"),position:"right"}],belongsCell:this.cellType,isSortIcon:!0}:this.actionIconConfig=Jv(this.spreadsheet.options.headerActionIcons,this.meta,this.cellType),this.groupedIcons=ux((n=(e=this.actionIconConfig)===null||e===void 0?void 0:e.icons)!==null&&n!==void 0?n:[],this.conditionIconMappingResult)},r.prototype.getFormattedFieldValue=function(){var e=this.meta,n=e.isTotalRoot,i=e.isGrandTotals,a=e.value,o=this.spreadsheet.dataSet.getFieldFormatter(this.meta.field),s=!0;this.spreadsheet.isTableMode()?s=!1:this.spreadsheet.isHierarchyTreeType()?s=!(i&&n):s=!n;var l=s&&o?o(a,void 0,this.meta):a;return{formattedValue:l,value:a}},r.prototype.showSortIcon=function(){var e=this.spreadsheet,n=e.options,i=e.dataCfg,a=ke(i.fields.values);if(n.showDefaultHeaderActionIcon&&!a){var o=this.getHeaderConfig().sortParam,s=this.meta.query;return s&&tn(o==null?void 0:o.query,s)&&(o==null?void 0:o.type)&&(o==null?void 0:o.type)!=="none"}return!1},r.prototype.getActionIconStyle=function(e){var n=this.getStyle().icon,i=this.getTextConditionMappingResult(),a=(i==null?void 0:i.fill)||this.getTextStyle().fill;return{width:n==null?void 0:n.size,height:n==null?void 0:n.size,fill:(e==null?void 0:e.fill)||(n==null?void 0:n.fill)||a,cursor:"pointer"}},r.prototype.hasDefaultHideActionIcon=function(){return this.hasDefaultHiddenIcon},r.prototype.addActionIcon=function(e){var n=this,i=e.x,a=e.y,o=e.name,s=e.defaultHide,l=e.onClick,u=e.onHover,h=e.isSortIcon,v=new qv(Y(Y({},this.getActionIconStyle(e)),{name:o,x:i,y:a}));v.setAttribute("visibility",s?"hidden":"visible"),v.addEventListener("mouseover",function(p){n.spreadsheet.emit(se.GLOBAL_ACTION_ICON_HOVER,p),u==null||u({hovering:!0,name:o,meta:n.meta,event:p})}),v.addEventListener("mouseleave",function(p){n.spreadsheet.emit(se.GLOBAL_ACTION_ICON_HOVER_OFF,p),u==null||u({hovering:!1,name:o,meta:n.meta,event:p})}),v.addEventListener("click",function(p){if(n.spreadsheet.emit(se.GLOBAL_ACTION_ICON_CLICK,p),h){n.spreadsheet.handleGroupSort(p,n.meta);return}l==null||l({name:o,meta:n.meta,event:p})}),this.actionIcons.push(v),this.appendChild(v)},r.prototype.drawActionAndConditionIcons=function(){var e=this;ke(this.groupedIcons.left)&&ke(this.groupedIcons.right)||!this.leftIconPosition||!this.rightIconPosition||tt(this.groupedIcons,function(n,i){var a=e.getStyle().icon,o=a.size,s=a.margin,l=s.right,u=i==="left"?e.leftIconPosition:e.rightIconPosition;tt(n,function(h,v){var p,m,C,w=u.x+(o+l)*v,b=u.y;if(h.isConditionIcon){e.conditionIconShape=Gl(e,{x:w,y:b,name:h.name,width:o,height:o,fill:h.fill}),e.addConditionIconShape(e.conditionIconShape);return}var E=e.actionIconConfig,R=E.onClick,M=E.onHover,k=E.defaultHide,L=E.isSortIcon,_=(p=h.defaultHide)!==null&&p!==void 0?p:k,I=typeof _=="function"?_(e.meta,h.name):_;I&&(e.hasDefaultHiddenIcon=!0),e.addActionIcon({name:h.name,fill:h.fill,x:w,y:b,defaultHide:I,onClick:(m=h.onClick)!==null&&m!==void 0?m:R,onHover:(C=h.onHover)!==null&&C!==void 0?C:M,isSortIcon:L})})})},r.prototype.isSortCell=function(){var e,n,i,a=(n=(e=this.meta.spreadsheet)===null||e===void 0?void 0:e.isValueInCols)===null||n===void 0?void 0:n.call(e),o=this.meta.level===((i=this.meta.hierarchy)===null||i===void 0?void 0:i.maxLevel);return a?o&&this.cellType===Le.COL_CELL:o&&this.cellType===Le.ROW_CELL},r.prototype.handleByStateName=function(e,n){Za(e,this)&&this.updateByState(n)},r.prototype.handleSearchResult=function(e){if(Za(e,this)){var n=Rr(e,function(i){return i==null?void 0:i.isTarget});n.id===this.getMeta().id?this.updateByState(Xe.HIGHLIGHT):this.updateByState(Xe.SEARCH_RESULT)}},r.prototype.handleHover=function(e){var n;Za(e,this)&&(this.updateByState(Xe.HOVER),this.hasDefaultHideActionIcon()&&this.toggleActionIcon((n=e==null?void 0:e[0])===null||n===void 0?void 0:n.id))},r.prototype.handleSelect=function(e,n){n===void 0&&(n=[]),Za(e,this)&&this.updateByState(Xe.SELECTED);var i=ct(n,"id");hn(i,this.meta.id)&&this.updateByState(Xe.SELECTED)},r.prototype.getTextStyle=function(){var e=this.getCellTextWordWrapStyle(),n=this.getStyle(),i=n.text,a=n.bolderText,o=n.measureText,s;return this.isMeasureField()?s=o||i:this.isBolderText()?s=a:s=i,this.getContainConditionMappingResultTextStyle(Y(Y({},e),s))},r.prototype.getBackgroundColor=function(){var e,n=((e=this.getStyle())===null||e===void 0?void 0:e.cell)||{},i=n.backgroundColor,a=n.backgroundColorOpacity;return Wl({backgroundColor:i,backgroundColorOpacity:a},this.getBackgroundConditionFill())},r.prototype.toggleActionIcon=function(e){if(this.getMeta().id===e){var n=[];tt(this.actionIcons,function(i){i.parsedStyle.visibility!=="visible"&&(i.setAttribute("visibility","visible"),n.push(i))}),this.spreadsheet.store.set("visibleActionIcons",n)}},r.prototype.getIconPosition=function(){return this.leftIconPosition||this.rightIconPosition},r.prototype.update=function(){var e=this.spreadsheet.interaction,n=e==null?void 0:e.getState(),i=e==null?void 0:e.getCells([Le.CORNER_CELL,Le.COL_CELL,Le.ROW_CELL,Le.SERIES_NUMBER_CELL]);if(Kc(i))switch(n==null?void 0:n.stateName){case Xe.SELECTED:case Xe.ROW_CELL_BRUSH_SELECTED:case Xe.COL_CELL_BRUSH_SELECTED:this.handleSelect(i,n==null?void 0:n.nodes);break;case Xe.HOVER_FOCUS:case Xe.HOVER:this.handleHover(i);break;case Xe.SEARCH_RESULT:this.handleSearchResult(i);break;default:this.handleByStateName(i,n==null?void 0:n.stateName);break}},r.prototype.updateByState=function(e){t.prototype.updateByState.call(this,e,this)},r.prototype.hideInteractionShape=function(){t.prototype.hideInteractionShape.call(this)},r.prototype.isMeasureField=function(){return[it,FA].includes(this.meta.field)},r.prototype.mappingValue=function(e){var n=this.getMeta().value;return e.mapping(n,this.meta,this)},r.prototype.findFieldCondition=function(e){var n=this;return e===void 0&&(e=[]),Fv(e,function(i){return i.field instanceof RegExp?i.field.test(n.meta.field):i.field===n.meta.field})},r.prototype.getTreeIcon=function(){return this.treeIcon},r.prototype.getActionIcons=function(){return this.actionIcons||[]},r}(Qc),$x=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return Object.defineProperty(r.prototype,"cellType",{get:function(){return Le.CORNER_CELL},enumerable:!1,configurable:!0}),r.prototype.isBolderText=function(){var e=this.meta.cornerType;return e===en.Col},r.prototype.getBorderPositions=function(){return[At.TOP,At.LEFT]},r.prototype.initCell=function(){t.prototype.initCell.call(this),this.resetTextAndConditionIconShapes(),this.drawBackgroundShape(),this.drawTextShape(),this.drawTreeIcon(),this.drawActionAndConditionIcons(),this.drawBorders(),this.drawResizeArea(),this.update()},r.prototype.drawTreeIcon=function(){var e=this,n;if(this.showTreeIcon()){var i=((n=this.spreadsheet.options.style)===null||n===void 0?void 0:n.rowCell).collapseFields,a=i===void 0?{}:i,o=this.getStyle().icon.size,s=o===void 0?0:o,l=this.getTextStyle().fill,u=this.getBBoxByType(Qt.CONTENT_BOX),h=this.spreadsheet.facet.getRowNodes(0),v=zv(a).filter(Boolean).length===h.length||h.every(function(m){return m.isCollapsed}),p=v;this.treeIcon=lx({group:this,iconCfg:{x:u.x,y:this.getIconPosition().y,width:s,height:s,fill:l},isCollapsed:p,onClick:function(){e.spreadsheet.facet.resetScrollY(),e.spreadsheet.emit(se.ROW_CELL_ALL_COLLAPSED__PRIVATE,p)}})}},r.prototype.isLastRowCornerCell=function(){var e=this.meta,n=e.cornerType,i=e.field,a=this.spreadsheet.dataSet.fields.rows;return n===en.Row&&(this.spreadsheet.isHierarchyTreeType()||mr(a)===i)},r.prototype.getResizeAreaEffect=function(){var e=this.meta.cornerType;return e===en.Series?Qr.Series:this.isLastRowCornerCell()&&this.spreadsheet.isHierarchyTreeType()?Qr.Tree:Qr.Field},r.prototype.drawResizeArea=function(){if(this.shouldDrawResizeAreaByType("cornerCellHorizontal",this)){var e=this.getResizeAreaStyle(),n=Qa(this.spreadsheet,Sd);if(n){var i=this.getHeaderConfig(),a=i.position,o=i.scrollX,s=o===void 0?0:o,l=i.scrollY,u=l===void 0?0:l,h=i.width,v=i.height,p=this.getBBoxByType(),m=p.x,C=p.y,w=p.width,b=p.height,E=this.meta.cornerType,R={x:m+w-e.size,y:C,width:e.size,height:b},M={x:0,y:0,width:h,height:v};if(!(E===en.Col||!Yl(R,M,{scrollX:s,scrollY:u}))){var k=a.x+m-s,L=a.y+(this.isLastRowCornerCell()?0:C),_=_l({theme:e,type:zr.Horizontal,effect:this.getResizeAreaEffect(),offsetX:k,offsetY:L,width:w,height:b,meta:this.meta});n.appendChild(new cs({style:Y(Y({},_.style),{x:k+w-e.size,y:L,height:this.isLastRowCornerCell()?v:b})},_.appendInfo))}}}},r.prototype.showTreeIcon=function(){return this.spreadsheet.isHierarchyTreeType()&&this.meta.cornerType===en.Row},r.prototype.getTreeIconWidth=function(){var e=this.getStyle().icon,n=e.size,i=e.margin;return this.showTreeIcon()?n+i.right:0},r.prototype.getMaxTextWidth=function(){var e=this.getBBoxByType(Qt.CONTENT_BOX).width;return e-this.getTreeIconWidth()-this.getActionAndConditionIconWidth()},r.prototype.getTextPosition=function(){var e=this.getBBoxByType(Qt.CONTENT_BOX),n=e.x,i=e.y,a=e.height,o=e.width,s=this.getTextStyle(),l=Cs({bbox:{x:n+this.getTreeIconWidth(),y:i,width:o-this.getTreeIconWidth(),height:a},textAlign:s.textAlign,textWidth:this.getActualTextWidth(),groupedIcons:this.groupedIcons,iconStyle:this.getIconStyle()}),u=l.textX,h=l.leftIconX,v=l.rightIconX,p=Sl(e,s.textBaseline),m=this.getStyle().icon.size,C=m===void 0?0:m,w=Ul(C,p,s.fontSize,s.textBaseline);return this.leftIconPosition={x:h,y:w},this.rightIconPosition={x:v,y:w},{x:u,y:p}},r.prototype.getFormattedFieldValue=function(){return cx(this.meta,this.spreadsheet.dataSet.getFieldName(this.meta.field))},r}(sf),P9=function(t){Me(r,t);function r(e){return t.call(this,e)||this}return r.prototype.getCellInstance=function(e){var n=this.getHeaderConfig(),i=n.spreadsheet,a=i.options.cornerCell;return(a==null?void 0:a(e,i,n))||new $x(e,i,n)},r.getCornerHeader=function(e){var n=e.panelBBox,i=e.cornerBBox,a=e.seriesNumberWidth,o=e.layoutResult,s=e.spreadsheet,l=n.width,u=n.height,h=i.originalWidth,v=i.originalHeight,p=i.width,m=i.height,C=this.getCornerNodes({position:{x:i.x,y:i.y},width:h,height:v,layoutResult:o,seriesNumberWidth:a,spreadsheet:s});return new r({nodes:C,position:{x:i.x,y:i.y},width:p,height:m,originalHeight:v,originalWidth:h,viewportWidth:l,viewportHeight:u,seriesNumberWidth:a,spreadsheet:s})},r.getTreeCornerText=function(e){var n=e.spreadsheet,i=n.dataSet.fields.rows,a=i===void 0?[]:i,o=n.options.cornerText;if(o)return o;var s=n.store.get("drillDownFieldInLevel",[]),l=s.map(function(h){return h.drillField}),u=a.filter(function(h){return!hn(l,h)}).map(function(h){return n.dataSet.getFieldName(h)}).join("/");return u||TB()},r.getCornerNodes=function(e){var n,i,a,o,s,l,u=e.position,h=e.width,v=e.layoutResult,p=e.seriesNumberWidth,m=e.spreadsheet,C=v.rowsHierarchy,w=v.colsHierarchy,b=((n=m==null?void 0:m.dataSet)===null||n===void 0?void 0:n.fields)||{},E=b.rows,R=E===void 0?[]:E,M=b.columns,k=M===void 0?[]:M,L=m.options.style.colCell,_=[],I=w==null?void 0:w.sampleNodeForLastLevel;if(p){var P=new pr({id:"",field:"",value:jc((i=m.options.seriesNumber)===null||i===void 0?void 0:i.text)});P.x=u==null?void 0:u.x,P.y=(a=I==null?void 0:I.y)!==null&&a!==void 0?a:0,P.width=p,P.height=(o=I==null?void 0:I.height)!==null&&o!==void 0?o:L==null?void 0:L.height,P.isPivotMode=!0,P.spreadsheet=m,P.cornerType=en.Series,_.push(P)}if(m.isHierarchyTreeType()){var U=this.getTreeCornerText(e),q=new pr({id:U,field:"",value:U});q.x=u.x+p,q.y=(s=I==null?void 0:I.y)!==null&&s!==void 0?s:0,q.width=h-p,q.height=(l=I==null?void 0:I.height)!==null&&l!==void 0?l:L==null?void 0:L.height,q.seriesNumberWidth=p,q.isPivotMode=!0,q.spreadsheet=m,q.cornerType=en.Row,_.push(q)}else{var Q=C.sampleNodesForAllLevels||[],J=m.isCustomRowFields();Q.forEach(function(ce){var me,oe,Se=J?ce.field:R[ce.level],Te=m.dataSet.getFieldName(Se),Ie=new pr({id:Se,field:Se,value:Te});Ie.x=ce.x+p,Ie.y=(me=I==null?void 0:I.y)!==null&&me!==void 0?me:0,Ie.width=ce.width,Ie.height=(oe=I==null?void 0:I.height)!==null&&oe!==void 0?oe:L==null?void 0:L.height,Ie.isPivotMode=!0,Ie.cornerType=en.Row,Ie.spreadsheet=m,_.push(Ie)})}var re=w.sampleNodesForAllLevels||[],ne=m.isCustomColumnFields();return re.forEach(function(ce){if(ce.level<w.maxLevel){var me=ne?ce.field:k[ce.level],oe=m.dataSet.getFieldName(me),Se=new pr({id:me,field:me,value:oe});Se.x=u.x,Se.y=ce.y,Se.width=h,Se.height=ce.height,Se.isPivotMode=!0,Se.cornerType=en.Col,Se.spreadsheet=m,_.push(Se)}}),_},r.prototype.onCorScroll=function(e,n){this.headerConfig.scrollX=e,this.render(n)},r.prototype.destroy=function(){t.prototype.destroy.call(this)},r.prototype.layout=function(){this.renderCells()},r.prototype.renderCells=function(){var e=this,n,i=this.getHeaderConfig(),a=i.nodes,o=i.spreadsheet,s=(n=o.options)===null||n===void 0?void 0:n.cornerHeader;if(s){s(this,o,this.headerConfig);return}a.forEach(function(l){var u=e.getCellInstance(l);e.appendChild(u),o.emit(se.CORNER_CELL_RENDER,u),o.emit(se.LAYOUT_CELL_RENDER,u)})},r.prototype.offset=function(){var e=this.getHeaderConfig().scrollX,n=e===void 0?0:e;Cc(this,-n)},r.prototype.clip=function(){var e=this.getHeaderConfig(),n=e.width,i=e.height;this.style.clipPath=new Zt({style:{x:0,y:0,width:n,height:i}})},r.prototype.getNodes=function(){return this.headerConfig.nodes||[]},r}(rf);function xt(t,r){return r===void 0&&(r=2),T5(t,r)}var Un=function(t){Me(r,t);function r(e){var n=t.call(this)||this;return n.cfg=e,n.render(),n}return r.prototype.layout=function(){this.addCornerBottomBorder(),this.addCornerRightBorder(),this.addSplitLineShadow()},r.prototype.render=function(){this.removeChildren(),this.layout()},r.getHorizontalBorderWidth=function(e){var n,i=((n=e.theme)===null||n===void 0?void 0:n.splitLine).horizontalBorderWidth;return i},r.getVerticalBorderWidth=function(e){var n,i=e.theme,a=i.splitLine,o=i.cornerCell,s=i.colCell,l=i.dataCell;return e.isPivotMode()?a==null?void 0:a.verticalBorderWidth:Math.max(l.cell.verticalBorderWidth,!((n=e.options.seriesNumber)===null||n===void 0)&&n.enable?o.cell.verticalBorderWidth:s.cell.verticalBorderWidth)},r.prototype.onBorderScroll=function(e){this.cfg.scrollX=e;var n=this.cfg.position;Qn(this,n.x-e,0),this.render()},r.prototype.onChangeShadowVisibility=function(e,n){this.cfg.showViewportLeftShadow=e>0,this.cfg.showViewportRightShadow=xt(e)<xt(n),this.render()},r.prototype.addCornerRightBorder=function(){var e,n,i=this.cfg,a=i.cornerWidth,o=i.cornerHeight,s=i.viewportHeight,l=i.position,u=i.spreadsheet,h=(e=u.theme)===null||e===void 0?void 0:e.splitLine,v=h.verticalBorderColor,p=h.verticalBorderColorOpacity,m=h.horizontalBorderWidth,C=r.getVerticalBorderWidth(u),w=l.x+a+C/2;if(u.isPivotMode()){var b=l.y+o+m+s;_r(this,{x1:w,y1:l.y,x2:w,y2:b,stroke:v,lineWidth:C,opacity:p});return}var E=!((n=u.options.seriesNumber)===null||n===void 0)&&n.enable?u.theme.cornerCell.cell:u.theme.colCell.cell,R=E.verticalBorderColor,M=E.verticalBorderColorOpacity;_r(this,{x1:w,y1:l.y,x2:w,y2:l.y+o,stroke:R,lineWidth:C,opacity:M});var k=u.theme.dataCell.cell,L=k.verticalBorderColor,_=k.verticalBorderColorOpacity;_r(this,{x1:w,y1:l.y+o+m,x2:w,y2:l.y+o+m+s,stroke:L,lineWidth:C,opacity:_})},r.prototype.addCornerBottomBorder=function(){var e,n=this.cfg,i=n.cornerWidth,a=n.cornerHeight,o=n.viewportWidth,s=n.position,l=n.scrollX,u=l===void 0?0:l,h=n.spreadsheet,v=(e=h.theme)===null||e===void 0?void 0:e.splitLine,p=v.horizontalBorderColor,m=v.horizontalBorderWidth,C=v.horizontalBorderColorOpacity,w=s.x,b=w+i+r.getVerticalBorderWidth(h)+o+(h.isFrozenRowHeader()?0:u),E=s.y+a+m/2;_r(this,{x1:w,y1:E,x2:b,y2:E,stroke:p,lineWidth:m,opacity:C})},r.prototype.addSplitLineShadow=function(){var e,n=this.cfg,i=n.spreadsheet,a=(e=i.theme)===null||e===void 0?void 0:e.splitLine;!i.isPivotMode()||!(a!=null&&a.showShadow)||!i.isFrozenRowHeader()||(this.addSplitLineLeftShadow(),this.addSplitLineRightShadow())},r.prototype.addSplitLineLeftShadow=function(){var e;if(this.cfg.showViewportLeftShadow){var n=this.cfg,i=n.cornerWidth,a=n.cornerHeight,o=n.viewportHeight,s=n.position,l=n.spreadsheet,u=(e=l.theme)===null||e===void 0?void 0:e.splitLine,h=u.shadowColors,v=u.shadowWidth,p=u.horizontalBorderWidth,m=s.x+i+r.getVerticalBorderWidth(l),C=s.y;this.appendChild(new Zt({style:{x:m,y:C,width:v,height:a+p+o,fill:"l (0) 0:".concat(h==null?void 0:h.left," 1:").concat(h==null?void 0:h.right)}}))}},r.prototype.addSplitLineRightShadow=function(){var e;if(this.cfg.showViewportRightShadow){var n=this.cfg,i=n.cornerWidth,a=n.cornerHeight,o=n.viewportHeight,s=n.viewportWidth,l=n.position,u=n.spreadsheet,h=(e=u.theme)===null||e===void 0?void 0:e.splitLine,v=h.shadowColors,p=h.shadowWidth,m=h.horizontalBorderWidth,C=l.x+i+r.getVerticalBorderWidth(u)+s-p,w=l.y;this.appendChild(new Zt({style:{x:C,y:w,width:p,height:a+m+o,fill:"l (0) 0:".concat(v==null?void 0:v.right," 1:").concat(v==null?void 0:v.left)}}))}},r}(Ft),D9=function(t){Me(r,t);function r(e){var n=t.call(this,e)||this;return n.initGroups(),n}return r.prototype.initGroups=function(){this.scrollGroup=this.appendChild(new Ft({name:bB,style:{zIndex:zw}})),this.frozenRowGroup=this.appendChild(new Ft({name:SB,style:{zIndex:wl}}))},r.prototype.getCellInstance=function(e){var n=this.getHeaderConfig(),i=n.spreadsheet,a=i.options.rowCell;return(a==null?void 0:a(e,i,n))||new lf(e,i,n)},r.prototype.isRowCellInRect=function(e){var n=this.getHeaderConfig(),i=n.width,a=n.viewportHeight,o=n.position,s=n.scrollY,l=s===void 0?0:s,u=n.scrollX,h=u===void 0?0:u;return this.isFrozenRow(e)?!0:a+l>e.y&&l<e.y+e.height&&i-o.x+h>e.x&&h-o.x<e.x+e.width},r.prototype.isFrozenRow=function(e){var n=this.headerConfig.spreadsheet,i=n.facet,a=Lx(n.options,i.getRowNodes()).rowCount,o=a===void 0?0:a;return o>0&&e.rowIndex>=0&&e.rowIndex<o},r.prototype.getCellGroup=function(e){return this.isFrozenRow(e)?this.frozenRowGroup:this.scrollGroup},r.prototype.layout=function(){var e=this,n=this.getHeaderConfig(),i=n.nodes,a=n.spreadsheet;tt(i,function(o){if(e.isRowCellInRect(o)&&o.height!==0){var s=e.getCellGroup(o);o.isFrozen=s!==e.scrollGroup;var l=e.getCellInstance(o);o.belongsCell=l,s.appendChild(l),a.emit(se.ROW_CELL_RENDER,l),a.emit(se.LAYOUT_CELL_RENDER,l)}})},r.prototype.offset=function(){var e=this.getHeaderConfig(),n=e.scrollX,i=n===void 0?0:n,a=e.scrollY,o=a===void 0?0:a,s=e.position,l=s.x-i;Qn(this.scrollGroup,l,s.y-o),Qn(this.frozenRowGroup,l,s.y)},r.prototype.clip=function(){var e=this.getHeaderConfig(),n=e.width,i=e.viewportHeight,a=e.position,o=e.spreadsheet,s=o.facet.frozenGroupInfo[Bt.FROZEN_ROW].height;this.scrollGroup.style.clipPath=new Zt({style:{x:o.facet.cornerBBox.x,y:a.y+s,width:n,height:i}}),this.frozenRowGroup.style.clipPath=new Zt({style:{x:o.facet.cornerBBox.x,y:a.y,width:n,height:s}})},r.prototype.clear=function(){var e,n;(e=this.scrollGroup)===null||e===void 0||e.removeChildren(),(n=this.frozenRowGroup)===null||n===void 0||n.removeChildren()},r}(rf),c0=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return Object.defineProperty(r.prototype,"cellType",{get:function(){return Le.ROW_CELL},enumerable:!1,configurable:!0}),r.prototype.getBorderPositions=function(){return[At.LEFT,At.BOTTOM]},r.prototype.initCell=function(){this.drawBackgroundShape(),this.drawInteractiveBgShape(),this.drawInteractiveBorderShape(),this.drawBorders(),this.drawTextShape(),this.update()},r.prototype.getBackgroundColor=function(){var e=this.getCrossBackgroundColor(this.meta.rowIndex),n=e.backgroundColor,i=e.backgroundColorOpacity;return{backgroundColor:n,backgroundColorOpacity:i,intelligentReverseTextColor:!1}},r.prototype.getTextStyle=function(){var e,n=this.getCellTextWordWrapStyle(Le.SERIES_NUMBER_CELL),i=(e=this.getStyle())===null||e===void 0?void 0:e.seriesText;return Y(Y({},n),i)},r.prototype.getFormattedFieldValue=function(){var e=this.meta.value;return{value:e,formattedValue:e}},r.prototype.getMaxTextWidth=function(){var e=this.getBBoxByType(Qt.CONTENT_BOX).width;return e},r.prototype.getTextPosition=function(){var e,n,i=this.headerConfig,a=i.scrollY,o=i.viewportHeight,s=this.getTextStyle(),l=this.getStyle().cell,u={start:a,size:o},h=this.getBBoxByType(Qt.CONTENT_BOX),v=a0(u,{start:h.y,size:h.height},{align:i0(s.textBaseline),size:{textSize:s.fontSize},padding:{start:(e=l==null?void 0:l.padding)===null||e===void 0?void 0:e.top,end:(n=l==null?void 0:l.padding)===null||n===void 0?void 0:n.bottom}}).textStart,p=Cs({bbox:h,textAlign:s.textAlign,textWidth:this.getActualTextWidth(),iconStyle:this.getIconStyle(),groupedIcons:this.groupedIcons}).textX;return{x:p,y:v}},r.prototype.isBolderText=function(){return!1},r.prototype.findFieldCondition=function(){},r.prototype.mappingValue=function(){},r.prototype.getIconPosition=function(){return{x:0,y:0}},r}(sf),B9=function(t,r,e){var n=e.isHierarchyTreeType(),i=t.getNodes(0);return i.map(function(a,o){var s="".concat(o+1),l=new pr({id:s,field:"",rowIndex:o,value:s});return l.x=a.x,l.y=a.y,l.width=r,l.height=n?a.getTotalHeightForTreeHierarchy():a.height,l.isLeaf=!0,l.spreadsheet=e,l})},F9=function(t){Me(r,t);function r(e){return t.call(this,e)||this}return r.prototype.getCellInstance=function(e){var n=this.getHeaderConfig(),i=n.spreadsheet,a=i.options.seriesNumberCell;return(a==null?void 0:a(e,i,n))||new c0(e,i,n)},r.getSeriesNumberHeader=function(e){var n,i,a=e.panelBBox,o=e.seriesNumberWidth,s=e.rowsHierarchy,l=e.spreadsheet,u=e.cornerWidth,h=a.height,v=a.viewportHeight,p=(i=(n=l.options)===null||n===void 0?void 0:n.layoutSeriesNumberNodes)!==null&&i!==void 0?i:B9;return new r({width:u,height:h,viewportWidth:u,viewportHeight:v,position:{x:0,y:a.y},nodes:p(s,o,l),spreadsheet:l})},r.prototype.clip=function(){var e=this.getHeaderConfig(),n=e.width,i=e.height,a=e.viewportHeight,o=e.position,s=e.spreadsheet;this.style.clipPath=new Zt({style:{x:s.facet.cornerBBox.x,y:o.y,width:n,height:i+a}})},r.prototype.layout=function(){var e=this,n=this.getHeaderConfig(),i=n.nodes,a=n.scrollY,o=a===void 0?0:a,s=n.viewportHeight,l=n.spreadsheet;tt(i,function(u){var h=u.y,v=u.height,p=e.isHeaderCellInViewport({cellPosition:h,cellSize:v,viewportPosition:o,viewportSize:s});if(p){var m=e.getCellInstance(u);u.belongsCell=m,e.appendChild(m),l.emit(se.SERIES_NUMBER_CELL_RENDER,m),l.emit(se.LAYOUT_CELL_RENDER,m)}})},r.prototype.offset=function(){var e=this.getHeaderConfig(),n=e.scrollY,i=n===void 0?0:n,a=e.scrollX,o=a===void 0?0:a,s=e.position;Qn(this,s.x-o,s.y-i)},r.prototype.getNodes=function(){var e=this.getHeaderConfig().nodes;return e||[]},r}(rf),qx=function(t){var r=t.includes(rn)?"id":"field";return r},zd=function(t,r){r===void 0&&(r=[]);var e=t.facet.getInitColLeafNodes();return ai(r.map(function(n){var i=qx(n);return e.find(function(a){return a[i]===n})}))},H9=function(t,r){if(r===void 0&&(r=[]),ke(r))return{prev:null,next:null};var e=t.facet.getInitColLeafNodes(),n=zd(t,r).map(function(l){return l==null?void 0:l.colIndex}),i=Math.max.apply(Math,pe([],te(n),!1)),a=Math.min.apply(Math,pe([],te(n),!1)),o=e.find(function(l){return l.colIndex===i+1}),s=e.find(function(l){return l.colIndex===a-1});return{prev:s||null,next:o||null}},z9=function(t,r){if(ke(r))return[];var e=Number.NEGATIVE_INFINITY;return t.reduce(function(n,i,a){if(!r.includes(i))return n;if(a===e+1){var o=mr(n);o==null||o.push(i)}else{var s=[i];n.push(s)}return e=a,n},[])},G1=function(t,r,e){return r===void 0&&(r=[]),e===void 0&&(e=!1),Ar(void 0,void 0,void 0,function(){var n,i,a,o,s,l,u,h,v;return Nr(this,function(p){switch(p.label){case 0:return n=function(m,C){return m===void 0&&(m=[]),C===void 0&&(C=[]),Ar(void 0,void 0,void 0,function(){return Nr(this,function(w){switch(w.label){case 0:return t.setOptions({interaction:{hiddenColumnFields:m}}),t.interaction.reset(),t.store.set("hiddenColumnsDetail",C),[4,t.render({reloadData:!1,reBuildHiddenColumnsDetail:!1})];case 1:return w.sent(),[2]}})})},ke(r)&&e?[4,n()]:[3,2];case 1:return p.sent(),[2];case 2:return i=t.store.get("hiddenColumnsDetail",[]),a=t.options.interaction.hiddenColumnFields,o=a===void 0?[]:a,tn(r,o)&&!e?[2]:(s=wa(pe(pe([],te(r),!1),te(o),!1)),l=zd(t,s).every(function(m,C,w){var b=w[C+1];return!b||Math.abs(m.colIndex-b.colIndex)===1}),u=H9(t,l?s:r),h={hideColumnNodes:zd(t,r),displaySiblingNode:u},v=pe(pe([],te(i),!1),[h],!1),t.emit(se.COL_CELL_HIDDEN,h,v),[4,n(s,v)]);case 3:return p.sent(),[2]}})})},W9=function(t){var r=t.dataCfg.fields.columns,e=r===void 0?[]:r;return t.isTableMode()&&!t.isCustomColumnFields()?e:t.facet.getInitColLeafNodes().map(function(n){var i=n.id;return i})},f0=function(t,r,e){return r===void 0&&(r=[]),e===void 0&&(e=!1),Ar(void 0,void 0,void 0,function(){var n,i,a;return Nr(this,function(o){switch(o.label){case 0:return ke(r)&&e?[4,G1(t,r,!0)]:[3,2];case 1:o.sent(),o.label=2;case 2:return n=W9(t),i=Xl(n),a=z9(i,r),[4,Promise.all(a.map(function(s){return Ar(void 0,void 0,void 0,function(){return Nr(this,function(l){switch(l.label){case 0:return[4,G1(t,s,e)];case 1:return l.sent(),[2]}})})}))];case 3:return o.sent(),[2]}})})},G9=function(t,r){var e=t.facet.getColNodes(),n=t.facet.getInitColLeafNodes(),i=qx(r);return dt(mr(e),i)===r&&dt(mr(n),i)!==r},U9=function(t){return(t==null?void 0:t.next)||(t==null?void 0:t.prev)},V9=function(t){var r=U9(t);return r==null?void 0:r.id},Wd=function(t,r){return V9(t)===r},$l=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return Object.defineProperty(r.prototype,"cellType",{get:function(){return Le.COL_CELL},enumerable:!1,configurable:!0}),r.prototype.getBorderPositions=function(){return[At.TOP,At.RIGHT]},r.prototype.initCell=function(){t.prototype.initCell.call(this),this.drawBackgroundShape(),this.drawInteractiveBgShape(),this.drawInteractiveBorderShape(),this.drawTextShape(),this.drawActionAndConditionIcons(),this.drawBorders(),this.drawResizeArea(),this.addExpandColumnIconShapes(),this.update()},r.prototype.getFormattedFieldValue=function(){var e,n=this.meta,i=n.extra,a=n.value,o=n.field,s=this.spreadsheet.dataSet.fields,l=(i==null?void 0:i.isCustomNode)&&((e=s==null?void 0:s.values)===null||e===void 0?void 0:e.includes(o));return l?{formattedValue:a,value:a}:t.prototype.getFormattedFieldValue.call(this)},r.prototype.getMaxTextWidth=function(){var e=this.getBBoxByType(Qt.CONTENT_BOX).width;return e-this.getActionAndConditionIconWidth()},r.prototype.isBolderText=function(){var e=this.meta,n=e.isLeaf,i=e.isTotals;return!!(i||!n)},r.prototype.handleViewport=function(){var e=this.getHeaderConfig(),n=e.width,i=e.cornerWidth,a=i===void 0?0:i,o=e.scrollX,s=o===void 0?0:o,l=!this.spreadsheet.isFrozenRowHeader(),u={start:s-(l?a:0),size:n+(l?a:0)};return u},r.prototype.getTextPosition=function(){var e,n,i,a=this.meta.isLeaf,o=this.getTextStyle(),s=this.getBBoxByType(Qt.CONTENT_BOX),l=this.getIconStyle(),u=Sl(s,o.textBaseline),h=Ul(l.size,u,o.fontSize,o.textBaseline);if(a){var v=Cs({bbox:s,textWidth:this.getActualTextWidth(),textAlign:o.textAlign,groupedIcons:this.groupedIcons,iconStyle:l}),p=v.textX,m=v.leftIconX,C=v.rightIconX;return this.leftIconPosition={x:m,y:h},this.rightIconPosition={x:C,y:h},{x:p,y:u}}var w=this.handleViewport(),b=this.getStyle(),E=b.cell,R=b.icon,M=this.getTextStyle(),k=M.textAlign,L=M.textBaseline,_=a0(w,{start:s.x,size:s.width},{align:i0(k),size:{textSize:this.getActualTextWidth(),iconStartSize:this.getActionAndConditionIconWidth("left"),iconEndSize:this.getActionAndConditionIconWidth("right")},padding:{start:(e=E==null?void 0:E.padding)===null||e===void 0?void 0:e.left,end:(n=E==null?void 0:E.padding)===null||n===void 0?void 0:n.right,betweenTextAndEndIcon:(i=R==null?void 0:R.margin)===null||i===void 0?void 0:i.left}}),I=_.textStart,P=_.iconStart,U=_.iconEnd,q=Sl(s,L);return this.leftIconPosition={x:P,y:h},this.rightIconPosition={x:U,y:h},{x:I,y:q}},r.prototype.getColResizeArea=function(){return Qa(this.spreadsheet,Ww)},r.prototype.getHorizontalResizeAreaName=function(){return"".concat(Uw).concat(this.meta.field)},r.prototype.isCrossColumnLeafNode=function(){var e,n=this.spreadsheet.facet.getLayoutResult().colsHierarchy,i=this.meta,a=i.level,o=i.isLeaf;return((e=n==null?void 0:n.sampleNodeForLastLevel)===null||e===void 0?void 0:e.level)!==a&&o},r.prototype.drawHorizontalResizeArea=function(){var e,n,i=((n=(e=this.spreadsheet.options.style)===null||e===void 0?void 0:e.colCell)===null||n===void 0?void 0:n.height)===0;if(!(i||!this.shouldDrawResizeAreaByType("colCellVertical",this))){var a=this.meta,o=a.y,s=a.height,l=this.getResizeAreaStyle(),u=this.getColResizeArea();if(!(!u||this.isCrossColumnLeafNode())){var h=this.getHorizontalResizeAreaName(),v=u==null?void 0:u.find(function(C){return C.name===h});if(!v){var p=this.getResizeAreaWidth(),m=_l({theme:l,type:zr.Vertical,effect:Qr.Field,offsetX:0,offsetY:o,width:p,height:s,meta:this.meta});u.appendChild(new cs({name:h,style:Y(Y({},m.style),{x:0,y:o+s-l.size,width:p})},m.appendInfo))}}}},r.prototype.getResizeAreaWidth=function(){var e=this.getHeaderConfig(),n=e.cornerWidth,i=n===void 0?0:n,a=e.viewportWidth;return Un.getVerticalBorderWidth(this.spreadsheet)+i+a},r.prototype.shouldAddVerticalResizeArea=function(){var e=this.meta,n=e.x,i=e.y,a=e.width,o=e.height,s=this.getHeaderConfig(),l=s.scrollX,u=s.scrollY,h=s.cornerWidth,v=h===void 0?0:h,p=s.height,m=s.width,C=!this.spreadsheet.isFrozenRowHeader(),w=this.getResizeAreaStyle(),b={x:n+a-w.size,y:i,width:w.size,height:o},E={x:C?-v:0,y:0,width:C?v+m:m,height:p};return Yl(b,E,{scrollX:l,scrollY:u})},r.prototype.getVerticalResizeAreaOffset=function(){var e=this.meta,n=e.x,i=e.y,a=this.getHeaderConfig(),o=a.scrollX,s=o===void 0?0:o,l=a.position;return{x:(l==null?void 0:l.x)+n-s,y:(l==null?void 0:l.y)+i}},r.prototype.drawVerticalResizeArea=function(){if(!(!this.meta.isLeaf||!this.shouldDrawResizeAreaByType("colCellHorizontal",this))){var e=this.meta,n=e.width,i=e.height,a=this.getResizeAreaStyle(),o=this.getColResizeArea();if(!(!o||!this.shouldAddVerticalResizeArea())){var s=this.getVerticalResizeAreaOffset(),l=s.x,u=s.y,h=_l({theme:a,type:zr.Horizontal,effect:Qr.Cell,offsetX:l,offsetY:u,width:n,height:i,meta:this.meta});o.appendChild(new cs({style:Y(Y({},h.style),{x:l+n-a.size,y:u,height:i})},h.appendInfo))}}},r.prototype.drawResizeArea=function(){this.drawHorizontalResizeArea(),this.drawVerticalResizeArea()},r.prototype.hasHiddenColumnCell=function(){var e=this,n,i=this.spreadsheet.options,a=i.interaction,o=i.tooltip,s=this.spreadsheet.store.get("hiddenColumnsDetail",[]);return ke(s)||ke(a==null?void 0:a.hiddenColumnFields)||!(!((n=o==null?void 0:o.operation)===null||n===void 0)&&n.hiddenColumns)?!1:!!s.find(function(l){return Wd(l==null?void 0:l.displaySiblingNode,e.meta.id)})},r.prototype.getExpandIconTheme=function(){var e=this.getStyle();return e.icon},r.prototype.addExpandColumnSplitLine=function(){var e=this.getBBoxByType(),n=e.x,i=e.y,a=e.width,o=e.height,s=this.theme.splitLine,l=s.horizontalBorderColor,u=s.horizontalBorderColorOpacity,h=this.isLastColumn()?n+a:n;_r(this,{x1:h,y1:i,x2:h,y2:i+o,stroke:l,lineWidth:mc,strokeOpacity:u})},r.prototype.addExpandColumnIconShapes=function(){this.hasHiddenColumnCell()&&(this.addExpandColumnSplitLine(),this.addExpandColumnIcons())},r.prototype.addExpandColumnIcons=function(){var e=this.isLastColumn();this.addExpandColumnIcon(e),this.isAllDisplaySiblingNodeHidden()&&e&&this.addExpandColumnIcon(!1)},r.prototype.addExpandColumnIcon=function(e){var n=this,i=this.getExpandColumnIconConfig(e),a=Gl(this,Y(Y({},i),{name:"ExpandColIcon",cursor:"pointer"}));a.addEventListener("click",function(){n.spreadsheet.emit(se.COL_CELL_EXPANDED,n.meta)})},r.prototype.getExpandColumnIconConfig=function(e){var n=this.getExpandIconTheme().size,i=n===void 0?0:n,a=this.getBBoxByType(),o=a.x,s=a.y,l=a.width,u=a.height,h=o-i,v=e?h+l:h,p=s+u/2-i/2;return{x:v,y:p,width:i*2,height:i}},r.prototype.isLastColumn=function(){return G9(this.spreadsheet,this.meta.id)},r.prototype.isAllDisplaySiblingNodeHidden=function(){var e=this.meta.id,n=this.spreadsheet.store.get("hiddenColumnsDetail",[]),i=n.find(function(o){var s,l=o.displaySiblingNode;return((s=l==null?void 0:l.next)===null||s===void 0?void 0:s.id)===e}),a=n.find(function(o){var s,l=o.displaySiblingNode;return((s=l==null?void 0:l.prev)===null||s===void 0?void 0:s.id)===e});return a&&i},r}(sf),Rc=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.handleRestOptions=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=te(e,1),a=i[0];this.headerConfig=Y({},a);var o=this.meta.field,s=this.spreadsheet.dataCfg.sortParams,l=Rr(s,function(h){return(h==null?void 0:h.sortFieldId)===o}),u=Yx(l,!0);this.headerConfig.sortParam=Y(Y(Y({},this.headerConfig.sortParam),l||{}),{type:u})},r.prototype.getFormattedFieldValue=function(){return cx(this.meta,this.spreadsheet.dataSet.getFieldName(this.meta.field))},r.prototype.shouldAddVerticalResizeArea=function(){if(this.getMeta().isFrozen)return!0;var e=this.getHeaderConfig(),n=e.scrollX,i=e.scrollY,a=e.width,o=e.height,s=e.spreadsheet,l=this.getBBoxByType(),u=l.x,h=l.y,v=l.width,p=l.height,m=this.getResizeAreaStyle(),C={x:u+v-m.size,y:h,width:m.size,height:p},w=s.facet.frozenGroupInfo,b=w[Bt.FROZEN_COL].width,E=w[Bt.FROZEN_TRAILING_COL].width,R={x:b,y:0,width:a-b-E,height:o};return Yl(C,R,{scrollX:n,scrollY:i})},r.prototype.getVerticalResizeAreaOffset=function(){var e=this.meta,n=e.x,i=e.y,a=this.getHeaderConfig(),o=a.scrollX,s=o===void 0?0:o,l=a.position;return this.getMeta().isFrozen?{x:(l==null?void 0:l.x)+n,y:(l==null?void 0:l.y)+i}:{x:(l==null?void 0:l.x)+n-s,y:(l==null?void 0:l.y)+i}},r.prototype.getColResizeArea=function(){return this.getMeta().isFrozen?Qa(this.spreadsheet,Gw):t.prototype.getColResizeArea.call(this)},r.prototype.isSortCell=function(){return!0},r.prototype.showSortIcon=function(){return this.spreadsheet.options.showDefaultHeaderActionIcon},r.prototype.getTextStyle=function(){var e,n=this.getCellTextWordWrapStyle(),i=(e=this.getStyle())===null||e===void 0?void 0:e.bolderText;return Y(Y({},n),i)},r.prototype.getHorizontalResizeAreaName=function(){return"".concat(Uw).concat(this.meta.id)},r.prototype.drawBackgroundShape=function(){var e=this.getStyle().cell||{},n=e.backgroundColor,i=e.backgroundColorOpacity;this.backgroundShape=La(this,Y(Y({},this.getBBoxByType()),{fill:n,fillOpacity:i}))},r.prototype.handleViewport=function(){var e=t.prototype.handleViewport.call(this);return this.getMeta().isFrozen&&(e.start=0),e},r}($l),U1=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.getStyle=function(e){var n;return e?dt(this.theme,e):(n=this.theme)===null||n===void 0?void 0:n.cornerCell},r.prototype.showSortIcon=function(){return!1},r}(Rc),Lc=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.getLinkFieldStyle=function(){return this.theme.rowCell.text.linkTextFill},r.prototype.drawBorders=function(){this.meta.isFrozenCorner&&Qc.prototype.drawBorders.call(this)},r.prototype.shouldDrawResizeArea=function(){var e="".concat(this.meta.rowIndex),n=Qa(this.spreadsheet,ss),i=Qa(this.spreadsheet,bd);return!(n!=null&&n.getElementById(e))&&!(i!=null&&i.getElementById(e))},r.prototype.drawResizeArea=function(){if(this.shouldDrawResizeArea()){var e=this.getBBoxByType(),n=e.y,i=e.height,a=this.meta.rowIndex,o=this.getResizeAreaStyle(),s=this.spreadsheet.options.frozen,l=s.rowCount,u=l===void 0?0:l,h=s.trailingRowCount,v=h===void 0?0:h,p=this.spreadsheet.facet.getCellRange(),m=tf(a,p.start,u),C=Vl(a,p.end,v),w=m||C,b=w?bd:ss,E=Qa(this.spreadsheet,b);if(E){var R=this.spreadsheet.facet.columnHeader.getHeaderConfig(),M=R.height,k=R.viewportWidth,L=this.spreadsheet.facet.getScrollOffset().scrollY,_=this.spreadsheet.facet.getPaginationScrollY(),I=n+M+Un.getHorizontalBorderWidth(this.spreadsheet),P=this.spreadsheet.facet.frozenGroupInfo,U=P[Bt.FROZEN_ROW].height,q=P[Bt.FROZEN_TRAILING_ROW].height,Q={x:0,y:n+i-o.size,width:k,height:o.size},J={x:0,y:U,width:k,height:this.spreadsheet.facet.panelBBox.height-U-q};if(!(!w&&!Yl(Q,J,{scrollX:0,scrollY:L}))){w||(I-=L+_);var re=k+Un.getVerticalBorderWidth(this.spreadsheet),ne=_l({theme:o,type:zr.Vertical,effect:Qr.Cell,offsetX:0,offsetY:I,width:re,height:i,meta:this.meta});E.appendChild(new cs({style:Y(Y({},ne.style),{x:0,y:I+i-o.size,width:re})},ne.appendInfo))}}}},r.prototype.isDisableHover=function(e){return(e==null?void 0:e.type)===Le.COL_CELL},r}(Di),h0=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return Object.defineProperty(r.prototype,"cellType",{get:function(){return Le.DATA_CELL},enumerable:!1,configurable:!0}),r.prototype.getTextStyle=function(){var e=this.getCellTextWordWrapStyle(Le.SERIES_NUMBER_CELL),n=this.theme.rowCell.seriesText;return Y(Y({},e),n)},r}(Lc),X9=function(t){var r=0,e=t.children;return e==null||e.forEach(function(n){r+=n.height||0}),r},lf=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return Object.defineProperty(r.prototype,"cellType",{get:function(){return Le.ROW_CELL},enumerable:!1,configurable:!0}),r.prototype.getBorderPositions=function(){return[At.BOTTOM,At.LEFT]},r.prototype.initCell=function(){t.prototype.initCell.call(this),this.drawBackgroundShape(),this.drawInteractiveBgShape(),this.drawInteractiveBorderShape(),this.drawTextShape(),this.drawActionAndConditionIcons(),this.drawTreeIcon(),this.drawTreeLeafNodeAlignDot(),this.drawBorders(),this.drawResizeAreaInLeaf(),this.update()},r.prototype.getBackgroundColor=function(){var e=this.getCrossBackgroundColor(this.meta.rowIndex),n=e.backgroundColor,i=e.backgroundColorOpacity;return Wl({backgroundColor:n,backgroundColorOpacity:i},this.getBackgroundConditionFill())},r.prototype.showTreeIcon=function(){return this.spreadsheet.isHierarchyTreeType()&&!this.meta.isLeaf},r.prototype.showTreeLeafNodeAlignDot=function(){var e,n;return((n=(e=this.spreadsheet.options.style)===null||e===void 0?void 0:e.rowCell)===null||n===void 0?void 0:n.showTreeLeafNodeAlignDot)&&this.spreadsheet.isHierarchyTreeType()},r.prototype.getParentTreeIconCfg=function(){var e;if(!(!this.showTreeLeafNodeAlignDot()||!this.spreadsheet.isHierarchyTreeType()||!this.meta.isLeaf)){var n=((e=this.meta.parent)===null||e===void 0?void 0:e.belongsCell).getTreeIcon();return n==null?void 0:n.style}},r.prototype.onTreeIconClick=function(){var e=this.meta,n=e.isCollapsed,i=e.hierarchy;if(!tr()){if(!n){var a=this.spreadsheet.facet.getScrollOffset().scrollY,o=this.spreadsheet.facet.panelBBox.viewportHeight||0,s=X9(this.meta),l=i.height-s;if(a>0&&a+o>l){var u=l-o;this.spreadsheet.facet.setScrollOffset({scrollY:u>0?u:0})}}this.emitCollapseEvent()}},r.prototype.emitCollapseEvent=function(){this.spreadsheet.emit(se.ROW_CELL_COLLAPSED__PRIVATE,{isCollapsed:!this.meta.isCollapsed,node:this.meta})},r.prototype.drawTreeIcon=function(){var e=this;if(this.showTreeIcon()){var n=this.meta.isCollapsed,i=this.getBBoxByType(Qt.CONTENT_BOX).x,a=this.getTextStyle().fill,o=this.getStyle().icon.size,s=this.getContentIndent(),l=i+s,u=this.getIconPosition().y;this.treeIcon=lx({group:this,iconCfg:{x:l,y:u,width:o,height:o,fill:a},isCollapsed:n,onClick:function(){e.onTreeIconClick()}}),tr()&&this.addEventListener("click",function(){e.emitCollapseEvent()})}},r.prototype.drawTreeLeafNodeAlignDot=function(){var e=this.getParentTreeIconCfg();if(e){var n=this.getStyle().icon,i=n.size,a=n.margin,o=e.x+i+a.right,s=this.getTextPosition().y,l=this.getTextStyle(),u=l.fill,h=l.fontSize,v=i/5;this.treeLeafNodeAlignDot=sx(this,{cx:o+i/2,cy:s+(h-v)/2,r:v,fill:u,fillOpacity:.3})}},r.prototype.isBolderText=function(){var e=this.meta,n=e.isLeaf,i=e.isTotals,a=e.level;return!n&&a===0||i},r.prototype.drawTextShape=function(){t.prototype.drawTextShape.call(this),this.isShallowRender()||this.drawLinkField(this.meta)},r.prototype.drawResizeAreaInLeaf=function(){var e;if(!(!this.meta.isLeaf||!this.shouldDrawResizeAreaByType("rowCellVertical",this))){var n=this.getBBoxByType(),i=n.x,a=n.y,o=n.width,s=n.height,l=this.getResizeAreaStyle(),u=Qa(this.spreadsheet,ss);if(u){var h=this.getHeaderConfig(),v=h.position,p=h.width,m=h.viewportHeight,C=h.scrollX,w=C===void 0?0:C,b=h.scrollY,E=b===void 0?0:b,R=h.spreadsheet,M={x:i,y:a+s-l.size,width:o,height:l.size},k=this.getMeta().isFrozen,L=(e=R.facet.frozenGroupInfo[Bt.FROZEN_ROW])===null||e===void 0?void 0:e.height,_={x:0,y:L,width:p,height:m};if(!(!k&&!Yl(M,_,{scrollX:w,scrollY:E}))){var I=v.x+i-w,P=v.y+a-(k?0:E),U=this.spreadsheet.isFrozenRowHeader()?p-v.x-(i-w):o,q=_l({theme:l,type:zr.Vertical,effect:Qr.Cell,offsetX:I,offsetY:P,width:o,height:s,meta:this.meta});u.appendChild(new cs({style:Y(Y({},q.style),{x:I,y:P+s-l.size,width:U})},q.appendInfo))}}}},r.prototype.getContentIndent=function(){if(!this.spreadsheet.isHierarchyTreeType())return 0;for(var e=this.getStyle(),n=e.icon,i=e.cell,a=n.size+n.margin.right,o=this.meta.parent,s=0;o;)o.height!==0&&(s+=a),o=o.parent;return this.showTreeLeafNodeAlignDot()&&(s+=this.isTreeLevel()?0:i.padding.right+n.margin.right),s},r.prototype.getTextIndent=function(){var e=this.getStyle().icon,n=e.size,i=e.margin,a=this.getContentIndent(),o=this.showTreeIcon()||this.isTreeLevel()&&this.showTreeLeafNodeAlignDot()?n+i.right:0;return a+o},r.prototype.isTreeLevel=function(){return Rr(dt(this.meta,"parent.children"),function(e){return!e.isLeaf})},r.prototype.getMaxTextWidth=function(){var e=this.getBBoxByType(Qt.CONTENT_BOX).width;return e-this.getTextIndent()-this.getActionAndConditionIconWidth()},r.prototype.getTextArea=function(){var e=this.getBBoxByType(Qt.CONTENT_BOX),n=this.getTextIndent();return Y(Y({},e),{x:e.x+n,width:e.width-n})},r.prototype.handleViewport=function(){var e=this.getHeaderConfig(),n=e.scrollY,i=e.viewportHeight,a=e.spreadsheet,o=a.facet.frozenGroupInfo[Bt.FROZEN_ROW].height,s={start:this.getMeta().isFrozen?0:n+o,size:i-o};return s},r.prototype.getTextPosition=function(){var e=this.getTextArea(),n=this.getTextStyle(),i=this.getStyle(),a=i.cell,o=i.icon,s=this.handleViewport(),l=a0(s,{start:e.y,size:e.height},{align:i0(n.textBaseline),size:{textSize:n.fontSize},padding:{start:a.padding.top,end:a.padding.bottom}}).textStart,u=Cs({bbox:e,textWidth:this.getActualTextWidth(),textAlign:n.textAlign,groupedIcons:this.groupedIcons,iconStyle:o}),h=u.textX,v=u.leftIconX,p=u.rightIconX,m=Ul(o==null?void 0:o.size,l,n.fontSize,n.textBaseline);return this.leftIconPosition={x:v,y:m},this.rightIconPosition={x:p,y:m},{x:h,y:l}},r}(sf),Mc=function(t){return[Ur.META,Ur.CONTROL].includes(t.key)},Kx=function(t){return t.ctrlKey||t.metaKey},Ii=function(t){var r=t.getMeta(),e=r||{},n=e.id,i=e.colIndex,a=e.rowIndex,o=e.rowQuery;return{id:n,colIndex:i,rowIndex:a,rowQuery:o,type:t instanceof h0?Le.ROW_CELL:t.cellType}},Y9=function(t,r){var e=t.interaction;e.changeState({stateName:Xe.SELECTED,cells:r}),t.emit(se.GLOBAL_SELECTED,e.getActiveCells())};function Gd(t,r){var e=Math.min(t.rowIndex,r.rowIndex),n=Math.max(t.rowIndex,r.rowIndex),i=Math.min(t.colIndex,r.colIndex),a=Math.max(t.colIndex,r.colIndex);return{start:{rowIndex:e,colIndex:i},end:{rowIndex:n,colIndex:a}}}function $9(t,r){var e,n=r.facet,i=r.options;if(r.isTableMode()){if(!(!((e=i.seriesNumber)===null||e===void 0)&&e.enable))return[];var a=n.getColLeafNodes()[0].id,o=ef(String(t.rowIndex),a),s=[],l=n.getCellById(o);return l&&l instanceof h0&&s.push(l),s}return r0(t.rowId,n.getRowCells(),r.isHierarchyTreeType())}var d0=function(t,r){var e=t.spreadsheet.facet,n=t.getSelectedCellHighlight(),i=n.colHeader,a=n.rowHeader;i&&t.updateCells(e.getColCells()),a&&t.updateCells(e.getRowCells()),r()},Zx=function(t){var r,e=t.store.get("visibleActionIcons"),n=t.interaction.getInteractedCells(),i=t.interaction.getState().cells;if(ke(n)&&ke(i)&&ke(e))return!1;if(tt(e,function(o){o.setAttribute("visibility","hidden")}),t.store.set("visibleActionIcons",[]),tt(n,function(o){o.hideInteractionShape()}),t.interaction.resetState(),!((r=t.options.interaction)===null||r===void 0)&&r.selectedCellsSpotlight){var a=t.interaction.getUnSelectedDataCells()||[];tt(a,function(o){o.clearUnselectedState()})}return!0},q9=function(t,r){var e=r==null?void 0:r.stateName;t.interaction.isEqualStateName(e)||(Zx(t),t.hideTooltip(),t.store.set(_d,r))},K9=function(t,r,e){var n,i,a=e.facet,o=a.panelBBox.width,s=a==null?void 0:a.frozenGroupInfo,l=(n=s==null?void 0:s.frozenCol.width)!==null&&n!==void 0?n:0,u=(i=s==null?void 0:s.frozenTrailingCol.width)!==null&&i!==void 0?i:0,h=a.getColLeafNodes()[t];return r===br.SCROLL_UP?h.x-l:h.x+h.width-(o-u)},Z9=function(t,r,e){var n,i,a=e.facet,o=a.viewCellHeights.getCellOffsetY,s=a.panelBBox.height,l=o(t+1);if(nr(l))return 0;var u=a==null?void 0:a.frozenGroupInfo,h=(n=u==null?void 0:u.frozenRow.height)!==null&&n!==void 0?n:0,v=(i=u==null?void 0:u.frozenTrailingRow.height)!==null&&i!==void 0?i:0;return r===br.SCROLL_UP?o(t)-h:l-(s-v)},ta=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var e=function(i,a){if(vt(i)&&vt(a))return a},n=pe(pe([],te(t),!1),[e],!1);return i5.apply(void 0,pe([{}],te(n),!1))},j9=function(t){var r=["rows","columns","values"],e=r.reduce(function(n,i){var a=t[i],o=wa(a);return tn(o,a)||console.warn("fields.".concat(i,":[").concat(a,"] should be unique")),n[i]=o,n},{});return Y(Y({},t),e)},Nh=function(){for(var t,r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var n=ta.apply(void 0,pe([RB],te(r),!1));n.fields=j9(n.fields);var i=(t=n.fields.rows)===null||t===void 0?void 0:t.some(function(o){return!oa(o)}),a=ke(n.fields.values);return(i||a)&&(n.fields.valueInCols=!1),n},V1=function(t){return ta(IB,t)},J9=function(t){var r=t.spreadsheet,e=t.position,n=t.tooltipContainer,i=t.autoAdjustBoundary,a=r.getCanvasElement(),o=e.x+S1.x,s=e.y+S1.y;if(!i||!a)return{x:o,y:s};var l=i==="body",u=r.facet.panelBBox,h=u.maxX,v=u.maxY,p=r.options,m=p.width,C=p.height,w=a.getBoundingClientRect(),b=w.top,E=w.left,R=n.getBoundingClientRect(),M=R.width,k=R.height,L=document.body.getBoundingClientRect(),_=L.width,I=L.height,P=l?_:Math.min(m,h)+E,U=l?I:Math.min(C,v)+b;return o+M>=P&&(o=P-M),s+k>=U&&(s=U-k),{x:o,y:s}},Ud=function(t){return Y(Y({},t==null?void 0:t.colQuery),t==null?void 0:t.rowQuery)},Bu=function(t,r){var e;if(t){var n=r.style,i=r.className,a=i===void 0?[]:i,o=r.visible;if(n&&Object.assign(t.style,n),a.length){var s=a.filter(Boolean);(e=t.classList).add.apply(e,pe([],te(s),!1))}t.classList.toggle(S6,o),t.classList.toggle(E6,!o)}},Q9=function(t){var r=Wn(t)&&Number.isNaN(t),e=t==="";return nr(t)||r||e?"-":t},v0=function(t,r){var e,n=(e=t==null?void 0:t.dataSet)===null||e===void 0?void 0:e.getFieldFormatter(r);return function(i,a){return Q9(n(i,a))}},Vd=function(t,r){var e,n=r.data,i=r.field,a=r.valueField,o=r.useCompleteDataForFormatter,s=o===void 0?!0:o,l=r.targetCell,u=(t==null?void 0:t.dataSet.getCustomRowFieldName(l))||((e=t==null?void 0:t.dataSet)===null||e===void 0?void 0:e.getFieldName(i)),h=v0(t,i),v=oi.getFieldValue(n,i),p=Lr(v)?null:v,m=h(a||p,s?n:void 0);return{name:u,value:m}},X1=function(t,r,e){var n=ci(Ra([],r),function(i){return i!==it&&oi.getFieldValue(e,i)});return ct(n,function(i){return Vd(t,{data:e,field:i,useCompleteDataForFormatter:!1})})},e7=function(t,r,e){var n,i,a,o,s=(e||{}).isTotals,l=[],u=[];if(r){var h=(i=(n=t==null?void 0:t.dataSet)===null||n===void 0?void 0:n.fields)===null||i===void 0?void 0:i.columns,v=(o=(a=t==null?void 0:t.dataSet)===null||a===void 0?void 0:a.fields)===null||o===void 0?void 0:o.rows;l=X1(t,Xl(h||[]),r),u=X1(t,v,r)}return ke(l)&&ke(u)&&s&&(l=[{value:gr("")}]),{cols:l,rows:u}},t7=function(t,r,e,n){if(!r)return[];var i=e.isTotals,a=r[it],o=[];return i?o.push(Vd(t,{data:r,field:a,targetCell:n,valueField:r[sa]})):o.push(Vd(t,{data:r,field:a,targetCell:n})),o},r7=function(t,r,e){var n;if(e)return gr("");var i=(n=t==null?void 0:t.dataSet)===null||n===void 0?void 0:n.getFieldName(r);return i&&i!=="undefined"?i:""},Y1=function(t,r,e){e===void 0&&(e=!0);var n=[];return tt(r,function(i,a){tt(t,function(o){!e&&o.colIndex!==-1?n.push([a,o.colIndex]):e&&o.rowIndex!==-1&&n.push([o.rowIndex,a])})}),n},n7=function(t){var r,e=t.facet.getRowLeafNodes(),n=t.facet.getColLeafNodes(),i=t.interaction.getState(),a=i.nodes,o=a===void 0?[]:a,s=i.cells,l=s===void 0?[]:s,u=(r=l==null?void 0:l[0])===null||r===void 0?void 0:r.type,h=t.isHierarchyTreeType()?o:o.filter(function(v){return v==null?void 0:v.isLeaf});return u===Le.COL_CELL?Y1(h,e,!1):u===Le.ROW_CELL?Y1(h,n):[]},i7=function(t,r,e){var n=t.facet,i=function(s){if(!s)return!1;var l=r==null?void 0:r.getMeta(),u=l==null?void 0:l.isTotals,h=(r==null?void 0:r.cellType)===Le.COL_CELL,v=(r==null?void 0:r.cellType)===Le.ROW_CELL;if(!h&&!v)return!1;var p=n.getColNodeByIndex(s.colIndex),m=n.getRowNodeByIndex(s.rowIndex),C=h?m==null?void 0:m.isTotals:p==null?void 0:p.isTotals;return!u&&(s==null?void 0:s.isTotals)||u&&C};if(e){var a=n7(t);return ai(ct(a,function(s){var l=te(s,2),u=l[0],h=l[1],v=n.getCellMeta(u,h);if(!i(v))return(v==null?void 0:v.data)||Ud(v)}))}var o=t.interaction.getCells();return o.filter(function(s){var l=n.getCellMeta(s.rowIndex,s.colIndex);return!i(l)}).map(function(s){var l=n.getCellMeta(s.rowIndex,s.colIndex);return(l==null?void 0:l.data)||Ud(l)})},a7=function(t){var r=Hv(t,"name");return Object.keys(r).map(function(e){var n=r[e],i=zl(n,function(s){return s.selectedData}),a=n.filter(function(s){return Wn(s.value)}),o=ke(a)?null:co(a,"value");return{name:e,selectedData:i,value:o}})},o7=function(t){var r=t.spreadsheet,e=t.targetCell,n=t.options,i=n===void 0?{}:n,a=[],o={},s=r.isTableMode();if(s&&(i!=null&&i.onlyShowCellText)){var l=e==null?void 0:e.getMeta(),u=l!=null&&l.field?r.dataSet.getCellMultiData({query:{field:l.field}}):[r.dataSet.getRowData(l)];return[{selectedData:u,name:"",value:""}]}var h=i7(r,e,i.onlyShowCellText);return tt(h,function(v){var p,m=v==null?void 0:v[it];o[m]?(p=o[m])===null||p===void 0||p.push(v):o[m]=[v]}),Q5(o,function(v,p){var m,C=r.isCustomHeaderFields()?r==null?void 0:r.dataSet.getCustomRowFieldName(e):r7(r,p,i==null?void 0:i.isTotals),w="",b="";if(Bv(v,function(L){return s0(dt(L,sa))})){var E=r.options.placeholder,R=hx(o,E);w=R,b=R}else{var M=v0(r,p),k=Ux(v,sa);b=k,w=(m=M==null?void 0:M(k,v))!==null&&m!==void 0?m:parseFloat(k.toPrecision(Vw))}a.push({selectedData:v,name:C||"",value:w,originValue:b})}),r.isCustomHeaderFields()?a7(a):a},s7=function(t){var r=t.spreadsheet,e=t.cellInfos,n=e===void 0?[]:e,i=t.options,a=i===void 0?{}:i,o=t.targetCell,s=null,l=[],u=null,h=null,v=r.dataSet.getCustomFieldDescription(o),p=n[0]||{};if(!(a!=null&&a.hideSummary))l=o7({spreadsheet:r,options:a,targetCell:o});else if(a.onlyShowCellText){var m=oi.getFieldValue(p,"value"),C=oi.getFieldValue(p,"valueField"),w=v0(r,C),b=w(m),E=a.enableFormat?r.dataSet.getFieldName(m)||b:r.dataSet.getFieldName(C);s=E||""}else u=e7(r,p,a),h=t7(r,p,a,o);var R=p||{},M=R.interpretation,k=R.infos,L=R.tips;return{name:s,summaries:l,interpretation:M,infos:k,tips:L,headInfo:u,details:h,description:v}},l7=function(t){return ct(t,function(r){var e=r.getMeta();return Lk({},e.query||{},LD(e,["colIndex","rowIndex"]))})},p0=function(t){if(!t.interaction.isSelectedState())return[];var r=t.dataCfg.fields.valueInCols;return t.interaction.getCells().reduce(function(e,n){var i=t.facet.getCellMeta(n==null?void 0:n.rowIndex,n==null?void 0:n.colIndex),a=Ud(i);if(ke(i)||ke(a))return[];var o=Y(Y({},a),{colIndex:r?i==null?void 0:i.colIndex:null,rowIndex:r?null:i==null?void 0:i.rowIndex}),s=e.find(function(l){return tn(o,l)});return s||e.push(o),e},[])},u7=function(t,r){t===void 0&&(t={});var e=function(s){return ta(t,s)},n=t.colCell,i=t.rowCell,a=t.dataCell,o=t.cornerCell;return r===Le.COL_CELL?e(n):r===Le.ROW_CELL?e(i):r===Le.DATA_CELL?e(a):r===Le.CORNER_CELL?e(o):Y({},t)},g0=function(t,r){var e;if(!r||!t)return null;var n=t.options,i=t.interaction,a=(e=t.getCellType)===null||e===void 0?void 0:e.call(t,r==null?void 0:r.target),o=i.getInteractedCells()[0];return u7(n.tooltip,a||(o==null?void 0:o.cellType))},jx=function(t,r){var e,n=r.defaultMenus,i=n===void 0?[]:n,a=r.cell,o=function(l){return l===void 0&&(l=[]),l.filter(function(u){var h;return ui(u.visible)?u.visible(a):(h=u.visible)!==null&&h!==void 0?h:!0}).map(function(u){return u.children&&(u.children=o(u.children)),u})},s=o((e=t==null?void 0:t.menu)===null||e===void 0?void 0:e.items);return{menu:Y(Y({},t==null?void 0:t.menu),{items:ai(pe(pe([],te(i),!1),te(s),!1))})}},c7=function(t,r){for(var e=!1,n=r;n&&n!==document.body;){if(t===n){e=!0;break}n=n.parentElement}return e},f7=function(t){t.store.set(dc,Vv)},h7=function(t,r){var e=t.store.get(dc,Vv);t.store.set(dc,Y(Y({},e),r))},d7=function(t,r){var e=t.store.get(dc,Vv);return e[r]},Jx=function(){function t(r){var e=this;this.displayFormattedValueMap=new Map,this.getField=function(n){var i=oa(n)?n:n==null?void 0:n.field;return i||n},this.getFieldMeta=Fl(function(n,i){var a=e.getField(n);return Rr(e.meta||i,{field:a})}),this.getCustomFieldDescription=function(n){var i,a;if(n){var o=(i=n.getMeta)===null||i===void 0?void 0:i.call(n);if(!(o!=null&&o.isTotals)){if(n.cellType===Le.DATA_CELL){var s=Rr(o==null?void 0:o.spreadsheet.dataCfg.meta,{field:(o==null?void 0:o.field)||(o==null?void 0:o.value)||(o==null?void 0:o.valueField)});return e.getFieldDescription(s==null?void 0:s.field)}return((a=o==null?void 0:o.extra)===null||a===void 0?void 0:a.description)||e.getFieldDescription(o==null?void 0:o.field)}}},this.spreadsheet=r}return t.prototype.getFieldName=function(r,e){var n,i,a=this.getField(r),o=(i=(n=this.spreadsheet)===null||n===void 0?void 0:n.facet)===null||i===void 0?void 0:i.getHeaderNodes().find(function(l){var u;return l.field===a&&((u=l==null?void 0:l.extra)===null||u===void 0?void 0:u.isCustomNode)}),s=(o==null?void 0:o.value)||(oa(r)?r:r==null?void 0:r.title)||r;return dt(this.getFieldMeta(a,this.meta),"name",e??s)},t.prototype.getCustomRowFieldName=function(r){var e;if(r){var n=(e=r.getMeta)===null||e===void 0?void 0:e.call(r);if(r.cellType===Le.DATA_CELL){var i=this.spreadsheet.facet.getRowNodeByIndex(n==null?void 0:n.rowIndex);return(i==null?void 0:i.value)||this.getFieldName(i==null?void 0:i.field)}return(n==null?void 0:n.value)||this.getFieldName(n==null?void 0:n.field)}},t.prototype.getFieldFormatter=function(r){var e=this.getField(r);return dt(this.getFieldMeta(e,this.meta),"formatter",Ia)},t.prototype.getFieldDescription=function(r){var e=this.getField(r);return dt(this.getFieldMeta(e,this.meta),"description")},t.prototype.setDataCfg=function(r){var e,n,i;(i=(n=(e=this.getFieldMeta)===null||e===void 0?void 0:e.cache)===null||n===void 0?void 0:n.clear)===null||i===void 0||i.call(n);var a=this.processDataCfg(r),o=a.fields,s=a.meta,l=a.data,u=a.sortParams,h=a.filterParams;this.fields=o,this.meta=s,this.originData=l,this.sortParams=u,this.filterParams=h,this.displayData=this.originData,this.indexesData={}},t.prototype.processMeta=function(r,e){var n,i;r===void 0&&(r=[]);var a=pe(pe([],te(r),!1),[O8(r,(i=(n=this.spreadsheet)===null||n===void 0?void 0:n.options)===null||i===void 0?void 0:i.cornerExtraFieldText,e)],!1);return a},t.prototype.getDisplayDataSet=function(){return this.displayData||[]},t.prototype.isEmpty=function(){return ke(this.getDisplayDataSet())},t.prototype.getEmptyViewIndexes=function(){return[]},t.prototype.getValueRangeByField=function(r){var e,n=d7(this.spreadsheet,r);if(n)return n;var i=ai(ct(this.originData,function(o){var s=o[r];return nr(s)?null:Number.parseFloat(s)})),a={maxValue:uo(i),minValue:Sw(i)};return h7(this.spreadsheet,(e={},e[r]=a,e)),a},t.prototype.moreThanOneValue=function(){var r,e;return((e=(r=this.fields)===null||r===void 0?void 0:r.values)===null||e===void 0?void 0:e.length)>1},t}(),Xd=function(t){Me(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.handleDimensionValuesSort=function(){tt(e.sortParams,function(n){var i=n.sortFieldId,a=n.sortByMeasure;if(i){var o=pe([],te(e.sortedDimensionValues[i]||[]),!1),s=I9({dataSet:e,sortParam:n,originValues:o,isSortByMeasure:!ke(a)});e.sortedDimensionValues[i]=s,e.handlePivotMetaSort(i,s)}})},e.getTotalStatus=function(n){var i=e.fields,a=i.columns,o=i.rows,s=function(l,u){if(u){var h=Rr(l,function(v){return!o1(n,v)});return!!(h&&h!==Kc(l))}return Bv(l,function(v){return!o1(n,v)})};return{isRowTotal:s(xc(o)),isRowSubTotal:s(o,!0),isColTotal:s(xc(a)),isColSubTotal:s(a,!0)}},e}return r.prototype.getExistValuesByDataItem=function(e,n){return Ox(e,n)},r.prototype.setDataCfg=function(e){t.prototype.setDataCfg.call(this,e);var n=this.fields.rows;this.sortedDimensionValues={},this.rowPivotMeta=new Map,this.colPivotMeta=new Map,this.transformIndexesData(this.originData,n),this.handleDimensionValuesSort()},r.prototype.transformIndexesData=function(e,n){var i=this,a=this.fields,o=a.columns,s=a.values,l=a.valueInCols,u;return Li.getInstance().debugCallback(M6,function(){u=M8({rows:n,columns:o,values:s,valueInCols:l,data:e,indexesData:i.indexesData,sortedDimensionValues:i.sortedDimensionValues,rowPivotMeta:i.rowPivotMeta,colPivotMeta:i.colPivotMeta,getExistValuesByDataItem:i.getExistValuesByDataItem}),i.indexesData=u.indexesData,i.rowPivotMeta=u.rowPivotMeta,i.colPivotMeta=u.colPivotMeta,i.sortedDimensionValues=u.sortedDimensionValues}),u},r.prototype.transformDrillDownData=function(e,n,i){var a=this,o,s=pr.getFieldPath(i,!0),l=pe(pe([],te(s),!1),[e],!1),u=this.spreadsheet.store,h=i==null?void 0:i.id,v=(o=u.get("drillDownIdPathMap"))!==null&&o!==void 0?o:new Map;v.has(h)&&(tt(v.get(h),function(m){c1(a.indexesData,m)}),k1(this.rowPivotMeta,h));var p=this.transformIndexesData(n,l).paths;v.set(h,p),u.set("drillDownIdPathMap",v)},r.prototype.clearDrillDownData=function(e){var n=this,i=this.spreadsheet.store,a=i.get("drillDownIdPathMap");if(!a)return!1;var o=i.get("drillDownDataCache",[]);if(e){var s=a.get(e);s&&tt(s,function(m){c1(n.indexesData,m)}),k1(this.rowPivotMeta,e),a.delete(e);var l=ci(o,function(m){return a.has(m==null?void 0:m.rowId)});i.set("drillDownDataCache",l);var u=l.map(function(m){return m==null?void 0:m.drillLevel}),h=i.get("drillDownFieldInLevel",[]),v=h.filter(function(m){return hn(u,m==null?void 0:m.drillLevel)});i.set("drillDownFieldInLevel",v)}else{a.clear();var p=this.spreadsheet.store.get("originalDataCfg");ke(p)||this.spreadsheet.setDataCfg(p),this.spreadsheet.store.set("drillItemsNum",-1),this.spreadsheet.store.set("drillDownDataCache",[]),this.spreadsheet.store.set("drillDownFieldInLevel",[])}return i.set("drillDownIdPathMap",a),!0},r.prototype.handlePivotMetaSort=function(e,n){var i=this.fields,a=i.rows,o=i.columns;hn(a,e)?this.rowPivotMeta=W1({pivotMeta:this.rowPivotMeta,dimensions:a,sortFieldId:e,sortedDimensionValues:n}):hn(o,e)&&(this.colPivotMeta=W1({pivotMeta:this.colPivotMeta,dimensions:o,sortFieldId:e,sortedDimensionValues:n}))},r.prototype.processDataCfg=function(e){var n=e.data,i=e.meta,a=i===void 0?[]:i,o=e.fields,s=e.sortParams,l=s===void 0?[]:s,u=o.columns,h=u===void 0?[]:u,v=o.rows,p=v===void 0?[]:v,m=o.values,C=o.valueInCols,w=o.customValueOrder,b=h,E=p;C?b=this.isCustomMeasuresPosition(w)?this.handleCustomMeasuresOrder(w,b):wa(pe(pe([],te(h),!1),[it],!1)):E=this.isCustomMeasuresPosition(w)?this.handleCustomMeasuresOrder(w,E):wa(pe(pe([],te(p),!1),[it],!1));var R=this.processMeta(a,gr(""));return{data:n,meta:R,fields:Y(Y({},o),{rows:E,columns:b,values:m}),sortParams:l}},r.prototype.getFieldsAndPivotMetaByField=function(e){var n=this.fields||{},i=n.rows,a=i===void 0?[]:i,o=n.columns,s=o===void 0?[]:o;return a.includes(e)?{dimensions:a,pivotMeta:this.rowPivotMeta}:s.includes(e)?{dimensions:s,pivotMeta:this.colPivotMeta}:{}},r.prototype.getDimensionValues=function(e,n){n===void 0&&(n={});var i=this.getFieldsAndPivotMetaByField(e),a=i.pivotMeta,o=i.dimensions;if(!a||!o)return[];var s=qa(n,o,Xu),l=Ax({pivotMeta:a,dimensionValues:s,fields:o,fieldIdx:Zc(o,e),queryType:ki.DetailOnly,sortedDimensionValues:this.sortedDimensionValues});return wa(l.map(function(u){return u.value}))},r.prototype.getTotalValue=function(e,n){var i,a,o=xd(n),s=o?n:this.getTotalStatus(e),l=uF(s,(a=this.spreadsheet.options)===null||a===void 0?void 0:a.totals)||{},u=l.aggregation,h=l.calcFunc,v=L9[u];if(v||h){var p=this.getCellMultiData({query:e,queryType:ki.DetailOnly}),m=null;return h?m=h(e,p):v&&(m=v(p,sa)),oi.getCellData(Y(Y({},Tw(e,[it])),(i={},i[e[it]]=m,i)),e[it])}},r.prototype.getCellData=function(e){var n,i,a,o=e||{},s=o.query,l=s===void 0?{}:s,u=o.rowNode,h=o.isTotals,v=h===void 0?!1:h,p=o.totalStatus,m=this.fields,C=m.rows,w=m.columns,b=C,E=(n=this.spreadsheet)===null||n===void 0?void 0:n.store.get("drillDownIdPathMap"),R=Array.from((i=E==null?void 0:E.keys())!==null&&i!==void 0?i:[]).some(function(I){return u==null?void 0:u.id.startsWith(I)});u&&R&&(b=(a=pr.getFieldPath(u,R))!==null&&a!==void 0?a:C);var M=qa(l,b),k=qa(l,w),L=Sc({rowDimensionValues:M,colDimensionValues:k,rowPivotMeta:this.rowPivotMeta,colPivotMeta:this.colPivotMeta,rowFields:b,colFields:w,prefix:bc(b,w)}),_=dt(this.indexesData,L);if(_)return oi.getCellData(_,l[it]);if(v)return this.getTotalValue(l,p)},r.prototype.getQueryExtraFields=function(e){var n=this.fields.values,i=n===void 0?[]:n,a=e[it];return a?hn(i,a)?[a]:[]:i},r.prototype.getCellMultiData=function(e){var n,i,a,o,s=e||{},l=s.query,u=l===void 0?{}:l,h=s.queryType,v=h===void 0?ki.All:h,p=s.drillDownFields,m=p===void 0?[]:p;ke(u)&&console.warn("query: ".concat(u,` shouldn't be empty, you can get all data from dataCfg if you're intended.
 you should use { EXTRA_FIELD: xxx} as least if you want query all specific value data`));var C=this.fields,w=C.rows,b=C.columns,E=ke(m)?w:w.concat(m),R=qa(u,E,Xu),M=qa(u,b,Xu),k=N8({rowDimensionValues:R,colDimensionValues:M,rowPivotMeta:this.rowPivotMeta,colPivotMeta:this.colPivotMeta,rowFields:E,colFields:b,sortedDimensionValues:this.sortedDimensionValues,queryType:v}),L=k.rowQueries,_=k.colQueries,I=bc(E,b),P=[];try{for(var U=Wr(L),q=U.next();!q.done;q=U.next()){var Q=q.value;try{for(var J=(a=void 0,Wr(_)),re=J.next();!re.done;re=J.next()){for(var ne=re.value,ce=Sc({rowDimensionValues:Q,colDimensionValues:ne,rowPivotMeta:this.rowPivotMeta,colPivotMeta:this.colPivotMeta,rowFields:E,colFields:b,prefix:I}),me=!1,oe=this.indexesData,Se=function(Be){var rt=ce[Be];me?Rl(rt)?oe=k8(oe,v):oe=ai(ct(oe,function(ut){return ut==null?void 0:ut[rt]})):Rl(rt)?(me=!0,oe=ai([oe]),Be--):oe=oe==null?void 0:oe[rt],Te=Be},Te,Ie=0;Ie<ce.length;Ie++)Se(Ie),Ie=Te;vt(oe)?P.push.apply(P,pe([],te(oe),!1)):oe&&P.push(oe)}}catch(Be){a={error:Be}}finally{try{re&&!re.done&&(o=J.return)&&o.call(J)}finally{if(a)throw a.error}}}}catch(Be){n={error:Be}}finally{try{q&&!q.done&&(i=U.return)&&i.call(U)}finally{if(n)throw n.error}}var je=this.getQueryExtraFields(u);return zl(wa(P),function(Be){return Be?oi.getCellDataList(Be,je):[]})},r.prototype.getFieldFormatter=function(e,n){return e===la?this.getFieldFormatterForTotalValue(n):t.prototype.getFieldFormatter.call(this,e)},r.prototype.getFieldFormatterForTotalValue=function(e){var n="";return!this.spreadsheet.isValueInCols()&&e&&(n=dt(e.rowQuery,it)),n=n??dt(this.fields.values,0),t.prototype.getFieldFormatter.call(this,n)},r.prototype.handleCustomMeasuresOrder=function(e,n){var i=wa(pe([],te(n),!1));return n.length>=e?(i.splice(e,0,it),i):pe(pe([],te(i),!1),[it],!1)},r.prototype.isCustomMeasuresPosition=function(e){return Wn(e)},r.prototype.getRowData=function(e){return this.getCellMultiData({query:e.rowQuery})},r}(Jx),v7=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.getCellData=function(e){var n=(e||{}).query,i=n===void 0?{}:n,a=this.fields,o=a.columns,s=a.rows,l=qa(i,s),u=qa(i,o),h=Sc({rowDimensionValues:l,colDimensionValues:u,rowPivotMeta:this.rowPivotMeta,colPivotMeta:this.colPivotMeta,rowFields:s,colFields:o,prefix:bc(s,o)}),v=dt(this.indexesData,h);if(v)return oi.getCellData(v,i[it])},r.prototype.processDataCfg=function(e){var n=t.prototype.processDataCfg.call(this,e),i=this.processMeta(e.meta,gr(""));return Y(Y({},n),{meta:i,fields:Y(Y({},n.fields),{rows:[it],valueInCols:!1})})},r}(Xd),p7=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.processDataCfg=function(e){var n=!this.spreadsheet.isCustomRowFields(),i=n?[it]:pe(pe([],te(e.fields.rows||[]),!1),[it],!1),a=this.processMeta(e.meta,gr(""));return Y(Y({},e),{meta:a,fields:Y(Y({},e.fields),{rows:i,valueInCols:n})})},r}(v7),g7=function(t){Me(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.handleDimensionValueFilter=function(){tt(e.filterParams,function(n){var i=n.filterKey,a=n.filteredValues,o=n.customFilter,s=new Set(a),l=function(h){return!s.has(h[i])},u=ci(e.displayData,function(h){return o?o(h)&&l(h):l(h)});e.displayData=e.getDisplayData(u)})},e.handleDimensionValuesSort=function(){tt(e.sortParams,function(n){var i=n.sortFieldId,a=n.sortBy,o=n.sortFunc,s=n.sortMethod,l=n.query;if(i){var u=e.displayData,h=[];if(l){var v=[];u.forEach(function(w){for(var b=Object.keys(l),E=!0,R=0;R<b.length;R++){var M=b[R];if(w[M]!==l[M]){E=!1,h.push(w);break}}E&&v.push(w)}),u=v}var p=u;if(o)p=o(Y(Y({},n),{data:u}));else if(a&&!ui(a)){var m=pe([],te(a),!1).reverse();p=u.sort(function(w,b){var E=m.indexOf(w[i]),R=m.indexOf(b[i]);return R-E})}else if(ws(s)||u0(s)){var C=ui(a)?a:null;p=uD(u,[C||i],[s==null?void 0:s.toLocaleLowerCase()])}h.length&&(p=pe(pe([],te(p),!1),te(h),!1)),e.displayData=e.getDisplayData(p)}})},e}return r.prototype.processDataCfg=function(e){return e},r.prototype.setDataCfg=function(e){t.prototype.setDataCfg.call(this,e),this.handleDimensionValueFilter(),this.handleDimensionValuesSort()},r.prototype.getStartFrozenRows=function(e){var n=(this.spreadsheet.options.frozen||{}).rowCount;return n?e.slice(0,n):[]},r.prototype.getEndFrozenRows=function(e){var n=(this.spreadsheet.options.frozen||{}).trailingRowCount;return n?e.slice(-n):[]},r.prototype.getDisplayData=function(e){var n=this.getStartFrozenRows(e),i=this.getEndFrozenRows(e),a=e.slice(n.length||0,-i.length||void 0);return pe(pe(pe([],te(n),!1),te(a),!1),te(i),!1)},r.prototype.getDimensionValues=function(){return[]},r.prototype.getCellData=function(e){var n=e===void 0?{}:e,i=n.query,a=i===void 0?{}:i;if(!(this.displayData.length===0&&a.rowIndex===0)){var o=this.displayData[a.rowIndex];return!os(a,"field")||!Lr(o)?o:o[a.field]}},r.prototype.getCellMultiData=function(e){var n=e===void 0?{}:e,i=n.query,a=i===void 0?{}:i;if(!a)return this.displayData;var o=this.displayData[a.rowIndex]?[this.displayData[a.rowIndex]]:this.displayData;return os(a,"field")?o.map(function(s){return s[a.field]}):o},r.prototype.getRowData=function(e){return this.getCellData({query:{rowIndex:e.rowIndex}})},r}(Jx);function m0(t){return function(){return t}}function m7(t,r){return function(e){return t+e*r}}function y7(t,r,e){return t=Math.pow(t,e),r=Math.pow(r,e)-t,e=1/e,function(n){return Math.pow(t+n*r,e)}}function C7(t){return(t=+t)==1?Qx:function(r,e){return e-r?y7(r,e,t):m0(isNaN(r)?e:r)}}function Qx(t,r){var e=r-t;return e?m7(t,e):m0(isNaN(t)?r:t)}var $1=function t(r){var e=C7(r);function n(i,a){var o=e((i=Uh(i)).r,(a=Uh(a)).r),s=e(i.g,a.g),l=e(i.b,a.b),u=Qx(i.opacity,a.opacity);return function(h){return i.r=o(h),i.g=s(h),i.b=l(h),i.opacity=u(h),i+""}}return n.gamma=t,n}(1);function eb(t,r){r||(r=[]);var e=t?Math.min(r.length,t.length):0,n=r.slice(),i;return function(a){for(i=0;i<e;++i)n[i]=t[i]*(1-a)+r[i]*a;return n}}function tb(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function w7(t,r){return(tb(r)?eb:rb)(t,r)}function rb(t,r){var e=r?r.length:0,n=t?Math.min(e,t.length):0,i=new Array(n),a=new Array(e),o;for(o=0;o<n;++o)i[o]=nb(t[o],r[o]);for(;o<e;++o)a[o]=r[o];return function(s){for(o=0;o<n;++o)a[o]=i[o](s);return a}}function x7(t,r){var e=new Date;return t=+t,r=+r,function(n){return e.setTime(t*(1-n)+r*n),e}}function Yd(t,r){return t=+t,r=+r,function(e){return t*(1-e)+r*e}}function b7(t,r){var e={},n={},i;(t===null||typeof t!="object")&&(t={}),(r===null||typeof r!="object")&&(r={});for(i in r)i in t?e[i]=nb(t[i],r[i]):n[i]=r[i];return function(a){for(i in e)n[i]=e[i](a);return n}}var $d=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,kh=new RegExp($d.source,"g");function S7(t){return function(){return t}}function E7(t){return function(r){return t(r)+""}}function T7(t,r){var e=$d.lastIndex=kh.lastIndex=0,n,i,a,o=-1,s=[],l=[];for(t=t+"",r=r+"";(n=$d.exec(t))&&(i=kh.exec(r));)(a=i.index)>e&&(a=r.slice(e,a),s[o]?s[o]+=a:s[++o]=a),(n=n[0])===(i=i[0])?s[o]?s[o]+=i:s[++o]=i:(s[++o]=null,l.push({i:o,x:Yd(n,i)})),e=kh.lastIndex;return e<r.length&&(a=r.slice(e),s[o]?s[o]+=a:s[++o]=a),s.length<2?l[0]?E7(l[0].x):S7(r):(r=l.length,function(u){for(var h=0,v;h<r;++h)s[(v=l[h]).i]=v.x(u);return s.join("")})}function nb(t,r){var e=typeof r,n;return r==null||e==="boolean"?m0(r):(e==="number"?Yd:e==="string"?(n=es(r))?(r=n,$1):T7:r instanceof es?$1:r instanceof Date?x7:tb(r)?eb:Array.isArray(r)?rb:typeof r.valueOf!="function"&&typeof r.toString!="function"||isNaN(r)?b7:Yd)(t,r)}var ds=0,tl=0,Ks=0,ib=1e3,Oc,rl,Ac=0,fo=0,uf=0,Ml=typeof performance=="object"&&performance.now?performance:Date,ab=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function ob(){return fo||(ab(_7),fo=Ml.now()+uf)}function _7(){fo=0}function qd(){this._call=this._time=this._next=null}qd.prototype=sb.prototype={constructor:qd,restart:function(t,r,e){if(typeof t!="function")throw new TypeError("callback is not a function");e=(e==null?ob():+e)+(r==null?0:+r),!this._next&&rl!==this&&(rl?rl._next=this:Oc=this,rl=this),this._call=t,this._time=e,Kd()},stop:function(){this._call&&(this._call=null,this._time=1/0,Kd())}};function sb(t,r,e){var n=new qd;return n.restart(t,r,e),n}function R7(){ob(),++ds;for(var t=Oc,r;t;)(r=fo-t._time)>=0&&t._call.call(null,r),t=t._next;--ds}function q1(){fo=(Ac=Ml.now())+uf,ds=tl=0;try{R7()}finally{ds=0,M7(),fo=0}}function L7(){var t=Ml.now(),r=t-Ac;r>ib&&(uf-=r,Ac=t)}function M7(){for(var t,r=Oc,e,n=1/0;r;)r._call?(n>r._time&&(n=r._time),t=r,r=r._next):(e=r._next,r._next=null,r=t?t._next=e:Oc=e);rl=t,Kd(n)}function Kd(t){if(!ds){tl&&(tl=clearTimeout(tl));var r=t-fo;r>24?(t<1/0&&(tl=setTimeout(q1,t-Ml.now()-uf)),Ks&&(Ks=clearInterval(Ks))):(Ks||(Ac=Ml.now(),Ks=setInterval(L7,ib)),ds=1,ab(q1))}}var lb=function(t){Me(r,t);function r(e){var n=this,i=e.name,a=e.s2,o=nn(e,["name","s2"]);return n=t.call(this,{name:i,style:o})||this,n.gridInfo={cols:[],rows:[]},n.updateGrid=function(s,l){var u,h;l===void 0&&(l=xB),!n.gridGroup||!n.getElementById(l)?n.gridGroup=n.appendChild(new Ft({id:l,style:{zIndex:aB}})):n.gridGroup.removeChildren();var v=(u=mr(s.cols))!==null&&u!==void 0?u:0,p=(h=mr(s.rows))!==null&&h!==void 0?h:0,m=n.s2.theme,C=m.dataCell.cell,w=C==null?void 0:C.verticalBorderWidth;n.gridInfo=s;var b=w/2;n.gridInfo.cols.forEach(function(M){_r(n.gridGroup,{x1:M-b,x2:M-b,y1:0,y2:p,stroke:C.verticalBorderColor,strokeOpacity:C.verticalBorderColorOpacity,lineWidth:w})});var E=C==null?void 0:C.horizontalBorderWidth,R=E/2;n.gridInfo.rows.forEach(function(M){_r(n.gridGroup,{x1:0,x2:v,y1:M-R,y2:M-R,stroke:C.horizontalBorderColor,strokeOpacity:C.horizontalBorderColorOpacity,lineWidth:E})})},n.s2=a,n}return r}(Ft),O7=function(t){Me(r,t);function r(e){var n=t.call(this,e)||this;return n.initMergedCellsGroup(),n}return r.prototype.getMergedCellsGroup=function(){return this.mergedCellsGroup},r.prototype.initMergedCellsGroup=function(){this.mergedCellsGroup&&this.getElementById(f1)||(this.mergedCellsGroup=this.appendChild(new Ft({id:f1,style:{zIndex:oB}})))},r.prototype.updateMergedCells=function(){this.initMergedCellsGroup(),w8(this.s2,this.mergedCellsGroup)},r.prototype.addMergeCell=function(e){var n;(n=this.mergedCellsGroup)===null||n===void 0||n.appendChild(e),this.s2.emit(se.MERGED_CELLS_RENDER,e),this.s2.emit(se.LAYOUT_CELL_RENDER,e)},r.prototype.update=function(e){this.updateGrid(e),this.updateMergedCells()},r}(lb),eo;(function(t){t.ScrollChange="scroll-change",t.ScrollEnd="scroll-end"})(eo||(eo={}));var Ih=function(t){Me(r,t);function r(e){var n=t.call(this)||this;n.eventHandlers=[],n.scrollFrameId=null,n.getCoordinatesName=function(){var m=n.isHorizontal?"x1":"y1",C=n.isHorizontal?"x2":"y2";return{from:m,to:C}},n.getCoordinatesWithBBoxExtraPadding=function(){var m=n.theme,C=m.lineCap,w=C===void 0?"butt":C,b=m.size,E=b===void 0?0:b;if(w==="butt")return{start:n.thumbOffset,end:n.thumbOffset+n.thumbLen};var R=n.isHorizontal?0:E/2,M=n.isHorizontal?E:E/2;return{start:n.thumbOffset+R,end:n.thumbOffset+n.thumbLen-M}},n.current=function(){var m=n.thumbLen/n.trackLen,C=n.thumbOffset/n.trackLen;return C/(1-m)},n.updateThumbLen=function(m){if(n.thumbLen!==m){n.thumbLen=m;var C=n.getCoordinatesName();n.thumbShape.attr(C.to,n.thumbOffset+m),n.emitScrollChange(n.thumbOffset/(n.trackLen-n.thumbLen)*n.scrollTargetMaxOffset,!1)}},n.updateThumbOffset=function(m,C){var w;C===void 0&&(C=!0);var b=n.validateRange(m),E=n.thumbOffset===b&&b!==0;if(!E){n.thumbOffset=b;var R=n.getCoordinatesName(),M=R.from,k=R.to,L=n.getCoordinatesWithBBoxExtraPadding(),_=L.start,I=L.end;n.thumbShape.attr((w={},w[M]=_,w[k]=I,w)),C&&n.emitScrollChange(b/(n.trackLen-n.thumbLen)*n.scrollTargetMaxOffset,!1)}},n.onlyUpdateThumbOffset=function(m){n.updateThumbOffset(m,!1)},n.emitScrollChange=function(m,C){C===void 0&&(C=!0),cancelAnimationFrame(n.scrollFrameId),n.scrollFrameId=requestAnimationFrame(function(){n.dispatchEvent(new Sr(eo.ScrollChange,{offset:m,updateThumbOffset:C}))})},n.bindEventListener=function(m,C,w){return m==null||m.addEventListener(C,w,!1),{remove:function(){m==null||m.removeEventListener(C,w,!1)}}},n.addEvent=function(m,C,w){m.addEventListener(C,w),n.eventHandlers.push({target:m,type:C,handler:w})},n.initScrollBar=function(){n.scrollBarGroup=n.createScrollBarGroup(),n.scrollBarGroup.setPosition(n.position.x,n.position.y),n.bindEvents()},n.createScrollBarGroup=function(){var m=n.appendChild(new Ft({className:n.isHorizontal?"horizontalBar":"verticalBar"}));return n.trackShape=n.createTrackShape(m),n.thumbShape=n.createThumbShape(m),m},n.createTrackShape=function(m){var C=n.theme,w=C.lineCap,b=w===void 0?"round":w,E=C.trackColor,R=C.size,M=R===void 0?0:R,k={lineWidth:M,stroke:E,lineCap:b};return n.isHorizontal?m.appendChild(new zo({style:Y(Y({},k),{x1:0,y1:M/2,x2:n.trackLen,y2:M/2})})):m.appendChild(new zo({style:Y(Y({},k),{x1:M/2,y1:0,x2:M/2,y2:n.trackLen})}))},n.createThumbShape=function(m){var C=n.theme,w=C.size,b=w===void 0?0:w,E=C.lineCap,R=E===void 0?"round":E,M=C.thumbColor,k={lineWidth:b,stroke:M,lineCap:R,cursor:"default"},L=n.getCoordinatesWithBBoxExtraPadding(),_=L.start,I=L.end;return n.isHorizontal?m.appendChild(new zo({style:Y(Y({},k),{x1:_,y1:b/2,x2:I,y2:b/2})})):m.appendChild(new zo({style:Y(Y({},k),{x1:b/2,y1:_,x2:b/2,y2:I})}))},n.bindEvents=function(){n.addEventListener(wt.POINTER_DOWN,n.onStartEvent),n.addEventListener(wt.POINTER_UP,n.onPointerUp),n.trackShape.addEventListener("click",n.onTrackClick),n.thumbShape.addEventListener(wt.POINTER_OVER,n.onTrackPointerOver),n.thumbShape.addEventListener(wt.POINTER_OUT,n.onTrackPointerOut)},n.onStartEvent=function(m){m.preventDefault();var C=m.clientX,w=m.clientY;n.startPos=n.isHorizontal?C:w,n.bindLaterEvent()},n.bindLaterEvent=function(){var m=n.ownerDocument.defaultView,C=document.body,w=[n.bindEventListener(C,wt.POINTER_MOVE,n.onPointerMove),n.bindEventListener(C,wt.POINTER_UP,n.onPointerUp),n.bindEventListener(C,wt.POINTER_LEAVE,n.onPointerUp)];n.addEvent(m,wt.POINTER_UP,n.onPointerUp),n.clearEvents=function(){w.forEach(function(b){b==null||b.remove()}),tt(n.eventHandlers,function(b){var E;(E=b.target)===null||E===void 0||E.removeEventListener(b.type,b.handler)}),n.eventHandlers.length=0}},n.onTrackClick=function(m){var C=n.isHorizontal?m.x-n.position.x-n.thumbLen/2:m.y-n.position.y-n.thumbLen/2,w=n.validateRange(C);n.updateThumbOffset(w)},n.onPointerMove=function(m){m.preventDefault();var C=m.clientX,w=m.clientY,b=n.isHorizontal?C:w,E=b-n.startPos;n.startPos=b,n.updateThumbOffset(n.thumbOffset+E)},n.onPointerUp=function(m){var C;n.dispatchEvent(new Sr(eo.ScrollEnd,{})),m.preventDefault(),(C=n.clearEvents)===null||C===void 0||C.call(n)},n.onTrackPointerOver=function(){var m=n.theme,C=m.thumbHoverColor,w=m.hoverSize;n.thumbShape.attr("stroke",C),n.thumbShape.attr("lineWidth",w)},n.onTrackPointerOut=function(){var m=n.theme,C=m.thumbColor,w=m.size;n.thumbShape.attr("stroke",C),n.thumbShape.attr("lineWidth",w)},n.validateRange=function(m){var C=m;return m+n.thumbLen>n.trackLen?C=n.trackLen-n.thumbLen:m+n.thumbLen<n.thumbLen&&(C=0),C};var i=e.isHorizontal,a=i===void 0?!1:i,o=e.trackLen,s=e.thumbLen,l=e.position,u=e.thumbOffset,h=u===void 0?0:u,v=e.theme,p=e.scrollTargetMaxOffset;return n.isHorizontal=a,n.thumbOffset=h,n.trackLen=o,n.thumbLen=s,n.position=l,n.theme=v,n.scrollTargetMaxOffset=p,n.initScrollBar(),n}return r}(Ft),ub=function(t,r,e){if(e<=0)return{start:0,end:0};var n=Cl(t,function(a,o){var s=r;return s>=a&&s<t[o+1]},0);n=Math.max(n,0);var i=e===r?n:Cl(t,function(a,o){var s=e;return s>a&&s<=t[o+1]},n);return i=Math.min(i===-1?1/0:i,t.length-2),{start:n,end:i}},A7=function(t,r){var e=r.width,n=r.originalWidth,i=Math.min(n-e,t);return i<0?0:i},K1=function(t,r,e){var n=Math.min(r-e,t);return n<0?0:n},nl=function(t,r){if(t===void 0&&(t=[]),ke(t))return[];var e=[];return t.forEach(function(n){if(n instanceof r&&e.push(n),n instanceof Ft){var i=n.children;i.forEach(function(a){a instanceof r&&e.push(a)})}}),e},cb=function(t,r,e){return e.slice(t,r+1).map(function(n){return n.x+n.width})},cf=function(t,r,e){for(var n=[],i=t;i<r+1;i++)n.push(e.getCellOffsetY(i+1));return n},N7=function(t,r,e,n){var i=cf(t,r,n),a=n.getCellOffsetY(t);return i.map(function(o){return o-a+e})},Z1=function(t,r,e){var n=te(e,4),i=n[0],a=n[1],o=n[2],s=n[3];return t>=i&&t<=a&&r>=o&&r<=s},j1=function(t){for(var r=te(t,4),e=r[0],n=r[1],i=r[2],a=r[3],o=[],s=e;s<=n;s+=1)for(var l=i;l<=a;l+=1)o.push([s,l]);return o},k7=function(t,r){var e=[],n=[];if(ke(t))return ke(r)?{add:e,remove:n}:{add:j1(r),remove:n};if(ke(r))return{add:e,remove:j1(t)};for(var i=te(t,4),a=i[0],o=i[1],s=i[2],l=i[3],u=te(r,4),h=u[0],v=u[1],p=u[2],m=u[3],C=a;C<=o;C++)for(var w=s;w<=l;w++)Z1(C,w,r)||n.push([C,w]);for(var C=h;C<=v;C+=1)for(var w=p;w<=m;w+=1)Z1(C,w,t)||e.push([C,w]);return{add:e,remove:n}},I7=function(t,r){var e=[],n=[];return Object.keys(r).forEach(function(i){var a=k7((t==null?void 0:t[i])||[],r[i]),o=a.add,s=a.remove;e.push.apply(e,pe([],te(o),!1)),n.push.apply(n,pe([],te(s),!1))}),{add:e,remove:n}},fb=function(){function t(r,e){e===void 0&&(e=!1),this.x=0,this.y=0,this.minX=0,this.minY=0,this.maxX=0,this.maxY=0,this.width=0,this.height=0,this.originalWidth=0,this.originalHeight=0,this.viewportHeight=0,this.viewportWidth=0,this.facet=r,this.spreadsheet=r.spreadsheet,this.layoutResult=r.getLayoutResult(),e&&this.calculateBBox()}return t}(),hb=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.calculateBBox=function(){var e=this.getCornerBBoxWidth(),n=this.getCornerBBoxHeight();this.width=e,this.height=n,this.maxX=e,this.maxY=n},r.prototype.getCornerBBoxOriginalHeight=function(){var e=this.layoutResult.colsHierarchy,n=this.spreadsheet.options.style.colCell;return e.sampleNodeForLastLevel?xt(e.height):n==null?void 0:n.height},r.prototype.getCornerBBoxHeight=function(){return this.originalHeight=this.getCornerBBoxOriginalHeight(),this.originalHeight},r.prototype.getCornerBBoxWidth=function(){var e=this.layoutResult.rowsHierarchy;return this.originalWidth=xt(e.width+this.facet.getSeriesNumberWidth()),this.spreadsheet.isFrozenRowHeader()?this.adjustCornerBBoxWidth():this.originalWidth},r.prototype.adjustCornerBBoxWidth=function(){var e=this.layoutResult.colsHierarchy,n=this.spreadsheet.options,i=n.width,a=n.frozen,o=a==null?void 0:a.rowHeader,s=na(o)?EB:lc(o,0,1),l=i*s,u=e==null?void 0:e.width,h=i-this.originalWidth;if(this.originalWidth<=l||u<=h)return this.originalWidth;var v=0,p=i-l;return u<=p?v=this.originalWidth-(u-h):v=l,xt(v)},r}(fb),P7=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.calculateBBox=function(){this.originalWidth=this.facet.getRealWidth(),this.originalHeight=this.facet.getRealHeight();var e=this.facet.cornerBBox,n={x:xt(e.maxX),y:xt(e.maxY)};this.x=n.x+Un.getVerticalBorderWidth(this.spreadsheet),this.y=n.y+Un.getHorizontalBorderWidth(this.spreadsheet),this.minX=this.x,this.minY=this.y;var i=this.spreadsheet.theme.scrollBar.size,a=this.spreadsheet.options,o=a.width,s=a.height,l=Math.max(0,o-this.x),u=Math.max(0,s-this.y-i);if(this.width=l,this.height=u,this.viewportHeight=Math.abs(xt(Math.min(u,this.originalHeight))),this.viewportWidth=Math.abs(xt(Math.min(l,this.originalWidth))),this.maxX=this.x+this.viewportWidth,this.maxY=this.y+this.viewportHeight,!!this.spreadsheet.enableFrozenHeaders()){var h=this.spreadsheet.options.frozen,v=h.trailingColCount,p=v===void 0?0:v,m=h.trailingRowCount,C=m===void 0?0:m;p>0&&(this.viewportWidth=this.width,this.maxX=this.x+this.width),C>0&&(this.viewportHeight=this.height,this.maxY=this.y+this.height)}},r}(fb),D7="*",db=function(){function t(){this._events={}}return t.prototype.on=function(r,e,n){return this._events[r]||(this._events[r]=[]),this._events[r].push({callback:e,once:!!n}),this},t.prototype.once=function(r,e){return this.on(r,e,!0)},t.prototype.emit=function(r){for(var e=this,n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var a=this._events[r]||[],o=this._events[D7]||[],s=function(l){for(var u=l.length,h=0;h<u;h++)if(l[h]){var v=l[h],p=v.callback,m=v.once;m&&(l.splice(h,1),l.length===0&&delete e._events[r],u--,h--),p.apply(e,n)}};s(a),s(o)},t.prototype.off=function(r,e){if(!r)this._events={};else if(!e)delete this._events[r];else{for(var n=this._events[r]||[],i=n.length,a=0;a<i;a++)n[a].callback===e&&(n.splice(a,1),i--,a--);n.length===0&&delete this._events[r]}return this},t.prototype.getEvents=function(){return this._events},t}();function B7(t){return t*t*t}var Zs=function(){var t;return(t=performance==null?void 0:performance.now())!==null&&t!==void 0?t:Date.now()},F7=800,H7=100,z7=function(t){Me(r,t);function r(e){var n=t.call(this)||this;return n.bindPointerDown=function(i){window.cancelAnimationFrame(n.raf),n.panning=!0,n.preX=i.x,n.preY=i.y,n.speedX=0,n.speedY=0,n.lastMoveMS=Zs()},n.bindPointerMove=function(i){if(n.panning){var a=Zs(),o=a-n.lastMoveMS,s=n.preX-i.x,l=n.preY-i.y;n.speedX=s/o,n.speedY=l/o,n.preX=i.x,n.preY=i.y,n.lastMoveMS=a,n.emit("wheel",Y(Y({},i.clone()),{x:i.x,y:i.y,deltaX:s,deltaY:l}))}},n.bindPointerUp=function(i){n.panning=!1;var a=Zs();if(!(!n.speedX||!n.speedY||a-n.lastMoveMS>=H7)){var o=function(){var s=Zs();n.raf=window.requestAnimationFrame(function(){var l=Zs(),u=(l-a)/F7;if(u<1){var h=B7(1-u),v=l-s;n.emit("wheel",Y(Y({},i.clone()),{x:i.x,y:i.y,deltaX:n.speedX*h*v,deltaY:n.speedY*h*v})),o()}})};o()}},n.canvas=e,n.panning=!1,n.init(),n}return r.prototype.init=function(){this.canvas.addEventListener(wt.POINTER_DOWN,this.bindPointerDown),this.canvas.addEventListener(wt.POINTER_MOVE,this.bindPointerMove),this.canvas.addEventListener(wt.POINTER_UP,this.bindPointerUp)},r.prototype.destroy=function(){this.canvas.removeEventListener(wt.POINTER_DOWN,this.bindPointerDown),this.canvas.removeEventListener(wt.POINTER_MOVE,this.bindPointerMove),this.canvas.removeEventListener(wt.POINTER_UP,this.bindPointerUp)},r}(db),W7=function(){function t(r){var e=this;this.scrollFrameId=null,this.getLayoutResult=function(){return Y(Y({},e.layoutResult),{cornerNodes:e.getCornerNodes(),seriesNumberNodes:e.getSeriesNumberNodes()})},this.hideScrollBar=function(){var n,i,a;(n=e.hRowScrollBar)===null||n===void 0||n.setAttribute("visibility","hidden"),(i=e.hScrollBar)===null||i===void 0||i.setAttribute("visibility","hidden"),(a=e.vScrollBar)===null||a===void 0||a.setAttribute("visibility","hidden")},this.delayHideScrollBar=cc(this.hideScrollBar,1e3),this.delayHideScrollbarOnMobile=function(){tr()&&e.delayHideScrollBar()},this.showVerticalScrollBar=function(){var n;(n=e.vScrollBar)===null||n===void 0||n.setAttribute("visibility","visible")},this.showHorizontalScrollBar=function(){var n,i;(n=e.hRowScrollBar)===null||n===void 0||n.setAttribute("visibility","visible"),(i=e.hScrollBar)===null||i===void 0||i.setAttribute("visibility","visible")},this.onContainerWheelForMobileCompatibility=function(){var n=e.spreadsheet.getCanvasElement(),i,a;n.addEventListener("touchstart",function(o){i=o.touches[0].clientY}),n.addEventListener("touchend",function(o){a=o.changedTouches[0].clientY,a<i?e.scrollDirection=br.SCROLL_UP:a>i&&(e.scrollDirection=br.SCROLL_DOWN)})},this.onContainerWheel=function(){tr()?e.onContainerWheelForMobile():e.onContainerWheelForPc()},this.getMobileWheelDeltaY=function(n){return e.scrollDirection===br.SCROLL_UP?Math.max(0,n):e.scrollDirection===br.SCROLL_DOWN?Math.min(0,n):n},this.onContainerWheelForPc=function(){var n=e.spreadsheet.getCanvasElement();n==null||n.addEventListener("wheel",e.onWheel)},this.onContainerWheelForMobile=function(){e.mobileWheel=new z7(e.spreadsheet.container),e.mobileWheel.on("wheel",function(n){e.spreadsheet.hideTooltip();var i=n.originalEvent,a=n.deltaX,o=n.deltaY,s=n.x,l=n.y,u=e.getMobileWheelDeltaY(o);e.onWheel(Y(Y({},i),{deltaX:a,deltaY:u,offsetX:s,offsetY:l}))}),e.onContainerWheelForMobileCompatibility()},this.bindEvents=function(){e.onContainerWheel(),e.emitPaginationEvent()},this.setScrollOffset=function(n){Object.keys(n).forEach(function(i){var a=dt(n,i);xw(a)||e.spreadsheet.store.set(i,xt(a))})},this.getScrollOffset=function(){var n=e.spreadsheet.store;return{scrollX:n.get("scrollX",0),scrollY:n.get("scrollY",0),rowHeaderScrollX:n.get("rowHeaderScrollX",0)}},this.resetScrollX=function(){e.setScrollOffset({scrollX:0})},this.resetRowScrollX=function(){e.setScrollOffset({rowHeaderScrollX:0})},this.resetScrollY=function(){e.setScrollOffset({scrollY:0})},this.resetScrollOffset=function(){e.setScrollOffset({scrollX:0,scrollY:0,rowHeaderScrollX:0})},this.emitPaginationEvent=function(){var n=e.spreadsheet.options.pagination;if(n){var i=n.current,a=i===void 0?Ld:i,o=n.pageSize,s=e.viewCellHeights.getTotalLength(),l=xt((s-1)/o)+1;e.spreadsheet.emit(se.LAYOUT_PAGINATION,{pageSize:o,pageCount:l,total:s,current:a})}},this.unbindEvents=function(){var n,i=e.spreadsheet.getCanvasElement();i==null||i.removeEventListener("wheel",e.onWheel),(n=e.mobileWheel)===null||n===void 0||n.destroy()},this.calculateCellWidthHeight=function(){var n=e.layoutResult.colLeafNodes,i=Pw(n,function(a,o){var s=mr(a)||0;return a.push(s+o.width),a},[0]);e.viewCellWidths=i,e.viewCellHeights=e.getViewCellHeights()},this.getRealScrollX=function(n,i){return i===void 0&&(i=0),e.spreadsheet.isFrozenRowHeader()?i:n},this.calculatePanelBBox=function(){e.panelBBox=new P7(e,!0)},this.getRealWidth=function(){return mr(e.viewCellWidths)||0},this.getRealHeight=function(){var n=e.spreadsheet.options.pagination,i=e.viewCellHeights;if(n){var a=e.getCellRange(),o=a.start,s=a.end;return i.getCellOffsetY(s+1)-i.getCellOffsetY(o)}return i.getTotalHeight()},this.scrollWithAnimation=function(n,i,a){var o,s,l,u;n===void 0&&(n={}),i===void 0&&(i=200);var h=e.getAdjustedScrollOffset({scrollX:((o=n.offsetX)===null||o===void 0?void 0:o.value)||0,scrollY:((s=n.offsetY)===null||s===void 0?void 0:s.value)||0,rowHeaderScrollX:((l=n.rowHeaderOffsetX)===null||l===void 0?void 0:l.value)||0}),v=h.scrollX,p=h.scrollY,m=h.rowHeaderScrollX;(u=e.timer)===null||u===void 0||u.stop();var C=e.getScrollOffset(),w=[v??C.scrollX,p??C.scrollY,m??C.rowHeaderScrollX],b=w7(Object.values(C),w);e.timer=sb(function(E){try{var R=Math.min(E/i,1),M=te(b(R),3),k=M[0],L=M[1],_=M[2];e.setScrollOffset({rowHeaderScrollX:_,scrollX:k,scrollY:L}),e.startScroll(),E>i&&(e.timer.stop(),a==null||a())}catch(I){console.error(I),e.timer.stop()}})},this.scrollImmediately=function(n){var i,a,o;n===void 0&&(n={});var s=e.getAdjustedScrollOffset({scrollX:((i=n.offsetX)===null||i===void 0?void 0:i.value)||0,scrollY:((a=n.offsetY)===null||a===void 0?void 0:a.value)||0,rowHeaderScrollX:((o=n.rowHeaderOffsetX)===null||o===void 0?void 0:o.value)||0}),l=s.scrollX,u=s.scrollY,h=s.rowHeaderScrollX;e.setScrollOffset({scrollX:l,scrollY:u,rowHeaderScrollX:h}),e.startScroll()},this.startScroll=function(n){var i,a,o;n===void 0&&(n=!1);var s=e.getScrollOffset(),l=s.rowHeaderScrollX,u=s.scrollX,h=s.scrollY;(i=e.hRowScrollBar)===null||i===void 0||i.onlyUpdateThumbOffset(e.getScrollBarOffset(l,e.hRowScrollBar)),(a=e.hScrollBar)===null||a===void 0||a.onlyUpdateThumbOffset(e.getScrollBarOffset(u,e.hScrollBar)),(o=e.vScrollBar)===null||o===void 0||o.onlyUpdateThumbOffset(e.getScrollBarOffset(h,e.vScrollBar)),e.dynamicRenderCell(n)},this.getRendererHeight=function(){var n=e.getCellRange(),i=n.start,a=n.end;return e.viewCellHeights.getCellOffsetY(a+1)-e.viewCellHeights.getCellOffsetY(i)},this.getAdjustedScrollOffset=function(n){var i=n.scrollX,a=n.scrollY,o=n.rowHeaderScrollX;return{scrollX:K1(i,e.layoutResult.colsHierarchy.width,e.panelBBox.width),scrollY:K1(a,e.getRendererHeight(),e.panelBBox.height),rowHeaderScrollX:A7(o,e.cornerBBox)}},this.renderRowScrollBar=function(n){if(e.spreadsheet.isFrozenRowHeader()&&e.cornerBBox.width<e.cornerBBox.originalWidth){var i=e.cornerBBox.originalWidth-e.cornerBBox.width,a=e.getScrollbarPosition().maxY,o=e.spreadsheet.theme,s=o.splitLine,l=o.scrollBar,u=Math.max(e.cornerBBox.width*e.cornerBBox.width/e.cornerBBox.originalWidth,l==null?void 0:l.thumbHorizontalMinSize),h=u-(s==null?void 0:s.verticalBorderWidth);e.hRowScrollBar=new Ih({isHorizontal:!0,trackLen:e.cornerBBox.width,thumbLen:h,position:{x:e.cornerBBox.minX+e.scrollBarSize/2,y:a},thumbOffset:n*(e.cornerBBox.width-u)/i,theme:e.scrollBarTheme,scrollTargetMaxOffset:i}),e.hRowScrollBar.addEventListener(eo.ScrollChange,function(v){var p,m,C=v.offset,w=e.getValidScrollBarOffset(C,i),b=xt(w);e.setScrollOffset({rowHeaderScrollX:b}),(p=e.rowHeader)===null||p===void 0||p.onRowScrollX(b,ss),(m=e.seriesNumberHeader)===null||m===void 0||m.onRowScrollX(b,h1),e.cornerHeader.onRowScrollX(b,Sd);var E=e.getScrollBarOffset(b,e.hRowScrollBar),R=e.getScrollOffset(),M=R.scrollX,k=R.scrollY,L={scrollX:M,scrollY:k,rowHeaderScrollX:E};e.hRowScrollBar.updateThumbOffset(E,!1),e.spreadsheet.emit(se.ROW_CELL_SCROLL,L),e.spreadsheet.emit(se.GLOBAL_SCROLL,L)}),e.foregroundGroup.appendChild(e.hRowScrollBar)}},this.getValidScrollBarOffset=function(n,i){return lc(n,0,i)},this.renderHScrollBar=function(n,i,a){if(xt(n)<xt(i)){var o=e.scrollBarSize/2,s=e.getScrollbarPosition().maxY,l=!e.spreadsheet.isFrozenRowHeader(),u=n+(l?Math.min(e.cornerBBox.width,e.getCanvasSize().width):0),h={x:e.panelBBox.minX+(l?-e.cornerBBox.width+o:o),y:s},v=i+(l?e.cornerBBox.width:0),p=e.spreadsheet.theme.scrollBar,m=v-u,C=Math.max(u/v*u,p==null?void 0:p.thumbHorizontalMinSize);e.hScrollBar=new Ih({isHorizontal:!0,trackLen:u,thumbLen:C,position:h,thumbOffset:a*(u-C)/m,theme:e.scrollBarTheme,scrollTargetMaxOffset:m}),e.hScrollBar.addEventListener(eo.ScrollChange,function(w){var b=w.offset,E=w.updateThumbOffset,R=e.getValidScrollBarOffset(b,m);E&&e.hScrollBar.updateThumbOffset(e.getScrollBarOffset(R,e.hScrollBar),!1),e.setScrollOffset({scrollX:R}),e.dynamicRenderCell()}),e.foregroundGroup.appendChild(e.hScrollBar)}},this.getScrollbarPosition=function(){var n=e.panelBBox,i=n.maxX,a=n.maxY,o=e.getCanvasSize(),s=o.width,l=o.height,u=e.spreadsheet.options.interaction.scrollbarPosition===vc.CONTENT;return{maxX:(u?i:s)-e.scrollBarSize,maxY:u?a:l-e.scrollBarSize}},this.renderVScrollBar=function(n,i,a){if(n<i){var o=e.spreadsheet.theme.scrollBar,s=Math.max(n/i*n,o==null?void 0:o.thumbVerticalMinSize),l=i-n,u=e.getScrollbarPosition().maxX;e.vScrollBar=new Ih({isHorizontal:!1,trackLen:n,thumbLen:s,thumbOffset:a*(n-s)/l,position:{x:u,y:e.panelBBox.minY},theme:e.scrollBarTheme,scrollTargetMaxOffset:l}),e.vScrollBar.addEventListener(eo.ScrollChange,function(h){var v=h.offset,p=h.updateThumbOffset,m=e.getValidScrollBarOffset(v,l);p&&e.vScrollBar.updateThumbOffset(e.getScrollBarOffset(m,e.vScrollBar),!1),e.setScrollOffset({scrollY:m}),e.dynamicRenderCell()}),e.foregroundGroup.appendChild(e.vScrollBar)}},this.getScrollBarOffset=function(n,i){var a=i.trackLen,o=i.thumbLen,s=i.scrollTargetMaxOffset;return n*(a-o)/s},this.isScrollOverThePanelArea=function(n){var i=n.offsetX,a=n.offsetY;return i>e.panelBBox.minX&&i<e.panelBBox.maxX&&a>e.panelBBox.minY&&a<e.panelBBox.maxY},this.isScrollOverTheCornerArea=function(n){var i=n.offsetX,a=n.offsetY;return i>e.cornerBBox.minX&&i<e.cornerBBox.maxX&&a>e.cornerBBox.minY&&a<e.cornerBBox.maxY+e.panelBBox.height},this.updateHorizontalRowScrollOffset=function(n){var i,a=n.offset,o=n.offsetX,s=n.offsetY;e.isScrollOverTheCornerArea({offsetX:o,offsetY:s})&&((i=e.hRowScrollBar)===null||i===void 0||i.emitScrollChange(a))},this.updateHorizontalScrollOffset=function(n){var i,a=n.offset,o=n.offsetX,s=n.offsetY;(!e.hRowScrollBar||e.isScrollOverThePanelArea({offsetX:o,offsetY:s}))&&((i=e.hScrollBar)===null||i===void 0||i.emitScrollChange(a))},this.isScrollToLeft=function(n){var i=n.deltaX,a=n.offsetX,o=n.offsetY;if(!e.hScrollBar&&!e.hRowScrollBar)return!0;var s=!e.hRowScrollBar||e.isScrollOverThePanelArea({offsetY:o,offsetX:a})||e.hRowScrollBar.thumbOffset<=0,l=!e.hScrollBar||e.hScrollBar.thumbOffset<=0;return i<=0&&l&&s},this.isScrollToRight=function(n){var i,a,o,s,l,u,h=n.deltaX,v=n.offsetX,p=n.offsetY;if(!e.hScrollBar&&!e.hRowScrollBar)return!0;var m=e.spreadsheet.isFrozenRowHeader()?(i=e.panelBBox)===null||i===void 0?void 0:i.width:(a=e.panelBBox)===null||a===void 0?void 0:a.maxX,C=!e.hRowScrollBar||e.isScrollOverThePanelArea({offsetY:p,offsetX:v})||((o=e.hRowScrollBar)===null||o===void 0?void 0:o.thumbOffset)+((s=e.hRowScrollBar)===null||s===void 0?void 0:s.thumbLen)>=e.cornerBBox.width,w=e.hRowScrollBar&&e.isScrollOverTheCornerArea({offsetX:v,offsetY:p})||((l=e.hScrollBar)===null||l===void 0?void 0:l.thumbOffset)+((u=e.hScrollBar)===null||u===void 0?void 0:u.thumbLen)>=m;return h>=0&&w&&C},this.isScrollToTop=function(n){var i;return e.vScrollBar?n<=0&&((i=e.vScrollBar)===null||i===void 0?void 0:i.thumbOffset)<=0:!0},this.isScrollToBottom=function(n){var i,a,o;return e.vScrollBar?n>=0&&((i=e.vScrollBar)===null||i===void 0?void 0:i.thumbOffset)+((a=e.vScrollBar)===null||a===void 0?void 0:a.thumbLen)>=((o=e.panelBBox)===null||o===void 0?void 0:o.height):!0},this.isVerticalScrollOverTheViewport=function(n){return!e.isScrollToTop(n)&&!e.isScrollToBottom(n)},this.isHorizontalScrollOverTheViewport=function(n){return!e.isScrollToLeft(n)&&!e.isScrollToRight(n)},this.isScrollOverTheViewport=function(n){var i=n.deltaY,a=n.deltaX,o=n.offsetY,s=o<=e.cornerBBox.maxY;return s?!1:i!==0?e.isVerticalScrollOverTheViewport(i):a!==0?e.isHorizontalScrollOverTheViewport(n):!1},this.cancelScrollFrame=function(){return tr()&&e.scrollFrameId?!1:(cancelAnimationFrame(e.scrollFrameId),!0)},this.clearScrollFrameIdOnMobile=function(){tr()&&(e.scrollFrameId=null)},this.stopScrollChainingIfNeeded=function(n){var i=e.spreadsheet.options.interaction;(i==null?void 0:i.overscrollBehavior)!=="auto"&&(e.cancelScrollFrame(),e.stopScrollChaining(n))},this.stopScrollChaining=function(n){var i,a;n!=null&&n.cancelable&&((i=n==null?void 0:n.preventDefault)===null||i===void 0||i.call(n));var o=n==null?void 0:n.originalEvent;o!=null&&o.cancelable&&((a=o==null?void 0:o.preventDefault)===null||a===void 0||a.call(o))},this.onWheel=function(n){var i=e.spreadsheet.options.interaction,a=n.deltaX,o=n.deltaY,s=n.offsetX,l=n.offsetY,u=n.shiftKey;u&&tx()&&(s=s-a+o,a=o,l-=o,o=0);var h=te(x8(a,o,i==null?void 0:i.scrollSpeedRatio),2),v=h[0],p=h[1];if(e.spreadsheet.hideTooltip(),e.spreadsheet.interaction.clearHoverTimer(),!e.isScrollOverTheViewport({deltaX:v,deltaY:p,offsetX:s,offsetY:l})){e.stopScrollChainingIfNeeded(n);return}e.stopScrollChaining(n),e.spreadsheet.interaction.addIntercepts([Qe.HOVER]),e.cancelScrollFrame()&&(e.scrollFrameId=requestAnimationFrame(function(){var m,C=e.getScrollOffset(),w=C.scrollX,b=C.scrollY,E=C.rowHeaderScrollX;v!==0&&(e.showHorizontalScrollBar(),e.updateHorizontalRowScrollOffset({offsetX:s,offsetY:l,offset:v+E}),e.updateHorizontalScrollOffset({offsetX:s,offsetY:l,offset:v+w})),p!==0&&(e.showVerticalScrollBar(),(m=e.vScrollBar)===null||m===void 0||m.emitScrollChange(p+b)),e.delayHideScrollbarOnMobile(),e.clearScrollFrameIdOnMobile()}))},this.realDataCellRender=function(n,i){var a=e.calculateXYIndexes(n,i);Li.getInstance().logger("realDataCellRender:",e.preCellIndexes,a);var o=I7(e.preCellIndexes,a),s=o.add,l=o.remove;Li.getInstance().debugCallback(A6,function(){tt(s,function(h){var v,p,m=te(h,2),C=m[0],w=m[1],b=e.getCellMeta(w,C);if(b){var E=(p=(v=e.spreadsheet.options).dataCell)===null||p===void 0?void 0:p.call(v,b);if(!E)return;E.position=[w,C],E.name="".concat(C,"-").concat(w),e.addDataCell(E)}});var u=nl(e.panelGroup.children,Di);tt(l,function(h){var v=te(h,2),p=v[0],m=v[1],C=Rr(u,function(w){return w.name==="".concat(p,"-").concat(m)});C==null||C.remove()}),Li.getInstance().logger("Render Cell Panel: ".concat(u==null?void 0:u.length,", Add: ").concat(s==null?void 0:s.length,", Remove: ").concat(l==null?void 0:l.length))}),e.preCellIndexes=a,e.spreadsheet.emit(se.LAYOUT_AFTER_REAL_DATA_CELL_RENDER,{add:s,remove:l,spreadsheet:e.spreadsheet})},this.getGridInfo=function(){var n=te(e.preCellIndexes.center,4),i=n[0],a=n[1],o=n[2],s=n[3],l=cb(i,a,e.layoutResult.colLeafNodes),u=cf(o,s,e.viewCellHeights);return{cols:l,rows:u}},this.onAfterScroll=cc(function(){var n=e.spreadsheet,i=n.interaction,a=n.container;if(!i.isSelectedState()&&(i.removeIntercepts([Qe.HOVER]),i.getHoverAfterScroll())){var o=i.eventController.canvasMousemoveEvent;if(o){var s=o.x,l=o.y,u=a.document.elementFromPointSync(s,l);u&&a.emit(wt.POINTER_MOVE,Y(Y({},o),{shape:u,target:u,timestamp:performance.now()}))}}},300),this.getCellChildrenNodes=function(n){var i,a=(i=n==null?void 0:n.getMeta)===null||i===void 0?void 0:i.call(n),o=(n==null?void 0:n.cellType)===Le.ROW_CELL,s=e.spreadsheet.isHierarchyTreeType();return s&&o?pr.getAllLeaveNodes(a).filter(function(l){return l.rowIndex===a.rowIndex}):pr.getAllChildrenNodes(a)},this.spreadsheet=r,this.init()}return Object.defineProperty(t.prototype,"scrollBarTheme",{get:function(){return this.spreadsheet.theme.scrollBar},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scrollBarSize",{get:function(){var r;return(r=this.scrollBarTheme)===null||r===void 0?void 0:r.size},enumerable:!1,configurable:!0}),t.prototype.initGroups=function(){var r=this.spreadsheet.container;this.backgroundGroup=r.appendChild(new Ft({name:lB,style:{zIndex:QD}})),this.initPanelGroups(),this.foregroundGroup=r.appendChild(new Ft({name:uB,style:{zIndex:eB}}))},t.prototype.initPanelGroups=function(){var r=this.spreadsheet.container;this.panelGroup=r.appendChild(new Ft({name:cB,style:{zIndex:nB}})),this.panelScrollGroup=new O7({name:fB,zIndex:iB,s2:this.spreadsheet}),this.panelGroup.appendChild(this.panelScrollGroup)},t.prototype.getCellCustomSize=function(r,e){return ui(e)?e==null?void 0:e(r):e},t.prototype.getRowCellDraggedWidth=function(r){var e,n,i,a=this.spreadsheet.options.style.rowCell;return(n=(e=a==null?void 0:a.widthByField)===null||e===void 0?void 0:e[r==null?void 0:r.id])!==null&&n!==void 0?n:(i=a==null?void 0:a.widthByField)===null||i===void 0?void 0:i[r==null?void 0:r.field]},t.prototype.getRowCellDraggedHeight=function(r){var e,n,i,a=this.spreadsheet.options.style.rowCell;return(n=(e=a==null?void 0:a.heightByField)===null||e===void 0?void 0:e[r==null?void 0:r.id])!==null&&n!==void 0?n:(i=a==null?void 0:a.heightByField)===null||i===void 0?void 0:i[r==null?void 0:r.field]},t.prototype.getRowCellHeight=function(r){var e,n,i,a=this.spreadsheet.options.style,o=a.rowCell,s=a.dataCell;return(i=(n=(e=this.getRowCellDraggedHeight(r))!==null&&e!==void 0?e:this.getCellCustomSize(r,o==null?void 0:o.height))!==null&&n!==void 0?n:s==null?void 0:s.height)!==null&&i!==void 0?i:0},t.prototype.getColCellDraggedWidth=function(r){var e,n,i,a=this.spreadsheet.options.style.colCell;return(n=(e=a==null?void 0:a.widthByField)===null||e===void 0?void 0:e[r==null?void 0:r.id])!==null&&n!==void 0?n:(i=a==null?void 0:a.widthByField)===null||i===void 0?void 0:i[r==null?void 0:r.field]},t.prototype.getColCellDraggedHeight=function(r){var e,n,i,a=this.spreadsheet.options.style.colCell;return(n=(e=a==null?void 0:a.heightByField)===null||e===void 0?void 0:e[r==null?void 0:r.id])!==null&&n!==void 0?n:(i=a==null?void 0:a.heightByField)===null||i===void 0?void 0:i[r==null?void 0:r.field]},t.prototype.getDefaultColNodeHeight=function(r,e){var n,i,a,o,s=this.spreadsheet.options.style.colCell,l=((i=(n=e==null?void 0:e.sampleNodesForAllLevels)===null||n===void 0?void 0:n.find(function(h){return h.level===r.level}))===null||i===void 0?void 0:i.height)||0,u=(o=(a=this.getColCellDraggedHeight(r))!==null&&a!==void 0?a:this.getCellCustomSize(r,s==null?void 0:s.height))!==null&&o!==void 0?o:0;return Math.max(u,l)},t.prototype.getCellAdaptiveHeight=function(r,e){if(!r)return e;var n=r.getStyle().cell.padding;r.drawTextShape();var i=r.getTextShape().parsedStyle,a=r.getActualTextHeight(),o=a+n.top+n.bottom;return(i==null?void 0:i.maxLines)>1&&a>=e?o:e},t.prototype.updateColsHierarchySampleMaxHeightNodes=function(r){var e=this,n=r.sampleNodesForAllLevels.map(function(i){var a=Gv(r.getNodes(i.level).filter(function(o){return!o.isTotals}),function(o){return e.getColNodeHeight(o,r)});return a});r.sampleNodesForAllLevels=ai(n),r.sampleNodesForAllLevels.forEach(function(i){var a;if(i.height=e.getColNodeHeight(i,r),i.level===0)i.y=0;else{var o=(a=r.sampleNodesForAllLevels[i.level-1])!==null&&a!==void 0?a:{y:0,height:0};i.y=o.y+o.height}r.height+=i.height})},t.prototype.render=function(){R8(this.spreadsheet.dataCfg.fields)||(this.adjustScrollOffset(),this.renderHeaders(),this.renderScrollBars(),this.renderBackground(),this.dynamicRenderCell())},t.prototype.adjustScrollOffset=function(){var r=this.getAdjustedScrollOffset(this.getScrollOffset());this.setScrollOffset(r)},t.prototype.getSeriesNumberWidth=function(){var r,e,n=this.spreadsheet.options.seriesNumber;return n!=null&&n.enable&&(e=(r=this.spreadsheet.theme.rowCell)===null||r===void 0?void 0:r.seriesNumberWidth)!==null&&e!==void 0?e:0},t.prototype.getCanvasSize=function(){var r=this.spreadsheet.options,e=r.width,n=e===void 0?0:e,i=r.height,a=i===void 0?0:i;return{width:n,height:a}},t.prototype.getContentHeight=function(){var r=this.layoutResult,e=r.rowsHierarchy,n=r.colsHierarchy;return e.height+n.height},t.prototype.updateScrollOffset=function(r){var e,n,i,a,o,s;if(((e=r.rowHeaderOffsetX)===null||e===void 0?void 0:e.value)!==void 0){!((n=r.rowHeaderOffsetX)===null||n===void 0)&&n.animate?this.scrollWithAnimation(r):this.scrollImmediately(r);return}if(((i=r.offsetX)===null||i===void 0?void 0:i.value)!==void 0){!((a=r.offsetX)===null||a===void 0)&&a.animate?this.scrollWithAnimation(r):this.scrollImmediately(r);return}((o=r.offsetY)===null||o===void 0?void 0:o.value)!==void 0&&(!((s=r.offsetY)===null||s===void 0)&&s.animate?this.scrollWithAnimation(r):this.scrollImmediately(r))},t.prototype.getPaginationScrollY=function(){var r=this.spreadsheet.options.pagination;if(r){var e=r.current,n=e===void 0?Ld:e,i=r.pageSize,a=this.viewCellHeights,o=Math.max((n-1)*i,0);return a.getCellOffsetY(o)}return 0},t.prototype.destroy=function(){this.unbindEvents(),this.clearAllGroup(),this.preCellIndexes=null,cancelAnimationFrame(this.scrollFrameId)},t.prototype.calculateCornerBBox=function(){this.cornerBBox=new hb(this,!0)},t.prototype.getCellRange=function(){var r=this.spreadsheet.options.pagination;return T8(this.viewCellHeights,r)},t.prototype.clearAllGroup=function(){for(var r=this.panelGroup.children,e=r===void 0?[]:r,n=e.length-1;n>=0;n--){var i=e[n];i instanceof Ft?i.removeChildren():e[n].remove()}this.foregroundGroup.removeChildren(),this.backgroundGroup.removeChildren()},t.prototype.translateRelatedGroups=function(r,e,n){var i,a,o,s,l,u;Qn(this.panelScrollGroup,this.panelBBox.x-r,this.panelBBox.y-e),(i=this.rowHeader)===null||i===void 0||i.onScrollXY(this.getRealScrollX(r,n),e,ss),(a=this.seriesNumberHeader)===null||a===void 0||a.onScrollXY(this.getRealScrollX(r,n),e,h1),(o=this.cornerHeader)===null||o===void 0||o.onCorScroll(this.getRealScrollX(r,n),Sd),(s=this.centerFrame)===null||s===void 0||s.onChangeShadowVisibility(r,this.getRealWidth()-this.panelBBox.width),(l=this.centerFrame)===null||l===void 0||l.onBorderScroll(this.getCenterFrameScrollX(r)),(u=this.columnHeader)===null||u===void 0||u.onColScroll(r,Ww)},t.prototype.getCenterFrameScrollX=function(r){return this.getRealScrollX(r)},t.prototype.init=function(){var r=this;this.initGroups(),Li.getInstance().debugCallback(O6,function(){r.layoutResult=r.doLayout(),r.saveInitColumnLeafNodes(r.layoutResult.colLeafNodes),r.spreadsheet.emit(se.LAYOUT_AFTER_HEADER_LAYOUT,r.layoutResult)}),this.calculateCellWidthHeight(),this.calculateCornerBBox(),this.calculatePanelBBox(),this.bindEvents()},t.prototype.renderBackground=function(){var r=this.getCanvasSize(),e=r.width,n=r.height,i=this.spreadsheet.theme.background,a=i.color,o=i.opacity;this.backgroundGroup.appendChild(new Zt({style:{fill:a,opacity:o,x:0,y:0,width:e,height:n}}))},t.prototype.renderScrollBars=function(){var r=this.getScrollOffset(),e=r.scrollX,n=r.scrollY,i=r.rowHeaderScrollX,a=this.panelBBox,o=a.width,s=a.height,l=this.layoutResult.colsHierarchy.width,u=this.getRealHeight();this.renderRowScrollBar(i),this.renderHScrollBar(o,l,e),this.renderVScrollBar(s,u,n)},t.prototype.renderHeaders=function(){var r=this.getSeriesNumberWidth();this.rowHeader=this.getRowHeader(),this.columnHeader=this.getColHeader(),r>0&&!this.seriesNumberHeader&&(this.seriesNumberHeader=this.getSeriesNumberHeader()),this.cornerHeader=this.getCornerHeader(),this.centerFrame=this.getCenterFrame(),this.seriesNumberHeader&&this.foregroundGroup.appendChild(this.seriesNumberHeader),this.rowHeader&&this.foregroundGroup.appendChild(this.rowHeader),this.foregroundGroup.appendChild(this.columnHeader),this.foregroundGroup.appendChild(this.cornerHeader),this.foregroundGroup.appendChild(this.centerFrame)},t.prototype.getRowHeaderCfg=function(){var r=this.panelBBox,e=r.y,n=r.viewportHeight,i=r.viewportWidth,a=r.height,o=this.getSeriesNumberWidth();return{width:this.cornerBBox.width,height:a,viewportWidth:i,viewportHeight:n,position:{x:o,y:e},nodes:this.layoutResult.rowNodes,spreadsheet:this.spreadsheet}},t.prototype.getRowHeader=function(){return this.rowHeader?this.rowHeader:new D9(this.getRowHeaderCfg())},t.prototype.getColHeader=function(){if(!this.columnHeader){var r=this.panelBBox,e=r.x,n=r.width,i=r.viewportHeight,a=r.viewportWidth;return new Mx({width:n,cornerWidth:this.cornerBBox.width,height:this.cornerBBox.height,viewportWidth:a,viewportHeight:i,position:{x:e,y:0},nodes:this.layoutResult.colNodes,sortParam:this.spreadsheet.store.get("sortParam"),spreadsheet:this.spreadsheet})}return this.columnHeader},t.prototype.getCornerHeader=function(){return this.cornerHeader||P9.getCornerHeader({panelBBox:this.panelBBox,cornerBBox:this.cornerBBox,seriesNumberWidth:this.getSeriesNumberWidth(),layoutResult:this.layoutResult,spreadsheet:this.spreadsheet})},t.prototype.getSeriesNumberHeader=function(){return this.seriesNumberHeader||F9.getSeriesNumberHeader({spreadsheet:this.spreadsheet,panelBBox:this.panelBBox,cornerWidth:this.cornerBBox.width,seriesNumberWidth:this.getSeriesNumberWidth(),rowsHierarchy:this.layoutResult.rowsHierarchy})},t.prototype.getCenterFrame=function(){var r;if(!this.centerFrame){var e=this.panelBBox,n=e.viewportWidth,i=e.viewportHeight,a=this.cornerBBox.width,o=this.cornerBBox.height,s=(r=this.spreadsheet.options)===null||r===void 0?void 0:r.frame,l={position:{x:this.cornerBBox.x,y:this.cornerBBox.y},cornerWidth:a,cornerHeight:o,viewportWidth:n,viewportHeight:i,showViewportLeftShadow:!1,showViewportRightShadow:!1,spreadsheet:this.spreadsheet};return s?s(l):new Un(l)}return this.centerFrame},t.prototype.updatePanelScrollGroup=function(){this.gridInfo=this.getGridInfo(),this.panelScrollGroup.update(this.gridInfo)},t.prototype.dynamicRenderCell=function(r){var e=this.getScrollOffset(),n=e.scrollX,i=e.scrollY,a=e.rowHeaderScrollX,o=i+this.getPaginationScrollY();this.spreadsheet.hideTooltip(),this.spreadsheet.interaction.clearHoverTimer(),this.realDataCellRender(n,o),this.updatePanelScrollGroup(),this.translateRelatedGroups(n,o,a),this.clip(n,o),r||this.emitScrollEvent({scrollX:n,scrollY:o,rowHeaderScrollX:a}),this.onAfterScroll()},t.prototype.emitScrollEvent=function(r){this.spreadsheet.emit(se.GLOBAL_SCROLL,r)},t.prototype.saveInitColumnLeafNodes=function(r){r===void 0&&(r=[]);var e=this.spreadsheet,n=e.store,i=e.options,a=i.interaction.hiddenColumnFields,o=a===void 0?[]:a,s=r.length+o.length,l=this.getInitColLeafNodes();s!==(l==null?void 0:l.length)&&n.set("initColLeafNodes",r)},t.prototype.getHiddenColumnsInfo=function(r){var e=this.spreadsheet.store.get("hiddenColumnsDetail",[]);if(!ke(e))return e.find(function(n){var i;return(i=n==null?void 0:n.hideColumnNodes)===null||i===void 0?void 0:i.some(function(a){return a.id===r.id})})},t.prototype.updateCustomFieldsSampleNodes=function(r){if(this.spreadsheet.isCustomColumnFields()){var e=r.getNodes().filter(function(n){var i;return(i=r.sampleNodeForLastLevel)===null||i===void 0?void 0:i.id.includes(n.id)});r.sampleNodesForAllLevels=e,r.height=co(e,"height")}},t.prototype.adjustRowLeafNodesWidth=function(r){this.spreadsheet.isCustomRowFields()&&this.adjustLeafNodesSize("width")(r)},t.prototype.adjustColLeafNodesHeight=function(r){this.spreadsheet.isCustomColumnFields()&&this.adjustLeafNodesSize("height")(r)},t.prototype.adjustLeafNodesSize=function(r){return function(e){var n=e.leafNodes,i=e.hierarchy,a=i.sampleNodeForLastLevel,o=i.sampleNodesForAllLevels;n.forEach(function(s){if(!(s.level>(a==null?void 0:a.level))){var l=co(o,function(u){return u.level<s.level?0:u[r]});s[r]=l}})}},t.prototype.getHeaderNodes=function(r){var e=Ra(this.getCornerNodes(),this.getSeriesNumberNodes(),this.getRowNodes(),this.getColNodes());return r?e.filter(function(n){return r.includes(n.id)}):e},t.prototype.getCornerNodes=function(){var r;return((r=this.cornerHeader)===null||r===void 0?void 0:r.getNodes())||[]},t.prototype.getSeriesNumberNodes=function(){var r;return((r=this.seriesNumberHeader)===null||r===void 0?void 0:r.getNodes())||[]},t.prototype.getColNodes=function(r){var e=this.layoutResult.colNodes,n=e===void 0?[]:e;return nr(r)?n:n.filter(function(i){return i.level===r})},t.prototype.getTopLevelColNodes=function(){return this.getColNodes(0)},t.prototype.getColNodeById=function(r){return this.getColNodes().find(function(e){return e.id===r})},t.prototype.getColNodeByIndex=function(r){return this.getColNodes().find(function(e){return e.colIndex===r})},t.prototype.getColLeafNodeByIndex=function(r){return this.getColLeafNodes().find(function(e){return e.colIndex===r})},t.prototype.getColNodesByField=function(r){return this.getColNodes().filter(function(e){return e.field===r})},t.prototype.getColLeafNodes=function(){var r;return((r=this.layoutResult)===null||r===void 0?void 0:r.colLeafNodes)||[]},t.prototype.getColTotalsNodes=function(r){return this.getColNodes(r).filter(function(e){return e.isTotals})},t.prototype.getColSubTotalsNodes=function(r){return this.getColTotalsNodes(r).filter(function(e){return e.isSubTotals})},t.prototype.getColGrandTotalsNodes=function(r){return this.getColTotalsNodes(r).filter(function(e){return e.isGrandTotals})},t.prototype.getRowNodes=function(r){var e=this.layoutResult.rowNodes,n=e===void 0?[]:e;return nr(r)?n:n.filter(function(i){return i.level===r})},t.prototype.getRowNodeById=function(r){return this.getRowNodes().find(function(e){return e.id===r})},t.prototype.getRowNodeByIndex=function(r){return this.getRowNodes().find(function(e){return e.rowIndex===r})},t.prototype.getRowLeafNodeByIndex=function(r){return this.getRowLeafNodes().find(function(e){return e.rowIndex===r})},t.prototype.getRowNodesByField=function(r){return this.getRowNodes().filter(function(e){return e.field===r})},t.prototype.getRowLeafNodes=function(){var r;return((r=this.layoutResult)===null||r===void 0?void 0:r.rowLeafNodes)||[]},t.prototype.getRowTotalsNodes=function(r){return this.getRowNodes(r).filter(function(e){return e.isTotals})},t.prototype.getRowSubTotalsNodes=function(r){return this.getRowTotalsNodes(r).filter(function(e){return e.isSubTotals})},t.prototype.getRowGrandTotalsNodes=function(r){return this.getRowTotalsNodes(r).filter(function(e){return e.isGrandTotals})},t.prototype.getDataCells=function(){var r;return nl((r=this.panelGroup)===null||r===void 0?void 0:r.children,Di)},t.prototype.getRowCells=function(){var r,e=((r=this.getRowHeader())===null||r===void 0?void 0:r.children)||[];return nl(e,lf).filter(function(n){return n.cellType===Le.ROW_CELL})},t.prototype.getRowLeafCells=function(){return this.getRowCells().filter(function(r){return r.getMeta().isLeaf})},t.prototype.getColCells=function(){var r,e=((r=this.getColHeader())===null||r===void 0?void 0:r.children)||[];return nl(e,$l).filter(function(n){return n.cellType===Le.COL_CELL})},t.prototype.getColLeafCells=function(){return this.getColCells().filter(function(r){return r.getMeta().isLeaf})},t.prototype.getMergedCells=function(){return ci(this.panelScrollGroup.getMergedCellsGroup().children,function(r){return r instanceof Sx})},t.prototype.getCornerCells=function(){return ci(this.getCornerHeader().children,function(r){return r instanceof $x})},t.prototype.getHeaderCells=function(r){var e=Ra(this.getCornerCells(),this.getSeriesNumberCells(),this.getRowCells(),this.getColCells());return r?e.filter(function(n){return r.includes(n.getMeta().id)}):e},t.prototype.getCellById=function(r){return this.getCells().find(function(e){return e.getMeta().id===r})},t.prototype.getCellsByField=function(r){return this.getCells().filter(function(e){return e.getMeta().field===r})},t.prototype.getCells=function(r){var e=Ra(this.getHeaderCells(),this.getDataCells());return r?e.filter(function(n){return r.includes(n.getMeta().id)}):e},t.prototype.getInitColLeafNodes=function(){return this.spreadsheet.store.get("initColLeafNodes",[])},t.prototype.clearInitColLeafNodes=function(){this.spreadsheet.store.set("initColLeafNodes",void 0)},t}(),G7=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r}(lb),vb=function(t){Me(r,t);function r(){var e,n=t!==null&&t.apply(this,arguments)||this;return n.frozenGroupInfo=(e={},e[Bt.FROZEN_COL]={width:0,x:0,range:[]},e[Bt.FROZEN_TRAILING_COL]={width:0,x:0,range:[]},e[Bt.FROZEN_ROW]={height:0,y:0,range:[]},e[Bt.FROZEN_TRAILING_ROW]={height:0,y:0,range:[]},e),n.panelScrollGroupIndexes=[0,0,0,0],n.addDataCell=function(i){var a=n.getFrozenOptions(),o=a.rowCount,s=o===void 0?0:o,l=a.colCount,u=l===void 0?0:l,h=a.trailingRowCount,v=h===void 0?0:h,p=a.trailingColCount,m=p===void 0?0:p,C=n.getColNodes().length,w=n.getCellRange(),b=n.getRealFrozenColumns(u,m),E=b.colCount,R=b.trailingColCount,M=b8(i.getMeta(),{rowCount:s,trailingRowCount:v,colCount:E,trailingColCount:R},C,w),k=d1[M];if(k){var L=n[k];L.appendChild(i)}setTimeout(function(){n.spreadsheet.emit(se.DATA_CELL_RENDER,i),n.spreadsheet.emit(se.LAYOUT_CELL_RENDER,i)},100)},n.addFrozenCell=function(i,a,o){var s,l,u=n.getCellMeta(a,i);if(u){u.isFrozenCorner=!0;var h=(l=(s=n.spreadsheet.options).dataCell)===null||l===void 0?void 0:l.call(s,u);o.appendChild(h)}},n.translateFrozenGroups=function(){var i=n.getScrollOffset(),a=i.scrollY,o=i.scrollX,s=n.getPaginationScrollY(),l=n.panelBBox,u=l.x,h=l.y;Qn(n.frozenTopGroup,u,h-s),Qn(n.frozenBottomGroup,u,h),Qn(n.frozenRowGroup,u-o,h-s),Qn(n.frozenTrailingRowGroup,u-o,h),Qn(n.frozenColGroup,u,h-a-s),Qn(n.frozenTrailingColGroup,u,h-a-s)},n.renderFrozenGroupSplitLine=function(i,a){var o,s=n.panelBBox,l=s.width,u=s.height,h=s.viewportWidth,v=s.viewportHeight,p=s.x,m=s.y,C=n.getTopLevelColNodes(),w=n.getCellRange(),b=n.getFrozenOptions(),E=b.rowCount,R=E===void 0?0:E,M=b.colCount,k=M===void 0?0:M,L=b.trailingColCount,_=L===void 0?0:L,I=b.trailingRowCount,P=I===void 0?0:I,U=Math.floor(a-n.getPaginationScrollY()),q=Math.max(0,mr(n.viewCellWidths)-h),Q=Math.max(0,n.viewCellHeights.getCellOffsetY(w.end+1)-n.viewCellHeights.getCellOffsetY(w.start)-v);(o=n.foregroundGroup.getElementById(hc))===null||o===void 0||o.remove();var J=n.spreadsheet.theme.splitLine,re=n.foregroundGroup.appendChild(new Ft({id:hc,style:{zIndex:wl}})),ne={lineWidth:mc,stroke:J==null?void 0:J.verticalBorderColor,opacity:J==null?void 0:J.verticalBorderColorOpacity},ce={lineWidth:mc,stroke:J==null?void 0:J.horizontalBorderColor,opacity:J==null?void 0:J.horizontalBorderColorOpacity},me=Un.getVerticalBorderWidth(n.spreadsheet);if(k>0){var oe=C.reduce(function(je,Be,rt){return rt<k?je+Be.width:je},0),Se=(P>0?u:v)+m;_r(re,Y(Y({},ne),{x1:oe+p,x2:oe+p,y1:0,y2:Se})),J!=null&&J.showShadow&&i>0&&re.appendChild(new Zt({style:{x:oe+p,y:0,width:J==null?void 0:J.shadowWidth,height:Se,fill:n.getShadowFill(0)}}))}if(R>0){var Te=m+n.getTotalHeightForRange(w.start,w.start+R-1),Ie=_>0?l:h;_r(re,Y(Y({},ce),{x1:0,x2:Ie+me,y1:Te,y2:Te})),J!=null&&J.showShadow&&U>0&&re.appendChild(new Zt({style:{x:0,y:Te,width:Ie+me,height:J==null?void 0:J.shadowWidth,fill:n.getShadowFill(90)}}))}if(_>0){var oe=C[C.length-_].x,Se=(P?u:v)+m;_r(re,Y(Y({},ne),{x1:oe+p,x2:oe+p,y1:0,y2:Se})),J!=null&&J.showShadow&&xt(i)<xt(q)&&re.appendChild(new Zt({style:{x:oe+p-J.shadowWidth,y:0,width:J.shadowWidth,height:Se,fill:n.getShadowFill(180)}}))}if(P>0){var Te=n.panelBBox.maxY-n.getTotalHeightForRange(w.end-P+1,w.end),Ie=_>0?l:h;_r(re,Y(Y({},ce),{x1:0,x2:Ie+me,y1:Te,y2:Te})),J!=null&&J.showShadow&&U<xt(Q)&&re.appendChild(new Zt({style:{x:0,y:Te-J.shadowWidth,width:Ie+me,height:J.shadowWidth,fill:n.getShadowFill(270)}}))}},n.renderFrozenPanelCornerGroup=function(){var i=n.getTopLevelColNodes(),a=n.getCellRange(),o=n.getFrozenOptions(),s=o.rowCount,l=s===void 0?0:s,u=o.colCount,h=u===void 0?0:u,v=o.trailingRowCount,p=v===void 0?0:v,m=o.trailingColCount,C=m===void 0?0:m,w=wc(i,h,C),b=w.colCount,E=w.trailingColCount,R=S8({rowCount:l,colCount:b,trailingRowCount:p,trailingColCount:E},n.getColLeafNodes().length,a);Object.keys(R).forEach(function(M){var k=R[M],L=n[d1[M]];L&&k.forEach(function(_){n.addFrozenCell(_.x,_.y,L)})})},n.getRealFrozenColumns=function(i,a){if(i||a){var o=n.getTopLevelColNodes();return wc(o,i,a)}return{colCount:i,trailingColCount:a}},n.getTotalHeightForRange=function(i,a){if(i<0||a<0)return 0;if(n.rowOffsets)return n.rowOffsets[a+1]-n.rowOffsets[i];for(var o=0,s=i;s<a+1;s++){var l=n.getDefaultCellHeight();o+=l}return o},n.getShadowFill=function(i){var a,o,s=n.spreadsheet.theme.splitLine;return"l (".concat(i,") 0:").concat((a=s==null?void 0:s.shadowColors)===null||a===void 0?void 0:a.left," 1:").concat((o=s==null?void 0:s.shadowColors)===null||o===void 0?void 0:o.right)},n}return r.prototype.initPanelGroups=function(){var e,n=this;t.prototype.initPanelGroups.call(this),e=te([hB,dB,vB,pB,gB,mB].map(function(i){var a=new G7({name:i,zIndex:sB,s2:n.spreadsheet});return n.panelGroup.appendChild(a),a}),6),this.frozenRowGroup=e[0],this.frozenColGroup=e[1],this.frozenTrailingRowGroup=e[2],this.frozenTrailingColGroup=e[3],this.frozenTopGroup=e[4],this.frozenBottomGroup=e[5]},r.prototype.getFrozenOptions=function(){var e=this.getColLeafNodes().length,n=this.getCellRange();return bl(this.spreadsheet.options.frozen,e,n.end-n.start+1)},r.prototype.calculateFrozenGroupInfo=function(){var e=this.getFrozenOptions(),n=e.colCount,i=n===void 0?0:n,a=e.rowCount,o=a===void 0?0:a,s=e.trailingColCount,l=s===void 0?0:s,u=e.trailingRowCount,h=u===void 0?0:u,v=this.getTopLevelColNodes(),p=this.viewCellHeights,m=this.getCellRange(),C=this.frozenGroupInfo,w=C.frozenCol,b=C.frozenTrailingCol,E=C.frozenRow,R=C.frozenTrailingRow;i>0&&(w.width=v[i-1].x+v[i-1].width,w.x=0,w.range=[0,i-1]),o>0&&(E.height=p.getCellOffsetY(m.start+o)-p.getCellOffsetY(m.start),E.y=0,E.range=[m.start,m.start+o-1]),l>0&&(b.width=v[v.length-1].x-v[v.length-l].x+v[v.length-1].width,b.x=this.panelBBox.width-b.width,b.range=[v.length-l,v.length-1]),h>0&&(R.height=p.getCellOffsetY(m.end+1)-p.getCellOffsetY(m.end+1-h),R.y=this.panelBBox.height-R.height,R.range=[m.end-h+1,m.end])},r.prototype.getFinalViewport=function(){var e=this.panelBBox,n=e.viewportHeight,i=e.viewportWidth,a=this.getFrozenOptions(),o=a.colCount,s=o===void 0?0:o,l=a.rowCount,u=l===void 0?0:l,h=a.trailingColCount,v=h===void 0?0:h,p=a.trailingRowCount,m=p===void 0?0:p,C={width:i,height:n,x:0,y:0};if(s>0||v>0){var w=this.frozenGroupInfo,b=w.frozenTrailingCol,E=w.frozenCol;C.width-=b.width+E.width,C.x+=E.width}if(u>0||m>0){var R=this.frozenGroupInfo,M=R.frozenRow,k=R.frozenTrailingRow;C.height<M.height+k.height?(C.height=0,C.y=0):(C.height-=M.height+k.height,C.y+=M.height)}return C},r.prototype.calculateXYIndexes=function(e,n){var i,a,o=this.getColLeafNodes().length,s=this.getCellRange(),l=this.getFrozenOptions(),u=l.colCount,h=u===void 0?0:u,v=l.rowCount,p=v===void 0?0:v,m=l.trailingColCount,C=m===void 0?0:m,w=l.trailingRowCount,b=w===void 0?0:w,E=this.getFinalViewport(),R=this.spreadsheet.isTableMode()&&(!((a=(i=this.spreadsheet.dataSet)===null||i===void 0?void 0:i.isEmpty)===null||a===void 0)&&a.call(i))?this.spreadsheet.dataSet.getEmptyViewIndexes():_x({scrollX:e,scrollY:n,widths:this.viewCellWidths,heights:this.viewCellHeights,viewport:E,rowRemainWidth:this.getRealScrollX(this.cornerBBox.width)});this.panelScrollGroupIndexes=R;var M=this.getRealFrozenColumns(h,C),k=M.colCount,L=M.trailingColCount;return E8(R,{colCount:k,trailingColCount:L,rowCount:p,trailingRowCount:b},o,s)},r.prototype.updateFrozenGroupGrid=function(){var e=this;[Bt.FROZEN_COL,Bt.FROZEN_ROW,Bt.FROZEN_TRAILING_COL,Bt.FROZEN_TRAILING_ROW].forEach(function(n){if(e.frozenGroupInfo[n].range){var i=[],a=[];if(n.toLowerCase().includes("row")){var o=te(e.frozenGroupInfo[n].range||[],2),s=o[0],l=o[1];if(i=e.gridInfo.cols,a=cf(s,l,e.viewCellHeights),n===Bt.FROZEN_TRAILING_ROW){var u=e.frozenGroupInfo[Bt.FROZEN_TRAILING_ROW].y;a=N7(s,l,u,e.viewCellHeights)}}else{var h=te(e.frozenGroupInfo[n].range||[],2),v=h[0],p=h[1],m=e.getTopLevelColNodes();i=cb(v,p,m),a=e.gridInfo.rows}e["".concat(n,"Group")].updateGrid({cols:i,rows:a},"".concat(n,"Group"))}})},r.prototype.updatePanelScrollGroup=function(){t.prototype.updatePanelScrollGroup.call(this),this.updateFrozenGroupGrid()},r.prototype.translateRelatedGroups=function(e,n,i){t.prototype.translateRelatedGroups.call(this,e,n,i),this.translateFrozenGroups(),this.updateRowResizeArea(),this.renderFrozenGroupSplitLine(e,n)},r.prototype.updateRowResizeArea=function(){},r.prototype.render=function(){this.calculateFrozenGroupInfo(),this.renderFrozenPanelCornerGroup(),t.prototype.render.call(this)},r.prototype.getCenterFrameScrollX=function(e){return this.getFrozenOptions().colCount>0?0:t.prototype.getCenterFrameScrollX.call(this,e)},r.prototype.getDefaultCellHeight=function(){return this.getRowCellHeight(null)},r.prototype.clip=function(){var e=this,n=e.frozenGroupInfo,i=e.spreadsheet,a=i.isFrozenRowHeader(),o=n[Bt.FROZEN_COL].width,s=n[Bt.FROZEN_TRAILING_COL].width,l=n[Bt.FROZEN_ROW].height,u=n[Bt.FROZEN_TRAILING_ROW].height,h=(a?this.panelBBox.x:0)+o,v=this.panelBBox.y+l,p=this.panelBBox.width-o-s+(a?0:this.panelBBox.x),m=this.panelBBox.height-l-u;this.panelScrollGroup.style.clipPath=new Zt({style:{x:h,y:v,width:p,height:m}}),this.frozenColGroup.style.clipPath=new Zt({style:{x:this.panelBBox.x,y:v,width:o,height:m}}),this.frozenTrailingColGroup.style.clipPath=new Zt({style:{x:this.panelBBox.x+this.panelBBox.width-s,y:v,width:s,height:m}}),this.frozenRowGroup.style.clipPath=new Zt({style:{x:h,y:this.panelBBox.y,width:p,height:l}}),this.frozenTrailingRowGroup.style.clipPath=new Zt({style:{x:h,y:this.panelBBox.y+this.panelBBox.height-u,width:p,height:u}})},r}(W7),pb=function(t){var r,e=t.tree,n=e===void 0?[]:e,i=t.level,a=t.parentNode,o=t.hierarchy,s=t.spreadsheet,l=(r=s.options.style)===null||r===void 0?void 0:r.rowCell,u=l.collapseFields,h=l.collapseAll,v=s.store.get("hiddenColumnsDetail")||[];n.forEach(function(p){var m,C,w=p.field,b=p.title,E=p.collapsed,R=p.children,M=nn(p,["field","title","collapsed","children"]),k=v.some(function(ne){var ce=ne.hideColumnNodes;return ce.find(function(me){return me.field===w})});if(!k){var L=(m={},m[it]=w,m),_=xl(a.id,w),I=E??!1,P=(C=u==null?void 0:u[_])!==null&&C!==void 0?C:u==null?void 0:u[w],U=P??(h||I),q=s.isHierarchyTreeType()&&U,Q=ke(R),J=new pr({id:_,field:w,value:b,level:i,parent:a,isTotals:!1,isCollapsed:q,hierarchy:o,query:L,spreadsheet:s,isLeaf:Q,extra:Y(Y({},M),{isCustomNode:!0})});i>o.maxLevel&&!J.isSeriesNumberNode()&&(o.maxLevel=i,o.sampleNodesForAllLevels.push(J),o.sampleNodeForLastLevel=J,o.maxLevel=i);var re=Kv(s,a,J,o);!ke(R)&&!U&&re&&pb({spreadsheet:s,parentNode:J,level:i+1,hierarchy:o,tree:R||[]})}})},U7=function(t,r,e){var n=t.getTotalsConfig(r);if(n!=null&&n.showGrandTotals){var i=n.reverseGrandTotalsLayout?"unshift":"push";e[i](new fs({label:n.grandTotalsLabel,isGrandTotals:!0,isSubTotals:!1,isTotalRoot:!1}))}},gb=function(t){var r,e,n,i,a,o,s,l,u,h,v=t.spreadsheet,p=t.parentNode,m=t.currentField,C=t.level,w=t.hierarchy,b=t.pivotMeta,E=p.query,R=p.id,M=((o=(a=(i=v.dataCfg)===null||i===void 0?void 0:i.fields)===null||a===void 0?void 0:a.rows)===null||o===void 0?void 0:o.length)<=C,k=Zv(Array.from(b.keys())),L=nx(v,k,p,m),_=v.store.get("drillItemsNum");M&&_>0&&(L=L.slice(0,_)),C===0&&U7(v,m,L);try{for(var I=Wr(L),P=I.next();!P.done;P=I.next()){var U=P.value,q=U instanceof fs,Q=q?null:b.get(U),J=void 0,re=E,ne=!1,ce=!1;if(q){var me=U;ne=me.isGrandTotals,ce=me.isSubTotals,J=gr(U.label),re=E}else J=U,re=Y(Y({},E),(n={},n[m]=J,n));var oe=xl(R,J),Se=(s=v.options.style)===null||s===void 0?void 0:s.rowCell,Te=Se.collapseFields,Ie=Se.collapseAll,je=Se.expandDepth,Be=(l=Te==null?void 0:Te[oe])!==null&&l!==void 0?l:Te==null?void 0:Te[m],rt=Wn(je)?C>je:null,ut=(u=Be??rt)!==null&&u!==void 0?u:Ie,St=new pr({id:oe,value:J,level:C,parent:p,field:m,isTotals:q,isGrandTotals:ne,isSubTotals:ce,isCollapsed:ut,hierarchy:w,query:re,spreadsheet:v});C>w.maxLevel&&(w.maxLevel=C);var st=!(!((h=Q==null?void 0:Q.children)===null||h===void 0)&&h.size);(st||q)&&(St.isLeaf=!0),st||(St.isTotals=!0);var fr=Kv(v,p,St,w);!st&&!ut&&!q&&fr&&gb({level:C+1,currentField:Q.childField,pivotMeta:Q.children,parentNode:St,hierarchy:w,spreadsheet:v})}}catch(Pr){r={error:Pr}}finally{try{P&&!P.done&&(e=I.return)&&e.call(I)}finally{if(r)throw r.error}}},y0=function(t){var r=t.rootNode,e=t.hierarchy,n=t.fields,i=t.spreadsheet,a=ci(n,function(o){return o!==it});pb({spreadsheet:i,tree:a,level:0,parentNode:r,hierarchy:e})},mb=function(t){var r=t.isValueInCols,e=t.moreThanOneValue,n=t.rootNode,i=t.hierarchy,a=t.fields,o=t.isRowHeader,s=t.isCustomTreeFields,l=t.spreadsheet,u,h;o?(u=!r&&e,h=!r&&!e):(u=r&&e,h=r&&!e),s?y0(t):ox({spreadsheet:l,addTotalMeasureInTotal:u,addMeasureInTotalQuery:h,parentNode:n,currentField:a[0],fields:a,hierarchy:i})},V7=function(t){var r=t.spreadsheet,e=t.rootNode,n=t.hierarchy,i=t.isCustomTreeFields,a=r.dataSet.fields.rows;r.isHierarchyTreeType()&&!i?gb({level:0,currentField:a==null?void 0:a[0],pivotMeta:r.dataSet.rowPivotMeta,parentNode:e,hierarchy:n,spreadsheet:r}):y0(t)},X7=function(t){var r=t.spreadsheet;r.isHierarchyTreeType()?V7(t):mb(t)},Y7=function(t){var r,e=t.isCustomTreeFields,n=t.spreadsheet,i=(r=n.options.seriesNumber)!==null&&r!==void 0?r:{},a=i.enable,o=i.text;if(e){var s={field:Rn,title:jc(o)},l=a?pe([s],te(t.fields),!1):t.fields.filter(function(u){return(u==null?void 0:u.field)!==Rn});y0(Y(Y({},t),{fields:l}));return}fF(t)},$7=function(t){var r=t.spreadsheet,e=r.isPivotMode();e?mb(t):Y7(t)},Zd=function(t){var r=t.isRowHeader,e=t.spreadsheet,n=e.dataSet.fields,i=n.rows,a=i===void 0?[]:i,o=n.columns,s=o===void 0?[]:o,l=e.isValueInCols(),u=e.dataSet.moreThanOneValue(),h=pr.rootNode(),v=new rx,p=r?a:s,m=e.isCustomHeaderFields(r?"rows":"columns"),C={isValueInCols:l,moreThanOneValue:u,rootNode:h,hierarchy:v,spreadsheet:e,fields:p,isRowHeader:r,isCustomTreeFields:m};r?X7(C):$7(C);var w=function(){return r&&e.isHierarchyTreeType()?v.getNodes():v.getLeaves()};return{hierarchy:v,leafNodes:w()}},q7=function(t){Me(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.renderFrozenGroupSplitLine=function(n,i){var a;if((a=e.foregroundGroup.getElementById(hc))===null||a===void 0||a.remove(),e.enableFrozenFirstRow()){var o=xt(i-e.getPaginationScrollY()),s=e.foregroundGroup.appendChild(new Ft({id:hc,style:{zIndex:wl}})),l=e.spreadsheet.theme.splitLine,u={lineWidth:mc,stroke:l==null?void 0:l.horizontalBorderColor,opacity:l==null?void 0:l.horizontalBorderColorOpacity},h=e.getCellRange(),v=e.panelBBox.y+e.getTotalHeightForRange(h.start,h.start),p=e.cornerBBox.width+Un.getVerticalBorderWidth(e.spreadsheet)+e.panelBBox.viewportWidth;_r(s,Y(Y({},u),{x1:0,x2:p,y1:v,y2:v})),l.showShadow&&o>0&&s.appendChild(new Zt({style:{x:0,y:v,width:p,height:l==null?void 0:l.shadowWidth,fill:e.getShadowFill(90)}}))}},e}return Object.defineProperty(r.prototype,"rowCellTheme",{get:function(){return this.spreadsheet.theme.rowCell.cell},enumerable:!1,configurable:!0}),r.prototype.doLayout=function(){var e=this.buildAllHeaderHierarchy(),n=e.rowLeafNodes,i=e.colLeafNodes,a=e.rowsHierarchy,o=e.colsHierarchy;return this.calculateHeaderNodesCoordinate({rowLeafNodes:n,rowsHierarchy:a,colLeafNodes:i,colsHierarchy:o}),{colNodes:o.getNodes(),colsHierarchy:o,rowNodes:a.getNodes(),rowsHierarchy:a,rowLeafNodes:n,colLeafNodes:i}},r.prototype.buildAllHeaderHierarchy=function(){var e=Zd({isRowHeader:!0,spreadsheet:this.spreadsheet}),n=e.leafNodes,i=e.hierarchy,a=Zd({isRowHeader:!1,spreadsheet:this.spreadsheet}),o=a.leafNodes,s=a.hierarchy;return{rowLeafNodes:n,colLeafNodes:o,rowsHierarchy:i,colsHierarchy:s}},r.prototype.getCellMeta=function(e,n){var i,a,o,s,l,u,h;e===void 0&&(e=0),n===void 0&&(n=0);var v=this.spreadsheet,p=v.options,m=v.dataSet,C=this.getLayoutResult(),w=C.rowLeafNodes,b=C.colLeafNodes,E=w[e],R=b[n];if(!E||!R)return null;var M=E.query,k=R.query,L=E.isTotals||E.isTotalMeasure||R.isTotals||R.isTotalMeasure,_=(s=(o=(a=p.style)===null||a===void 0?void 0:a.colCell)===null||o===void 0?void 0:o.hideValue)!==null&&s!==void 0?s:!1,I=_?(i={},i[it]=(l=m.fields.values)===null||l===void 0?void 0:l[0],i):{},P=Wl({},M,k,I),U=m.getCellData({query:P,rowNode:E,isTotals:L}),q=P[it],Q=dt(U,sa,null),J={spreadsheet:this.spreadsheet,x:R.x,y:E.y,width:R.width,height:E.height,data:U,rowIndex:e,colIndex:n,isTotals:L,valueField:q,fieldValue:Q,rowQuery:M,colQuery:k,rowId:E.id,colId:R.id,id:ef(E.id,R.id)};return(h=(u=p.layoutCellMeta)===null||u===void 0?void 0:u.call(p,J))!==null&&h!==void 0?h:J},r.prototype.getPreLevelSampleNode=function(e,n){return n.getNodes(e.level-1).find(function(i){return!i.isTotals})},r.prototype.calculateHeaderNodesCoordinate=function(e){this.calculateRowNodesCoordinate(e),this.calculateColNodesCoordinate(e)},r.prototype.calculateColNodesCoordinate=function(e){var n=this,i,a=e.rowLeafNodes,o=e.colLeafNodes,s=e.rowsHierarchy,l=e.colsHierarchy;this.updateColsHierarchySampleMaxHeightNodes(l);var u=pr.blankNode(),h=0,v=l.getNodes();v.forEach(function(p){var m;if(p.isLeaf&&(p.colIndex=h,h+=1,p.x=u.x+u.width,p.width=n.calculateColLeafNodesWidth(p,o,a,s.width),l.width+=p.width,u=p),p.level===0)p.y=0;else{var C=n.getPreLevelSampleNode(p,l);p.y=(m=(C==null?void 0:C.y)+(C==null?void 0:C.height))!==null&&m!==void 0?m:0}var w=n.getColNodeHeight(p,l);p.height=p.isGrandTotals&&!p.isTotalMeasure&&p.isLeaf?l.height:w,Od(n.spreadsheet,null,p)}),this.updateCustomFieldsSampleNodes(l),this.adjustColLeafNodesHeight({leafNodes:o,hierarchy:l}),this.autoCalculateColNodeWidthAndX(o),ke((i=this.spreadsheet.options.totals)===null||i===void 0?void 0:i.col)||(this.adjustTotalNodesCoordinate({hierarchy:l,isRowHeader:!1,isSubTotal:!0}),this.adjustTotalNodesCoordinate({hierarchy:l,isRowHeader:!1,isSubTotal:!1}))},r.prototype.getMultipleMap=function(e,n,i){for(var a=e.maxLevel,o=this.spreadsheet.dataSet,s=this.spreadsheet.options.totals,l=o.moreThanOneValue(),u=o.fields,h=u.rows,v=u.columns,p=n?h:v,m=n?s.row:s.col,C=i?(m==null?void 0:m.subTotalsGroupDimensions)||[]:(m==null?void 0:m.grandTotalsGroupDimensions)||[],w=Array.from({length:a+1},function(){return 1}),b=a;b>0;b--){var E=p[b],R=E===it&&l;C.includes(E)||R||(w[b-1]+=w[b],w[b]=0)}return w},r.prototype.adjustTotalNodesCoordinate=function(e){var n=e.hierarchy,i=e.isRowHeader,a=e.isSubTotal,o=this.getMultipleMap(n,i,a),s=ci(n.getNodes(),function(u){return a?u.isSubTotals:u.isGrandTotals}),l=i?"width":"height";tt(s,function(u){var h,v=o[u.level];if(!v&&a)for(var p=1;v<1;)v=o[u.level-p]-p,p++;for(var m=0,C=function(b){m+=dt((h=n.sampleNodesForAllLevels)===null||h===void 0?void 0:h.find(function(E){return E.level===u.level+b}),[l],0)},w=0;w<v;w++)C(w);u[l]=m})},r.prototype.autoCalculateColNodeWidthAndX=function(e){for(var n,i,a=null,o=0,s=e.slice(0);o<s.length;){var l=s[o++],u=l==null?void 0:l.parent;if(a!==u&&u){s.push(u);var h=(n=u.children)===null||n===void 0?void 0:n.find(function(m){return m.width}),v=(i=h==null?void 0:h.x)!==null&&i!==void 0?i:0,p=co(u.children,"width");u.x=v,u.width=p,a=u}}},r.prototype.calculateColLeafNodesWidth=function(e,n,i,a){var o=this.spreadsheet.options.style.colCell,s=this.getColCellDraggedWidth(e);if(Wn(s))return s;var l=this.getCellCustomSize(e,o==null?void 0:o.width);return Wn(l)?l:this.spreadsheet.getLayoutWidthType()===Na.Compact?this.getCompactGridColNodeWidth(e,i):this.spreadsheet.isHierarchyTreeType()?this.getAdaptTreeColWidth(e,n,i):this.getAdaptGridColWidth(n,a)},r.prototype.getRowNodeHeight=function(e){var n=new lf(e,this.spreadsheet,{shallowRender:!0}),i=this.getRowCellHeight(e);return this.getCellAdaptiveHeight(n,i)},r.prototype.getColNodeHeight=function(e,n){if(!e)return 0;var i=new $l(e,this.spreadsheet,{shallowRender:!0}),a=this.getDefaultColNodeHeight(e,n);return this.getCellAdaptiveHeight(i,a)},r.prototype.getExpectedCellIconWidth=function(e,n,i){var a,o,s,l=0;if(n)l=1;else{var u=ct(this.spreadsheet.options.headerActionIcons,function(v){return Y(Y({},v),{displayCondition:function(){return!0}})}),h=Jv(u,null,e);l=(a=h==null?void 0:h.icons.length)!==null&&a!==void 0?a:0}return l?l*(i.size+((o=i.margin)===null||o===void 0?void 0:o.left))+((s=i.margin)===null||s===void 0?void 0:s.right):0},r.prototype.calculateRowNodesCoordinate=function(e){var n=this,i,a,o,s,l=e.rowsHierarchy,u=e.rowLeafNodes,h=e.colLeafNodes,v=this.spreadsheet.isHierarchyTreeType(),p=l.sampleNodesForAllLevels||[];v?l.width=this.getTreeRowHeaderWidth():p.forEach(function(I){var P;I.width=n.calculateGridRowNodesWidth(I,h),l.width+=I.width;var U=(P=p[I.level-1])!==null&&P!==void 0?P:{x:0,width:0};I.x=(U==null?void 0:U.x)+(U==null?void 0:U.width)});for(var m=pr.blankNode(),C=l.getNodes(),w=0;w<C.length;w++){var b=C[w],E=v||!v&&b.isLeaf;if(E){var R=((i=m==null?void 0:m.rowIndex)!==null&&i!==void 0?i:-1)+1,M=pr.getBranchNodes(b).map(function(I){return n.getRowNodeHeight(I)}),k=uo(M)||this.getRowNodeHeight(b);(a=b.rowIndex)!==null&&a!==void 0||(b.rowIndex=R),(o=b.colIndex)!==null&&o!==void 0||(b.colIndex=w),b.y=m.y+m.height,b.height=k,m=b,l.height+=b.height}if(v||b.level===0)b.x=0;else{var L=p[b.level-1];b.x=(L==null?void 0:L.x)+(L==null?void 0:L.width)}if(v)b.width=this.getTreeRowHeaderWidth();else{var _=p[b.level];b.width=_==null?void 0:_.width}Od(this.spreadsheet,b,null)}v||(this.adjustRowLeafNodesWidth({leafNodes:u,hierarchy:l}),this.autoCalculateRowNodeHeightAndY(u),ke((s=this.spreadsheet.options.totals)===null||s===void 0?void 0:s.row)||(this.adjustTotalNodesCoordinate({hierarchy:l,isRowHeader:!0,isSubTotal:!1}),this.adjustTotalNodesCoordinate({hierarchy:l,isRowHeader:!0,isSubTotal:!0})))},r.prototype.autoCalculateRowNodeHeightAndY=function(e){for(var n=null,i=0,a=e.slice(0);i<a.length;){var o=a[i++],s=o==null?void 0:o.parent;n!==s&&s&&(a.push(s),s.y=s.children[0].y,s.height=co(s.children,"height"),n=s)}},r.prototype.calculateGridRowNodesWidth=function(e,n){var i=this.spreadsheet.options.style.rowCell,a=this.getRowCellDraggedWidth(e);if(Wn(a))return a;var o=this.getCellCustomSize(e,i==null?void 0:i.width);return Wn(o)?o:this.spreadsheet.getLayoutWidthType()!==Na.Adaptive?this.getCompactGridRowNodeWidth(e):this.getAdaptGridColWidth(n)},r.prototype.getAdaptTreeColWidth=function(e,n,i){var a=this.getCanvasSize().width,o=a-this.getSeriesNumberWidth()-Un.getVerticalBorderWidth(this.spreadsheet),s=Math.min(o/2,this.getTreeRowHeaderWidth()),l=Math.max(1,n.length),u=this.spreadsheet.options.style.dataCell;return Math.max(Oh(u,this.getColLabelLength(e,i)),xt((o-s)/l))},r.prototype.getColLabelLength=function(e,n){var i=hF(e==null?void 0:e.value);if(vt(i))return i.length;for(var a=1,o=0;o<Mh;o++){var s=n[o];if(!s)return a;for(var l=this.spreadsheet.dataSet.getCellData({query:Y(Y({},e.query),s.query),rowNode:s,isTotals:e.isTotals||e.isTotalMeasure||s.isTotals||s.isTotalMeasure}),u=pn(l),h=0;h<u.length;h++){var v=dt(l,u[h]),p=Wo(dt(v==null?void 0:v.values,"0"));p>a&&(a=p)}}return a},r.prototype.getAdaptGridColWidth=function(e,n){var i=this.spreadsheet.dataSet.fields.rows,a=i===void 0?[]:i,o=this.spreadsheet.options.style.dataCell,s=a.length,l=e.length,u=this.getCanvasSize().width,h=u-this.getSeriesNumberWidth()-Un.getVerticalBorderWidth(this.spreadsheet),v=Math.max(1,s+l);return n?Math.max(Oh(o),xt((h-n)/l)):Math.max(Oh(o),xt(h/v))},r.prototype.getTreeRowHeaderWidth=function(){var e=this,n,i,a,o,s=this.spreadsheet.options.style.rowCell,l=this.spreadsheet.dataSet.fields.rows,u=l===void 0?[]:l,h=this.getCellCustomSize(null,s==null?void 0:s.width);if(Wn(h))return h;var v=u.map(function(E){return e.spreadsheet.dataSet.getFieldName(E)}).join("/"),p=this.spreadsheet.theme.cornerCell,m=p.bolderText,C=p.icon,w=this.spreadsheet.measureTextWidth(v,m)+C.size*2+((n=C.margin)===null||n===void 0?void 0:n.left)+((i=C.margin)===null||i===void 0?void 0:i.right)+((a=this.rowCellTheme.padding)===null||a===void 0?void 0:a.left)+((o=this.rowCellTheme.padding)===null||o===void 0?void 0:o.right)+1,b=Math.max(h??g1,w);return Number.isNaN(b)?g1:b},r.prototype.getCompactGridRowNodeWidth=function(e){var n=this,i,a=this.spreadsheet.theme.rowCell,o=a.bolderText,s=a.icon,l=a.cell,u=this.spreadsheet.theme.cornerCell,h=u.bolderText,v=u.icon,p=u.cell,m=e.field,C=e.isLeaf,w=this.getExpectedCellIconWidth(Le.ROW_CELL,!this.spreadsheet.isValueInCols()&&C&&this.spreadsheet.options.showDefaultHeaderActionIcon,s),b=(i=this.spreadsheet.dataSet.getDimensionValues(m))===null||i===void 0?void 0:i.slice(0,Mh).map(function(_){var I,P;return(P=(I=n.spreadsheet.dataSet.getFieldFormatter(m))===null||I===void 0?void 0:I(_))!==null&&P!==void 0?P:_}),E=Gv(b,function(_){return"".concat(_).length}),R=this.spreadsheet.measureTextWidth(E,o)+w+l.padding.left+l.padding.right+l.verticalBorderWidth,M=this.spreadsheet.dataSet.getFieldName(m),k=this.getExpectedCellIconWidth(Le.CORNER_CELL,!1,v),L=this.spreadsheet.measureTextWidth(M,h)+k+p.padding.left+p.padding.right;return Li.getInstance().logger("Max Label In Row:",m,R>L?E:M),Math.max(R,L)},r.prototype.getCompactGridColNodeWidth=function(e,n){for(var i,a,o,s=this.spreadsheet.theme.colCell,l=s.bolderText,u=s.cell,h=s.icon,v=this.spreadsheet.theme.dataCell.text,p=this.spreadsheet.dataSet.getFieldFormatter(e.field),m=(i=p==null?void 0:p(e.value))!==null&&i!==void 0?i:e.value,C=this.getExpectedCellIconWidth(Le.COL_CELL,this.spreadsheet.isValueInCols()&&this.spreadsheet.options.showDefaultHeaderActionIcon,h),w=this.spreadsheet.measureTextWidthRoughly(m)+C,b="",E=0,R=0;R<Mh;R++){var M=n[R];if(M){var k=this.spreadsheet.dataSet.getCellData({query:Y(Y({},e.query),M.query),rowNode:M,isTotals:e.isTotals||e.isTotalMeasure||M.isTotals||M.isTotalMeasure});if(k){var L=k==null?void 0:k[sa],_=(o=(a=this.spreadsheet.dataSet.getFieldFormatter(k[it]))===null||a===void 0?void 0:a(L))!==null&&o!==void 0?o:L,I="".concat(_),P=this.spreadsheet.measureTextWidthRoughly(I);P>E&&(b=I,E=P)}}}var U=w>E,q=U?m:b,Q=U?C:0;Li.getInstance().logger("Max Label In Col:",e.field,q,E);var J=this.spreadsheet.measureTextWidth(q,Y(Y({},l),{fontSize:Math.max(v.fontSize,l.fontSize)}));return J+u.padding.left+u.padding.right+u.verticalBorderWidth*2+Q},r.prototype.getViewCellHeights=function(){var e=this.getRowLeafNodes(),n=Pw(e,function(i,a){var o=mr(i)||0;return i.push(o+a.height),i},[0]);return{getTotalHeight:function(){return mr(n)||0},getCellOffsetY:function(i){return n[i]||0},getTotalLength:function(){return n.length-1},getIndexRange:function(i,a){return ub(n,i,a)}}},r.prototype.getSeriesNumberCells=function(){var e;return ci((e=this.getSeriesNumberHeader())===null||e===void 0?void 0:e.children,function(n){return n instanceof c0})},r.prototype.updateFrozenGroupGrid=function(){var e=this;[Bt.FROZEN_ROW].forEach(function(n){if(e.frozenGroupInfo[n].range){var i=[],a=[];if(n.toLowerCase().includes("row")){var o=te(e.frozenGroupInfo[n].range||[],2),s=o[0],l=o[1];i=e.gridInfo.cols,a=cf(s,l,e.viewCellHeights)}e["".concat(n,"Group")].updateGrid({cols:i,rows:a},"".concat(n,"Group"))}})},r.prototype.getFrozenOptions=function(){return Lx(this.spreadsheet.options,this.layoutResult.rowNodes)},r.prototype.enableFrozenFirstRow=function(){return!!this.getFrozenOptions().rowCount},r}(vb),K7=function(t,r,e,n){var i,a,o=n==null?void 0:n.size,s=n==null?void 0:n.margin,l=0;return t.options.showDefaultHeaderActionIcon?l=1:l=(a=(i=Jv(t.options.headerActionIcons,r,e))===null||i===void 0?void 0:i.icons.length)!==null&&a!==void 0?a:0,l*(o+s.left)+(l>0?s.right:0)},Z7=function(t,r,e){var n,i,a,o,s=((i=(n=e.icon)===null||n===void 0?void 0:n.margin)===null||i===void 0?void 0:i.left)||0,l=((o=(a=e.icon)===null||a===void 0?void 0:a.margin)===null||o===void 0?void 0:o.right)||0,u=t.store.get("hiddenColumnsDetail",[]),h=!1,v=!1;u.forEach(function(m){var C,w,b,E;((w=(C=m==null?void 0:m.displaySiblingNode)===null||C===void 0?void 0:C.prev)===null||w===void 0?void 0:w.field)===r&&(h=!0),((E=(b=m==null?void 0:m.displaySiblingNode)===null||b===void 0?void 0:b.next)===null||E===void 0?void 0:E.field)===r&&(v=!0)});var p=dt(e,"icon.size");return{left:v?p+l:0,right:h?p+s:0}},j7=function(t,r,e){var n,i,a=dt(e,"cell.padding"),o=(i=(n=e==null?void 0:e.cell)===null||n===void 0?void 0:n.horizontalBorderWidth)!==null&&i!==void 0?i:1,s=Z7(t,r.field,e),l=K7(t,r,Le.COL_CELL,e==null?void 0:e.icon);return a.left+a.right+l+s.left+s.right+o},J7=function(t){Me(r,t);function r(e){var n=t.call(this,e)||this;return n.getScrollGroupClipBBox=function(){var i=n.getHeaderConfig(),a=i.width,o=i.height,s=i.spreadsheet,l=i.position,u=s.facet.frozenGroupInfo,h=u[Bt.FROZEN_COL].width,v=u[Bt.FROZEN_TRAILING_COL].width,p=a-h-v;return{x:l.x+h,y:l.y,width:p,height:o}},n.initFrozenColGroups(),n}return r.prototype.getCellInstance=function(e){var n=this.getHeaderConfig(),i=n.spreadsheet,a=i.options,o=a.seriesNumberCell,s=a.colCell,l=[e,i,n];return e.field===Rn?(o==null?void 0:o.apply(void 0,pe([],te(l),!1)))||new(U1.bind.apply(U1,pe([void 0],te(l),!1))):(s==null?void 0:s.apply(void 0,pe([],te(l),!1)))||new(Rc.bind.apply(Rc,pe([void 0],te(l),!1)))},r.prototype.initFrozenColGroups=function(){var e=this.getHeaderConfig(),n=e.spreadsheet.options.frozen,i=n.colCount,a=n.trailingColCount,o=e.spreadsheet.facet.getColNodes(0),s=wc(o,i,a),l=s.colCount,u=s.trailingColCount;this.finalColCount=l,this.finalTrailingColCount=u,this.topLevelColNodeLength=o.length,l&&(this.frozenColGroup=this.appendChild(new Ft({name:CB,style:{zIndex:wl}}))),u&&(this.frozenTrailingColGroup=this.appendChild(new Ft({name:wB,style:{zIndex:wl}})))},r.prototype.clear=function(){var e,n,i;t.prototype.clear.call(this),(e=this.frozenTrailingColGroup)===null||e===void 0||e.removeChildren(),(n=this.frozenColGroup)===null||n===void 0||n.removeChildren();var a=this.getHeaderConfig().spreadsheet,o=(i=a.facet)===null||i===void 0?void 0:i.foregroundGroup.getElementById(Gw);o==null||o.removeChildren()},r.prototype.getColFrozenOptionsByNode=function(e){var n=Rx(e);return{colLength:this.topLevelColNodeLength,leftLeafNodeColIndex:n.colIndex,colCount:this.finalColCount,trailingColCount:this.finalTrailingColCount}},r.prototype.getCellGroup=function(e){var n=this.getColFrozenOptionsByNode(e),i=n.colLength,a=n.leftLeafNodeColIndex,o=n.colCount,s=n.trailingColCount;return El(a,o)?this.frozenColGroup:Tl(a,s,i)?this.frozenTrailingColGroup:this.scrollGroup},r.prototype.isColCellInRect=function(e){var n=this.getColFrozenOptionsByNode(e),i=n.leftLeafNodeColIndex,a=n.colLength,o=n.colCount,s=n.trailingColCount;return El(i,o)||Tl(i,s,a)?!0:t.prototype.isColCellInRect.call(this,e)},r.prototype.offset=function(){t.prototype.offset.call(this);var e=this.getHeaderConfig().position;Cc(this.frozenColGroup,e.x),Cc(this.frozenTrailingColGroup,e.x)},r.prototype.clip=function(){this.scrollGroup.style.clipPath=new Zt({style:this.getScrollGroupClipBBox()})},r}(Mx),Q7=function(t){Me(r,t);function r(e){var n=t.call(this,e)||this;return n.onSortHandler=function(i){var a=n.spreadsheet,o=i;Array.isArray(i)||(o=[i]);var s=a.dataCfg.sortParams||[];o=o.map(function(u){var h,v,p=Y(Y({},u),{sortFieldId:(h=u.sortKey)!==null&&h!==void 0?h:u.sortFieldId}),m=(v=s.find(function(C){return C.sortFieldId===p.sortFieldId}))!==null&&v!==void 0?v:{};return Y(Y({},m),p)});var l=s.filter(function(u){var h=o.find(function(v){return v.sortFieldId===u.sortFieldId});return!h});wd(a.dataCfg,"sortParams",pe(pe([],te(l),!1),te(o),!1)),a.setDataCfg(a.dataCfg),a.render(!0),a.emit(se.RANGE_SORTED,a.dataSet.getDisplayDataSet())},n.onFilterHandler=function(i){return Ar(n,void 0,void 0,function(){var a,o,s,l;return Nr(this,function(u){switch(u.label){case 0:return a=this.spreadsheet,o=!i.filteredValues||i.filteredValues.length===0,s=a.dataCfg.filterParams||[],l=s.findIndex(function(h){return h.filterKey===i.filterKey}),l!==-1?o?s.splice(l,1):s[l]=i:s.push(i),wd(a.dataCfg,"filterParams",s),[4,a.render(!0)];case 1:return u.sent(),a.emit(se.RANGE_FILTERED,a.dataSet.getDisplayDataSet()),[2]}})})},n.spreadsheet.on(se.RANGE_SORT,n.onSortHandler),n.spreadsheet.on(se.RANGE_FILTER,n.onFilterHandler),n}return r.prototype.init=function(){t.prototype.init.call(this),this.initRowOffsets()},r.prototype.getDataCellAdaptiveHeight=function(e){var n=new Lc(e,this.spreadsheet,{shallowRender:!0}),i=this.getDefaultCellHeight();return this.getCellAdaptiveHeight(n,i)},r.prototype.getCellHeightByRowIndex=function(e){return this.rowOffsets?this.getRowCellHeight({id:String(e)}):this.getDefaultCellHeight()},r.prototype.presetRowCellHeightIfNeeded=function(e){var n,i=this,a,o=this.spreadsheet.options.style,s=this.getColLeafNodes();if(!(ke(s)||((a=o==null?void 0:o.dataCell)===null||a===void 0?void 0:a.maxLines)<=1)){var l=uo(s.map(function(u){var h=i.getCellMeta(e,u.colIndex);return i.getDataCellAdaptiveHeight(h)}));this.spreadsheet.setOptions({style:{rowCell:{heightByField:(n={},n[e]=l||this.getDefaultCellHeight(),n)}}})}},r.prototype.initRowOffsets=function(){var e=this,n,i,a=this.spreadsheet.options.style,o=(n=a==null?void 0:a.rowCell)===null||n===void 0?void 0:n.heightByField;if(pn(o).length||((i=a==null?void 0:a.dataCell)===null||i===void 0?void 0:i.maxLines)>1){var s=this.spreadsheet.dataSet.getDisplayDataSet();this.rowOffsets=[0];var l=0;s.forEach(function(u,h){e.presetRowCellHeightIfNeeded(h);var v=e.getCellHeightByRowIndex(h),p=l+v;e.rowOffsets.push(p),l=p})}},r.prototype.destroy=function(){t.prototype.destroy.call(this),this.spreadsheet.off(se.RANGE_SORT,this.onSortHandler),this.spreadsheet.off(se.RANGE_FILTER,this.onFilterHandler)},r.prototype.calculateCornerBBox=function(){var e=this.getLayoutResult().colsHierarchy,n=xt(e.height);this.cornerBBox=new hb(this),this.cornerBBox.height=n,this.cornerBBox.maxY=n},r.prototype.doLayout=function(){var e=new rx,n=this.buildColHeaderHierarchy(),i=n.colLeafNodes,a=n.colsHierarchy;return this.calculateColNodesCoordinate(i,a),{colNodes:a.getNodes(),colLeafNodes:i,colsHierarchy:a,rowNodes:[],rowsHierarchy:e,rowLeafNodes:[],cornerNodes:[]}},r.prototype.buildColHeaderHierarchy=function(){var e=Zd({isRowHeader:!1,spreadsheet:this.spreadsheet});return{colLeafNodes:e.leafNodes,colsHierarchy:e.hierarchy}},r.prototype.getCellMeta=function(e,n){var i,a,o,s;e===void 0&&(e=0),n===void 0&&(n=0);var l=this.spreadsheet,u=l.options,h=l.dataSet,v=this.getColLeafNodes(),p=v[n];if(!p)return null;var m=this.getCellHeightByRowIndex(e),C=this.getCellRange(),w=bl(this.spreadsheet.options.frozen,v.length,C.end-C.start+1).trailingRowCount,b=w===void 0?0:w,E,R=p.x,M=this.viewCellHeights.getCellOffsetY(e);Vl(e,C.end,b)&&(M=this.panelBBox.height-this.getTotalHeightForRange(e,C.end)),!((a=u.seriesNumber)===null||a===void 0)&&a.enable&&p.field===Rn?E=e+1:E=h.getCellData({query:{field:p.field,rowIndex:e}});var k={spreadsheet:this.spreadsheet,x:R,y:M,width:p.width,height:m,data:(i={},i[p.field]=E,i),rowIndex:e,colIndex:n,isTotals:!1,colId:p.id,rowId:String(e),valueField:p.field,fieldValue:E,id:ef(String(e),p.id)};return(s=(o=u.layoutCellMeta)===null||o===void 0?void 0:o.call(u,k))!==null&&s!==void 0?s:k},r.prototype.getAdaptiveColWidth=function(e){var n,i=this.spreadsheet.options.style.dataCell,a=this.spreadsheet.options.seriesNumber;if(this.spreadsheet.getLayoutWidthType()!==Na.Compact){var o=this.getSeriesNumberWidth(),s=e.length-(a!=null&&a.enable?1:0),l=this.getCanvasSize().width-o-Un.getVerticalBorderWidth(this.spreadsheet);return Math.max(i==null?void 0:i.width,xt(l/Math.max(1,s)))}return(n=i==null?void 0:i.width)!==null&&n!==void 0?n:0},r.prototype.getContentHeight=function(){var e=this.getViewCellHeights().getTotalHeight,n=this.layoutResult.colsHierarchy;return e()+n.height},r.prototype.getColNodeHeight=function(e,n){var i=new Rc(e,this.spreadsheet,{shallowRender:!0}),a=this.getDefaultColNodeHeight(e,n);return this.getCellAdaptiveHeight(i,a)},r.prototype.calculateColNodesCoordinate=function(e,n){var i,a,o;this.updateColsHierarchySampleMaxHeightNodes(n);for(var s=pr.blankNode(),l=0,u=n.getNodes(),h=this.getAdaptiveColWidth(e),v=0;v<u.length;v++){var p=u[v];p.isLeaf&&(p.colIndex=l,l+=1,p.x=s.x+s.width,p.width=this.calculateColLeafNodesWidth(p,h),Od(this.spreadsheet,null,p),n.width+=p.width,s=p),p.level===0?p.y=0:p.y=(o=((i=p==null?void 0:p.parent)===null||i===void 0?void 0:i.y)+((a=p==null?void 0:p.parent)===null||a===void 0?void 0:a.height))!==null&&o!==void 0?o:0,p.height=this.getColNodeHeight(p,n)}var m=n.getNodes(0),C=bl(this.spreadsheet.options.frozen,m.length).trailingColCount,w=C===void 0?0:C;s=pr.blankNode();var b=this.getCanvasSize().width-Un.getVerticalBorderWidth(this.spreadsheet);if(w>0)for(var E=wc(m,0,w).trailingColCount,R=u.filter(function(M){return M.isLeaf}),v=1;v<=E;v++){var p=R[R.length-v];v===1?p.x=b-p.width:p.x=s.x-p.width,s=p}this.updateCustomFieldsSampleNodes(n),this.adjustColLeafNodesHeight({leafNodes:e,hierarchy:n}),this.autoCalculateColNodeWidthAndX(e)},r.prototype.autoCalculateColNodeWidthAndX=function(e){for(var n=null,i=e.slice(0);i.length;){var a=i.shift(),o=a==null?void 0:a.parent;n!==o&&o&&(i.push(o),o.x=o.children[0].x,o.width=o.children.map(function(s){return s.width}).reduce(function(s,l){return s+l},0),n=o)}},r.prototype.calculateColLeafNodesWidth=function(e,n){var i=this.spreadsheet,a=i.dataSet,o=i.options.style.colCell,s=i.getLayoutWidthType(),l=this.getColCellDraggedWidth(e);if(Wn(l))return l;var u=this.getCellCustomSize(e,o==null?void 0:o.width);if(Wn(u))return u;var h;if(s===Na.Compact){var v=a.getDisplayDataSet(),p=a.getFieldFormatter(e.field),m=Gv(v==null?void 0:v.slice(0,50).map(function(L){var _;return"".concat((_=p==null?void 0:p(L[e.field]))!==null&&_!==void 0?_:L[e.field])}),function(L){return i.measureTextWidthRoughly(L)});Li.getInstance().logger("Max Label In Col:",e.field,m);var C=i.theme.colCell.bolderText,w=i.theme.dataCell,b=w.text,E=w.cell,R=1,M=i.measureTextWidth(m,b)+E.padding.left+E.padding.right+R,k=i.measureTextWidth(e.value,C)+j7(this.spreadsheet,e,i.theme.colCell);h=Math.max(k,M)}else h=n;return e.field===Rn&&(h=this.getSeriesNumberWidth()),h},r.prototype.getViewCellHeights=function(){var e=this,n=this.getDefaultCellHeight();return{getTotalHeight:function(){return e.rowOffsets?mr(e.rowOffsets)||0:n*e.spreadsheet.dataSet.getDisplayDataSet().length},getCellOffsetY:function(i){return i<=0?0:e.rowOffsets?e.rowOffsets[i]:i*n},getTotalLength:function(){return e.spreadsheet.dataSet.getDisplayDataSet().length},getIndexRange:function(i,a){if(e.rowOffsets)return ub(e.rowOffsets,i,a);var o=xt(i/n,0),s=a%n===0?a/n-1:xt(a/n,0);return{start:Math.max(0,o),end:Math.max(0,s)}}}},r.prototype.updateRowResizeArea=function(){var e=this.spreadsheet.options.interaction.resize,n=na(e)?e:e==null?void 0:e.rowCellVertical;if(n){var i=this.foregroundGroup.getElementById(ss),a=this.foregroundGroup.getElementById(bd);i&&i.removeChildren(),a&&a.removeChildren();var o=nl(this.panelGroup.children,Lc);o.forEach(function(s){s.drawResizeArea()})}},r.prototype.getRowHeader=function(){return null},r.prototype.getColHeader=function(){if(!this.columnHeader){var e=this.panelBBox,n=e.x,i=e.width,a=e.viewportHeight,o=e.viewportWidth;return new J7({width:i,height:this.cornerBBox.height,viewportWidth:o,viewportHeight:a,cornerWidth:this.cornerBBox.width,position:{x:n,y:0},nodes:this.getColNodes(),sortParam:this.spreadsheet.store.get("sortParam"),spreadsheet:this.spreadsheet})}return this.columnHeader},r.prototype.getSeriesNumberHeader=function(){return null},r.prototype.getSeriesNumberCells=function(){return this.getDataCells().filter(function(e){return e.getMeta().valueField===Rn})},r}(vb);function eH(t,r){var e=r.r;t.arc(e,e,e,0,Math.PI*2,!1)}function tH(t,r){var e=r.rx,n=r.ry,i=e,a=n;if(t.ellipse)t.ellipse(i,a,i,a,0,0,Math.PI*2,!1);else{var o=i>a?i:a,s=i>a?1:i/a,l=i>a?a/i:1;t.save(),t.scale(s,l),t.arc(o,o,o,0,Math.PI*2)}}function rH(t,r){var e=r.x1,n=r.y1,i=r.x2,a=r.y2,o=r.defX,s=o===void 0?0:o,l=r.defY,u=l===void 0?0:l,h=r.markerStart,v=r.markerEnd,p=r.markerStartOffset,m=r.markerEndOffset,C=0,w=0,b=0,E=0,R=0,M,k;h&&pt(h)&&p&&(M=i-e,k=a-n,R=Math.atan2(k,M),C=Math.cos(R)*(p||0),w=Math.sin(R)*(p||0)),v&&pt(v)&&m&&(M=e-i,k=n-a,R=Math.atan2(k,M),b=Math.cos(R)*(m||0),E=Math.sin(R)*(m||0)),t.moveTo(e-s+C,n-u+w),t.lineTo(i-s+b,a-u+E)}function nH(t,r){var e=r.defX,n=e===void 0?0:e,i=r.defY,a=i===void 0?0:i,o=r.markerStart,s=r.markerEnd,l=r.markerStartOffset,u=r.markerEndOffset,h=r.path,v=h.absolutePath,p=h.segments,m=0,C=0,w=0,b=0,E=0,R,M;if(o&&pt(o)&&l){var k=te(o.parentNode.getStartTangent(),2),L=k[0],_=k[1];R=L[0]-_[0],M=L[1]-_[1],E=Math.atan2(M,R),m=Math.cos(E)*(l||0),C=Math.sin(E)*(l||0)}if(s&&pt(s)&&u){var I=te(s.parentNode.getEndTangent(),2),L=I[0],_=I[1];R=L[0]-_[0],M=L[1]-_[1],E=Math.atan2(M,R),w=Math.cos(E)*(u||0),b=Math.sin(E)*(u||0)}for(var P=0;P<v.length;P++){var U=v[P],q=U[0],Q=v[P+1],J=P===0&&(m!==0||C!==0),re=(P===v.length-1||Q&&(Q[0]==="M"||Q[0]==="Z"))&&w!==0&&b!==0;switch(q){case"M":J?(t.moveTo(U[1]-n+m,U[2]-a+C),t.lineTo(U[1]-n,U[2]-a)):t.moveTo(U[1]-n,U[2]-a);break;case"L":re?t.lineTo(U[1]-n+w,U[2]-a+b):t.lineTo(U[1]-n,U[2]-a);break;case"Q":t.quadraticCurveTo(U[1]-n,U[2]-a,U[3]-n,U[4]-a),re&&t.lineTo(U[3]-n+w,U[4]-a+b);break;case"C":t.bezierCurveTo(U[1]-n,U[2]-a,U[3]-n,U[4]-a,U[5]-n,U[6]-a),re&&t.lineTo(U[5]-n+w,U[6]-a+b);break;case"A":{var ne=p[P].arcParams,ce=ne.cx,me=ne.cy,oe=ne.rx,Se=ne.ry,Te=ne.startAngle,Ie=ne.endAngle,je=ne.xRotation,Be=ne.sweepFlag;if(t.ellipse)t.ellipse(ce-n,me-a,oe,Se,je,Te,Ie,!!(1-Be));else{var rt=oe>Se?oe:Se,ut=oe>Se?1:oe/Se,St=oe>Se?Se/oe:1;t.translate(ce-n,me-a),t.rotate(je),t.scale(ut,St),t.arc(0,0,rt,Te,Ie,!!(1-Be)),t.scale(1/ut,1/St),t.rotate(-je),t.translate(-(ce-n),-(me-a))}re&&t.lineTo(U[6]-n+w,U[7]-a+b);break}case"Z":t.closePath();break}}}function iH(t,r){var e=r.defX,n=e===void 0?0:e,i=r.defY,a=i===void 0?0:i,o=r.markerStart,s=r.markerEnd,l=r.markerStartOffset,u=r.markerEndOffset,h=r.points.points,v=h.length,p=h[0][0]-n,m=h[0][1]-a,C=h[v-1][0]-n,w=h[v-1][1]-a,b=0,E=0,R=0,M=0,k=0,L,_;o&&pt(o)&&l&&(L=h[1][0]-h[0][0],_=h[1][1]-h[0][1],k=Math.atan2(_,L),b=Math.cos(k)*(l||0),E=Math.sin(k)*(l||0)),s&&pt(s)&&u&&(L=h[v-1][0]-h[0][0],_=h[v-1][1]-h[0][1],k=Math.atan2(_,L),R=Math.cos(k)*(u||0),M=Math.sin(k)*(u||0)),t.moveTo(p+(b||R),m+(E||M));for(var I=1;I<v-1;I++){var P=h[I];t.lineTo(P[0]-n,P[1]-a)}t.lineTo(C,w)}function aH(t,r){var e=r.defX,n=e===void 0?0:e,i=r.defY,a=i===void 0?0:i,o=r.markerStart,s=r.markerEnd,l=r.markerStartOffset,u=r.markerEndOffset,h=r.points.points,v=h.length,p=h[0][0]-n,m=h[0][1]-a,C=h[v-1][0]-n,w=h[v-1][1]-a,b=0,E=0,R=0,M=0,k=0,L,_;o&&pt(o)&&l&&(L=h[1][0]-h[0][0],_=h[1][1]-h[0][1],k=Math.atan2(_,L),b=Math.cos(k)*(l||0),E=Math.sin(k)*(l||0)),s&&pt(s)&&u&&(L=h[v-2][0]-h[v-1][0],_=h[v-2][1]-h[v-1][1],k=Math.atan2(_,L),R=Math.cos(k)*(u||0),M=Math.sin(k)*(u||0)),t.moveTo(p+b,m+E);for(var I=1;I<v-1;I++){var P=h[I];t.lineTo(P[0]-n,P[1]-a)}t.lineTo(C+R,w+M)}function oH(t,r){var e=r.radius,n=r.width,i=r.height,a=n,o=i,s=e&&e.some(function(b){return b!==0});if(!s)t.rect(0,0,a,o);else{var l=n>0?1:-1,u=i>0?1:-1,h=l+u===0,v=te(e.map(function(b){return Tn(b,0,Math.min(Math.abs(a)/2,Math.abs(o)/2))}),4),p=v[0],m=v[1],C=v[2],w=v[3];t.moveTo(l*p,0),t.lineTo(a-l*m,0),m!==0&&t.arc(a-l*m,u*m,m,-u*Math.PI/2,l>0?0:Math.PI,h),t.lineTo(a,o-u*C),C!==0&&t.arc(a-l*C,o-u*C,C,l>0?0:Math.PI,u>0?Math.PI/2:1.5*Math.PI,h),t.lineTo(l*w,o),w!==0&&t.arc(l*w,o-u*w,w,u>0?Math.PI/2:-Math.PI/2,l>0?Math.PI:0,h),t.lineTo(0,u*p),p!==0&&t.arc(l*p,u*p,p,l>0?Math.PI:0,u>0?Math.PI*1.5:Math.PI/2,h)}}var sH=function(t){Me(r,t);function r(){var e=t.apply(this,pe([],te(arguments),!1))||this;return e.name="canvas-path-generator",e}return r.prototype.init=function(){var e,n=(e={},e[ge.CIRCLE]=eH,e[ge.ELLIPSE]=tH,e[ge.RECT]=oH,e[ge.LINE]=rH,e[ge.POLYLINE]=aH,e[ge.POLYGON]=iH,e[ge.PATH]=nH,e[ge.TEXT]=void 0,e[ge.GROUP]=void 0,e[ge.IMAGE]=void 0,e[ge.HTML]=void 0,e[ge.MESH]=void 0,e);this.context.pathGeneratorFactory=n},r.prototype.destroy=function(){delete this.context.pathGeneratorFactory},r}(ho),lH=at(),uH=at(),cH=at(),fH=Ot(),hH=function(){function t(){var r=this;this.isHit=function(e,n,i,a){var o=r.context.pointInPathPickerFactory[e.nodeName];if(o){var s=Ti(fH,i),l=Gn(uH,Jn(cH,n[0],n[1],0),s),u=e.getGeometryBounds().halfExtents,h=e.parsedStyle.anchor;if(l[0]+=(h&&h[0]||0)*u[0]*2,l[1]+=(h&&h[1]||0)*u[1]*2,o(e,new Tr(l[0],l[1]),a,r.isPointInPath,r.context,r.runtime))return!0}return!1},this.isPointInPath=function(e,n){var i=r.runtime.offscreenCanvasCreator.getOrCreateContext(r.context.config.offscreenCanvas),a=r.context.pathGeneratorFactory[e.nodeName];return a&&(i.beginPath(),a(i,e.parsedStyle),i.closePath()),i.isPointInPath(n.x,n.y)}}return t.prototype.apply=function(r,e){var n=this,i,a=r.renderingService,o=r.renderingContext;this.context=r,this.runtime=e;var s=(i=o.root)===null||i===void 0?void 0:i.ownerDocument;a.hooks.pick.tapPromise(t.tag,function(l){return Ar(n,void 0,void 0,function(){return Nr(this,function(u){return[2,this.pick(s,l)]})})}),a.hooks.pickSync.tap(t.tag,function(l){return n.pick(s,l)})},t.prototype.pick=function(r,e){var n,i,a=e.topmost,o=e.position,s=o.x,l=o.y,u=Jn(lH,s,l,0),h=r.elementsFromBBox(u[0],u[1],u[0],u[1]),v=[];try{for(var p=Wr(h),m=p.next();!m.done;m=p.next()){var C=m.value,w=C.getWorldTransform(),b=this.isHit(C,u,w,!1);if(b){var E=jy(C);if(E){var R=E.parsedStyle.clipPath,M=this.isHit(R,u,R.getWorldTransform(),!0);if(M){if(a)return e.picked=[C],e;v.push(C)}}else{if(a)return e.picked=[C],e;v.push(C)}}}}catch(k){n={error:k}}finally{try{m&&!m.done&&(i=p.return)&&i.call(p)}finally{if(n)throw n.error}}return e.picked=v,e},t.tag="CanvasPicker",t}();function dH(t,r,e){var n=t.parsedStyle,i=n.r,a=n.fill,o=n.stroke,s=n.lineWidth,l=n.increasedLineWidthForHitTesting,u=n.pointerEvents,h=((s||0)+(l||0))/2,v=aa(i,i,r.x,r.y),p=te(vo(u,a,o),2),m=p[0],C=p[1];return m&&C||e?v<=i+h:m?v<=i:C?v>=i-h&&v<=i+h:!1}function Fu(t,r,e,n){return t/(e*e)+r/(n*n)}function vH(t,r,e){var n=t.parsedStyle,i=n.rx,a=n.ry,o=n.fill,s=n.stroke,l=n.lineWidth,u=n.increasedLineWidthForHitTesting,h=n.pointerEvents,v=r.x,p=r.y,m=te(vo(h,o,s),2),C=m[0],w=m[1],b=((l||0)+(u||0))/2,E=(v-i)*(v-i),R=(p-a)*(p-a);return C&&w||e?Fu(E,R,i+b,a+b)<=1:C?Fu(E,R,i,a)<=1:w?Fu(E,R,i-b,a-b)>=1&&Fu(E,R,i+b,a+b)<=1:!1}function ja(t,r,e,n,i,a){return i>=t&&i<=t+e&&a>=r&&a<=r+n}function pH(t,r,e,n,i,a,o){var s=i/2;return ja(t-s,r-s,e,i,a,o)||ja(t+e-s,r-s,i,n,a,o)||ja(t+s,r+n-s,e,i,a,o)||ja(t-s,r+s,i,n,a,o)}function Hu(t,r,e,n,i,a,o,s){var l=(Math.atan2(s-r,o-t)+Math.PI*2)%(Math.PI*2),u={x:t+e*Math.cos(l),y:r+e*Math.sin(l)};return aa(u.x,u.y,o,s)<=a/2}function Sa(t,r,e,n,i,a,o){var s=Math.min(t,e),l=Math.max(t,e),u=Math.min(r,n),h=Math.max(r,n),v=i/2;return a>=s-v&&a<=l+v&&o>=u-v&&o<=h+v?WR(t,r,e,n,a,o)<=i/2:!1}function yb(t,r,e,n,i){var a=t.length;if(a<2)return!1;for(var o=0;o<a-1;o++){var s=t[o][0],l=t[o][1],u=t[o+1][0],h=t[o+1][1];if(Sa(s,l,u,h,r,e,n))return!0}if(i){var v=t[0],p=t[a-1];if(Sa(v[0],v[1],p[0],p[1],r,e,n))return!0}return!1}var gH=1e-6;function Ph(t){return Math.abs(t)<gH?0:t<0?-1:1}function mH(t,r,e){return(e[0]-t[0])*(r[1]-t[1])===(r[0]-t[0])*(e[1]-t[1])&&Math.min(t[0],r[0])<=e[0]&&e[0]<=Math.max(t[0],r[0])&&Math.min(t[1],r[1])<=e[1]&&e[1]<=Math.max(t[1],r[1])}function Cb(t,r,e){var n=!1,i=t.length;if(i<=2)return!1;for(var a=0;a<i;a++){var o=t[a],s=t[(a+1)%i];if(mH(o,s,[r,e]))return!0;Ph(o[1]-e)>0!=Ph(s[1]-e)>0&&Ph(r-(e-o[1])*(o[0]-s[0])/(o[1]-s[1])-o[0])<0&&(n=!n)}return n}function J1(t,r,e){for(var n=!1,i=0;i<t.length;i++){var a=t[i];if(n=Cb(a,r,e),n)break}return n}function yH(t,r,e){var n=t.parsedStyle,i=n.x1,a=n.y1,o=n.x2,s=n.y2,l=n.lineWidth,u=n.increasedLineWidthForHitTesting,h=n.defX,v=h===void 0?0:h,p=n.defY,m=p===void 0?0:p,C=n.pointerEvents,w=n.fill,b=n.stroke,E=te(vo(C,w,b),2),R=E[1];return!R&&!e||!l?!1:Sa(i,a,o,s,(l||0)+(u||0),r.x+v,r.y+m)}function CH(t,r,e,n,i){for(var a=!1,o=r/2,s=0;s<t.length;s++){var l=t[s],u=l.currentPoint,h=l.params,v=l.prePoint,p=l.box;if(!(p&&!ja(p.x-o,p.y-o,p.width+r,p.height+r,e,n)))switch(l.command){case"L":case"Z":if(a=Sa(v[0],v[1],u[0],u[1],r,e,n),a)return!0;break;case"Q":var m=qR(v[0],v[1],h[1],h[2],h[3],h[4],e,n);if(a=m<=r/2,a)return!0;break;case"C":var C=Vg(v[0],v[1],h[1],h[2],h[3],h[4],h[5],h[6],e,n,i);if(a=C<=r/2,a)return!0;break;case"A":l.cubicParams||(l.cubicParams=rv(v[0],v[1],h[1],h[2],h[3],h[4],h[5],h[6],h[7],void 0));for(var w=l.cubicParams,b=v,E=0;E<w.length;E+=6){var R=Vg(b[0],b[1],w[E],w[E+1],w[E+2],w[E+3],w[E+4],w[E+5],e,n,i);if(b=[w[E+4],w[E+5]],a=R<=r/2,a)return!0}break}}return a}function wH(t,r,e,n,i,a){var o=t.parsedStyle,s=o.lineWidth,l=o.increasedLineWidthForHitTesting,u=o.stroke,h=o.fill,v=o.defX,p=v===void 0?0:v,m=o.defY,C=m===void 0?0:m,w=o.path,b=o.pointerEvents,E=w.segments,R=w.hasArc,M=w.polylines,k=w.polygons,L=te(vo(b,(k==null?void 0:k.length)&&h,u),2),_=L[0],I=L[1],P=ed(t),U=!1;return _||e?(R?U=n(t,r):U=J1(k,r.x+p,r.y+C)||J1(M,r.x+p,r.y+C),U):((I||e)&&(U=CH(E,(s||0)+(l||0),r.x+p,r.y+C,P)),U)}function xH(t,r,e){var n=t.parsedStyle,i=n.stroke,a=n.fill,o=n.lineWidth,s=n.increasedLineWidthForHitTesting,l=n.points,u=n.defX,h=u===void 0?0:u,v=n.defY,p=v===void 0?0:v,m=n.pointerEvents,C=te(vo(m,a,i),2),w=C[0],b=C[1],E=!1;return(b||e)&&(E=yb(l.points,(o||0)+(s||0),r.x+h,r.y+p,!0)),!E&&(w||e)&&(E=Cb(l.points,r.x+h,r.y+p)),E}function bH(t,r,e){var n=t.parsedStyle,i=n.lineWidth,a=n.increasedLineWidthForHitTesting,o=n.points,s=n.defX,l=s===void 0?0:s,u=n.defY,h=u===void 0?0:u,v=n.pointerEvents,p=n.fill,m=n.stroke,C=te(vo(v,p,m),2),w=C[1];return!w&&!e||!i?!1:yb(o.points,(i||0)+(a||0),r.x+l,r.y+h,!1)}function SH(t,r,e,n,i){var a=t.parsedStyle,o=a.radius,s=a.fill,l=a.stroke,u=a.lineWidth,h=a.increasedLineWidthForHitTesting,v=a.width,p=a.height,m=a.pointerEvents,C=te(vo(m,s,l),2),w=C[0],b=C[1],E=o&&o.some(function(L){return L!==0}),R=(u||0)+(h||0);if(E){var k=!1;return(b||e)&&(k=EH(0,0,v,p,o.map(function(L){return Tn(L,0,Math.min(Math.abs(v)/2,Math.abs(p)/2))}),R,r.x,r.y)),!k&&(w||e)&&(k=n(t,r)),k}else{var M=R/2;if(w&&b||e)return ja(0-M,0-M,v+M,p+M,r.x,r.y);if(w)return ja(0,0,v,p,r.x,r.y);if(b)return pH(0,0,v,p,R,r.x,r.y)}return!1}function EH(t,r,e,n,i,a,o,s){var l=te(i,4),u=l[0],h=l[1],v=l[2],p=l[3];return Sa(t+u,r,t+e-h,r,a,o,s)||Sa(t+e,r+h,t+e,r+n-v,a,o,s)||Sa(t+e-v,r+n,t+p,r+n,a,o,s)||Sa(t,r+n-p,t,r+u,a,o,s)||Hu(t+e-h,r+h,h,1.5*Math.PI,2*Math.PI,a,o,s)||Hu(t+e-v,r+n-v,v,0,.5*Math.PI,a,o,s)||Hu(t+p,r+n-p,p,.5*Math.PI,Math.PI,a,o,s)||Hu(t+u,r+u,u,Math.PI,1.5*Math.PI,a,o,s)}function TH(t,r,e,n,i,a){var o=t.parsedStyle,s=o.pointerEvents,l=o.width,u=o.height;if(s==="non-transparent-pixel"){var h=i.config.offscreenCanvas,v=a.offscreenCanvasCreator.getOrCreateCanvas(h),p=a.offscreenCanvasCreator.getOrCreateContext(h,{willReadFrequently:!0});v.width=l,v.height=u,i.defaultStyleRendererFactory[ge.IMAGE].render(p,t.parsedStyle,t,void 0,void 0,void 0);var m=p.getImageData(r.x,r.y,1,1).data;return m.every(function(C){return C!==0})}return!0}var _H=function(t){Me(r,t);function r(){var e=t.apply(this,pe([],te(arguments),!1))||this;return e.name="canvas-picker",e}return r.prototype.init=function(){var e,n=function(){return!0},i=(e={},e[ge.CIRCLE]=dH,e[ge.ELLIPSE]=vH,e[ge.RECT]=SH,e[ge.LINE]=yH,e[ge.POLYLINE]=bH,e[ge.POLYGON]=xH,e[ge.PATH]=wH,e[ge.TEXT]=n,e[ge.GROUP]=null,e[ge.IMAGE]=TH,e[ge.HTML]=null,e[ge.MESH]=null,e);this.context.pointInPathPickerFactory=i,this.addRenderingPlugin(new hH)},r.prototype.destroy=function(){delete this.context.pointInPathPickerFactory,this.removeAllRenderingPlugins()},r}(ho),RH=function(){function t(r){this.canvasRendererPluginOptions=r,this.removedRBushNodeAABBs=[],this.renderQueue=[],this.restoreStack=[],this.clearFullScreen=!1,this.vpMatrix=Ot(),this.dprMatrix=Ot(),this.tmpMat4=Ot(),this.vec3a=at(),this.vec3b=at(),this.vec3c=at(),this.vec3d=at()}return t.prototype.apply=function(r,e){var n=this;this.context=r;var i=r.config,a=r.camera,o=r.renderingService,s=r.renderingContext,l=r.rBushRoot,u=r.pathGeneratorFactory;this.rBush=l,this.pathGeneratorFactory=u;var h=r.contextService,v=s.root.ownerDocument.defaultView,p=function(w){var b=w.target,E=b.rBushNode;E.aabb&&n.removedRBushNodeAABBs.push(E.aabb)},m=function(w){var b=w.target,E=b.rBushNode;E.aabb&&n.removedRBushNodeAABBs.push(E.aabb)};o.hooks.init.tap(t.tag,function(){v.addEventListener(ht.UNMOUNTED,p),v.addEventListener(ht.CULLED,m);var w=h.getDPR(),b=i.width,E=i.height,R=h.getContext();n.clearRect(R,0,0,b*w,E*w,i.background)}),o.hooks.destroy.tap(t.tag,function(){v.removeEventListener(ht.UNMOUNTED,p),v.removeEventListener(ht.CULLED,m),n.renderQueue=[],n.removedRBushNodeAABBs=[],n.restoreStack=[]}),o.hooks.beginFrame.tap(t.tag,function(){var w=h.getContext(),b=h.getDPR(),E=i.width,R=i.height,M=n.canvasRendererPluginOptions,k=M.dirtyObjectNumThreshold,L=M.dirtyObjectRatioThreshold,_=o.getStats(),I=_.total,P=_.rendered,U=P/I;n.clearFullScreen=o.disableDirtyRectangleRendering()||P>k&&U>L,w&&(w.resetTransform?w.resetTransform():w.setTransform(1,0,0,1,0,0),n.clearFullScreen&&n.clearRect(w,0,0,E*b,R*b,i.background))});var C=function(w,b){w.isVisible()&&!w.isCulled()&&(n.renderDisplayObject(w,b,n.context,n.restoreStack,e),n.saveDirtyAABB(w));var E=w.sortable.sorted||w.childNodes;E.forEach(function(R){C(R,b)})};o.hooks.endFrame.tap(t.tag,function(){var w=h.getContext(),b=h.getDPR();if(hy(n.dprMatrix,[b,b,1]),Gr(n.vpMatrix,n.dprMatrix,a.getOrthoMatrix()),n.clearFullScreen)C(s.root,w);else{var E=n.safeMergeAABB.apply(n,pe([n.mergeDirtyAABBs(n.renderQueue)],te(n.removedRBushNodeAABBs.map(function(je){var Be=je.minX,rt=je.minY,ut=je.maxX,St=je.maxY,st=new ur;return st.setMinMax([Be,rt,0],[ut,St,0]),st})),!1));if(n.removedRBushNodeAABBs=[],ur.isEmpty(E)){n.renderQueue=[];return}var R=n.convertAABB2Rect(E),M=R.x,k=R.y,L=R.width,_=R.height,I=Gn(n.vec3a,[M,k,0],n.vpMatrix),P=Gn(n.vec3b,[M+L,k,0],n.vpMatrix),U=Gn(n.vec3c,[M,k+_,0],n.vpMatrix),q=Gn(n.vec3d,[M+L,k+_,0],n.vpMatrix),Q=Math.min(I[0],P[0],q[0],U[0]),J=Math.min(I[1],P[1],q[1],U[1]),re=Math.max(I[0],P[0],q[0],U[0]),ne=Math.max(I[1],P[1],q[1],U[1]),ce=Math.floor(Q),me=Math.floor(J),oe=Math.ceil(re-Q),Se=Math.ceil(ne-J);w.save(),n.clearRect(w,ce,me,oe,Se,i.background),w.beginPath(),w.rect(ce,me,oe,Se),w.clip(),w.setTransform(n.vpMatrix[0],n.vpMatrix[1],n.vpMatrix[4],n.vpMatrix[5],n.vpMatrix[12],n.vpMatrix[13]);var Te=i.renderer.getConfig().enableDirtyRectangleRenderingDebug;Te&&v.dispatchEvent(new Sr(fn.DIRTY_RECTANGLE,{dirtyRect:{x:ce,y:me,width:oe,height:Se}}));var Ie=n.searchDirtyObjects(E);Ie.sort(function(je,Be){return je.sortable.renderOrder-Be.sortable.renderOrder}).forEach(function(je){je&&je.isVisible()&&!je.isCulled()&&n.renderDisplayObject(je,w,n.context,n.restoreStack,e)}),w.restore(),n.renderQueue.forEach(function(je){n.saveDirtyAABB(je)}),n.renderQueue=[]}n.restoreStack.forEach(function(){w.restore()}),n.restoreStack=[]}),o.hooks.render.tap(t.tag,function(w){n.clearFullScreen||n.renderQueue.push(w)})},t.prototype.clearRect=function(r,e,n,i,a,o){r.clearRect(e,n,i,a),o&&(r.fillStyle=o,r.fillRect(e,n,i,a))},t.prototype.renderDisplayObject=function(r,e,n,i,a){var o=r.nodeName,s=i[i.length-1];s&&!(r.compareDocumentPosition(s)&wr.DOCUMENT_POSITION_CONTAINS)&&(e.restore(),i.pop());var l=this.context.styleRendererFactory[o],u=this.pathGeneratorFactory[o],h=r.parsedStyle.clipPath;if(h){this.applyWorldTransform(e,h);var v=this.pathGeneratorFactory[h.nodeName];v&&(e.save(),i.push(r),e.beginPath(),v(e,h.parsedStyle),e.closePath(),e.clip())}l&&(this.applyWorldTransform(e,r),e.save(),this.applyAttributesToContext(e,r)),u&&(e.beginPath(),u(e,r.parsedStyle),r.nodeName!==ge.LINE&&r.nodeName!==ge.PATH&&r.nodeName!==ge.POLYLINE&&e.closePath()),l&&(l.render(e,r.parsedStyle,r,n,this,a),e.restore()),r.renderable.dirty=!1},t.prototype.convertAABB2Rect=function(r){var e=r.getMin(),n=r.getMax(),i=Math.floor(e[0]),a=Math.floor(e[1]),o=Math.ceil(n[0]),s=Math.ceil(n[1]),l=o-i,u=s-a;return{x:i,y:a,width:l,height:u}},t.prototype.mergeDirtyAABBs=function(r){var e=new ur;return r.forEach(function(n){var i=n.getRenderBounds();e.add(i);var a=n.renderable.dirtyRenderBounds;a&&e.add(a)}),e},t.prototype.searchDirtyObjects=function(r){var e=te(r.getMin(),2),n=e[0],i=e[1],a=te(r.getMax(),2),o=a[0],s=a[1],l=this.rBush.search({minX:n,minY:i,maxX:o,maxY:s});return l.map(function(u){var h=u.displayObject;return h})},t.prototype.saveDirtyAABB=function(r){var e=r.renderable;e.dirtyRenderBounds||(e.dirtyRenderBounds=new ur);var n=r.getRenderBounds();n&&e.dirtyRenderBounds.update(n.center,n.halfExtents)},t.prototype.applyAttributesToContext=function(r,e){var n=e.parsedStyle,i=n.stroke,a=n.fill,o=n.opacity,s=n.lineDash,l=n.lineDashOffset;s&&r.setLineDash(s),We(l)||(r.lineDashOffset=l),We(o)||(r.globalAlpha*=o),!We(i)&&!Array.isArray(i)&&!i.isNone&&(r.strokeStyle=e.attributes.stroke),!We(a)&&!Array.isArray(a)&&!a.isNone&&(r.fillStyle=e.attributes.fill)},t.prototype.applyWorldTransform=function(r,e,n){var i=0,a=0,o=(e.parsedStyle||{}).anchor,s=o&&o[0]||0,l=o&&o[1]||0;if(s!==0||l!==0){var u=e.geometry.contentBounds,h=u&&u.halfExtents[0]*2||0,v=u&&u.halfExtents[1]*2||0;i=-(s*h),a=-(l*v)}n?(to(this.tmpMat4,e.getLocalTransform()),this.vec3a[0]=i,this.vec3a[1]=a,this.vec3a[2]=0,Ea(this.tmpMat4,this.tmpMat4,this.vec3a),Gr(this.tmpMat4,n,this.tmpMat4),Gr(this.tmpMat4,this.vpMatrix,this.tmpMat4)):(to(this.tmpMat4,e.getWorldTransform()),this.vec3a[0]=i,this.vec3a[1]=a,this.vec3a[2]=0,Ea(this.tmpMat4,this.tmpMat4,this.vec3a),Gr(this.tmpMat4,this.vpMatrix,this.tmpMat4)),r.setTransform(this.tmpMat4[0],this.tmpMat4[1],this.tmpMat4[4],this.tmpMat4[5],this.tmpMat4[12],this.tmpMat4[13])},t.prototype.safeMergeAABB=function(){for(var r=[],e=0;e<arguments.length;e++)r[e]=arguments[e];var n=new ur;return r.forEach(function(i){n.add(i)}),n},t.tag="CanvasRenderer",t}(),Ba=function(){function t(r){this.imagePool=r}return t.prototype.render=function(r,e,n,i,a,o){var s=e.fill,l=e.fillRule,u=e.opacity,h=e.fillOpacity,v=e.stroke,p=e.strokeOpacity,m=e.lineWidth,C=e.lineCap,w=e.lineJoin,b=e.shadowType,E=e.shadowColor,R=e.shadowBlur,M=e.filter,k=e.miterLimit,L=!We(s)&&!s.isNone,_=!We(v)&&!v.isNone&&m>0,I=s.alpha===0,P=!!(M&&M.length),U=!We(E)&&R>0,q=n.nodeName,Q=b==="inner",J=_&&U&&(q===ge.PATH||q===ge.LINE||q===ge.POLYLINE||I||Q);L&&(r.globalAlpha=u*h,J||Nc(n,r,U),this.fill(r,n,s,l,i,a,o),J||this.clearShadowAndFilter(r,P,U)),_&&(r.globalAlpha=u*p,r.lineWidth=m,We(k)||(r.miterLimit=k),We(C)||(r.lineCap=C),We(w)||(r.lineJoin=w),J&&(Q&&(r.globalCompositeOperation="source-atop"),Nc(n,r,!0),Q&&(this.stroke(r,n,v,i,a,o),r.globalCompositeOperation="source-over",this.clearShadowAndFilter(r,P,!0))),this.stroke(r,n,v,i,a,o))},t.prototype.clearShadowAndFilter=function(r,e,n){if(n&&(r.shadowColor="transparent",r.shadowBlur=0),e){var i=r.filter;!We(i)&&i.indexOf("drop-shadow")>-1&&(r.filter=i.replace(/drop-shadow\([^)]*\)/,"").trim()||"none")}},t.prototype.fill=function(r,e,n,i,a,o,s){var l=this;Array.isArray(n)?n.forEach(function(u){r.fillStyle=l.getColor(u,e,r),i?r.fill(i):r.fill()}):(vl(n)&&(r.fillStyle=this.getPattern(n,e,r,a,o,s)),i?r.fill(i):r.fill())},t.prototype.stroke=function(r,e,n,i,a,o){var s=this;Array.isArray(n)?n.forEach(function(l){r.strokeStyle=s.getColor(l,e,r),r.stroke()}):(vl(n)&&(r.strokeStyle=this.getPattern(n,e,r,i,a,o)),r.stroke())},t.prototype.getPattern=function(r,e,n,i,a,o){var s,l;if(r.image.nodeName==="rect"){var u=r.image.parsedStyle,h=u.width,v=u.height;l=i.contextService.getDPR();var p=i.config.offscreenCanvas;s=o.offscreenCanvasCreator.getOrCreateCanvas(p),s.width=h*l,s.height=v*l;var m=o.offscreenCanvasCreator.getOrCreateContext(p),C=[];r.image.forEach(function(b){a.renderDisplayObject(b,m,i,C,o)}),C.forEach(function(){m.restore()})}var w=this.imagePool.getOrCreatePatternSync(r,n,s,l,function(){e.renderable.dirty=!0,i.renderingService.dirtify()});return w},t.prototype.getColor=function(r,e,n){var i;if(r.type===Ri.LinearGradient||r.type===Ri.RadialGradient){var a=e.getGeometryBounds(),o=a&&a.halfExtents[0]*2||1,s=a&&a.halfExtents[1]*2||1;i=this.imagePool.getOrCreateGradient(Y(Y({type:r.type},r.value),{width:o,height:s}),n)}return i},t}();function Nc(t,r,e){var n=t.parsedStyle,i=n.filter,a=n.shadowColor,o=n.shadowBlur,s=n.shadowOffsetX,l=n.shadowOffsetY;i&&i.length&&(r.filter=t.style.filter),e&&(r.shadowColor=a.toString(),r.shadowBlur=o||0,r.shadowOffsetX=s||0,r.shadowOffsetY=l||0)}var LH=function(){function t(r){this.imagePool=r}return t.prototype.render=function(r,e,n){var i=e.width,a=e.height,o=e.img,s=e.shadowColor,l=e.shadowBlur,u,h=i,v=a;if(kr(o)?u=this.imagePool.getImageSync(o):(h||(h=o.width),v||(v=o.height),u=o),u){var p=!We(s)&&l>0;Nc(n,r,p);try{r.drawImage(u,0,0,h,v)}catch{}}},t}(),MH=function(){function t(){}return t.prototype.render=function(r,e,n,i,a,o){var s=e,l=s.lineWidth,u=s.textAlign,h=s.textBaseline,v=s.lineJoin,p=s.miterLimit,m=s.letterSpacing,C=s.stroke,w=s.fill,b=s.fillOpacity,E=s.strokeOpacity,R=s.opacity,M=s.metrics,k=s.dx,L=s.dy,_=s.shadowColor,I=s.shadowBlur,P=M.font,U=M.lines,q=M.height,Q=M.lineHeight,J=M.lineMetrics;r.font=P,r.lineWidth=l,r.textAlign=u==="middle"?"center":u;var re=h;!o.enableCSSParsing&&re==="alphabetic"&&(re="bottom"),r.lineJoin=v,We(p)||(r.miterLimit=p);var ne=0;h==="middle"?ne=-q/2-Q/2:h==="bottom"||h==="alphabetic"||h==="ideographic"?ne=-q:(h==="top"||h==="hanging")&&(ne=-Q);var ce=k||0;ne+=L||0,U.length===1&&(re==="bottom"?(re="middle",ne-=.5*q):re==="top"&&(re="middle",ne+=.5*q)),r.textBaseline=re;var me=!We(_)&&I>0;Nc(n,r,me);for(var oe=0;oe<U.length;oe++){var Se=l/2+ce;ne+=Q,!We(C)&&!C.isNone&&l&&this.drawLetterSpacing(r,U[oe],J[oe],u,Se,ne,m,b,E,R,!0),We(w)||this.drawLetterSpacing(r,U[oe],J[oe],u,Se,ne,m,b,E,R)}},t.prototype.drawLetterSpacing=function(r,e,n,i,a,o,s,l,u,h,v){if(v===void 0&&(v=!1),s===0){v?this.strokeText(r,e,a,o,u):this.fillText(r,e,a,o,l,h);return}var p=r.textAlign;r.textAlign="left";var m=a;i==="center"||i==="middle"?m=a-n.width/2:(i==="right"||i==="end")&&(m=a-n.width);for(var C=Array.from(e),w=r.measureText(e).width,b=0,E=0;E<C.length;++E){var R=C[E];v?this.strokeText(r,R,m,o,u):this.fillText(r,R,m,o,l,h),b=r.measureText(e.substring(E+1)).width,m+=w-b+s,w=b}r.textAlign=p},t.prototype.fillText=function(r,e,n,i,a,o){var s,l=!We(a)&&a!==1;l&&(s=r.globalAlpha,r.globalAlpha=a*o),r.fillText(e,n,i),l&&(r.globalAlpha=s)},t.prototype.strokeText=function(r,e,n,i,a){var o,s=!We(a)&&a!==1;s&&(o=r.globalAlpha,r.globalAlpha=a),r.strokeText(e,n,i),s&&(r.globalAlpha=o)},t}();(function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r})(Ba);(function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r})(Ba);(function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r})(Ba);(function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r})(Ba);(function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r})(Ba);(function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r})(Ba);(function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r})(Ba);var OH=function(t){Me(r,t);function r(e){e===void 0&&(e={});var n=t.call(this)||this;return n.options=e,n.name="canvas-renderer",n}return r.prototype.init=function(){var e,n=Y({dirtyObjectNumThreshold:500,dirtyObjectRatioThreshold:.8},this.options),i=this.context.imagePool,a=new Ba(i),o=(e={},e[ge.CIRCLE]=a,e[ge.ELLIPSE]=a,e[ge.RECT]=a,e[ge.IMAGE]=new LH(i),e[ge.TEXT]=new MH,e[ge.LINE]=a,e[ge.POLYLINE]=a,e[ge.POLYGON]=a,e[ge.PATH]=a,e[ge.GROUP]=void 0,e[ge.HTML]=void 0,e[ge.MESH]=void 0,e);this.context.defaultStyleRendererFactory=o,this.context.styleRendererFactory=o,this.addRenderingPlugin(new RH(n))},r.prototype.destroy=function(){this.removeAllRenderingPlugins(),delete this.context.defaultStyleRendererFactory,delete this.context.styleRendererFactory},r}(ho),AH=function(){function t(){}return t.prototype.apply=function(r,e){var n=this,i=r.renderingService,a=r.renderingContext,o=r.config;this.context=r;var s=a.root.ownerDocument.defaultView,l=function(_){i.hooks.pointerMove.call(_)},u=function(_){i.hooks.pointerUp.call(_)},h=function(_){i.hooks.pointerDown.call(_)},v=function(_){i.hooks.pointerOver.call(_)},p=function(_){i.hooks.pointerOut.call(_)},m=function(_){i.hooks.pointerCancel.call(_)},C=function(_){i.hooks.pointerWheel.call(_)},w=function(_){i.hooks.click.call(_)},b=function(_){e.globalThis.document.addEventListener("pointermove",l,!0),_.addEventListener("pointerdown",h,!0),_.addEventListener("pointerleave",p,!0),_.addEventListener("pointerover",v,!0),e.globalThis.addEventListener("pointerup",u,!0),e.globalThis.addEventListener("pointercancel",m,!0)},E=function(_){_.addEventListener("touchstart",h,!0),_.addEventListener("touchend",u,!0),_.addEventListener("touchmove",l,!0),_.addEventListener("touchcancel",m,!0)},R=function(_){e.globalThis.document.addEventListener("mousemove",l,!0),_.addEventListener("mousedown",h,!0),_.addEventListener("mouseout",p,!0),_.addEventListener("mouseover",v,!0),e.globalThis.addEventListener("mouseup",u,!0)},M=function(_){e.globalThis.document.removeEventListener("pointermove",l,!0),_.removeEventListener("pointerdown",h,!0),_.removeEventListener("pointerleave",p,!0),_.removeEventListener("pointerover",v,!0),e.globalThis.removeEventListener("pointerup",u,!0)},k=function(_){_.removeEventListener("touchstart",h,!0),_.removeEventListener("touchend",u,!0),_.removeEventListener("touchmove",l,!0),_.removeEventListener("touchcancel",m,!0)},L=function(_){e.globalThis.document.removeEventListener("mousemove",l,!0),_.removeEventListener("mousedown",h,!0),_.removeEventListener("mouseout",p,!0),_.removeEventListener("mouseover",v,!0),e.globalThis.removeEventListener("mouseup",u,!0)};i.hooks.init.tap(t.tag,function(){var _=n.context.contextService.getDomElement();e.globalThis.navigator.msPointerEnabled?(_.style.msContentZooming="none",_.style.msTouchAction="none"):s.supportsPointerEvents&&(_.style.touchAction="none"),s.supportsPointerEvents?b(_):R(_),s.supportsTouchEvents&&E(_),o.useNativeClickEvent&&_.addEventListener("click",w,!0),_.addEventListener("wheel",C,{passive:!0,capture:!0})}),i.hooks.destroy.tap(t.tag,function(){var _=n.context.contextService.getDomElement();e.globalThis.navigator.msPointerEnabled?(_.style.msContentZooming="",_.style.msTouchAction=""):s.supportsPointerEvents&&(_.style.touchAction=""),s.supportsPointerEvents?M(_):L(_),s.supportsTouchEvents&&k(_),o.useNativeClickEvent&&_.removeEventListener("click",w,!0),_.removeEventListener("wheel",C,!0)})},t.tag="DOMInteraction",t}(),NH=function(t){Me(r,t);function r(){var e=t.apply(this,pe([],te(arguments),!1))||this;return e.name="dom-interaction",e}return r.prototype.init=function(){this.addRenderingPlugin(new AH)},r.prototype.destroy=function(){this.removeAllRenderingPlugins()},r}(ho),kH="g-canvas-camera",IH=function(){function t(){this.displayObjectHTMLElementMap=new WeakMap}return t.prototype.joinTransformMatrix=function(r){return"matrix(".concat([r[0],r[1],r[4],r[5],r[12],r[13]].join(","),")")},t.prototype.apply=function(r,e){var n=this,i=r.camera,a=r.renderingContext,o=r.renderingService;this.context=r;var s=a.root.ownerDocument.defaultView,l=s.context.eventService.nativeHTMLMap,u=function(w,b){b.style.transform=n.joinTransformMatrix(w.getWorldTransform())},h=function(w){var b=w.target;if(b.nodeName===ge.HTML){n.$camera||(n.$camera=n.createCamera(i));var E=n.getOrCreateEl(b);if(n.$camera.appendChild(E),e.enableCSSParsing){var R=b.ownerDocument.documentElement.attributes;Object.keys(R).forEach(function(M){E.style[M]=R[M]})}Object.keys(b.attributes).forEach(function(M){n.updateAttribute(M,b)}),u(b,E),l.set(E,b)}},v=function(w){var b=w.target;if(b.nodeName===ge.HTML&&n.$camera){var E=n.getOrCreateEl(b);E&&(E.remove(),l.delete(E))}},p=function(w){var b=w.target;if(b.nodeName===ge.HTML){var E=w.attrName;n.updateAttribute(E,b)}},m=function(w){var b=w.target;if(b.nodeName===ge.HTML){var E=n.getOrCreateEl(b);u(b,E)}},C=function(){if(n.$camera){var w=n.context.config,b=w.width,E=w.height;n.$camera.style.width="".concat(b||0,"px"),n.$camera.style.height="".concat(E||0,"px")}};o.hooks.init.tap(t.tag,function(){s.addEventListener(fn.RESIZE,C),s.addEventListener(ht.MOUNTED,h),s.addEventListener(ht.UNMOUNTED,v),s.addEventListener(ht.ATTR_MODIFIED,p),s.addEventListener(ht.BOUNDS_CHANGED,m)}),o.hooks.endFrame.tap(t.tag,function(){n.$camera&&a.renderReasons.has(_a.CAMERA_CHANGED)&&(n.$camera.style.transform=n.joinTransformMatrix(i.getOrthoMatrix()))}),o.hooks.destroy.tap(t.tag,function(){n.$camera&&n.$camera.remove(),s.removeEventListener(fn.RESIZE,C),s.removeEventListener(ht.MOUNTED,h),s.removeEventListener(ht.UNMOUNTED,v),s.removeEventListener(ht.ATTR_MODIFIED,p),s.removeEventListener(ht.BOUNDS_CHANGED,m)})},t.prototype.createCamera=function(r){var e=this.context.config,n=e.document,i=e.width,a=e.height,o=this.context.contextService.getDomElement(),s=o.parentNode;if(s){var l=kH,u=s.querySelector("#"+l);if(!u){var h=(n||document).createElement("div");u=h,h.id=l,h.style.position="absolute",h.style.left="".concat(o.offsetLeft||0,"px"),h.style.top="".concat(o.offsetTop||0,"px"),h.style.transformOrigin="left top",h.style.transform=this.joinTransformMatrix(r.getOrthoMatrix()),h.style.overflow="hidden",h.style.pointerEvents="none",h.style.width="".concat(i||0,"px"),h.style.height="".concat(a||0,"px"),s.appendChild(h)}return u}return null},t.prototype.getOrCreateEl=function(r){var e=this.context.config.document,n=this.displayObjectHTMLElementMap.get(r);return n||(n=(e||document).createElement("div"),r.parsedStyle.$el=n,this.displayObjectHTMLElementMap.set(r,n),r.id&&(n.id=r.id),r.name&&n.setAttribute("name",r.name),r.className&&(n.className=r.className),n.style.position="absolute",n.style.left="0px",n.style.top="0px",n.style["will-change"]="transform",n.style.transform=this.joinTransformMatrix(r.getWorldTransform())),n},t.prototype.updateAttribute=function(r,e){var n=this.getOrCreateEl(e);switch(r){case"innerHTML":var i=e.parsedStyle.innerHTML;kr(i)?n.innerHTML=i:(n.innerHTML="",n.appendChild(i));break;case"transformOrigin":var a=e.parsedStyle.transformOrigin;n.style["transform-origin"]="".concat(a[0].value," ").concat(a[1].value);break;case"width":if(this.context.enableCSSParsing){var o=e.computedStyleMap().get("width");n.style.width=o.toString()}else{var o=e.parsedStyle.width;n.style.width=li(o)?"".concat(o,"px"):o.toString()}break;case"height":if(this.context.enableCSSParsing){var s=e.computedStyleMap().get("height");n.style.height=s.toString()}else{var s=e.parsedStyle.height;n.style.height=li(s)?"".concat(s,"px"):s.toString()}break;case"zIndex":var l=e.parsedStyle.zIndex;n.style["z-index"]="".concat(l);break;case"visibility":var u=e.parsedStyle.visibility;n.style.visibility=u;break;case"pointerEvents":var h=e.parsedStyle.pointerEvents;n.style.pointerEvents=h;break;case"opacity":var v=e.parsedStyle.opacity;n.style.opacity="".concat(v);break;case"fill":var p=e.parsedStyle.fill,m="";rc(p)?p.isNone?m="transparent":m=e.getAttribute("fill"):Array.isArray(p)?m=e.getAttribute("fill"):vl(p),n.style.background=m;break;case"stroke":var C=e.parsedStyle.stroke,w="";rc(C)?C.isNone?w="transparent":w=e.getAttribute("stroke"):Array.isArray(C)?w=e.getAttribute("stroke"):vl(C),n.style["border-color"]=w,n.style["border-style"]="solid";break;case"lineWidth":var b=e.parsedStyle.lineWidth;n.style["border-width"]="".concat(b||0,"px");break;case"lineDash":n.style["border-style"]="dashed";break;case"filter":var E=e.style.filter;n.style.filter=E;break;default:r!=="x"&&r!=="y"&&!We(e.style[r])&&e.style[r]!==""&&(n.style[r]=e.style[r])}},t.tag="HTMLRendering",t}(),PH=function(t){Me(r,t);function r(){var e=t.apply(this,pe([],te(arguments),!1))||this;return e.name="html-renderer",e}return r.prototype.init=function(){this.addRenderingPlugin(new IH)},r.prototype.destroy=function(){this.removeAllRenderingPlugins()},r}(ho),DH=function(){function t(r){this.canvasConfig=r,this.imageCache={},this.gradientCache={},this.patternCache={}}return t.prototype.getImageSync=function(r,e){return this.imageCache[r]?e&&e(this.imageCache[r]):this.getOrCreateImage(r).then(function(n){e&&e(n)}),this.imageCache[r]},t.prototype.getOrCreateImage=function(r){var e=this;if(this.imageCache[r])return Promise.resolve(this.imageCache[r]);var n=this.canvasConfig.createImage;return new Promise(function(i,a){var o;n?o=n(r):kl&&(o=new window.Image),o&&(o.onload=function(){e.imageCache[r]=o,i(o)},o.onerror=function(s){a(s)},o.crossOrigin="Anonymous",o.src=r)})},t.prototype.getOrCreatePatternSync=function(r,e,n,i,a){var o=this.generatePatternKey(r);if(o&&this.patternCache[o])return this.patternCache[o];var s=r.image,l=r.repetition,u=r.transform,h,v=!1;kr(s)?h=this.getImageSync(s,a):n?(h=n,v=!0):h=s;var p=h&&e.createPattern(h,l);if(p){var m=void 0;u?m=fv(lv(u),new mn({})):m=Ol(Ot()),v&&Ku(m,m,[1/i,1/i,1]),p.setTransform({a:m[0],b:m[1],c:m[4],d:m[5],e:m[12],f:m[13]})}return o&&p&&(this.patternCache[o]=p),p},t.prototype.getOrCreateGradient=function(r,e){var n=this.generateGradientKey(r),i=r.type,a=r.steps,o=r.width,s=r.height,l=r.angle,u=r.cx,h=r.cy,v=r.size;if(this.gradientCache[n])return this.gradientCache[n];var p=null;if(i===Ri.LinearGradient){var m=RL(o,s,l),C=m.x1,w=m.y1,b=m.x2,E=m.y2;p=e.createLinearGradient(C,w,b,E)}else if(i===Ri.RadialGradient){var R=LL(o,s,u,h,v),M=R.x,k=R.y,L=R.r;p=e.createRadialGradient(M,k,0,M,k,L)}return p&&(a.forEach(function(_){var I=_.offset,P=_.color;I.unit===De.kPercentage&&(p==null||p.addColorStop(I.value/100,P.toString()))}),this.gradientCache[n]=p),this.gradientCache[n]},t.prototype.generateGradientKey=function(r){var e=r.type,n=r.width,i=r.height,a=r.steps,o=r.angle,s=r.cx,l=r.cy,u=r.size;return"gradient-".concat(e,"-").concat((o==null?void 0:o.toString())||0,"-").concat((s==null?void 0:s.toString())||0,"-").concat((l==null?void 0:l.toString())||0,"-").concat((u==null?void 0:u.toString())||0,"-").concat(n,"-").concat(i,"-").concat(a.map(function(h){var v=h.offset,p=h.color;return"".concat(v).concat(p)}).join("-"))},t.prototype.generatePatternKey=function(r){var e=r.image,n=r.repetition;if(kr(e))return"pattern-".concat(e,"-").concat(n);if(e.nodeName==="rect")return"pattern-".concat(e.entity,"-").concat(n)},t}(),BH=function(){function t(){}return t.prototype.apply=function(r){var e=r.renderingService,n=r.renderingContext,i=r.imagePool,a=n.root.ownerDocument.defaultView,o=function(u,h,v){var p=u.parsedStyle,m=p.width,C=p.height;m&&!C?u.setAttribute("height",v/h*m):!m&&C&&u.setAttribute("width",h/v*C)},s=function(u){var h=u.target,v=h.nodeName,p=h.attributes;if(v===ge.IMAGE){var m=p.img,C=p.keepAspectRatio;kr(m)&&i.getImageSync(m,function(w){var b=w.width,E=w.height;C&&o(h,b,E),h.renderable.dirty=!0,e.dirtify()})}},l=function(u){var h=u.target,v=u.attrName,p=u.newValue;h.nodeName===ge.IMAGE&&v==="img"&&kr(p)&&i.getOrCreateImage(p).then(function(m){var C=m.width,w=m.height;h.attributes.keepAspectRatio&&o(h,C,w),h.renderable.dirty=!0,e.dirtify()})};e.hooks.init.tap(t.tag,function(){a.addEventListener(ht.MOUNTED,s),a.addEventListener(ht.ATTR_MODIFIED,l)}),e.hooks.destroy.tap(t.tag,function(){a.removeEventListener(ht.MOUNTED,s),a.removeEventListener(ht.ATTR_MODIFIED,l)})},t.tag="LoadImage",t}(),FH=function(t){Me(r,t);function r(){var e=t.apply(this,pe([],te(arguments),!1))||this;return e.name="image-loader",e}return r.prototype.init=function(){this.context.imagePool=new DH(this.context.config),this.addRenderingPlugin(new BH)},r.prototype.destroy=function(){this.removeAllRenderingPlugins()},r}(ho),HH=function(){function t(r){this.renderingContext=r.renderingContext,this.canvasConfig=r.config}return t.prototype.init=function(){var r=this.canvasConfig,e=r.container,n=r.canvas;if(n)this.$canvas=n,e&&n.parentElement!==e&&e.appendChild(n),this.$container=n.parentElement,this.canvasConfig.container=this.$container;else if(e&&(this.$container=kr(e)?document.getElementById(e):e,this.$container)){var i=document.createElement("canvas");this.$container.appendChild(i),this.$container.style.position||(this.$container.style.position="relative"),this.$canvas=i}this.context=this.$canvas.getContext("2d"),this.resize(this.canvasConfig.width,this.canvasConfig.height)},t.prototype.getContext=function(){return this.context},t.prototype.getDomElement=function(){return this.$canvas},t.prototype.getDPR=function(){return this.dpr},t.prototype.getBoundingClientRect=function(){if(this.$canvas.getBoundingClientRect)return this.$canvas.getBoundingClientRect()},t.prototype.destroy=function(){this.$container&&this.$canvas&&this.$canvas.parentNode&&this.$container.removeChild(this.$canvas)},t.prototype.resize=function(r,e){var n=this.canvasConfig.devicePixelRatio,i=n||kl&&window.devicePixelRatio||1;i=i>=1?Math.ceil(i):1,this.dpr=i,this.$canvas&&(this.$canvas.width=this.dpr*r,this.$canvas.height=this.dpr*e,NM(this.$canvas,r,e)),this.renderingContext.renderReasons.add(_a.CAMERA_CHANGED)},t.prototype.applyCursorStyle=function(r){this.$container&&this.$container.style&&(this.$container.style.cursor=r)},t.prototype.toDataURL=function(r){return r===void 0&&(r={}),Ar(this,void 0,void 0,function(){var e,n;return Nr(this,function(i){return e=r.type,n=r.encoderOptions,[2,this.context.canvas.toDataURL(e,n)]})})},t}(),zH=function(t){Me(r,t);function r(){var e=t.apply(this,pe([],te(arguments),!1))||this;return e.name="canvas-context-register",e}return r.prototype.init=function(){this.context.ContextService=HH},r.prototype.destroy=function(){delete this.context.ContextService},r}(ho),WH=function(t){Me(r,t);function r(e){var n=t.call(this,e)||this;return n.registerPlugin(new zH),n.registerPlugin(new FH),n.registerPlugin(new sH),n.registerPlugin(new OH),n.registerPlugin(new NH),n.registerPlugin(new _H),n.registerPlugin(new PH),n}return r}(jR),vi=function(){function t(r){var e=this;this.isLinkFieldText=function(n){var i=e.getCellAppendInfo(n);return i==null?void 0:i.isLinkFieldText},this.spreadsheet=r,this.bindEvents()}return t.prototype.getCellAppendInfo=function(r){return bx(r)},t.prototype.reset=function(){},t}(),GH=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.bindEvents=function(){this.bindDataCellClick()},r.prototype.bindDataCellClick=function(){var e=this;this.spreadsheet.on(se.DATA_CELL_CLICK,function(n){var i;n.stopPropagation();var a=e.spreadsheet.interaction;if(a.clearHoverTimer(),!a.hasIntercepts([Qe.CLICK])){if(e.isLinkFieldText(n.target)){e.emitLinkFieldClickEvent(n);return}var o=e.spreadsheet.getCell(n.target),s=o.getMeta();if(s){if(a.addIntercepts([Qe.HOVER]),a.isSelectedCell(o)){((i=n.originalEvent)===null||i===void 0?void 0:i.detail)===1&&(a.reset(),e.spreadsheet.emit(se.GLOBAL_SELECTED,a.getActiveCells()));return}a.changeState({cells:[Ii(o)],stateName:Xe.SELECTED,onUpdateCells:d0}),e.spreadsheet.emit(se.GLOBAL_SELECTED,[o]),e.showTooltip(n,s),a.updateDataCellRelevantHeaderCells(Xe.SELECTED,s)}}})},r.prototype.getTooltipOperator=function(e){var n=this.spreadsheet.getCell(e.target),i=g0(this.spreadsheet,e).operation;return jx(i,{defaultMenus:[],cell:n})},r.prototype.showTooltip=function(e,n){var i=n.data,a=n.isTotals,o=a===void 0?!1:a,s=n.value,l=n.fieldValue,u=n.field,h=n.valueField,v=i,p=this.spreadsheet.isTableMode(),m=p?Y(Y({},v),{value:s||l,valueField:u||h}):v,C=[m||Y(Y({},n.rowQuery),n.colQuery)],w=this.getTooltipOperator(e);this.spreadsheet.showTooltipWithInfo(e,C,{isTotals:o,operator:w,hideSummary:!0,onlyShowCellText:p})},r.prototype.emitLinkFieldClickEvent=function(e){var n=this.getCellAppendInfo(e.target).cellData,i=n,a=i.valueField,o=i.data;this.spreadsheet.emit(se.GLOBAL_LINK_FIELD_JUMP,{cellData:n,field:a,record:Object.assign({rowIndex:n==null?void 0:n.rowIndex},o)})},r}(vi),UH=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.bindEvents=function(){this.bindDataCellClick()},r.prototype.bindDataCellClick=function(){var e=this;this.spreadsheet.on(se.MERGED_CELLS_CLICK,function(n){n.stopPropagation();var i=e.spreadsheet.interaction;i.hasIntercepts([Qe.CLICK])||i.addIntercepts([Qe.HOVER])})},r}(vi),VH=function(t){Me(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.isMultiSelection=!1,e.handleRowColClick=function(n){if(n.stopPropagation(),!e.isLinkFieldText(n.target)){var i=e.spreadsheet,a=i.interaction,o=i.options,s=e.spreadsheet.getCell(n.target);if(!(s instanceof c0)){var l=o.interaction.multiSelection,u=!!(l&&e.isMultiSelection),h=a.selectHeaderCell({cell:s,isMultiSelection:u});h&&e.showTooltip(n)}}},e.getHideColumnField=function(n){var i;return!((i=n.extra)===null||i===void 0)&&i.isCustomNode?n.id:e.spreadsheet.isTableMode()?n.field:n.id},e}return r.prototype.bindEvents=function(){this.bindKeyboardDown(),this.bindKeyboardUp(),this.bindColCellClick(),this.bindRowCellClick(),this.bindTableColExpand(),this.bindMouseMove()},r.prototype.reset=function(){this.isMultiSelection=!1,this.spreadsheet.interaction.removeIntercepts([Qe.CLICK])},r.prototype.bindKeyboardDown=function(){var e=this;this.spreadsheet.on(se.GLOBAL_KEYBOARD_DOWN,function(n){Mc(n)&&(e.isMultiSelection=!0)})},r.prototype.bindKeyboardUp=function(){var e=this;this.spreadsheet.on(se.GLOBAL_KEYBOARD_UP,function(n){Mc(n)&&e.reset()})},r.prototype.bindMouseMove=function(){var e=this;this.spreadsheet.on(se.GLOBAL_MOUSE_MOVE,function(n){e.isMultiSelection&&!Kx(n)&&e.reset()})},r.prototype.bindRowCellClick=function(){var e=this;this.spreadsheet.on(se.ROW_CELL_CLICK,function(n){e.handleRowColClick(n)})},r.prototype.bindColCellClick=function(){var e=this;this.spreadsheet.on(se.COL_CELL_CLICK,function(n){e.handleRowColClick(n)})},r.prototype.showTooltip=function(e){var n=g0(this.spreadsheet,e),i=n.operation,a=n.enable;if(a){var o=this.spreadsheet.interaction,s=o.isSelectedState()?l7(o.getActiveCells()):[],l=this.getTooltipOperator(e,i);this.spreadsheet.showTooltipWithInfo(e,s,{onlyShowCellText:!0,operator:l})}},r.prototype.getTooltipOperator=function(e,n){var i=this,a=this.spreadsheet.getCell(e.target),o=a.getMeta(),s=a.cellType===Le.COL_CELL,l=this.spreadsheet.facet.getColLeafNodes().length===1,u=T6(),h=s&&!l&&o.isLeaf&&n.hiddenColumns,v=Y(Y({},u),{onClick:function(){i.hideSelectedColumns()}}),p=h?[v]:[];return jx(n,{defaultMenus:p,cell:a})},r.prototype.bindTableColExpand=function(){var e=this;this.spreadsheet.on(se.COL_CELL_EXPANDED,function(n){e.handleExpandIconClick(n)})},r.prototype.hideSelectedColumns=function(){return Ar(this,void 0,void 0,function(){var e,n,i;return Nr(this,function(a){switch(a.label){case 0:return e=this.spreadsheet.interaction,n=e.getActiveCells().map(function(o){return o.getMeta()}),i=n.map(this.getHideColumnField),[4,f0(this.spreadsheet,i,!0)];case 1:return a.sent(),[2]}})})},r.prototype.handleExpandIconClick=function(e){var n=this.spreadsheet.store.get("hiddenColumnsDetail",[]),i=(Fv(n,function(h){var v=h.displaySiblingNode;return Wd(v,e.id)})||{}).hideColumnNodes,a=i===void 0?[]:i,o=this.spreadsheet.options.interaction.hiddenColumnFields,s=a.map(this.getHideColumnField),l=c5(o,s),u=n.filter(function(h){var v=h.displaySiblingNode;return!Wd(v,e.id)});this.spreadsheet.setOptions({interaction:{hiddenColumnFields:l}}),this.spreadsheet.store.set("hiddenColumnsDetail",u),this.spreadsheet.interaction.reset(),this.spreadsheet.render(!1)},r}(vi),XH=function(t){Me(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.getRowData=function(n){var i,a=n.getHeadLeafChild(),o=e.spreadsheet.dataSet.getCellMultiData({query:a==null?void 0:a.query})[0],s=oi.getFieldValue(o);return Y(Y({},s),{rowIndex:(i=n.rowIndex)!==null&&i!==void 0?i:a==null?void 0:a.rowIndex})},e}return r.prototype.bindEvents=function(){this.bindRowCellClick()},r.prototype.bindRowCellClick=function(){var e=this;this.spreadsheet.on(se.ROW_CELL_CLICK,function(n){if(!e.spreadsheet.interaction.hasIntercepts([Qe.CLICK])&&e.isLinkFieldText(n.target)){var i=e.getCellAppendInfo(n.target).cellData,a=i.field,o=e.getRowData(i);e.spreadsheet.emit(se.GLOBAL_LINK_FIELD_JUMP,{field:a,cellData:i,record:o})}})},r}(vi),YH=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.bindEvents=function(){this.bindCornerCellClick()},r.prototype.bindCornerCellClick=function(){var e=this;this.spreadsheet.on(se.CORNER_CELL_CLICK,function(n){var i=e.spreadsheet.getCell(n.target);if(i){var a=i.getMeta();switch(a==null?void 0:a.cornerType){case en.Row:e.onRowCornerClick(a==null?void 0:a.field,n);break;case en.Col:e.onColCornerClick(a==null?void 0:a.field,n);break;case en.Series:e.onSeriesCornerClick(a==null?void 0:a.field,n);break}}})},r.prototype.onRowCornerClick=function(e,n){var i=this.getSelectedRowNodes(e);this.selectCells(i,n)},r.prototype.onColCornerClick=function(e,n){var i=this.getSelectedColNodes(e);this.selectCells(i,n)},r.prototype.onSeriesCornerClick=function(e,n){var i=this.spreadsheet.facet.getSeriesNumberNodes();this.selectCells(i,n)},r.prototype.getSelectedRowNodes=function(e){var n=this.spreadsheet.facet;if(this.spreadsheet.isHierarchyTreeType())return n.getRowNodes();if(!this.spreadsheet.isCustomRowFields())return n.getRowNodesByField(e);var i=n.getRowNodesByField(e)[0];return n.getRowNodes(i==null?void 0:i.level)},r.prototype.getSelectedColNodes=function(e){var n=this.spreadsheet.facet;if(!this.spreadsheet.isCustomColumnFields())return n.getColNodesByField(e);var i=n.getColNodesByField(e)[0];return n.getColNodes(i==null?void 0:i.level)},r.prototype.getCellMetas=function(e,n){return e.map(function(i){return{id:i.id,colIndex:-1,rowIndex:-1,type:n}})},r.prototype.selectCells=function(e,n){var i,a=this.spreadsheet.interaction,o=(i=e[0])===null||i===void 0?void 0:i.belongsCell,s=this.getCellMetas(e,o==null?void 0:o.cellType);if(o&&a.isSelectedCell(o)){a.reset(),this.spreadsheet.emit(se.GLOBAL_SELECTED,a.getActiveCells());return}ke(e)||ke(s)||(a.addIntercepts([Qe.HOVER]),a.changeState({cells:s,stateName:Xe.SELECTED}),a.highlightNodes(e),this.showTooltip(n),this.spreadsheet.emit(se.GLOBAL_SELECTED,a.getActiveCells()))},r.prototype.showTooltip=function(e){var n=this.spreadsheet.interaction.getActiveCells();this.spreadsheet.showTooltipWithInfo(e,[],{data:{summaries:[{selectedData:n,name:"",value:null}]}})},r}(vi),$H=function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.bindEvents=function(){this.bindDataCellHover(),this.bindHeaderCellHover()},r.prototype.changeStateToHoverFocus=function(e,n){var i=this,a;if(e){var o=e.getMeta(),s=this.spreadsheet.interaction,l=this.spreadsheet.options.interaction,u=l.hoverFocus;s.clearHoverTimer();var h=function(){if(!s.hasIntercepts([Qe.HOVER])){s.changeState({cells:[Ii(e)],stateName:Xe.HOVER_FOCUS});var m=i.spreadsheet.isTableMode(),C={isTotals:o.isTotals,hideSummary:!0,onlyShowCellText:m};l!=null&&l.hoverHighlight&&s.updateDataCellRelevantHeaderCells(Xe.HOVER,o);var w=i.getCellData(o,m);i.spreadsheet.showTooltipWithInfo(n,w,C)}},v=na(u)?Td:(a=u==null?void 0:u.duration)!==null&&a!==void 0?a:Td;if(v===0)h();else{var p=window.setTimeout(function(){return h()},v);s.setHoverTimer(p)}}},r.prototype.handleHeaderHover=function(e){var n=this.spreadsheet.getCell(e.target);if(!ke(n)){var i=this.spreadsheet.interaction;i.clearHoverTimer(),!i.isActiveCell(n)&&(i.changeState({cells:[Ii(n)],stateName:Xe.HOVER}),n.update(),this.showEllipsisTooltip(e,n))}},r.prototype.showEllipsisTooltip=function(e,n){if(!n||!n.isTextOverflowing()){this.spreadsheet.hideTooltip();return}var i=n.getMeta(),a={isTotals:i.isTotals,hideSummary:!0,onlyShowCellText:!0,enableFormat:!0},o=this.getCellData(i,a.onlyShowCellText);this.spreadsheet.showTooltipWithInfo(e,o,a)},r.prototype.getCellData=function(e,n){e===void 0&&(e={});var i=e.data,a=e.query,o=e.value,s=e.field,l=e.fieldValue,u=e.valueField,h=e.rowQuery,v=e.colQuery,p=i,m=n?[Y(Y({},a),{value:o||l,valueField:s||u})]:[p||Y(Y({},h),v)];return m},r.prototype.bindDataCellHover=function(){var e=this;this.spreadsheet.on(se.DATA_CELL_HOVER,function(n){var i=e.spreadsheet.getCell(n.target);if(!ke(i)){var a=e.spreadsheet,o=a.interaction,s=a.options,l=s.interaction,u=i==null?void 0:i.getMeta();o.isActiveCell(i)||(o.changeState({cells:[Ii(i)],stateName:Xe.HOVER}),l!=null&&l.hoverHighlight&&o.updateDataCellRelevantHeaderCells(Xe.HOVER,u),l!=null&&l.hoverFocus&&e.changeStateToHoverFocus(i,n))}})},r.prototype.bindHeaderCellHover=function(){var e=this;[se.ROW_CELL_HOVER,se.COL_CELL_HOVER,se.CORNER_CELL_HOVER].forEach(function(n){e.spreadsheet.on(n,function(i){e.handleHeaderHover(i)})})},r}(vi),C0=function(t){Me(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.displayedCells=[],e.brushRangeCells=[],e.brushSelectionStage=Hr.UN_DRAGGED,e.brushSelectionMinimumMoveDistance=5,e.scrollAnimationComplete=!0,e.mouseMoveDistanceFromCanvas=0,e.setMoveDistanceFromCanvas=function(n,i,a){var o=0;if(i&&(o=n.x),a){var s=n.y;i?o=Math.max(s,o):o=s}e.mouseMoveDistanceFromCanvas=Math.abs(o)},e.formatBrushPointForScroll=function(n,i){var a,o,s,l;i===void 0&&(i=!1);var u=n.x,h=n.y,v=e.spreadsheet.facet,p=i?v.cornerBBox:v.panelBBox,m=p.minX,C=p.maxX,w=v.panelBBox,b=w.minY,E=w.maxY,R=((a=e.endBrushPoint)===null||a===void 0?void 0:a.x)+u,M=((o=e.endBrushPoint)===null||o===void 0?void 0:o.y)+h,k=!0,L=!0,_=(l=(s=v.vScrollBar)===null||s===void 0?void 0:s.getBBox())===null||l===void 0?void 0:l.width,I=2;return R>C?R=C-_-I:R<m?R=m+I:k=!1,M>E?M=E-I:M<=b?M=b+I:L=!1,{x:{value:R,needScroll:k},y:{value:M,needScroll:L}}},e.autoScrollIntervalId=null,e.rectanglesIntersect=function(n,i){return n.maxX>i.minX&&n.minX<i.maxX&&n.minY<i.maxY&&n.maxY>i.minY},e.autoScrollConfig=t1(p1),e.validateYIndex=function(n){var i,a,o=e.spreadsheet.facet,s=o.frozenGroupInfo,l=0,u=(i=s==null?void 0:s.frozenRow)===null||i===void 0?void 0:i.range;if(u!=null&&u[1]&&(l=u[1]+1),n<l)return null;var h=o.getCellRange().end,v=(a=s==null?void 0:s.frozenTrailingRow)===null||a===void 0?void 0:a.range;return v!=null&&v[0]&&(h=v[0]-1),n>h?null:n},e.validateXIndex=function(n){var i,a,o=e.spreadsheet.facet,s=o.frozenGroupInfo,l=0,u=(i=s==null?void 0:s.frozenCol)===null||i===void 0?void 0:i.range;if(u!=null&&u[1]&&(l=u[1]+1),n<l)return null;var h=o.getColLeafNodes().length-1,v=(a=s==null?void 0:s.frozenTrailingCol)===null||a===void 0?void 0:a.range;return v!=null&&v[0]&&(h=v[0]-1),n>h?null:n},e.adjustNextColIndexWithFrozen=function(n,i){var a=e.spreadsheet,o=a.facet,s=a.dataSet,l=a.options,u=s.getDisplayDataSet().length,h=o.getColLeafNodes().length,v=bl(l.frozen,h,u),p=v.trailingColCount,m=v.colCount,C=o.panelScrollGroupIndexes;return p>0&&i===br.SCROLL_DOWN&&Tl(n,p,h)?C[1]:m>0&&i===br.SCROLL_UP&&El(n,m)?C[0]:n},e.adjustNextRowIndexWithFrozen=function(n,i){var a=e.spreadsheet,o=a.facet,s=a.dataSet,l=a.options,u=s.getDisplayDataSet().length,h=o.getColLeafNodes().length,v=o.getCellRange(),p=bl(l.frozen,h,u),m=p.trailingRowCount,C=p.rowCount,w=o.panelScrollGroupIndexes;return m>0&&i===br.SCROLL_DOWN&&Vl(n,v.end,m)?w[3]:C>0&&i===br.SCROLL_UP&&tf(n,v.start,C)?w[2]:n},e.getWillScrollRowIndexDiff=function(n){return n===br.SCROLL_DOWN?pc.SCROLL_DOWN:pc.SCROLL_UP},e.getDefaultWillScrollToRowIndex=function(n){var i=e.adjustNextRowIndexWithFrozen(e.endBrushPoint.rowIndex,n),a=i+e.getWillScrollRowIndexDiff(n);return e.validateYIndex(a)},e.getWillScrollToRowIndex=function(n){return e.getDefaultWillScrollToRowIndex(n)},e.getNextScrollDelta=function(n){var i=e.spreadsheet.facet.getScrollOffset(),a=i.scrollX,o=a===void 0?0:a,s=i.scrollY,l=s===void 0?0:s,u=0,h=0;if(n.y.scroll){var v=n.y.value>0?br.SCROLL_DOWN:br.SCROLL_UP,p=e.getWillScrollToRowIndex(v);if(nr(p))h=0;else{var m=Z9(p,v,e.spreadsheet)-l,C=nr(m)||Number.isNaN(m);h=C?0:m}}if(n.x.scroll){var v=n.x.value>0?br.SCROLL_DOWN:br.SCROLL_UP,w=e.adjustNextColIndexWithFrozen(e.endBrushPoint.colIndex,v),b=e.validateXIndex(w+(n.x.value>0?1:-1));u=nr(b)?0:K9(b,v,e.spreadsheet)-o}return{x:u,y:h}},e.onScrollAnimationComplete=function(){e.scrollAnimationComplete=!0,e.brushSelectionStage!==Hr.UN_DRAGGED&&e.renderPrepareSelected(e.endBrushPoint)},e.autoScroll=function(n){if(n===void 0&&(n=!1),!(e.brushSelectionStage===Hr.UN_DRAGGED||!e.scrollAnimationComplete)){var i=e.autoScrollConfig,a=e.spreadsheet.facet.getScrollOffset(),o=n?"rowHeaderOffsetX":"offsetX",s={rowHeaderOffsetX:{value:a.rowHeaderScrollX,animate:!0},offsetX:{value:a.scrollX,animate:!0},offsetY:{value:a.scrollY,animate:!0}},l=e.getNextScrollDelta(i),u=l.x,h=l.y;if(h===0&&u===0){e.clearAutoScroll();return}if(i.y.scroll&&(s.offsetY.value+=h),i.x.scroll){var v=s[o];v.value+=u,v.value<0&&(v.value=0)}e.scrollAnimationComplete=!1;var p=i.x.scroll?1:3,m=Math.max(16,300-e.mouseMoveDistanceFromCanvas*p);e.spreadsheet.facet.scrollWithAnimation(s,m,e.onScrollAnimationComplete)}},e.handleScroll=Dw(function(n,i,a){if(a===void 0&&(a=!1),e.brushSelectionStage!==Hr.UN_DRAGGED){var o=e.formatBrushPointForScroll({x:n,y:i},a),s=o.x,l=s.value,u=s.needScroll,h=o.y,v=h.value,p=h.needScroll,m=e.autoScrollConfig;p&&(m.y.value=i,m.y.scroll=!0),u&&(m.x.value=n,m.x.scroll=!0),e.setMoveDistanceFromCanvas({x:n,y:i},u,p),e.renderPrepareSelected({x:l,y:v}),(p||u)&&(e.clearAutoScroll(),e.autoScroll(a),e.autoScrollIntervalId=setInterval(function(){e.autoScroll(a)},16))}},30),e.clearAutoScroll=function(){e.autoScrollIntervalId&&(clearInterval(e.autoScrollIntervalId),e.autoScrollIntervalId=null,e.resetScrollDelta())},e.onUpdateCells=function(n,i){return i()},e.showPrepareSelectedCells=function(){e.brushRangeCells=e.getBrushRangeCells(),e.spreadsheet.interaction.changeState({cells:ct(e.brushRangeCells,function(n){return Ii(n)}),stateName:Xe.PREPARE_SELECT,force:!0,onUpdateCells:e.onUpdateCells})},e.renderPrepareSelected=function(n){var i=n.x,a=n.y,o=e.spreadsheet.container.document.elementsFromPointSync(i,a),s=o.map(function(m){return e.spreadsheet.getCell(m)}).find(Boolean),l=s instanceof Di||s instanceof lf||s instanceof $l;if(!(!s||!l)){var u=s.getMeta(),h=u.rowIndex,v=u.colIndex;e.endBrushPoint={x:i,y:a,rowIndex:h,colIndex:v};var p=e.spreadsheet.interaction;p.addIntercepts([Qe.HOVER]),p.clearStyleIndependent(),e.isValidBrushSelection()&&(e.showPrepareSelectedCells(),e.updatePrepareSelectMask())}},e}return r.prototype.bindEvents=function(){this.bindMouseDown(),this.bindMouseMove(),this.bindMouseUp()},r.prototype.getPrepareSelectMaskTheme=function(){var e;return(e=this.spreadsheet.theme)===null||e===void 0?void 0:e.prepareSelectMask},r.prototype.initPrepareSelectMaskShape=function(){var e,n=this.spreadsheet.facet.foregroundGroup;if(n){(e=this.prepareSelectMaskShape)===null||e===void 0||e.remove();var i=this.getPrepareSelectMaskTheme();this.prepareSelectMaskShape=n.appendChild(new Zt({style:{width:0,height:0,x:0,y:0,fill:i==null?void 0:i.backgroundColor,fillOpacity:i==null?void 0:i.backgroundOpacity,zIndex:rB,visibility:"hidden",pointerEvents:"none"}}))}},r.prototype.setBrushSelectionStage=function(e){this.brushSelectionStage=e},r.prototype.isPointInCanvas=function(e){var n=this.spreadsheet.facet.getCanvasSize(),i=n.height,a=n.width,o=this.spreadsheet.facet.panelBBox,s=o.minX,l=o.minY;return(e==null?void 0:e.x)>s&&(e==null?void 0:e.x)<a&&(e==null?void 0:e.y)>l&&(e==null?void 0:e.y)<i},r.prototype.resetDrag=function(){this.hidePrepareSelectMaskShape(),this.setBrushSelectionStage(Hr.UN_DRAGGED)},r.prototype.isValidBrushSelection=function(){var e=this.getBrushRange(),n=e.start,i=e.end,a=i.x-n.x>this.brushSelectionMinimumMoveDistance||i.y-n.y>this.brushSelectionMinimumMoveDistance;return a},r.prototype.setDisplayedCells=function(){this.displayedCells=this.spreadsheet.facet.getDataCells()},r.prototype.updatePrepareSelectMask=function(){var e=this.getBrushRange(),n=this.getPrepareSelectMaskPosition(e),i=n.x,a=n.y;this.prepareSelectMaskShape.attr({x:i,y:a,width:e.width,height:e.height}),this.prepareSelectMaskShape.setAttribute("visibility","visible")},r.prototype.hidePrepareSelectMaskShape=function(){var e;(e=this.prepareSelectMaskShape)===null||e===void 0||e.setAttribute("visibility","hidden")},r.prototype.resetScrollDelta=function(){this.autoScrollConfig=t1(p1)},r.prototype.getBrushPoint=function(e){var n=this.spreadsheet.facet.getScrollOffset(),i=n.scrollY,a=n.scrollX,o={x:e==null?void 0:e.x,y:e==null?void 0:e.y},s=this.spreadsheet.getCell(e.target),l=s.getMeta(),u=l.colIndex,h=l.rowIndex;return Y(Y({},o),{rowIndex:h,colIndex:u,scrollY:i,scrollX:a})},r.prototype.getBrushRange=function(){var e,n,i,a,o,s,l,u,h=this.spreadsheet.facet.getScrollOffset(),v=h.scrollX,p=v===void 0?0:v,m=h.scrollY,C=m===void 0?0:m,w=Math.min(this.startBrushPoint.rowIndex,(e=this.endBrushPoint)===null||e===void 0?void 0:e.rowIndex),b=Math.max(this.startBrushPoint.rowIndex,(n=this.endBrushPoint)===null||n===void 0?void 0:n.rowIndex),E=Math.min(this.startBrushPoint.colIndex,(i=this.endBrushPoint)===null||i===void 0?void 0:i.colIndex),R=Math.max(this.startBrushPoint.colIndex,(a=this.endBrushPoint)===null||a===void 0?void 0:a.colIndex),M=this.startBrushPoint.x+this.startBrushPoint.scrollX-p,k=this.startBrushPoint.y+this.startBrushPoint.scrollY-C,L=Math.min(M,(o=this.endBrushPoint)===null||o===void 0?void 0:o.x),_=Math.max(M,(s=this.endBrushPoint)===null||s===void 0?void 0:s.x),I=Math.min(k,(l=this.endBrushPoint)===null||l===void 0?void 0:l.y),P=Math.max(k,(u=this.endBrushPoint)===null||u===void 0?void 0:u.y);return{start:{rowIndex:w,colIndex:E,x:L,y:I},end:{rowIndex:b,colIndex:R,x:_,y:P},width:_-L,height:P-I}},r.prototype.getBrushRangeCells=function(){var e=this;return this.setDisplayedCells(),this.displayedCells.filter(function(n){var i=n.getMeta();return e.isInBrushRange(i)})},r.prototype.mouseDown=function(e){this.spreadsheet.interaction.hasIntercepts([Qe.CLICK])||(this.setBrushSelectionStage(Hr.CLICK),this.initPrepareSelectMaskShape(),this.setDisplayedCells(),this.startBrushPoint=this.getBrushPoint(e))},r.prototype.addBrushIntercepts=function(){this.spreadsheet.interaction.addIntercepts([Qe.DATA_CELL_BRUSH_SELECTION])},r.prototype.bindMouseUp=function(e){var n=this;e===void 0&&(e=!1),this.spreadsheet.on(se.GLOBAL_MOUSE_UP,function(i){if(n.brushSelectionStage!==Hr.DRAGGED){n.resetDrag();return}if(e&&n.clearAutoScroll(),n.isValidBrushSelection()){n.addBrushIntercepts(),n.updateSelectedCells();var a=p0(n.spreadsheet);n.spreadsheet.showTooltipWithInfo(i,a)}n.spreadsheet.interaction.getCurrentStateName()===Xe.PREPARE_SELECT&&n.spreadsheet.interaction.reset(),n.resetDrag()}),this.spreadsheet.on(se.GLOBAL_CONTEXT_MENU,function(){n.brushSelectionStage!==Hr.UN_DRAGGED&&(n.spreadsheet.interaction.removeIntercepts([Qe.HOVER]),n.resetDrag())})},r.prototype.autoBrushScroll=function(e,n){var i,a;if(n===void 0&&(n=!1),this.clearAutoScroll(),!this.isPointInCanvas(e)){var o=(e==null?void 0:e.x)-((i=this.endBrushPoint)===null||i===void 0?void 0:i.x),s=(e==null?void 0:e.y)-((a=this.endBrushPoint)===null||a===void 0?void 0:a.y);return this.handleScroll(o,s,n),!0}return!1},r.prototype.emitBrushSelectionEvent=function(e,n){this.spreadsheet.emit(e,n),this.spreadsheet.emit(se.GLOBAL_SELECTED,n),ke(n)&&this.spreadsheet.interaction.removeIntercepts([Qe.HOVER])},r.prototype.getVisibleBrushRangeCells=function(e){return this.brushRangeCells.find(function(n){var i=n.getMeta();return(i==null?void 0:i.id)===e})},r.prototype.isInBrushRange=function(e){return!1},r.prototype.bindMouseDown=function(){},r.prototype.bindMouseMove=function(){},r.prototype.updateSelectedCells=function(){},r.prototype.getPrepareSelectMaskPosition=function(e){return{x:e.start.x,y:e.start.y}},r}(vi),qH=function(t){Me(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.displayedCells=[],e.brushRangeCells=[],e.onUpdateCells=function(n){return n.updateCells(e.spreadsheet.facet.getColCells())},e}return r.prototype.bindEvents=function(){this.bindMouseDown(),this.bindMouseMove(),this.bindMouseUp()},r.prototype.bindMouseDown=function(){var e=this;this.spreadsheet.on(se.COL_CELL_MOUSE_DOWN,function(n){e.spreadsheet.interaction.getBrushSelection().colCell&&t.prototype.mouseDown.call(e,n)})},r.prototype.isPointInCanvas=function(e){var n=this.spreadsheet.facet.getCanvasSize().width,i=this.spreadsheet.facet.cornerBBox,a=i.width,o=i.minY,s=i.maxY;return e.x>=a&&e.x<=n&&e.y>=o&&e.y<=s},r.prototype.bindMouseMove=function(){var e=this;this.spreadsheet.on(se.COL_CELL_MOUSE_MOVE,function(n){var i;if(e.brushSelectionStage!==Hr.UN_DRAGGED){e.setBrushSelectionStage(Hr.DRAGGED);var a=(i=e.spreadsheet.interaction.eventController)===null||i===void 0?void 0:i.getViewportPoint(n);e.isPointInCanvas(a)&&e.renderPrepareSelected(a)}})},r.prototype.setDisplayedCells=function(){this.displayedCells=this.spreadsheet.facet.getColCells()},r.prototype.isInBrushRange=function(e){var n=this.getBrushRange(),i=n.start,a=n.end,o=this.spreadsheet.facet.getScrollOffset().scrollX,s=o===void 0?0:o,l=this.spreadsheet.facet.cornerBBox,u=e.x,h=u===void 0?0:u,v=e.y,p=v===void 0?0:v,m=e.width,C=m===void 0?0:m,w=e.height,b=w===void 0?0:w;return this.rectanglesIntersect({minX:i.x-l.width+s,minY:i.y,maxX:a.x-l.width+s,maxY:a.y},{minX:h,maxX:h+C,minY:p,maxY:p+b})},r.prototype.updateSelectedCells=function(){var e=this.spreadsheet,n=e.interaction,i=e.facet;n.changeState({cells:ct(this.brushRangeCells,Ii),onUpdateCells:function(a){a.updateCells(i.getColCells())},stateName:Xe.COL_CELL_BRUSH_SELECTED}),this.spreadsheet.emit(se.COL_CELL_BRUSH_SELECTION,this.brushRangeCells),this.spreadsheet.emit(se.GLOBAL_SELECTED,this.brushRangeCells),ke(this.brushRangeCells)&&n.removeIntercepts([Qe.HOVER])},r.prototype.addBrushIntercepts=function(){this.spreadsheet.interaction.addIntercepts([Qe.COL_CELL_BRUSH_SELECTION])},r}(C0),KH=function(t){Me(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.displayedCells=[],e.brushRangeCells=[],e.getSelectedCellMetas=function(n){var i=e.spreadsheet.facet,a=[],o=i.getRowLeafNodes(),s=i.getColLeafNodes(),l=ll(n.start.rowIndex,n.end.rowIndex+1),u=ll(n.start.colIndex,n.end.colIndex+1);return l.forEach(function(h){u.forEach(function(v){var p=String(s[v].id),m=ke(o)?String(h):String(o[h].id);a.push({colIndex:v,rowIndex:h,id:"".concat(m,"-").concat(p),type:Le.DATA_CELL,rowId:m,colId:p,spreadsheet:e.spreadsheet})})}),a},e}return r.prototype.bindMouseDown=function(){var e=this;this.spreadsheet.on(se.DATA_CELL_MOUSE_DOWN,function(n){e.spreadsheet.interaction.getBrushSelection().dataCell&&(t.prototype.mouseDown.call(e,n),e.resetScrollDelta())})},r.prototype.bindMouseMove=function(){var e=this;this.spreadsheet.on(se.GLOBAL_MOUSE_MOVE,function(n){if(e.brushSelectionStage!==Hr.UN_DRAGGED){e.setBrushSelectionStage(Hr.DRAGGED);var i=e.spreadsheet.interaction.eventController.getViewportPoint(n);e.autoBrushScroll(i)||e.renderPrepareSelected(i)}})},r.prototype.isInBrushRange=function(e){var n=this.getBrushRange(),i=n.start,a=n.end,o=e.rowIndex,s=e.colIndex;return o>=i.rowIndex&&o<=a.rowIndex&&s>=i.colIndex&&s<=a.colIndex},r.prototype.updateSelectedCells=function(){var e=this.getBrushRange(),n=this.getSelectedCellMetas(e);this.spreadsheet.interaction.changeState({cells:n,stateName:Xe.DATA_CELL_BRUSH_SELECTED,onUpdateCells:d0});var i=this.getScrollBrushRangeCells(n);this.emitBrushSelectionEvent(se.DATA_CELL_BRUSH_SELECTION,i)},r.prototype.getScrollBrushRangeCells=function(e){var n=this;return e.map(function(i){var a=n.getVisibleBrushRangeCells(i.id);if(a)return a;var o=n.spreadsheet.facet.getCellMeta(i.rowIndex,i.colIndex);return n.spreadsheet.options.dataCell(o)})},r.prototype.bindMouseUp=function(){t.prototype.bindMouseUp.call(this,!0)},r.prototype.getPrepareSelectMaskPosition=function(e){var n=this.spreadsheet.facet.panelBBox,i=n.minX,a=n.minY,o=Math.max(e.start.x,i),s=Math.max(e.start.y,a);return{x:o,y:s}},r}(C0),ZH=function(t){Me(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.displayedCells=[],e.brushRangeCells=[],e.isInBrushRange=function(n){var i=e.getBrushRange(),a=i.start,o=i.end,s=e.spreadsheet.facet.getScrollOffset(),l=s.scrollY,u=s.rowHeaderScrollX,h=e.spreadsheet.facet.cornerBBox,v=n.x,p=v===void 0?0:v,m=n.y,C=m===void 0?0:m,w=n.width,b=w===void 0?0:w,E=n.height,R=E===void 0?0:E;return e.rectanglesIntersect({minX:a.x+u,minY:a.y-h.height+l,maxX:o.x+u,maxY:o.y-h.height+l},{minX:p,maxX:p+b,minY:C,maxY:C+R})},e.onUpdateCells=function(n){return n.updateCells(e.spreadsheet.facet.getRowCells())},e.getSelectedRowNodes=function(){return e.spreadsheet.facet.getRowNodes().filter(e.isInBrushRange)},e.getVisibleRowLeafCellByScrollDirection=function(n){var i=e.spreadsheet.facet.getRowCells();return n===br.SCROLL_DOWN?mr(i):i.find(function(a){var o=a.getMeta();return o.isLeaf})},e.getWillScrollToRowIndex=function(n){var i,a;if(!nr(e.endBrushPoint.rowIndex))return e.getDefaultWillScrollToRowIndex(n);var o=e.getVisibleRowLeafCellByScrollDirection(n),s=(a=(i=o==null?void 0:o.getMeta())===null||i===void 0?void 0:i.rowIndex)!==null&&a!==void 0?a:0,l=s+e.getWillScrollRowIndexDiff(n);return e.validateYIndex(l)},e}return r.prototype.bindMouseDown=function(){var e=this;this.spreadsheet.on(se.ROW_CELL_MOUSE_DOWN,function(n){e.spreadsheet.interaction.getBrushSelection().rowCell&&t.prototype.mouseDown.call(e,n)})},r.prototype.isPointInCanvas=function(e){var n=this.spreadsheet.facet.getCanvasSize().height,i=this.spreadsheet.facet.cornerBBox,a=i.minX,o=i.height,s=i.maxX;return e.x>=a&&e.x<=s&&e.y>=o&&e.y<=n},r.prototype.bindMouseMove=function(){var e=this;this.spreadsheet.on(se.GLOBAL_MOUSE_MOVE,function(n){if(e.brushSelectionStage!==Hr.UN_DRAGGED){e.setBrushSelectionStage(Hr.DRAGGED);var i=e.spreadsheet.interaction.eventController.getViewportPoint(n);e.autoBrushScroll(i,!0)||e.renderPrepareSelected(i)}})},r.prototype.setDisplayedCells=function(){this.displayedCells=this.spreadsheet.facet.getRowCells()},r.prototype.updateSelectedCells=function(){var e=this.getSelectedRowNodes(),n=this.getScrollBrushRangeCells(e),i=ct(n,Ii);this.spreadsheet.interaction.changeState({cells:i,stateName:Xe.ROW_CELL_BRUSH_SELECTED,onUpdateCells:this.onUpdateCells}),this.emitBrushSelectionEvent(se.ROW_CELL_BRUSH_SELECTION,n)},r.prototype.addBrushIntercepts=function(){this.spreadsheet.interaction.addIntercepts([Qe.ROW_CELL_BRUSH_SELECTION])},r.prototype.getScrollBrushRangeCells=function(e){var n=this;return e.map(function(i){var a=n.getVisibleBrushRangeCells(i.id);return a||n.spreadsheet.facet.rowHeader.getCellInstance(i)})},r.prototype.getPrepareSelectMaskPosition=function(e){var n=this.spreadsheet.facet.panelBBox.minY,i=e.start.x,a=Math.max(e.start.y,n);return{x:i,y:a}},r}(C0),jH=function(t){Me(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.isMultiSelection=!1,e}return r.prototype.bindEvents=function(){this.bindKeyboardDown(),this.bindDataCellClick(),this.bindKeyboardUp(),this.bindMouseMove()},r.prototype.reset=function(){this.isMultiSelection=!1,this.spreadsheet.interaction.removeIntercepts([Qe.CLICK])},r.prototype.bindKeyboardDown=function(){var e=this;this.spreadsheet.on(se.GLOBAL_KEYBOARD_DOWN,function(n){Mc(n)&&(e.isMultiSelection=!0,e.spreadsheet.interaction.addIntercepts([Qe.CLICK]))})},r.prototype.bindKeyboardUp=function(){var e=this;this.spreadsheet.on(se.GLOBAL_KEYBOARD_UP,function(n){Mc(n)&&e.reset()})},r.prototype.bindMouseMove=function(){var e=this;this.spreadsheet.on(se.GLOBAL_MOUSE_MOVE,function(n){e.isMultiSelection&&!Kx(n)&&e.reset()})},r.prototype.getSelectedCells=function(e){var n=e.getMeta().id,i=this.spreadsheet.interaction,a=i.getCells([Le.DATA_CELL]),o=[];return i.getCurrentStateName()!==Xe.SELECTED&&(a=[]),a.find(function(s){return s.id===n})?o=a.filter(function(s){return s.id!==n}):o=pe(pe([],te(a),!1),[Ii(e)],!1),o},r.prototype.bindDataCellClick=function(){var e=this;this.spreadsheet.on(se.DATA_CELL_CLICK,function(n){n.stopPropagation();var i=e.spreadsheet.getCell(n.target),a=i.getMeta(),o=e.spreadsheet.interaction;if(e.isMultiSelection&&a){var s=e.getSelectedCells(i);if(ke(s)){o.clearState(),e.spreadsheet.hideTooltip(),e.spreadsheet.emit(se.GLOBAL_SELECTED,o.getActiveCells());return}o.addIntercepts([Qe.CLICK,Qe.HOVER]),e.spreadsheet.hideTooltip(),o.changeState({cells:s,stateName:Xe.SELECTED,onUpdateCells:d0}),e.spreadsheet.emit(se.GLOBAL_SELECTED,o.getActiveCells()),e.spreadsheet.showTooltipWithInfo(n,p0(e.spreadsheet))}})},r}(vi),JH=function(){function t(r){var e=this;this.canvasEventHandlers=[],this.s2EventHandlers=[],this.domEventListeners=[],this.isCanvasEffect=!1,this.isGuiIconShape=function(n){return n instanceof ex&&n.imgType===qv.type},this.isConditionIconShape=function(n,i){return i.getConditionIconShapes().some(function(a){var o;return(a==null?void 0:a.name)===((o=n==null?void 0:n.attributes)===null||o===void 0?void 0:o.name)})},this.onCanvasMousedown=function(n){if(e.target=n.target,e.spreadsheet.interaction.clearHoverTimer(),e.isResizeArea(n)){e.spreadsheet.emit(se.LAYOUT_RESIZE_MOUSE_DOWN,n);var i=function(o){if(!e.spreadsheet.getCanvasElement())return!1;e.spreadsheet.getCanvasElement()!==o.target&&e.spreadsheet.emit(se.LAYOUT_RESIZE_MOUSE_MOVE,o)};window.addEventListener(wt.POINTER_MOVE,i),window.addEventListener(wt.POINTER_UP,function(){window.removeEventListener(wt.POINTER_MOVE,i)},{once:!0});return}var a=e.spreadsheet.getCellType(n.target);switch(a){case Le.DATA_CELL:e.spreadsheet.emit(se.DATA_CELL_MOUSE_DOWN,n);break;case Le.ROW_CELL:e.spreadsheet.emit(se.ROW_CELL_MOUSE_DOWN,n);break;case Le.COL_CELL:e.spreadsheet.emit(se.COL_CELL_MOUSE_DOWN,n);break;case Le.CORNER_CELL:e.spreadsheet.emit(se.CORNER_CELL_MOUSE_DOWN,n);break;case Le.MERGED_CELL:e.spreadsheet.emit(se.MERGED_CELLS_MOUSE_DOWN,n);break}},this.onCanvasMousemove=function(n){if(e.canvasMousemoveEvent=n,e.isResizeArea(n)){e.activeResizeArea(n),e.spreadsheet.emit(se.LAYOUT_RESIZE_MOUSE_MOVE,n.nativeEvent);return}e.resetResizeArea();var i=e.spreadsheet.getCell(n.target);if(i){var a=i.cellType;switch(a){case Le.DATA_CELL:e.spreadsheet.emit(se.DATA_CELL_MOUSE_MOVE,n);break;case Le.ROW_CELL:e.spreadsheet.emit(se.ROW_CELL_MOUSE_MOVE,n);break;case Le.COL_CELL:e.spreadsheet.emit(se.COL_CELL_MOUSE_MOVE,n);break;case Le.CORNER_CELL:e.spreadsheet.emit(se.CORNER_CELL_MOUSE_MOVE,n);break;case Le.MERGED_CELL:e.spreadsheet.emit(se.MERGED_CELLS_MOUSE_MOVE,n);break}if(!e.hasBrushSelectionIntercepts())switch(e.spreadsheet.emit(se.GLOBAL_HOVER,n),a){case Le.DATA_CELL:e.spreadsheet.emit(se.DATA_CELL_HOVER,n);break;case Le.ROW_CELL:e.spreadsheet.emit(se.ROW_CELL_HOVER,n);break;case Le.COL_CELL:e.spreadsheet.emit(se.COL_CELL_HOVER,n);break;case Le.CORNER_CELL:e.spreadsheet.emit(se.CORNER_CELL_HOVER,n);break;case Le.MERGED_CELL:e.spreadsheet.emit(se.MERGED_CELLS_HOVER,n);break}}},this.onCanvasMouseup=function(n){if(e.isResizeArea(n)){e.spreadsheet.emit(se.LAYOUT_RESIZE_MOUSE_UP,n);return}var i=e.spreadsheet.getCell(n.target);if(i){var a=i.cellType;if(e.target===n.target){if(e.isGuiIconShape(n.target)&&!e.isConditionIconShape(n.target,i))return;switch(a){case Le.DATA_CELL:e.spreadsheet.emit(se.DATA_CELL_CLICK,n);break;case Le.ROW_CELL:e.spreadsheet.emit(se.ROW_CELL_CLICK,n);break;case Le.COL_CELL:e.spreadsheet.emit(se.COL_CELL_CLICK,n);break;case Le.CORNER_CELL:e.spreadsheet.emit(se.CORNER_CELL_CLICK,n);break;case Le.MERGED_CELL:e.spreadsheet.emit(se.MERGED_CELLS_CLICK,n);break}}switch(a){case Le.DATA_CELL:e.spreadsheet.emit(se.DATA_CELL_MOUSE_UP,n);break;case Le.ROW_CELL:e.spreadsheet.emit(se.ROW_CELL_MOUSE_UP,n);break;case Le.COL_CELL:e.spreadsheet.emit(se.COL_CELL_MOUSE_UP,n);break;case Le.CORNER_CELL:e.spreadsheet.emit(se.CORNER_CELL_MOUSE_UP,n);break;case Le.MERGED_CELL:e.spreadsheet.emit(se.MERGED_CELLS_MOUSE_UP,n);break}}},this.onCanvasClick=function(n){e.spreadsheet.emit(se.GLOBAL_CLICK,n),tr()&&e.onCanvasMouseup(n),n.detail===2&&e.onCanvasDoubleClick(n)},this.onCanvasDoubleClick=function(n){var i=e.spreadsheet;if(e.isResizeArea(n)){i.emit(se.LAYOUT_RESIZE_MOUSE_UP,n);return}i.emit(se.GLOBAL_DOUBLE_CLICK,n);var a=i.getCell(n.target);if(a){var o=a.cellType;if(e.target===n.target)switch(o){case Le.DATA_CELL:i.emit(se.DATA_CELL_DOUBLE_CLICK,n);break;case Le.ROW_CELL:i.emit(se.ROW_CELL_DOUBLE_CLICK,n);break;case Le.COL_CELL:i.emit(se.COL_CELL_DOUBLE_CLICK,n);break;case Le.CORNER_CELL:i.emit(se.CORNER_CELL_DOUBLE_CLICK,n);break;case Le.MERGED_CELL:i.emit(se.MERGED_CELLS_DOUBLE_CLICK,n);break}}},this.onCanvasMouseout=function(n){if(!(!e.isAutoResetSheetStyle||e.isMouseOnTheCanvasContainer(n))){var i=e.spreadsheet.interaction;!i.isSelectedState()&&!(i.intercepts.size>0)&&i.reset()}},this.onCanvasContextMenu=function(n){var i=e.spreadsheet;if(e.isResizeArea(n)){i.emit(se.LAYOUT_RESIZE_MOUSE_UP,n);return}i.emit(se.GLOBAL_CONTEXT_MENU,n);var a=e.spreadsheet.getCellType(n.target);switch(a){case Le.DATA_CELL:e.spreadsheet.emit(se.DATA_CELL_CONTEXT_MENU,n);break;case Le.ROW_CELL:e.spreadsheet.emit(se.ROW_CELL_CONTEXT_MENU,n);break;case Le.COL_CELL:e.spreadsheet.emit(se.COL_CELL_CONTEXT_MENU,n);break;case Le.CORNER_CELL:e.spreadsheet.emit(se.CORNER_CELL_CONTEXT_MENU,n);break;case Le.MERGED_CELL:e.spreadsheet.emit(se.MERGED_CELLS_CONTEXT_MENU,n);break}},this.spreadsheet=r,this.bindEvents()}return Object.defineProperty(t.prototype,"canvasContainer",{get:function(){return this.spreadsheet.container},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAutoResetSheetStyle",{get:function(){var r;return(r=this.spreadsheet.options.interaction)===null||r===void 0?void 0:r.autoResetSheetStyle},enumerable:!1,configurable:!0}),t.prototype.bindEvents=function(){var r=this;this.clearAllEvents(),this.addCanvasEvent(wt.CLICK,this.onCanvasClick),this.addCanvasEvent(wt.MOUSE_DOWN,this.onCanvasMousedown),this.addCanvasEvent(wt.TOUCH_START,function(e){r.target=e.target}),this.addCanvasEvent(wt.POINTER_MOVE,this.onCanvasMousemove),this.addCanvasEvent(wt.MOUSE_OUT,this.onCanvasMouseout),this.addCanvasEvent(wt.POINTER_UP,this.onCanvasMouseup),this.addCanvasEvent(ud.RIGHT_MOUSE_UP,this.onCanvasContextMenu),this.addS2Event(se.GLOBAL_ACTION_ICON_CLICK,function(){r.spreadsheet.interaction.addIntercepts([Qe.HOVER]),r.spreadsheet.interaction.clearState()}),this.addDomEventListener(window,wt.CLICK,function(e){r.resetSheetStyle(e),r.isCanvasEffect=r.isMouseOnTheCanvasContainer(e)}),this.addDomEventListener(window,wt.KEY_DOWN,function(e){r.onKeyboardCopy(e),r.onKeyboardEsc(e),r.spreadsheet.emit(se.GLOBAL_KEYBOARD_DOWN,e)}),this.addDomEventListener(window,wt.KEY_UP,function(e){r.spreadsheet.emit(se.GLOBAL_KEYBOARD_UP,e)}),this.addDomEventListener(window,wt.POINTER_UP,function(e){r.spreadsheet.emit(se.GLOBAL_MOUSE_UP,e)}),this.addDomEventListener(window,wt.POINTER_MOVE,function(e){r.spreadsheet.emit(se.GLOBAL_MOUSE_MOVE,e)})},t.prototype.onKeyboardCopy=function(r){var e=this.spreadsheet.options.interaction.copy;if(this.isCanvasEffect&&(e!=null&&e.enable)&&O1(r.key,Ur.COPY)&&(r.metaKey||r.ctrlKey)){var n=JF(this.spreadsheet);nr(n)||this.spreadsheet.emit(se.GLOBAL_COPIED,n)}},t.prototype.onKeyboardEsc=function(r){this.isCanvasEffect&&O1(r.key,Ur.ESC)&&this.resetSheetStyle(r)},t.prototype.resetSheetStyle=function(r){var e,n;if(!(!this.isAutoResetSheetStyle||!this.spreadsheet)){var i=this.spreadsheet.interaction;if(!((e=i==null?void 0:i.hasIntercepts)===null||e===void 0)&&e.call(i,[Qe.DATA_CELL_BRUSH_SELECTION,Qe.COL_CELL_BRUSH_SELECTION,Qe.ROW_CELL_BRUSH_SELECTION])){(n=i==null?void 0:i.removeIntercepts)===null||n===void 0||n.call(i,[Qe.DATA_CELL_BRUSH_SELECTION,Qe.ROW_CELL_BRUSH_SELECTION,Qe.COL_CELL_BRUSH_SELECTION]);return}this.isMouseOnTheTooltip(r)||this.isMouseOnTheCanvasContainer(r)||(i.reset(),this.spreadsheet.emit(se.GLOBAL_RESET,r),this.spreadsheet.emit(se.GLOBAL_SELECTED,i.getActiveCells()))}},t.prototype.isMouseEvent=function(r){return os(r,"clientX")&&os(r,"clientY")},t.prototype.isMatchElement=function(r){var e=this.spreadsheet.getCanvasElement(),n=r.target;return n===e||n instanceof mn||n instanceof sd},t.prototype.isMatchPoint=function(r){var e=this.spreadsheet.getCanvasElement(),n=this.getContainerRect(),i=n.width,a=n.height,o=e.getBoundingClientRect()||{},s=o.x,l=o.y,u=r.clientX,h=r.clientY;return u<=s+i&&u>=s&&h<=l+a&&h>=l},t.prototype.isMouseOnTheCanvasContainer=function(r){if(this.isMouseEvent(r)){var e=this.spreadsheet.getCanvasElement();return e?this.isMatchElement(r)&&this.isMatchPoint(r):!1}return!1},t.prototype.getContainerRect=function(){var r,e=this.spreadsheet,n=e.facet,i=e.options,a=(n==null?void 0:n.hRowScrollBar)||(n==null?void 0:n.hScrollBar),o=(n==null?void 0:n.panelBBox)||{},s=o.maxX,l=o.maxY,u=i.width,h=u===void 0?0:u,v=i.height,p=v===void 0?0:v,m=((r=a==null?void 0:a.theme)===null||r===void 0?void 0:r.size)||0;return{width:Math.min(h,s),height:Math.min(p,l+m)}},t.prototype.isMouseOnTheTooltip=function(r){var e,n,i,a,o=this.spreadsheet.tooltip;if(!(o!=null&&o.visible))return!1;var s=((i=(n=(e=this.spreadsheet.tooltip)===null||e===void 0?void 0:e.container)===null||n===void 0?void 0:n.getBoundingClientRect)===null||i===void 0?void 0:i.call(n))||{},l=s.x,u=s.y,h=s.width,v=s.height;return r.target instanceof Node?c7((a=this.spreadsheet.tooltip)===null||a===void 0?void 0:a.container,r.target):this.isMouseEvent(r)?r.clientX>=l&&r.clientX<=l+h&&r.clientY>=u&&r.clientY<=u+v:!1},t.prototype.isResizeArea=function(r){var e=bx(r.target);return e==null?void 0:e.isResizeArea},t.prototype.activeResizeArea=function(r){var e,n,i,a=dt(r.target,"attrs.appendInfo");if(!(a!=null&&a.isResizeMask)){this.resetResizeArea();var o=r.target;this.spreadsheet.store.set("activeResizeArea",o),o.attr(xn.backgroundOpacity,(i=(n=(e=this.spreadsheet.theme.resizeArea)===null||e===void 0?void 0:e.interactionState)===null||n===void 0?void 0:n.hover)===null||i===void 0?void 0:i.backgroundOpacity)}},t.prototype.resetResizeArea=function(){var r,e=this.spreadsheet.store.get("activeResizeArea");ke(e)||e.attr(xn.backgroundOpacity,(r=this.spreadsheet.theme.resizeArea)===null||r===void 0?void 0:r.backgroundOpacity),this.spreadsheet.store.set("activeResizeArea",e)},t.prototype.hasBrushSelectionIntercepts=function(){return this.spreadsheet.interaction.hasIntercepts([Qe.HOVER,Qe.DATA_CELL_BRUSH_SELECTION,Qe.ROW_CELL_BRUSH_SELECTION,Qe.COL_CELL_BRUSH_SELECTION])},t.prototype.clear=function(){this.unbindEvents()},t.prototype.unbindEvents=function(){this.clearAllEvents()},t.prototype.addCanvasEvent=function(r,e){var n;(n=this.canvasContainer)===null||n===void 0||n.on(r,e),this.canvasEventHandlers.push({type:r,handler:e})},t.prototype.addS2Event=function(r,e){this.spreadsheet.on(r,e),this.s2EventHandlers.push({type:r,handler:e})},t.prototype.addDomEventListener=function(r,e,n){if(r.addEventListener){var i=this.spreadsheet.options.interaction.eventListenerOptions;r.addEventListener(e,n,i),this.domEventListeners.push({target:r,type:e,handler:n,options:i})}else console.error("Please make sure ".concat(r," has addEventListener function"))},t.prototype.clearAllEvents=function(){var r=this;tt(this.canvasEventHandlers,function(e){var n,i=e.type,a=e.handler;(n=r.canvasContainer)===null||n===void 0||n.removeEventListener(i,a)}),tt(this.s2EventHandlers,function(e){var n=e.type,i=e.handler;r.spreadsheet.off(n,i)}),tt(this.domEventListeners,function(e){e.target.removeEventListener(e.type,e.handler,e.options)}),this.canvasEventHandlers=[],this.s2EventHandlers=[],this.domEventListeners=[]},t.prototype.getViewportPoint=function(r){var e=this.spreadsheet.getCanvasConfig();return e.supportsCSSTransform&&!nr(r.offsetX)&&!nr(r.offsetY)?{x:r.offsetX,y:r.offsetY}:this.spreadsheet.container.client2Viewport({x:r.clientX,y:r.clientY})},t}(),QH=function(t){Me(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.isRangeSelection=!1,e.handleColClick=function(n){n.stopPropagation();var i=e.spreadsheet,a=i.interaction,o=i.facet,s=e.spreadsheet.getCell(n.target),l=s==null?void 0:s.getMeta();if(!nr(l==null?void 0:l.x)){a.addIntercepts([Qe.HOVER]);var u=[Ii(s)],h=e.spreadsheet.store.get("lastClickedCell");if(e.isRangeSelection&&h&&h.cellType===s.cellType&&h.getMeta().level===l.level){var v=o.getLayoutResult(),p=v.rowsHierarchy,m=v.colsHierarchy,C=te([p.maxLevel,m.maxLevel],2),w=C[0],b=C[1],E=Gd(h.getMeta(),l),R=E.start,M=E.end;s instanceof Di?u=e.handleSeriesNumberRowSelected(R.rowIndex,M.rowIndex,s):(s==null?void 0:s.cellType)===Le.ROW_CELL&&l.level===w?u=e.handleRowSelected(R.rowIndex,M.rowIndex,s):(s==null?void 0:s.cellType)===Le.COL_CELL&&l.level===b&&(u=e.handleColSelected(R.colIndex,M.colIndex,s)),a.changeState({cells:u,stateName:Xe.SELECTED})}else ke(a.getCells())&&a.removeIntercepts([Qe.HOVER]),e.spreadsheet.store.set("lastClickedCell",s);var k=u.map(function(L){var _=L.id;return _});a.updateCells(o.getHeaderCells(k)),e.spreadsheet.emit(se.GLOBAL_SELECTED,a.getActiveCells())}},e}return r.prototype.bindEvents=function(){this.bindKeyboardDown(),this.bindDataCellClick(),this.bindColCellClick(),this.bindKeyboardUp(),this.bindMouseMove()},r.prototype.reset=function(){this.isRangeSelection=!1,this.spreadsheet.interaction.removeIntercepts([Qe.CLICK])},r.prototype.bindKeyboardDown=function(){var e=this;this.spreadsheet.on(se.GLOBAL_KEYBOARD_DOWN,function(n){n.key===Ur.SHIFT&&(e.isRangeSelection=!0,e.spreadsheet.interaction.addIntercepts([Qe.CLICK]))})},r.prototype.bindKeyboardUp=function(){var e=this;this.spreadsheet.on(se.GLOBAL_KEYBOARD_UP,function(n){n.key===Ur.SHIFT&&e.reset()})},r.prototype.bindMouseMove=function(){var e=this;this.spreadsheet.on(se.GLOBAL_MOUSE_MOVE,function(n){e.isRangeSelection&&!n.shiftKey&&e.reset()})},r.prototype.bindColCellClick=function(){var e=this;this.spreadsheet.isTableMode()&&this.spreadsheet.on(se.ROW_CELL_CLICK,function(n){e.handleColClick(n)}),this.spreadsheet.on(se.COL_CELL_CLICK,function(n){e.handleColClick(n)})},r.prototype.bindDataCellClick=function(){var e=this;this.spreadsheet.on(se.DATA_CELL_CLICK,function(n){n.stopPropagation();var i=e.spreadsheet.getCell(n.target),a=i.getMeta(),o=e.spreadsheet.interaction;if(a){var s=e.spreadsheet.store.get("lastClickedCell"),l=e.isRangeSelection&&(s==null?void 0:s.cellType)===i.cellType;if(!l){e.spreadsheet.store.set("lastClickedCell",i);return}var u=Gd(s.getMeta(),i.getMeta()),h=u.start,v=u.end,p=ll(h.colIndex,v.colIndex+1).flatMap(function(m){var C=e.spreadsheet.facet.getColLeafNodes()[m].id;return ll(h.rowIndex,v.rowIndex+1).map(function(w){var b=e.spreadsheet.facet.getSeriesNumberWidth()||e.spreadsheet.isTableMode()?String(w):e.spreadsheet.facet.getRowLeafNodes()[w].id;return{id:"".concat(b,"-").concat(C),colIndex:m,rowIndex:w,type:i.cellType}})});o.addIntercepts([Qe.CLICK,Qe.HOVER]),o.changeState({cells:p,stateName:Xe.SELECTED}),e.spreadsheet.showTooltipWithInfo(n,p0(e.spreadsheet)),e.spreadsheet.emit(se.GLOBAL_SELECTED,o.getActiveCells())}})},r.prototype.handleSeriesNumberRowSelected=function(e,n,i){var a=this.spreadsheet.facet.getColLeafNodes()[0].id;return ll(e,n+1).map(function(o){var s=String(o);return{id:"".concat(s,"-").concat(a),colIndex:0,rowIndex:o,type:i.cellType}})},r.prototype.handleRowSelected=function(e,n,i){return this.spreadsheet.facet.getRowNodes().filter(function(a){var o=a.rowIndex;return s1(o,e,n+1)}).map(function(a){return{id:a.id,colIndex:a.colIndex,rowIndex:a.rowIndex,type:i.cellType}})},r.prototype.handleColSelected=function(e,n,i){return this.spreadsheet.facet.getColLeafNodes().filter(function(a){var o=a.colIndex;return s1(o,e,n+1)}).map(function(a){return{id:a.id,colIndex:a.colIndex,rowIndex:a.rowIndex,type:i.cellType}})},r}(vi),ez=function(t){Me(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.resizeStartPosition={},e}return r.prototype.bindEvents=function(){this.bindMouseDown(),this.bindMouseMove(),this.bindMouseUp()},r.prototype.initResizeGroup=function(){if(!this.resizeReferenceGroup){this.resizeReferenceGroup=this.spreadsheet.facet.foregroundGroup.appendChild(new Ft);var e=this.spreadsheet.options,n=e.width,i=e.height,a=this.getResizeAreaTheme(),o=a.guideLineColor,s=a.guideLineDash,l=a.size,u={path:"",lineDash:s,stroke:o,lineWidth:l};this.resizeReferenceGroup.appendChild(new od({id:MB,style:u})),this.resizeReferenceGroup.appendChild(new od({id:OB,style:u})),this.resizeReferenceGroup.appendChild(new cs({id:AB,style:{x:0,y:0,width:n,height:i,fill:"transparent"}},{isResizeArea:!0,isResizeMask:!0}))}},r.prototype.getResizeAreaTheme=function(){return this.spreadsheet.theme.resizeArea},r.prototype.setResizeTarget=function(e){this.resizeTarget=e},r.prototype.getGuideLineWidthAndHeight=function(){var e=this.spreadsheet.options,n=e.width,i=e.height,a=this.spreadsheet.facet.panelBBox,o=a.maxY,s=a.maxX,l=Math.min(s,n),u=Math.min(o,i);return{width:l,height:u}},r.prototype.getResizeShapes=function(){var e;return((e=this.resizeReferenceGroup)===null||e===void 0?void 0:e.children)||[]},r.prototype.setResizeMaskCursor=function(e){var n=te(this.getResizeShapes(),3),i=n[2];i==null||i.attr("cursor",e)},r.prototype.updateResizeGuideLinePosition=function(e,n){var i=this.getResizeShapes();if(!ke(i)){var a=te(i,2),o=a[0],s=a[1],l=n.type,u=n.offsetX,h=n.offsetY,v=n.width,p=n.height,m=n.size,C=this.getGuideLineWidthAndHeight(),w=C.width,b=C.height;this.cursorType="".concat(l,"-resize"),this.setResizeMaskCursor(this.cursorType);var E=m/2;if(l===zr.Horizontal){o.attr("path",[["M",u+E,h],["L",u+E,b]]),s.attr("path",[["M",u+v-E,h],["L",u+v-E,b]]),this.resizeStartPosition.offsetX=e.offsetX,this.resizeStartPosition.clientX=e.clientX;return}o.attr("path",[["M",u,h+E],["L",w,h+E]]),s.attr("path",[["M",u,h+p-E],["L",w,h+p-E]]),this.resizeStartPosition.offsetY=e.offsetY,this.resizeStartPosition.clientY=e.clientY}},r.prototype.bindMouseDown=function(){var e=this;this.spreadsheet.on(se.LAYOUT_RESIZE_MOUSE_DOWN,function(n){var i=n.target,a=e.getCellAppendInfo(n.target);e.spreadsheet.store.set("resized",!1),a!=null&&a.isResizeArea&&(e.spreadsheet.hideTooltip(),e.spreadsheet.interaction.addIntercepts([Qe.RESIZE]),e.setResizeTarget(i),e.showResizeGroup(),e.updateResizeGuideLinePosition(n,a))})},r.prototype.bindMouseMove=function(){this.spreadsheet.on(se.LAYOUT_RESIZE_MOUSE_MOVE,Dw(this.resizeMouseMove.bind(this),33))},r.prototype.getResizeGuideLinePosition=function(){var e,n=te(((e=this.resizeReferenceGroup)===null||e===void 0?void 0:e.children)||[],2),i=n[0],a=n[1],o=(i==null?void 0:i.attr("path"))||[],s=(a==null?void 0:a.attr("path"))||[],l=te(o[0]||[],3),u=l[1],h=u===void 0?0:u,v=l[2],p=v===void 0?0:v,m=te(s[0]||[],3),C=m[1],w=C===void 0?0:C,b=m[2],E=b===void 0?0:b;return{start:{x:+h,y:+p},end:{x:+w,y:+E}}},r.prototype.getDisAllowResizeInfo=function(){var e,n=this.getResizeInfo(),i=this.spreadsheet.options.interaction.resize,a=n.width,o=n.height,s=n.resizedWidth,l=s===void 0?0:s,u=n.resizedHeight,h=u===void 0?0:u,v=(e=i==null?void 0:i.disable)===null||e===void 0?void 0:e.call(i,n),p=v?a:l,m=v?o:h;return{displayWidth:p,displayHeight:m,isDisabled:v}},r.prototype.getResizeCellField=function(e){var n,i,a,o,s,l=e.type===zr.Vertical,u=l?!this.isEffectRowOf(bi.ALL):!this.isEffectColOf(bi.ALL);return this.spreadsheet.isTableMode()?l?((n=e==null?void 0:e.meta)===null||n===void 0?void 0:n.rowId)||String((i=e==null?void 0:e.meta)===null||i===void 0?void 0:i.rowIndex):(a=e==null?void 0:e.meta)===null||a===void 0?void 0:a.field:u?(o=e==null?void 0:e.meta)===null||o===void 0?void 0:o.id:(s=e==null?void 0:e.meta)===null||s===void 0?void 0:s.field},r.prototype.isEffectRowOf=function(e){var n,i;return((i=(n=this.spreadsheet.options.interaction)===null||n===void 0?void 0:n.resize)===null||i===void 0?void 0:i.rowResizeType)===e},r.prototype.isEffectColOf=function(e){var n,i;return((i=(n=this.spreadsheet.options.interaction)===null||n===void 0?void 0:n.resize)===null||i===void 0?void 0:i.colResizeType)===e},r.prototype.getCellStyleByField=function(e){var n,i=this,a=this.spreadsheet.interaction,o=this.getResizeInfo(),s=o.type===zr.Vertical,l=s?a.getActiveRowCells():a.getActiveColCells(),u=a.isSelectedState()&&l.length>1;return!this.isEffectRowOf(bi.SELECTED)||!this.isEffectColOf(bi.SELECTED)||!u?(n={},n[this.getResizeCellField(o)]=e,n):l.reduce(function(h,v){return pr.getAllLeaveNodes(v.getMeta()).forEach(function(p){var m=Y(Y({},o),{meta:p});h[i.getResizeCellField(m)]=e}),h},{})},r.prototype.getResizeWidthDetail=function(){var e,n=this.getResizeInfo(),i=this.getDisAllowResizeInfo().displayWidth;switch(n.effect){case Qr.Field:return{eventType:se.LAYOUT_RESIZE_ROW_WIDTH,style:{rowCell:{widthByField:(e={},e[n.meta.field]=i,e)}}};case Qr.Tree:return{eventType:se.LAYOUT_RESIZE_TREE_WIDTH,style:{rowCell:{width:i}}};case Qr.Cell:return{eventType:se.LAYOUT_RESIZE_COL_WIDTH,style:{colCell:{width:this.isEffectColOf(bi.ALL)?i:null,widthByField:this.getCellStyleByField(i)}}};case Qr.Series:return{eventType:se.LAYOUT_RESIZE_SERIES_WIDTH,seriesNumberWidth:i};default:return null}},r.prototype.getResizeHeightDetail=function(){var e=this.getResizeInfo(),n=this.getDisAllowResizeInfo().displayHeight;switch(e.effect){case Qr.Field:return{eventType:se.LAYOUT_RESIZE_COL_HEIGHT,style:{colCell:{heightByField:this.getHeightByField(e,n)}}};case Qr.Cell:return{eventType:se.LAYOUT_RESIZE_ROW_HEIGHT,style:{rowCell:{height:this.isEffectRowOf(bi.ALL)?n:null,heightByField:this.getCellStyleByField(n)}}};default:return null}},r.prototype.getHeightByField=function(e,n){var i;return this.spreadsheet.isCustomColumnFields()||this.spreadsheet.isTableMode()?this.spreadsheet.facet.getColNodes().filter(function(a){var o,s;return a.level===((o=e.meta)===null||o===void 0?void 0:o.level)&&a.height===((s=e.meta)===null||s===void 0?void 0:s.height)}).reduce(function(a,o){return a[o.field]=n,a},{}):(i={},i[e.meta.field]=n,i)},r.prototype.getResizeDetail=function(){var e=this.getResizeInfo();return e.type===zr.Horizontal?this.getResizeWidthDetail():this.getResizeHeightDetail()},r.prototype.showResizeGroup=function(){var e;this.initResizeGroup(),(e=this.resizeReferenceGroup)===null||e===void 0||e.setAttribute("visibility","visible")},r.prototype.hideResizeGroup=function(){var e;(e=this.resizeReferenceGroup)===null||e===void 0||e.setAttribute("visibility","hidden")},r.prototype.bindMouseUp=function(){var e=this;this.spreadsheet.on(se.GLOBAL_MOUSE_UP,function(){var n;e.cursorType="default",e.setResizeMaskCursor(e.cursorType),!(!e.resizeReferenceGroup||ke((n=e.resizeReferenceGroup)===null||n===void 0?void 0:n.children))&&(e.hideResizeGroup(),e.renderResizedResult())})},r.prototype.resizeMouseMove=function(e){var n,i;if(((n=this.resizeReferenceGroup)===null||n===void 0?void 0:n.parsedStyle.visibility)==="visible"){var a=this.getResizeInfo(),o=((i=this.resizeReferenceGroup)===null||i===void 0?void 0:i.children)||[];if(!ke(o)){var s=te(o,2),l=s[1],u=te($c(l.attr("path")),2),h=u[0],v=u[1];a.type===zr.Horizontal?this.updateHorizontalResizingEndGuideLinePosition(e.offsetX,a,{start:h,end:v}):this.updateVerticalResizingEndGuideLinePosition(e.offsetY,a,{start:h,end:v}),this.updateResizeGuideLineTheme(l),l.attr("path",[h,v])}}},r.prototype.updateResizeGuideLineTheme=function(e){var n=this.getResizeAreaTheme(),i=n.guideLineColor,a=n.guideLineDisableColor,o=this.getDisAllowResizeInfo().isDisabled;e.attr("stroke",o?a:i),this.setResizeMaskCursor(o?"no-drop":this.cursorType)},r.prototype.updateHorizontalResizingEndGuideLinePosition=function(e,n,i){var a,o,s=(((a=this.spreadsheet.options.interaction)===null||a===void 0?void 0:a.resize)||{}).minCellWidth,l=s===void 0?Yw:s,u=e-this.resizeStartPosition.offsetX;n.width+u<l&&(u=-(n.width-l));var h=n.offsetX+n.width+u,v=n.size/2;i.start[1]=h-v,i.end[1]=h-v,(o=this.resizeTarget)===null||o===void 0||o.attr({x:h-n.size})},r.prototype.updateVerticalResizingEndGuideLinePosition=function(e,n,i){var a,o,s=(((a=this.spreadsheet.options.interaction)===null||a===void 0?void 0:a.resize)||{}).minCellHeight,l=s===void 0?$w:s,u=e-this.resizeStartPosition.offsetY;n.height+u<l&&(u=-(n.height-l));var h=n.offsetY+n.height+u,v=n.size/2;i.start[2]=h-v,i.end[2]=h-v,(o=this.resizeTarget)===null||o===void 0||o.attr({y:h-n.size})},r.prototype.renderResizedResult=function(){var e=this.getResizeInfo(),n=this.getResizeDetail()||{},i=n.style,a=n.seriesNumberWidth,o=n.eventType,s={info:e,style:i};this.spreadsheet.emit(se.LAYOUT_RESIZE,s),this.spreadsheet.emit(o,s),i&&this.spreadsheet.setOptions({style:i}),a&&this.spreadsheet.setTheme({rowCell:{seriesNumberWidth:a}}),this.spreadsheet.store.set("resized",!0),this.render()},r.prototype.getResizeInfo=function(){var e=this.getCellAppendInfo(this.resizeTarget),n=this.getResizeGuideLinePosition(),i=n.start,a=n.end,o=xt(a.x-i.x+(e.type===zr.Horizontal?e.size:0)),s=xt(a.y-i.y+(e.type===zr.Vertical?e.size:0));return Y(Y({},e),{resizedWidth:o,resizedHeight:s})},r.prototype.render=function(){this.resizeStartPosition={},this.resizeTarget=null,this.resizeReferenceGroup=null,this.spreadsheet.render(!1)},r}(vi),tz=[Ur.ARROW_LEFT,Ur.ARROW_RIGHT,Ur.ARROW_UP,Ur.ARROW_DOWN],rz=function(t){Me(r,t);function r(e){return t.call(this,e)||this}return r.prototype.isCanvasEffect=function(){return this.spreadsheet.interaction.eventController.isCanvasEffect},r.prototype.bindEvents=function(){var e=this;this.spreadsheet.on(se.GLOBAL_KEYBOARD_DOWN,function(n){if(e.isCanvasEffect()){var i=n.shiftKey,a=n.metaKey,o=tz.includes(n.key),s=!1,l=!1,u=!1;o&&(a&&i?(s=!1,l=!0,u=!1):a?(s=!0,l=!0,u=!0):i?(s=!1,l=!1,u=!1):(s=!0,l=!1,u=!0),e.handleMove({event:n,changeStartCell:s,isJumpMode:l,isSingleSelection:u}))}}),this.spreadsheet.on(se.DATA_CELL_CLICK,function(n){var i=e.spreadsheet.getCell(n.target),a=i==null?void 0:i.getMeta();a&&(e.startCell=e.getCellMetaByViewMeta(a),e.endCell=e.startCell)})},r.prototype.getCellMetaByViewMeta=function(e){return{rowIndex:e.rowIndex,colIndex:e.colIndex,id:e.id,type:Le.DATA_CELL}},r.prototype.handleMove=function(e){var n=e.event,i=e.changeStartCell,a=e.isJumpMode,o=e.isSingleSelection,s=this,l=s.spreadsheet,u=s.startCell,h=s.endCell,v=i?u:h,p=this.getMoveInfo(n.key,v,a);if(p){var m=te([p.row,p.col],2),C=m[0],w=m[1];this.scrollToActiveCell(l,C,w);var b=this.generateCellMeta(l,C,w),E=o?[b]:this.getRangeCells(l,u,b);Y9(l,E),i&&(this.startCell=b),this.endCell=b,this.spreadsheet.emit(se.DATA_CELL_SELECT_MOVE,E)}},r.prototype.generateCellMeta=function(e,n,i){var a=e.isTableMode,o=e.facet,s=o.getRowLeafNodes(),l=o.getColLeafNodes(),u=a()?String(n):s[n].id,h=l[i].id;return{rowIndex:n,colIndex:i,id:ef(u,h),type:Le.DATA_CELL}},r.prototype.getRangeCells=function(e,n,i){for(var a=Gd(n,i),o=a.start,s=o.rowIndex,l=o.colIndex,u=a.end,h=u.rowIndex,v=u.colIndex,p=[],m=s;m<=h;m++)for(var C=l;C<=v;C++)p.push(this.generateCellMeta(e,m,C));return p},r.prototype.getMoveInfo=function(e,n,i){var a=this.spreadsheet,o=a.options.frozen,s=o.rowCount,l=s===void 0?0:s,u=o.trailingRowCount,h=u===void 0?0:u,v=o.colCount,p=v===void 0?0:v,m=o.trailingColCount,C=m===void 0?0:m,w=a.facet.getRowLeafNodes(),b=a.facet.getColLeafNodes(),E=te([0+p,b.length-C-1],2),R=E[0],M=E[1],k=te([0+l,(a.isTableMode()?a.dataSet.getDisplayDataSet().length:w.length)-h-1],2),L=k[0],_=k[1];if(n)switch(e){case Ur.ARROW_RIGHT:return n.colIndex+1>M?void 0:{row:n.rowIndex,col:i?M:n.colIndex+1};case Ur.ARROW_LEFT:return n.colIndex-1<R?void 0:{row:n.rowIndex,col:i?R:n.colIndex-1};case Ur.ARROW_UP:return n.rowIndex-1<L?void 0:{row:i?L:n.rowIndex-1,col:n.colIndex};case Ur.ARROW_DOWN:return n.rowIndex+1>_?void 0:{row:i?_:n.rowIndex+1,col:n.colIndex}}},r.prototype.calculateOffset=function(e,n,i){var a=e.options.frozen,o=a.rowCount,s=o===void 0?0:o,l=a.trailingRowCount,u=l===void 0?0:l,h=e.facet,v=h.frozenColGroup,p=h.frozenTrailingColGroup,m=h.frozenRowGroup,C=h.frozenTrailingRowGroup,w=h.getColLeafNodes(),b=h.getScrollOffset(),E=b.scrollX,R=b.scrollY,M=h.panelBBox,k=M.viewportHeight,L=M.viewportWidth,_=dt(e,"theme.splitLine"),I=v?xt(v.getBBox().width-_.verticalBorderWidth/2):0,P=p?xt(p.getBBox().width):0,U=m?xt(m.getBBox().height-_.horizontalBorderWidth/2):0,q=C?xt(C.getBBox().height):0,Q=_x({scrollX:E,scrollY:R,widths:h.viewCellWidths,heights:h.viewCellHeights,viewport:{width:L-I-P,height:k-U-q,x:I,y:U},rowRemainWidth:h.getRealScrollX(h.cornerBBox.width)}),J=-1,re=-1,ne=w.find(function(me){return me.colIndex===i});if(i<=Q[0]?J=(ne==null?void 0:ne.x)-I:i>=Q[1]&&i<w.length-u&&(J=(ne==null?void 0:ne.x)+(ne==null?void 0:ne.width)-L+P),n<=Q[2])re=h.viewCellHeights.getCellOffsetY(n-s);else if(n>=Q[3]){var ce=h.viewCellHeights.getCellOffsetY(n+1);re=ce+q-k}return{offsetX:J,offsetY:re}},r.prototype.scrollToActiveCell=function(e,n,i){var a=this.calculateOffset(e,n,i),o=a.offsetX,s=a.offsetY,l=e.facet,u=e.facet.getScrollOffset(),h=u.scrollX,v=u.scrollY;l.scrollWithAnimation({offsetX:{value:o>-1?o:h},offsetY:{value:s>-1?s:v}})},r}(vi),nz=function(){function t(r){var e=this;this.interactions=new Map,this.intercepts=new Set,this.hoverTimer=null,this.defaultState={cells:[],force:!1},this.onTriggerInteractionsResetEffect=function(){e.interactions.forEach(function(n){n.reset()})},this.selectAll=function(){e.changeState({stateName:Xe.ALL_SELECTED})},this.selectHeaderCell=function(n){var i;n===void 0&&(n={});var a=n.cell;if(!ke(a)){var o=(i=a==null?void 0:a.getMeta)===null||i===void 0?void 0:i.call(a);if(!(!o||nr(o==null?void 0:o.x))){e.addIntercepts([Qe.HOVER]);var s=e.spreadsheet.isHierarchyTreeType(),l=(a==null?void 0:a.cellType)===Le.COL_CELL,u=e.getState(),h=e.isSelectedCell(a),v=(n==null?void 0:n.isMultiSelection)&&e.isSelectedState(),p=h?[]:e.spreadsheet.facet.getCellChildrenNodes(a),m=h?[]:[Ii(a)];if(v&&(m=Ra((u==null?void 0:u.cells)||[],m),p=Ra((u==null?void 0:u.nodes)||[],p),h&&(m=m.filter(function(b){var E=b.id;return E!==o.id}),p=p.filter(function(b){return!(b!=null&&b.id.includes(o.id))}))),ke(m)){e.reset(),e.spreadsheet.emit(se.GLOBAL_SELECTED,e.getActiveCells());return}if(!(XD(m,"type").length>1)){var C=ke(p)?[a.getMeta()]:p;e.changeState({cells:m,nodes:C,stateName:Xe.SELECTED});var w=m.map(function(b){var E=b.id;return E});return e.updateCells(e.spreadsheet.facet.getHeaderCells(w)),(!s||l)&&e.highlightNodes(p),e.spreadsheet.emit(se.GLOBAL_SELECTED,e.getActiveCells()),!0}}}},this.highlightNodes=function(n){n===void 0&&(n=[]),n.forEach(function(i){var a;(a=i==null?void 0:i.belongsCell)===null||a===void 0||a.updateByState(Xe.SELECTED,i.belongsCell)})},this.mergeCells=function(n,i){g8(e.spreadsheet,n,i)},this.unmergeCell=function(n){y8(e.spreadsheet,n)},this.spreadsheet=r,this.registerEventController(),this.registerInteractions(),window.addEventListener("visibilitychange",this.onTriggerInteractionsResetEffect)}return t.prototype.destroy=function(){this.interactions.clear(),this.intercepts.clear(),this.eventController.clear(),this.clearHoverTimer(),this.resetState(),window.removeEventListener("visibilitychange",this.onTriggerInteractionsResetEffect)},t.prototype.reset=function(){this.clearState(),this.clearHoverTimer(),this.intercepts.clear(),this.spreadsheet.hideTooltip()},t.prototype.setState=function(r){q9(this.spreadsheet,r)},t.prototype.getState=function(){return this.spreadsheet.store.get(_d)||this.defaultState},t.prototype.setInteractedCells=function(r){var e=this.getInteractedCells().concat([r]),n=this.getState();n.interactedCells=e,this.setState(n)},t.prototype.getInteractedCells=function(){var r=this.getState();return(r==null?void 0:r.interactedCells)||[]},t.prototype.resetState=function(){this.spreadsheet.store.set(_d,this.defaultState)},t.prototype.getCurrentStateName=function(){return this.getState().stateName},t.prototype.isEqualStateName=function(r){return this.getCurrentStateName()===r},t.prototype.isStateOf=function(r){var e=this.getState();return(e==null?void 0:e.stateName)===r},t.prototype.isSelectedState=function(){var r=this;return[Xe.SELECTED,Xe.ROW_CELL_BRUSH_SELECTED,Xe.COL_CELL_BRUSH_SELECTED,Xe.DATA_CELL_BRUSH_SELECTED].some(function(e){return r.isStateOf(e)})},t.prototype.isAllSelectedState=function(){return this.isStateOf(Xe.ALL_SELECTED)},t.prototype.isHoverFocusState=function(){return this.isStateOf(Xe.HOVER_FOCUS)},t.prototype.isHoverState=function(){return this.isStateOf(Xe.HOVER)},t.prototype.isActiveCell=function(r){return!!this.getCells().find(function(e){return r.getMeta().id===e.id})},t.prototype.isSelectedCell=function(r){return this.isSelectedState()&&this.isActiveCell(r)},t.prototype.getCells=function(r){var e=this.getState(),n=(e==null?void 0:e.cells)||[];return nr(r)?n:n.filter(function(i){return r.includes(i.type)})},t.prototype.getActiveCells=function(){var r,e=this.getCells().map(function(i){return i.id}),n=(r=this.spreadsheet.facet)===null||r===void 0?void 0:r.getCells();return ct(e,function(i){return Rr(n,function(a){var o;return((o=a==null?void 0:a.getMeta())===null||o===void 0?void 0:o.id)===i})}).filter(Boolean)},t.prototype.getActiveDataCells=function(){return this.getActiveCells().filter(function(r){return r.cellType===Le.DATA_CELL})},t.prototype.getActiveRowCells=function(){return this.getActiveCells().filter(function(r){return r.cellType===Le.ROW_CELL})},t.prototype.getActiveColCells=function(){return this.getActiveCells().filter(function(r){return r.cellType===Le.COL_CELL})},t.prototype.clearStyleIndependent=function(){!this.isSelectedState()&&!this.isHoverState()&&!this.isAllSelectedState()||this.spreadsheet.facet.getDataCells().forEach(function(r){r.hideInteractionShape()})},t.prototype.getUnSelectedDataCells=function(){var r=this;return this.spreadsheet.facet.getDataCells().filter(function(e){return!r.isActiveCell(e)})},t.prototype.hideColumns=function(r,e){return r===void 0&&(r=[]),e===void 0&&(e=!0),Ar(this,void 0,void 0,function(){return Nr(this,function(n){switch(n.label){case 0:return[4,f0(this.spreadsheet,r,e)];case 1:return n.sent(),[2]}})})},t.prototype.getBrushSelectionInfo=function(r){var e,n,i;return na(r)?{dataCellBrushSelection:r,rowCellBrushSelection:r,colCellBrushSelection:r}:{dataCellBrushSelection:(e=r==null?void 0:r.dataCell)!==null&&e!==void 0?e:!1,rowCellBrushSelection:(n=r==null?void 0:r.rowCell)!==null&&n!==void 0?n:!1,colCellBrushSelection:(i=r==null?void 0:r.colCell)!==null&&i!==void 0?i:!1}},t.prototype.getDefaultInteractions=function(){var r=this.spreadsheet.options.interaction,e=r.resize,n=r.brushSelection,i=r.multiSelection,a=r.rangeSelection,o=r.selectedCellMove,s=this.getBrushSelectionInfo(n),l=s.dataCellBrushSelection,u=s.rowCellBrushSelection,h=s.colCellBrushSelection;return[{key:jr.CORNER_CELL_CLICK,interaction:YH},{key:jr.DATA_CELL_CLICK,interaction:GH},{key:jr.ROW_COLUMN_CLICK,interaction:VH},{key:jr.ROW_TEXT_CLICK,interaction:XH},{key:jr.MERGED_CELLS_CLICK,interaction:UH},{key:jr.HOVER,interaction:$H,enable:!tr()},{key:jr.DATA_CELL_BRUSH_SELECTION,interaction:KH,enable:!tr()&&l},{key:jr.ROW_CELL_BRUSH_SELECTION,interaction:ZH,enable:!tr()&&u},{key:jr.COL_CELL_BRUSH_SELECTION,interaction:qH,enable:!tr()&&h},{key:jr.COL_ROW_RESIZE,interaction:ez,enable:!tr()&&e},{key:jr.DATA_CELL_MULTI_SELECTION,interaction:jH,enable:!tr()&&i},{key:jr.RANGE_SELECTION,interaction:QH,enable:!tr()&&a},{key:jr.SELECTED_CELL_MOVE,interaction:rz,enable:!tr()&&o}]},t.prototype.registerInteractions=function(){var r=this,e=this.spreadsheet.options.interaction.customInteractions;this.interactions.clear();var n=this.getDefaultInteractions();n.forEach(function(i){var a=i.key,o=i.interaction,s=i.enable;s!==!1&&r.interactions.set(a,new o(r.spreadsheet))}),ke(e)||tt(e,function(i){var a=i.interaction;r.interactions.set(i.key,new a(r.spreadsheet))})},t.prototype.registerEventController=function(){this.eventController=new JH(this.spreadsheet)},t.prototype.draw=function(){this.spreadsheet.container.render()},t.prototype.clearState=function(){Zx(this.spreadsheet)&&this.draw()},t.prototype.changeState=function(r){var e=this,n=this.spreadsheet.interaction,i=r.cells,a=i===void 0?[]:i,o=r.force,s=r.stateName,l=r.onUpdateCells;if(ke(a)&&s===Xe.SELECTED){o&&n.changeState({cells:[],stateName:Xe.UNSELECTED});return}this.getCurrentStateName()===Xe.ALL_SELECTED&&this.clearStyleIndependent(),this.clearState(),this.setState(r);var u=function(){e.updatePanelGroupAllDataCells()};l?l(this,u):u(),this.draw()},t.prototype.updatePanelGroupAllDataCells=function(){this.updateCells(this.spreadsheet.facet.getDataCells())},t.prototype.updateCells=function(r){r===void 0&&(r=[]),r.forEach(function(e){e.update()})},t.prototype.addIntercepts=function(r){var e=this;r===void 0&&(r=[]),r.forEach(function(n){e.intercepts.add(n)})},t.prototype.hasIntercepts=function(r){var e=this;return r===void 0&&(r=[]),r.some(function(n){return e.intercepts.has(n)})},t.prototype.removeIntercepts=function(r){var e=this;r===void 0&&(r=[]),r.forEach(function(n){e.intercepts.delete(n)})},t.prototype.clearHoverTimer=function(){clearTimeout(this.hoverTimer)},t.prototype.setHoverTimer=function(r){this.hoverTimer=r},t.prototype.getHoverTimer=function(){return this.hoverTimer},t.prototype.getSelectedCellHighlight=function(){var r,e=this.spreadsheet.options.interaction.selectedCellHighlight;if(na(e))return{rowHeader:e,colHeader:e,currentRow:e,currentCol:e};var n=(r=e)!==null&&r!==void 0?r:{},i=n.rowHeader,a=i===void 0?!1:i,o=n.colHeader,s=o===void 0?!1:o,l=n.currentRow,u=l===void 0?!1:l,h=n.currentCol,v=h===void 0?!1:h;return{rowHeader:a,colHeader:s,currentRow:u,currentCol:v}},t.prototype.getHoverAfterScroll=function(){return this.spreadsheet.options.interaction.hoverAfterScroll},t.prototype.getHoverHighlight=function(){var r=this.spreadsheet.options.interaction.hoverHighlight;if(na(r))return{rowHeader:r,colHeader:r,currentRow:r,currentCol:r};var e=r??{},n=e.rowHeader,i=n===void 0?!1:n,a=e.colHeader,o=a===void 0?!1:a,s=e.currentRow,l=s===void 0?!1:s,u=e.currentCol,h=u===void 0?!1:u;return{rowHeader:i,colHeader:o,currentRow:l,currentCol:h}},t.prototype.getBrushSelection=function(){var r=this.spreadsheet.options.interaction.brushSelection;if(na(r))return{dataCell:r,rowCell:r,colCell:r};var e=r??{},n=e.dataCell,i=n===void 0?!1:n,a=e.rowCell,o=a===void 0?!1:a,s=e.colCell,l=s===void 0?!1:s;return{dataCell:i,rowCell:o,colCell:l}},t.prototype.updateDataCellRelevantHeaderCells=function(r,e){this.updateDataCellRelevantColCells(r,e),this.updateDataCellRelevantRowCells(r,e)},t.prototype.updateDataCellRelevantRowCells=function(r,e){var n=e.rowId,i=this.spreadsheet,a=i.facet,o=i.interaction,s=r===Xe.HOVER,l=(s?o.getHoverHighlight():o.getSelectedCellHighlight()).rowHeader;if(l&&n){var u=s?r0(n,a.getRowCells(),this.spreadsheet.isHierarchyTreeType()):$9(e,this.spreadsheet),h=a.getSeriesNumberCells().filter(function(p){return u.find(function(m){return m.getMeta().y===p.getMeta().y})}),v=pe(pe([],te(h),!1),te(u),!1);tt(v,function(p){p.updateByState(r)})}},t.prototype.updateDataCellRelevantColCells=function(r,e){var n=e.colId,i=this.spreadsheet,a=i.facet,o=i.interaction,s=(r===Xe.HOVER?o.getHoverHighlight():o.getSelectedCellHighlight()).colHeader;s&&n&&t8(n,a.getColCells(),r)},t}(),iz=function(){function t(r){var e=this;this.viewport=window,this.isDevicePixelRatioChange=!1,this.init=function(){e.initDevicePixelRatioListener(),e.initDeviceZoomListener()},this.destroy=function(){e.removeDevicePixelRatioListener(),e.removeDeviceZoomListener()},this.removeDevicePixelRatioListener=function(){var n;!((n=e.devicePixelRatioMedia)===null||n===void 0)&&n.removeEventListener?e.devicePixelRatioMedia.removeEventListener("change",e.renderByDevicePixelRatioChanged):e.devicePixelRatioMedia.removeListener(e.renderByDevicePixelRatioChanged)},this.initDeviceZoomListener=function(){var n,i;tr()||(i=(n=e.viewport)===null||n===void 0?void 0:n.visualViewport)===null||i===void 0||i.addEventListener("resize",e.renderByZoomScaleWithoutResizeEffect)},this.removeDeviceZoomListener=function(){var n,i;tr()||(i=(n=e.viewport)===null||n===void 0?void 0:n.visualViewport)===null||i===void 0||i.removeEventListener("resize",e.renderByZoomScaleWithoutResizeEffect)},this.renderByZoomScaleWithoutResizeEffect=function(n){e.isDevicePixelRatioChange=!1,e.renderByZoomScale(n)},this.renderByDevicePixelRatioChanged=function(){e.isDevicePixelRatioChange=!0,e.renderByDevicePixelRatio()},this.renderByDevicePixelRatio=function(n){n===void 0&&(n=window.devicePixelRatio);var i=e.spreadsheet,a=i.container,o=i.options,s=o.width,l=o.height,u=e.spreadsheet.getCanvasElement(),h=a.getConfig().devicePixelRatio;if(!(h===n||!u)){var v=Math.max(n,h,NB);a.getConfig().devicePixelRatio=v,a.resize(s,l),e.spreadsheet.render(!1)}},this.renderByZoomScale=cc(function(n){var i,a=Math.ceil((i=n.target)===null||i===void 0?void 0:i.scale);a>=1&&!e.isDevicePixelRatioChange&&e.renderByDevicePixelRatio(a)},350),this.spreadsheet=r}return t.prototype.initDevicePixelRatioListener=function(){var r;this.devicePixelRatioMedia=window.matchMedia("(resolution: ".concat(window.devicePixelRatio,"dppx)")),!((r=this.devicePixelRatioMedia)===null||r===void 0)&&r.addEventListener?this.devicePixelRatioMedia.addEventListener("change",this.renderByDevicePixelRatioChanged):this.devicePixelRatioMedia.addListener(this.renderByDevicePixelRatioChanged)},t}(),Q1=function(){function t(r){this.visible=!1,this.position={x:0,y:0},this.spreadsheet=r}return t.prototype.show=function(r){var e,n,i,a=r.position,o=r.content,s=r.event,l=this.spreadsheet.options.tooltip||{},u=l.autoAdjustBoundary,h=l.adjustPosition;this.visible=!0,this.options=r;var v=this.getContainer();this.renderContent(o);var p=J9({spreadsheet:this.spreadsheet,position:a,tooltipContainer:v,autoAdjustBoundary:u}),m=p.x,C=p.y;this.position=(e=h==null?void 0:h({position:{x:m,y:C},event:s}))!==null&&e!==void 0?e:{x:m,y:C},Bu(v,{style:{left:"".concat((n=this.position)===null||n===void 0?void 0:n.x,"px"),top:"".concat((i=this.position)===null||i===void 0?void 0:i.y,"px"),pointerEvents:"all"},visible:!0})},t.prototype.hide=function(){this.visible=!1,this.container&&(Bu(this.container,{style:{pointerEvents:"none"},visible:!1}),this.resetPosition())},t.prototype.destroy=function(){var r,e;this.visible=!1,this.container&&(this.resetPosition(),(e=(r=this.container).remove)===null||e===void 0||e.call(r),this.container=null)},t.prototype.renderContent=function(r){var e,n,i,a;if(this.container){this.clearContent();var o=(this.spreadsheet.options.tooltip||{}).content,s=r??o;if(!nr(s)){if(typeof s=="string"){this.container.innerHTML=s,(n=(e=this.options).onMounted)===null||n===void 0||n.call(e);return}s instanceof Element&&(this.container.appendChild(s),(a=(i=this.options).onMounted)===null||a===void 0||a.call(i))}}},t.prototype.clearContent=function(){this.container&&(this.container.innerHTML="")},t.prototype.disablePointerEvent=function(){this.container&&this.container.style.pointerEvents!=="none"&&Bu(this.container,{style:{pointerEvents:"none"}})},t.prototype.resetPosition=function(){this.position={x:0,y:0}},t.prototype.getContainer=function(){var r;if(!this.container){var e=this.spreadsheet.options.tooltip,n=((r=e==null?void 0:e.getContainer)===null||r===void 0?void 0:r.call(e))||document.body,i=document.createElement("div");return Bu(i,{style:e==null?void 0:e.style,className:[Yv].concat(e==null?void 0:e.className)}),n.appendChild(i),this.container=i,this.container}return this.container},t}(),az="s2-offscreen-canvas",oz=function(){var t;(t=document.getElementById(az))===null||t===void 0||t.remove()};ye.enableCSSParsing=!1;var wb=function(t){Me(r,t);function r(e,n,i){var a=t.call(this)||this;return a.store=new Q6,a.destroyed=!1,a.untypedOn=a.on,a.untypedEmit=a.emit,a.on=function(o,s){return a.untypedOn(o,s)},a.emit=function(o){for(var s=[],l=1;l<arguments.length;l++)s[l-1]=arguments[l];return a.untypedEmit.apply(a,pe([o],te(s),!1))},a.measureText=Fl(function(o,s){var l;if(o===void 0&&(o=""),!s)return null;var u=(l=a.getCanvasElement())===null||l===void 0?void 0:l.getContext("2d"),h=s,v=h.fontSize,p=h.fontFamily,m=h.fontWeight,C=h.fontStyle,w=h.fontVariant;return u.font=[C,w,m,"".concat(v,"px"),p].join(" ").trim(),u.measureText(String(o))},function(o,s){return pe([o],te(zv(s)),!1).join("")}),a.measureTextWidth=function(o,s){o===void 0&&(o="");var l=a.measureText(o,s);return(l==null?void 0:l.width)||0},a.measureTextHeight=function(o,s){o===void 0&&(o="");var l=a.measureText(o,s);return l?l.actualBoundingBoxAscent+l.actualBoundingBoxDescent:0},a.measureTextWidthRoughly=function(o,s){var l,u;s===void 0&&(s={});var h=a.measureTextWidth("a",s),v=a.measureTextWidth("",s),p=0;if(!o)return p;try{for(var m=Wr(o),C=m.next();!C.done;C=m.next()){var w=C.value,b=w.charCodeAt(0);p+=b>=0&&b<=255?h:v}}catch(E){l={error:E}}finally{try{C&&!C.done&&(u=m.return)&&u.call(m)}finally{if(l)throw l.error}}return p},a.dataCfg=Nh(n),a.options=V1(i),a.dataSet=a.getDataSet(),a.setDebug(),a.initTooltip(),a.initContainer(e),a.bindEvents(),a.initInteraction(),a.initTheme(),a.initHdAdapter(),a.registerIcons(),a.setOverscrollBehavior(),a}return r.prototype.isCustomHeaderFields=function(e){var n=this.dataCfg.fields;return e?xd(n==null?void 0:n[e],function(i){return!oa(i)}):xd(pe(pe([],te(n==null?void 0:n.rows),!1),te(n==null?void 0:n.columns),!1),function(i){return!oa(i)})},r.prototype.isCustomColumnFields=function(){return this.isCustomHeaderFields("columns")},r.prototype.setOverscrollBehavior=function(){var e=this.options.interaction.overscrollBehavior,n=window.getComputedStyle(document.body).getPropertyValue("overscroll-behavior"),i=n&&n!=="auto";i?this.store.set("initOverscrollBehavior",n):e&&(document.body.style.overscrollBehavior=e)},r.prototype.restoreOverscrollBehavior=function(){document.body.style.overscrollBehavior=this.store.get("initOverscrollBehavior")||""},r.prototype.setDebug=function(){Li.getInstance().setDebug(this.options.debug)},r.prototype.initTheme=function(){this.setThemeCfg({name:"default"})},r.prototype.getMountContainer=function(e){var n=oa(e)?document.querySelector(e):e;if(!n)throw new Error("Target mount container is not a DOM element");return n},r.prototype.initHdAdapter=function(){this.options.hd&&(this.hdAdapter=new iz(this),this.hdAdapter.init())},r.prototype.initInteraction=function(){var e,n;(n=(e=this.interaction)===null||e===void 0?void 0:e.destroy)===null||n===void 0||n.call(e),this.interaction=new nz(this)},r.prototype.initTooltip=function(){var e,n,i,a;(n=(e=this.tooltip)===null||e===void 0?void 0:e.destroy)===null||n===void 0||n.call(e),this.tooltip=this.renderTooltip(),this.tooltip instanceof Q1||console.warn("[Custom Tooltip]: ".concat((a=(i=this.tooltip)===null||i===void 0?void 0:i.constructor)===null||a===void 0?void 0:a.toString()," should be extends from BaseTooltip"))},r.prototype.renderTooltip=function(){var e,n;return((n=(e=this.options.tooltip)===null||e===void 0?void 0:e.render)===null||n===void 0?void 0:n.call(e,this))||new Q1(this)},r.prototype.showTooltip=function(e){var n=this,i=e.content,a=e.event,o=this.getCell(a==null?void 0:a.target),s=ui(i)?i(o,e):i;return new Promise(function(l){var u,h,v=Y(Y({},e),{content:s,onMounted:l});tr()?s5(function(){var p,m;(m=(p=n.tooltip).show)===null||m===void 0||m.call(p,v)},50):(h=(u=n.tooltip).show)===null||h===void 0||h.call(u,v)})},r.prototype.showTooltipWithInfo=function(e,n,i){var a,o=g0(this,e),s=o.enable,l=o.content;if(s){var u=this.getCell(e==null?void 0:e.target),h=(a=i==null?void 0:i.data)!==null&&a!==void 0?a:s7({spreadsheet:this,cellInfos:n,targetCell:u,options:Y({enableFormat:!0},i)});return this.showTooltip({data:h,position:{x:e.clientX,y:e.clientY},options:i,event:e,content:l})}},r.prototype.hideTooltip=function(){var e,n;(n=(e=this.tooltip).hide)===null||n===void 0||n.call(e)},r.prototype.destroyTooltip=function(){var e,n;(n=(e=this.tooltip).destroy)===null||n===void 0||n.call(e)},r.prototype.registerIcons=function(){var e=this.options.customSVGIcons;ke(e)||tt(e,function(n){Qw(n.name,n.svg)})},r.prototype.setDataCfg=function(e,n){this.store.set("originalDataCfg",e),n?this.dataCfg=Nh(e):this.dataCfg=Nh(this.dataCfg,e),f7(this)},r.prototype.setOptions=function(e,n){var i;this.hideTooltip(),n?this.options=V1(e):this.options=ta(this.options,e),(n||!((i=e==null?void 0:e.tooltip)===null||i===void 0)&&i.render)&&this.initTooltip(),this.resetHiddenColumnsDetailInfoIfNeeded(),this.registerIcons()},r.prototype.resetDataCfg=function(){this.setDataCfg(null,!0)},r.prototype.resetOptions=function(){this.setOptions(null,!0)},r.prototype.resetHiddenColumnsDetailInfoIfNeeded=function(){var e;ke((e=this.options.interaction)===null||e===void 0?void 0:e.hiddenColumnFields)||this.store.set("hiddenColumnsDetail",[])},r.prototype.doRender=function(e){return Ar(this,void 0,void 0,function(){var n,i,a,o,s,l,u;return Nr(this,function(h){switch(h.label){case 0:return!this.getCanvasElement()||!window.document.body.contains(this.getCanvasElement())?[2]:(n=e||{},i=n.reloadData,a=i===void 0?!0:i,o=n.reBuildDataSet,s=o===void 0?!1:o,l=n.reBuildHiddenColumnsDetail,u=l===void 0?!0:l,this.emit(se.LAYOUT_BEFORE_RENDER),s&&(this.dataSet=this.getDataSet()),a&&(this.clearDrillDownData("",!0),this.dataSet.setDataCfg(this.dataCfg)),this.buildFacet(),u?[4,this.initHiddenColumnsDetail()]:[3,2]);case 1:h.sent(),h.label=2;case 2:return this.emit(se.LAYOUT_AFTER_RENDER),[2]}})})},r.prototype.render=function(e){return Ar(this,void 0,void 0,function(){var n;return Nr(this,function(i){switch(i.label){case 0:return this.destroyed?[2]:(n=typeof e=="boolean"?{reloadData:e}:e,[4,this.container.ready]);case 1:return i.sent(),[4,this.doRender(n)];case 2:return i.sent(),[2]}})})},r.prototype.destroy=function(){var e,n,i,a,o;this.destroyed||(this.destroyed=!0,this.restoreOverscrollBehavior(),this.emit(se.LAYOUT_DESTROY),(e=this.facet)===null||e===void 0||e.destroy(),(n=this.hdAdapter)===null||n===void 0||n.destroy(),(i=this.interaction)===null||i===void 0||i.destroy(),(a=this.store)===null||a===void 0||a.clear(),this.destroyTooltip(),this.clearCanvasEvent(),(o=this.container)===null||o===void 0||o.destroy(),oz())},r.prototype.setThemeName=function(e){this.themeName=e},r.prototype.setThemeCfg=function(e){e===void 0&&(e={});var n=(e==null?void 0:e.theme)||{},i=aF(Y(Y({},e),{spreadsheet:this}));this.theme=ta(i,n),this.setThemeName(e==null?void 0:e.name),iF(e==null?void 0:e.name)},r.prototype.setTheme=function(e){this.theme=ta(this.theme,e)},r.prototype.getTheme=function(){return this.theme},r.prototype.getThemeName=function(){return this.themeName},r.prototype.updatePagination=function(e){this.options=ta(this.options,{pagination:e}),this.facet.resetScrollOffset()},r.prototype.getContentHeight=function(){return this.facet.getContentHeight()},r.prototype.changeSheetSize=function(e,n){e===void 0&&(e=this.options.width),n===void 0&&(n=this.options.height);var i=this.getCanvasElement(),a=this.container.getConfig(),o=a.width,s=a.height,l=e!==o||n!==s;!l||!i||(this.options=ta(this.options,{width:e,height:n}),this.container.resize(e,n))},r.prototype.getCanvas=function(){return this.container},r.prototype.getCanvasConfig=function(){return this.getCanvas().getConfig()},r.prototype.getCanvasElement=function(){return this.getCanvas().getContextService().getDomElement()},r.prototype.getLayoutWidthType=function(){var e;return(e=this.options.style)===null||e===void 0?void 0:e.layoutWidthType},r.prototype.updateScrollOffset=function(e){var n={offsetX:{value:void 0,animate:!1},offsetY:{value:void 0,animate:!1},rowHeaderOffsetX:{value:void 0,animate:!1}};this.facet.updateScrollOffset(ta(n,e))},r.prototype.isCellType=function(e){return e instanceof Qc},r.prototype.getCell=function(e){for(var n=e;n&&!(n instanceof sd);){if(this.isCellType(n))return n;n=n==null?void 0:n.parentNode}return null},r.prototype.getCellType=function(e){var n=this.getCell(e);return n==null?void 0:n.cellType},r.prototype.getTotalsConfig=function(e){var n=this.options.totals,i=this.dataSet.fields.rows,a=dt(n,hn(i,e)?"row":"col",{}),o=a.showSubTotals&&hn(a.subTotalsDimensions,e)?a.showSubTotals:!1;return Y(Y({grandTotalsLabel:gr(""),subTotalsLabel:gr(""),grandTotalsGroupDimensions:[],subTotalsGroupDimensions:[]},a),{showSubTotals:o})},r.prototype.initContainer=function(e){var n=this.options,i=n.width,a=n.height,o=n.transformCanvasConfig,s=new WH,l=o==null?void 0:o(s,this);this.container=new sd(Y({container:this.getMountContainer(e),width:i,height:a,renderer:s},l)),this.updateContainerStyle()},r.prototype.updateContainerStyle=function(){var e=this.getCanvasElement();e&&(e.style.display="block")},r.prototype.initHiddenColumnsDetail=function(){return Ar(this,void 0,void 0,function(){var e,n;return Nr(this,function(i){switch(i.label){case 0:return e=this.options.interaction.hiddenColumnFields,n=this.store.get("hiddenColumnsDetail"),ke(e)&&ke(n)?[2]:[4,f0(this,e,!0)];case 1:return i.sent(),[2]}})})},r.prototype.clearCanvasEvent=function(){var e=this,n=this.getEvents();_5(n,function(i,a){e.off(a)})},r.prototype.updateSortMethodMap=function(e,n,i){var a;i===void 0&&(i=!1);var o=i?null:this.store.get("sortMethodMap");this.store.set("sortMethodMap",Y(Y({},o),(a={},a[e]=n,a)))},r.prototype.getMenuDefaultSelectedKeys=function(e){var n=this.store.get("sortMethodMap"),i=dt(n,e);return i?[i]:[]},r.prototype.handleGroupSort=function(e,n){var i=this;e.stopPropagation(),this.interaction.addIntercepts([Qe.HOVER]);var a=this.getMenuDefaultSelectedKeys(n==null?void 0:n.id),o=this.isTableMode()?R6():_6(),s={menu:{defaultSelectedKeys:a,items:o,onClick:function(l){var u=l.key;i.groupSortByMethod(u,n),i.emit(se.RANGE_SORTED,e)}}};this.showTooltipWithInfo(e,[],{operator:s,onlyShowOperator:!0,forceRender:!0})},r}(db);(function(t){Me(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.prototype.isCustomRowFields=function(){return this.isCustomHeaderFields("rows")},r.prototype.getDataSet=function(){var e=this.options.dataSet;return e?e(this):this.isCustomRowFields()?new p7(this):new Xd(this)},r.prototype.enableFrozenHeaders=function(){return!1},r.prototype.getContentHeight=function(){return this.facet.getContentHeight()},r.prototype.isPivotMode=function(){return!0},r.prototype.isTableMode=function(){return!1},r.prototype.isHierarchyTreeType=function(){return this.options.hierarchyType==="tree"},r.prototype.isFrozenRowHeader=function(){var e,n;return!!(!((n=(e=this.options)===null||e===void 0?void 0:e.frozen)===null||n===void 0)&&n.rowHeader)},r.prototype.isValueInCols=function(){return this.dataSet.fields.valueInCols},r.prototype.clearDrillDownData=function(e,n){if(this.dataSet instanceof Xd){var i=this.dataSet.clearDrillDownData(e);i&&!n&&(this.interaction.reset(),this.render(!1))}},r.prototype.buildFacet=function(){var e=this,n,i,a,o,s,l,u=function(h){return new Di(h,e)};(n=(l=this.options).dataCell)!==null&&n!==void 0||(l.dataCell=u),(i=this.facet)===null||i===void 0||i.destroy(),this.facet=(s=(o=(a=this.options).facet)===null||o===void 0?void 0:o.call(a,this))!==null&&s!==void 0?s:new q7(this),this.facet.render()},r.prototype.bindEvents=function(){this.off(se.ROW_CELL_COLLAPSED__PRIVATE),this.off(se.ROW_CELL_ALL_COLLAPSED__PRIVATE),this.on(se.ROW_CELL_COLLAPSED__PRIVATE,this.handleRowCellCollapsed),this.on(se.ROW_CELL_ALL_COLLAPSED__PRIVATE,this.handleRowCellToggleCollapseAll)},r.prototype.handleRowCellCollapsed=function(e){var n,i,a=e.isCollapsed,o=e.node,s=((i=this.options.style)===null||i===void 0?void 0:i.rowCell).collapseFields,l=Y(Y({},s),(n={},n[o.id]=a,n));this.setOptions({style:{rowCell:{collapseFields:l}}}),this.render(!1),this.emit(se.ROW_CELL_COLLAPSED,{isCollapsed:a,collapseFields:l,node:o})},r.prototype.handleRowCellToggleCollapseAll=function(e){var n=!e;this.setOptions({style:{rowCell:{collapseAll:n,collapseFields:null,expandDepth:null}}}),this.render(!1),this.emit(se.ROW_CELL_ALL_COLLAPSED,n)},r.prototype.groupSortByMethod=function(e,n){var i,a=this.dataCfg.fields,o=a.rows,s=a.columns,l=this.options.style.colCell.hideValue,u=this.isValueInCols()?mr(o):mr(s),h=n.query,v=n.value,p=$c(h),m=v;l&&this.isValueInCols()&&(m=this.dataSet.fields.values[0],p[it]=m);var C=oa(u)?u:u.field,w={sortFieldId:C,sortMethod:e,sortByMeasure:m,query:p},b=(i=this.dataCfg.sortParams)===null||i===void 0?void 0:i.filter(function(R){return(R==null?void 0:R.sortFieldId)!==u});this.updateSortMethodMap(n.id,e,!0);var E=pe(pe([],te(b),!1),[w],!1);this.emit(se.RANGE_SORT,E),this.setDataCfg(Y(Y({},this.dataCfg),{sortParams:E})),this.render()},r})(wb);var sz=function(t){Me(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.groupSortByMethod=function(n,i){var a=i.field,o={sortFieldId:a,sortMethod:n};e.updateSortMethodMap(i.id,n),e.emit(se.RANGE_SORT,[o])},e}return r.prototype.isCustomRowFields=function(){return!1},r.prototype.getDataSet=function(){var e=this.options.dataSet;return e?e(this):new g7(this)},r.prototype.enableFrozenHeaders=function(){var e=this.options.frozen,n=e.rowCount,i=n===void 0?0:n,a=e.trailingRowCount,o=a===void 0?0:a,s=e.colCount,l=s===void 0?0:s,u=e.trailingColCount,h=u===void 0?0:u;return i>0||o>0||l>0||h>0},r.prototype.isPivotMode=function(){return!1},r.prototype.isTableMode=function(){return!0},r.prototype.isHierarchyTreeType=function(){return!1},r.prototype.isFrozenRowHeader=function(){return!1},r.prototype.clearDrillDownData=function(){},r.prototype.isValueInCols=function(){return!1},r.prototype.bindEvents=function(){},r.prototype.buildFacet=function(){var e=this,n,i,a,o,s,l,u=function(h){var v;return!((v=e.options.seriesNumber)===null||v===void 0)&&v.enable&&h.colIndex===0?new h0(h,e):new Lc(h,e)};(n=(l=this.options).dataCell)!==null&&n!==void 0||(l.dataCell=u),(i=this.facet)===null||i===void 0||i.destroy(),this.facet=(s=(o=(a=this.options).facet)===null||o===void 0?void 0:o.call(a,this))!==null&&s!==void 0?s:new Q7(this),this.facet.render()},r.prototype.destroy=function(){t.prototype.destroy.call(this),this.off(se.RANGE_SORT),this.off(se.RANGE_FILTER)},r}(wb);class lz extends Di{getTextStyle(){return{...super.getTextStyle(),fill:"#646464",textAlign:"center"}}}class uz extends Di{getTextStyle(){return{...super.getTextStyle(),fontWeight:600,textAlign:"center"}}}const cz={interaction:{resize:{colCellVertical:!1,rowCellVertical:!1}},style:{layoutWidthType:Na.Compact,colCell:{widthByField:{"root[&]$$series_number$$":60}}},dataCell:t=>t.colId=="root[&]$$series_number$$"?new lz(t,t==null?void 0:t.spreadsheet):t.rowIndex==0?new uz(t,t==null?void 0:t.spreadsheet):new Di(t,t==null?void 0:t.spreadsheet),seriesNumber:{enable:!0,text:""},placeholder:""},kc="#e6e6e6",Ya="#ffffff",ey={bolderText:{fill:"#585757"},cell:{backgroundColor:"#f4f5f8",verticalBorderColor:kc,horizontalBorderColor:kc,interactionState:{hover:{backgroundColor:"#f4f5f8"},highlight:{backgroundColor:"#f4f5f8"}}}},fz={colCell:ey,cornerCell:ey,splitLine:{horizontalBorderWidth:1,horizontalBorderColor:"#858585"},dataCell:{text:{textAlign:"left",textBaseline:"top"},cell:{verticalBorderColor:kc,horizontalBorderColor:kc,backgroundColor:Ya,crossBackgroundColor:Ya,interactionState:{hover:{backgroundColor:Ya},highlight:{backgroundColor:Ya},hoverFocus:{borderColor:"#418f1f",borderWidth:1,backgroundColor:Ya},prepareSelect:{borderColor:"#418f1f",borderWidth:1,backgroundColor:Ya},selected:{backgroundColor:"#bbf1cf"}}}},background:{color:Ya}},hz=",",ty='"',dz="	",vz="|",pz=";",gz=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d{3,})?(?:Z|[-+]\d{2}:?\d{2})$/,mz=/^(?:t(?:rue)?|f(?:alse)?|y(?:es)?|n(?:o)?|0|1)$/i,yz=[dz,vz,pz,hz],Cz=1e3;function wz(t){let[r,e=""]=t;return r=="1"||r=="0"?"1":r=="t"||r=="f"?e==""?"t":"true":r=="T"||r=="F"?e==""?"T":e=="R"||e==="A"?"TRUE":"True":r=="y"||r=="n"?e==""?"y":"yes":r=="Y"||r=="N"?e==""?"Y":e=="E"||e==="O"?"YES":"Yes":""}function xz(t){if(t[0]==="["||t[0]==="{")try{return JSON.parse(t),!0}catch{}return!1}const xb="s",bb="d",jd="n",Sb="j",Eb="b";function bz(t,r){let e=r.findLast(i=>i[t]!==""&&i[t]!=="null"&&i[t]!=="NULL"&&i[t]!=="NaN"),n=xb;if(e!=null){let i=e[t];n=gz.test(i)?bb:+i==+i?jd:mz.test(i)?Eb+":"+wz(i):xz(i)?Sb:n}return n}const Ic=JSON.stringify,Dh=t=>typeof t=="string"?Ic(t):t;function ry(t,r){let{type:e}=r,n=`r[${t}]`,i=e===bb?`new Date(${n})`:e===Sb?`JSON.parse(${n})`:e===jd?`+${n}`:e[0]===Eb?`${n} === ${Ic(e.slice(2))} ? true : false`:n,{repl:a}=r,o=a.NaN!==void 0&&e===jd?`${n} === 'NaN' ? ${Dh(a.NaN)} : `:"",s=a.null!==void 0?`${n} === 'null' || ${n} === 'NULL' ? ${Dh(a.null)} : `:"";return`${a.empty!==void 0?`${n} === '' ? ${Dh(a.empty)} : `:""} ${s} ${o} ${i}`}const Sz=/\w+(?:\[|\]?[\.\[]?|$)/gm;function zu(t,r=!1,e=!1){let n="";if(r&&e){let o={},s=0,l=t.map(u=>u.name.replace(/\.(\d+)\.?/gi,"[$1]"));do{let u=l.shift(),h=/\s/.test(u)?[u]:[...u.matchAll(Sz)].flatMap(p=>p.map(m=>m.replace("]",""))),v=o;do{let p=h.shift(),m=p,C=p.at(-1);if(C=="."||C=="["){m=p.slice(0,-1);let b=v[m]??(C=="."?{}:[]);v=v[m]=b}else v[m]=`${s}`}while(h.length>0);s++}while(l.length>0);n=Ic(o).replace(/"(\d+)"/g,(u,h)=>ry(+h,t[+h]))}else!r&&t.every(o=>o.type===xb)?n="r":(n=r?"{":"[",t.forEach((o,s)=>{n+=r?`${Ic(o.name)}:`:"";let l=ry(s,o);n+=`${l},`}),n+=r?"}":"]");let i=`
		let arr = Array(rows.length);

		for (let i = 0; i < rows.length; i++) {
			let r = rows[i];
			arr[i] = ${n};
		}

		return arr;
	`;return new Function("rows",i)}function Ez(t){return new Function("rows",`
		let cols = [${t.map(()=>"Array(rows.length)").join(",")}];

		for (let i = 0; i < rows.length; i++) {
			let r = rows[i];
			${t.map((r,e)=>`cols[${e}][i] = r[${e}]`).join(";")};
		}

		return cols;
	`)}function Tz(t,r,e){let{header:n,col:i,row:a,encl:o,esc:s,trim:l=!1}=r??{};n??(n=R=>[R[0]]),e??(e=10);const u=new RegExp(`(.*)(${a??`\r
|\r|
`})`),h=t.match(u),v=h[1];a??(a=h[2]),i??(i=yz.find(R=>v.indexOf(R)>-1)??"");const p={skip:1,col:i,row:a,encl:o,esc:s,trim:l,cols:[]},m=v.split(i).length,C=[];Tb(t,p,R=>{C.push(...R)},0,!0,e,1,m);let w=n(C)??[],b=p.skip=w.length,E=w.find(R=>R!=null)??[...Array(C[0].length).keys()];return C.splice(0,b),E.forEach((R,M)=>{let k=bz(M,C),L={name:R,type:k,repl:{empty:null,NaN:void 0,null:void 0}};p.cols.push(L)}),p}function _z(t,r){let{skip:e,cols:n}=t,i=null,a=null,o=null,s=null,l=null,u=0,h=0,v=null,p=null,m="",C="",w=null;function b(){h=u=0,C=m="",v=p=w=null}let E=(J,re)=>{re(J)},R=()=>[],M=()=>n.map(J=>[]),k=J=>{w.push(...J)},L=J=>{J.forEach((re,ne)=>{w[ne].push(...re)})};function _(J,re,ne){let ce=null;return(me,oe=E)=>{ce??(ce=ne()),w??(w=J());let Se=w,Te=h===0||h===2;return Tb(me,t,(je,Be)=>{C=Be;let rt=oe(ce(je),re);return rt===!1&&h!==0&&b(),rt},u===0?e:0,Te,r),Te&&(w=null),Se}}const I=_(R,k,()=>(i??(i=J=>J),i)),P=_(R,k,()=>(a??(a=zu(n,!1,!1)),a)),U=_(R,k,()=>(o??(o=zu(n,!0,!1)),o)),q=_(R,k,()=>(s??(s=zu(n,!0,!0)),s)),Q=_(M,L,()=>(a??(a=zu(n,!1,!1)),l??(l=Ez(n)),J=>l(a(J))));return{schema:t,stringArrs:I,typedArrs:P,typedObjs:U,typedDeep:q,typedCols:Q,chunk(J,re=I,ne=E){v??(v=re),p??(p=ne),h===1&&(v(C+m,p),u++),m=J,h=1},end(){h=2;let J=v(C+m,p);return b(),J}}}function Tb(t,r,e,n=0,i=!0,a=Cz,o=null,s=null){let{row:l,col:u,encl:h,esc:v,trim:p}=r;h??(h=t.indexOf(ty)>-1?ty:""),v??(v=h);let m=s||r.cols.length,C=o!=null,w=s!=null&&C,b=l.length,E=u.length,R=h.charCodeAt(0),M=v.charCodeAt(0),k=l.charCodeAt(0),L=u.charCodeAt(0),_=32,I=0,P=0,U=t.length-1,q=0,Q=[],J=Array(m).fill(""),re=J.slice(),ne=0,ce=m-1,me=-1;if(h===""){for(;P<=U;)if(ne===ce){let Be=t.indexOf(l,P);if(Be===-1){if(!i)break;Be=U+1}let rt=t.slice(P,Be);if(re[ne]=p?rt.trim():rt,--n<0&&Q.push(re),Q.length===a){let ut=e(Q,"")===!1;if(Q=[],ut||C&&++I===o)return}re=J.slice(),ne=0,me=-1,P=Be+b,q=P}else if(ne===0&&t.charCodeAt(P)===k)P+=b;else{let Be=t.indexOf(u,P);if(Be===-1&&!i)break;let rt=t.slice(P,Be);re[ne]=p?rt.trim():rt,P=Be+E,me=ne++}i&&ne===ce&&--n<0&&Q.push(re),(!i||Q.length>0)&&e(Q,i?"":t.slice(q));return}const oe=w?new RegExp(`[^${u}${l}]+`,"my"):null;let Se=0,Te="",Ie;for(;P<=U;){if(Ie=t.charCodeAt(P),Se===0)if(Ie===R){if(Se=2,P+=1,P>U)break;Ie=t.charCodeAt(P)}else if(Ie===L||Ie===k){if(Ie===k&&ne===0){P+=b;continue}if(re[ne]=Te,me=ne,ne+=1,P+=1,Te="",Ie===k){if(w&&me<ce&&Q.length===0&&(re.length=J.length=me+1,ce=me),--n<0&&Q.push(re),Q.length===a){let Be=e(Q,"")===!1;if(Q=[],Be||C&&++I===o)return}re=J.slice(),ne=0,me=-1,P+=b-1,q=P}if(P>U)break;Ie=t.charCodeAt(P)}else if(p&&Ie===_)for(;Ie===_;)Ie=t.charCodeAt(++P);else Se=1;if(Se===2)for(;;)if(Ie===R)if(R===M){if(P+1>U){P=U+1;break}if(t.charCodeAt(P+1)===R){if(P+=2,Te+=h,P>U)break;Ie=t.charCodeAt(P)}else{Se=0,P+=1;break}}else if(t.charCodeAt(P-1)===M){if(P+=1,Te+=h,P>U)break;Ie=t.charCodeAt(P)}else{Se=0,P+=1;break}else{let Be=t.indexOf(h,P);if(Be===-1){P=U+1;break}Te+=t.slice(P,R===M?Be:Be-1),P=Be,Ie=R}else if(Se===1)if(Ie===L||Ie===k){if(Ie===k&&ne===0){P+=b;continue}if(re[ne]=Te,me=ne,ne+=1,P+=1,Te="",Ie===k){if(w&&me<ce&&Q.length===0&&(re.length=J.length=me+1,ce=me),--n<0&&Q.push(re),Q.length===a){let Be=e(Q,"")===!1;if(Q=[],Be||C&&++I===o)return}re=J.slice(),ne=0,me=-1,P+=b-1,q=P}Se=0}else if(w){oe.lastIndex=P;let Be=oe.exec(t)[0];Te+=Be,P+=Be.length}else{let Be=t.indexOf(ne===ce?l:u,P);Be===-1&&(Be=U+1);let rt=t.slice(P,Be);Te+=p?rt.trim():rt,P=Be}}i&&ne===ce&&(re[ne]=Te,--n<0&&Q.push(re),Se=0);let je=!i&&(Se!==0||(me===-1?Te!=="":me<ce));e(Q,je?t.slice(q):"")}var Jd={exports:{}};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */(function(t,r){var e={};function n(i){i.version="0.18.5";var a=1200,o=1252,s=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],l={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},u=function(c){s.indexOf(c)!=-1&&(o=l[0]=c)};function h(){u(1252)}var v=function(c){a=c,u(c)};function p(){v(1200),h()}function m(c){for(var d=[],f=0,y=c.length;f<y;++f)d[f]=c.charCodeAt(f);return d}function C(c){for(var d=[],f=0;f<c.length>>1;++f)d[f]=String.fromCharCode(c.charCodeAt(2*f)+(c.charCodeAt(2*f+1)<<8));return d.join("")}function w(c){for(var d=[],f=0;f<c.length>>1;++f)d[f]=String.fromCharCode(c.charCodeAt(2*f+1)+(c.charCodeAt(2*f)<<8));return d.join("")}var b=function(c){var d=c.charCodeAt(0),f=c.charCodeAt(1);return d==255&&f==254?C(c.slice(2)):d==254&&f==255?w(c.slice(2)):d==65279?c.slice(1):c},E=function(d){return String.fromCharCode(d)},R=function(d){return String.fromCharCode(d)},M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function k(c){for(var d="",f=0,y=0,g=0,x=0,S=0,T=0,A=0,N=0;N<c.length;)f=c.charCodeAt(N++),x=f>>2,y=c.charCodeAt(N++),S=(f&3)<<4|y>>4,g=c.charCodeAt(N++),T=(y&15)<<2|g>>6,A=g&63,isNaN(y)?T=A=64:isNaN(g)&&(A=64),d+=M.charAt(x)+M.charAt(S)+M.charAt(T)+M.charAt(A);return d}function L(c){var d="",f=0,y=0,g=0,x=0,S=0,T=0,A=0;c=c.replace(/[^\w\+\/\=]/g,"");for(var N=0;N<c.length;)x=M.indexOf(c.charAt(N++)),S=M.indexOf(c.charAt(N++)),f=x<<2|S>>4,d+=String.fromCharCode(f),T=M.indexOf(c.charAt(N++)),y=(S&15)<<4|T>>2,T!==64&&(d+=String.fromCharCode(y)),A=M.indexOf(c.charAt(N++)),g=(T&3)<<6|A,A!==64&&(d+=String.fromCharCode(g));return d}var _=function(){return typeof Buffer<"u"&&!1}(),I=function(){if(typeof Buffer<"u"){var c=!Buffer.from;if(!c)try{Buffer.from("foo","utf8")}catch{c=!0}return c?function(d,f){return f?new Buffer(d,f):new Buffer(d)}:Buffer.from.bind(Buffer)}return function(){}}();function P(c){return _?Buffer.alloc?Buffer.alloc(c):new Buffer(c):typeof Uint8Array<"u"?new Uint8Array(c):new Array(c)}function U(c){return _?Buffer.allocUnsafe?Buffer.allocUnsafe(c):new Buffer(c):typeof Uint8Array<"u"?new Uint8Array(c):new Array(c)}var q=function(d){return _?I(d,"binary"):d.split("").map(function(f){return f.charCodeAt(0)&255})};function Q(c){if(typeof ArrayBuffer>"u")return q(c);for(var d=new ArrayBuffer(c.length),f=new Uint8Array(d),y=0;y!=c.length;++y)f[y]=c.charCodeAt(y)&255;return d}function J(c){if(Array.isArray(c))return c.map(function(y){return String.fromCharCode(y)}).join("");for(var d=[],f=0;f<c.length;++f)d[f]=String.fromCharCode(c[f]);return d.join("")}function re(c){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(c)}function ne(c){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(c instanceof ArrayBuffer)return ne(new Uint8Array(c));for(var d=new Array(c.length),f=0;f<c.length;++f)d[f]=c[f];return d}var ce=_?function(c){return Buffer.concat(c.map(function(d){return Buffer.isBuffer(d)?d:I(d)}))}:function(c){if(typeof Uint8Array<"u"){var d=0,f=0;for(d=0;d<c.length;++d)f+=c[d].length;var y=new Uint8Array(f),g=0;for(d=0,f=0;d<c.length;f+=g,++d)if(g=c[d].length,c[d]instanceof Uint8Array)y.set(c[d],f);else{if(typeof c[d]=="string")throw"wtf";y.set(new Uint8Array(c[d]),f)}return y}return[].concat.apply([],c.map(function(x){return Array.isArray(x)?x:[].slice.call(x)}))};function me(c){for(var d=[],f=0,y=c.length+250,g=P(c.length+255),x=0;x<c.length;++x){var S=c.charCodeAt(x);if(S<128)g[f++]=S;else if(S<2048)g[f++]=192|S>>6&31,g[f++]=128|S&63;else if(S>=55296&&S<57344){S=(S&1023)+64;var T=c.charCodeAt(++x)&1023;g[f++]=240|S>>8&7,g[f++]=128|S>>2&63,g[f++]=128|T>>6&15|(S&3)<<4,g[f++]=128|T&63}else g[f++]=224|S>>12&15,g[f++]=128|S>>6&63,g[f++]=128|S&63;f>y&&(d.push(g.slice(0,f)),f=0,g=P(65535),y=65530)}return d.push(g.slice(0,f)),ce(d)}var oe=/\u0000/g,Se=/[\u0001-\u0006]/g;function Te(c){for(var d="",f=c.length-1;f>=0;)d+=c.charAt(f--);return d}function Ie(c,d){var f=""+c;return f.length>=d?f:on("0",d-f.length)+f}function je(c,d){var f=""+c;return f.length>=d?f:on(" ",d-f.length)+f}function Be(c,d){var f=""+c;return f.length>=d?f:f+on(" ",d-f.length)}function rt(c,d){var f=""+Math.round(c);return f.length>=d?f:on("0",d-f.length)+f}function ut(c,d){var f=""+c;return f.length>=d?f:on("0",d-f.length)+f}var St=Math.pow(2,32);function st(c,d){if(c>St||c<-St)return rt(c,d);var f=Math.round(c);return ut(f,d)}function fr(c,d){return d=d||0,c.length>=7+d&&(c.charCodeAt(d)|32)===103&&(c.charCodeAt(d+1)|32)===101&&(c.charCodeAt(d+2)|32)===110&&(c.charCodeAt(d+3)|32)===101&&(c.charCodeAt(d+4)|32)===114&&(c.charCodeAt(d+5)|32)===97&&(c.charCodeAt(d+6)|32)===108}var Pr=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ln=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Xr(c){return c||(c={}),c[0]="General",c[1]="0",c[2]="0.00",c[3]="#,##0",c[4]="#,##0.00",c[9]="0%",c[10]="0.00%",c[11]="0.00E+00",c[12]="# ?/?",c[13]="# ??/??",c[14]="m/d/yy",c[15]="d-mmm-yy",c[16]="d-mmm",c[17]="mmm-yy",c[18]="h:mm AM/PM",c[19]="h:mm:ss AM/PM",c[20]="h:mm",c[21]="h:mm:ss",c[22]="m/d/yy h:mm",c[37]="#,##0 ;(#,##0)",c[38]="#,##0 ;[Red](#,##0)",c[39]="#,##0.00;(#,##0.00)",c[40]="#,##0.00;[Red](#,##0.00)",c[45]="mm:ss",c[46]="[h]:mm:ss",c[47]="mmss.0",c[48]="##0.0E+0",c[49]="@",c[56]='"/ "hh""mm""ss" "',c}var mt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},fa={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},xs={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Fa(c,d,f){for(var y=c<0?-1:1,g=c*y,x=0,S=1,T=0,A=1,N=0,O=0,F=Math.floor(g);N<d&&(F=Math.floor(g),T=F*S+x,O=F*N+A,!(g-F<5e-8));)g=1/(g-F),x=S,S=T,A=N,N=O;if(O>d&&(N>d?(O=A,T=x):(O=N,T=S)),!f)return[0,y*T,O];var W=Math.floor(y*T/O);return[W,y*T-W*O,O]}function ha(c,d,f){if(c>2958465||c<0)return null;var y=c|0,g=Math.floor(86400*(c-y)),x=0,S=[],T={D:y,T:g,u:86400*(c-y)-g,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(T.u)<1e-6&&(T.u=0),d&&d.date1904&&(y+=1462),T.u>.9999&&(T.u=0,++g==86400&&(T.T=g=0,++y,++T.D)),y===60)S=f?[1317,10,29]:[1900,2,29],x=3;else if(y===0)S=f?[1317,8,29]:[1900,1,0],x=6;else{y>60&&--y;var A=new Date(1900,0,1);A.setDate(A.getDate()+y-1),S=[A.getFullYear(),A.getMonth()+1,A.getDate()],x=A.getDay(),y<60&&(x=(x+6)%7),f&&(x=ff(A,S))}return T.y=S[0],T.m=S[1],T.d=S[2],T.S=g%60,g=Math.floor(g/60),T.M=g%60,g=Math.floor(g/60),T.H=g,T.q=x,T}var Ha=new Date(1899,11,31,0,0,0),ql=Ha.getTime(),Kl=new Date(1900,2,1,0,0,0);function bs(c,d){var f=c.getTime();return d?f-=1461*24*60*60*1e3:c>=Kl&&(f+=24*60*60*1e3),(f-(ql+(c.getTimezoneOffset()-Ha.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function da(c){return c.indexOf(".")==-1?c:c.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Zl(c){return c.indexOf("E")==-1?c:c.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Fi(c){var d=c<0?12:11,f=da(c.toFixed(12));return f.length<=d||(f=c.toPrecision(10),f.length<=d)?f:c.toExponential(5)}function Hi(c){var d=da(c.toFixed(11));return d.length>(c<0?12:11)||d==="0"||d==="-0"?c.toPrecision(6):d}function Ss(c){var d=Math.floor(Math.log(Math.abs(c))*Math.LOG10E),f;return d>=-4&&d<=-1?f=c.toPrecision(10+d):Math.abs(d)<=9?f=Fi(c):d===10?f=c.toFixed(10).substr(0,12):f=Hi(c),da(Zl(f.toUpperCase()))}function wo(c,d){switch(typeof c){case"string":return c;case"boolean":return c?"TRUE":"FALSE";case"number":return(c|0)===c?c.toString(10):Ss(c);case"undefined":return"";case"object":if(c==null)return"";if(c instanceof Date)return Yn(14,bs(c,d&&d.date1904),d)}throw new Error("unsupported value in General format: "+c)}function ff(c,d){d[0]-=581;var f=c.getDay();return c<60&&(f=(f+6)%7),f}function hf(c,d,f,y){var g="",x=0,S=0,T=f.y,A,N=0;switch(c){case 98:T=f.y+543;case 121:switch(d.length){case 1:case 2:A=T%100,N=2;break;default:A=T%1e4,N=4;break}break;case 109:switch(d.length){case 1:case 2:A=f.m,N=d.length;break;case 3:return Ln[f.m-1][1];case 5:return Ln[f.m-1][0];default:return Ln[f.m-1][2]}break;case 100:switch(d.length){case 1:case 2:A=f.d,N=d.length;break;case 3:return Pr[f.q][0];default:return Pr[f.q][1]}break;case 104:switch(d.length){case 1:case 2:A=1+(f.H+11)%12,N=d.length;break;default:throw"bad hour format: "+d}break;case 72:switch(d.length){case 1:case 2:A=f.H,N=d.length;break;default:throw"bad hour format: "+d}break;case 77:switch(d.length){case 1:case 2:A=f.M,N=d.length;break;default:throw"bad minute format: "+d}break;case 115:if(d!="s"&&d!="ss"&&d!=".0"&&d!=".00"&&d!=".000")throw"bad second format: "+d;return f.u===0&&(d=="s"||d=="ss")?Ie(f.S,d.length):(y>=2?S=y===3?1e3:100:S=y===1?10:1,x=Math.round(S*(f.S+f.u)),x>=60*S&&(x=0),d==="s"?x===0?"0":""+x/S:(g=Ie(x,2+y),d==="ss"?g.substr(0,2):"."+g.substr(2,d.length-1)));case 90:switch(d){case"[h]":case"[hh]":A=f.D*24+f.H;break;case"[m]":case"[mm]":A=(f.D*24+f.H)*60+f.M;break;case"[s]":case"[ss]":A=((f.D*24+f.H)*60+f.M)*60+Math.round(f.S+f.u);break;default:throw"bad abstime format: "+d}N=d.length===3?1:2;break;case 101:A=T,N=1;break}var O=N>0?Ie(A,N):"";return O}function va(c){var d=3;if(c.length<=d)return c;for(var f=c.length%d,y=c.substr(0,f);f!=c.length;f+=d)y+=(y.length>0?",":"")+c.substr(f,d);return y}var w0=/%/g;function _b(c,d,f){var y=d.replace(w0,""),g=d.length-y.length;return zi(c,y,f*Math.pow(10,2*g))+on("%",g)}function Rb(c,d,f){for(var y=d.length-1;d.charCodeAt(y-1)===44;)--y;return zi(c,d.substr(0,y),f/Math.pow(10,3*(d.length-y)))}function x0(c,d){var f,y=c.indexOf("E")-c.indexOf(".")-1;if(c.match(/^#+0.0E\+0$/)){if(d==0)return"0.0E+0";if(d<0)return"-"+x0(c,-d);var g=c.indexOf(".");g===-1&&(g=c.indexOf("E"));var x=Math.floor(Math.log(d)*Math.LOG10E)%g;if(x<0&&(x+=g),f=(d/Math.pow(10,x)).toPrecision(y+1+(g+x)%g),f.indexOf("e")===-1){var S=Math.floor(Math.log(d)*Math.LOG10E);for(f.indexOf(".")===-1?f=f.charAt(0)+"."+f.substr(1)+"E+"+(S-f.length+x):f+="E+"+(S-x);f.substr(0,2)==="0.";)f=f.charAt(0)+f.substr(2,g)+"."+f.substr(2+g),f=f.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");f=f.replace(/\+-/,"-")}f=f.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(T,A,N,O){return A+N+O.substr(0,(g+x)%g)+"."+O.substr(x)+"E"})}else f=d.toExponential(y);return c.match(/E\+00$/)&&f.match(/e[+-]\d$/)&&(f=f.substr(0,f.length-1)+"0"+f.charAt(f.length-1)),c.match(/E\-/)&&f.match(/e\+/)&&(f=f.replace(/e\+/,"e")),f.replace("e","E")}var b0=/# (\?+)( ?)\/( ?)(\d+)/;function Lb(c,d,f){var y=parseInt(c[4],10),g=Math.round(d*y),x=Math.floor(g/y),S=g-x*y,T=y;return f+(x===0?"":""+x)+" "+(S===0?on(" ",c[1].length+1+c[4].length):je(S,c[1].length)+c[2]+"/"+c[3]+Ie(T,c[4].length))}function Mb(c,d,f){return f+(d===0?"":""+d)+on(" ",c[1].length+2+c[4].length)}var S0=/^#*0*\.([0#]+)/,E0=/\).*[0#]/,T0=/\(###\) ###\\?-####/;function Yr(c){for(var d="",f,y=0;y!=c.length;++y)switch(f=c.charCodeAt(y)){case 35:break;case 63:d+=" ";break;case 48:d+="0";break;default:d+=String.fromCharCode(f)}return d}function _0(c,d){var f=Math.pow(10,d);return""+Math.round(c*f)/f}function R0(c,d){var f=c-Math.floor(c),y=Math.pow(10,d);return d<(""+Math.round(f*y)).length?0:Math.round(f*y)}function Ob(c,d){return d<(""+Math.round((c-Math.floor(c))*Math.pow(10,d))).length?1:0}function Ab(c){return c<2147483647&&c>-2147483648?""+(c>=0?c|0:c-1|0):""+Math.floor(c)}function Mn(c,d,f){if(c.charCodeAt(0)===40&&!d.match(E0)){var y=d.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return f>=0?Mn("n",y,f):"("+Mn("n",y,-f)+")"}if(d.charCodeAt(d.length-1)===44)return Rb(c,d,f);if(d.indexOf("%")!==-1)return _b(c,d,f);if(d.indexOf("E")!==-1)return x0(d,f);if(d.charCodeAt(0)===36)return"$"+Mn(c,d.substr(d.charAt(1)==" "?2:1),f);var g,x,S,T,A=Math.abs(f),N=f<0?"-":"";if(d.match(/^00+$/))return N+st(A,d.length);if(d.match(/^[#?]+$/))return g=st(f,0),g==="0"&&(g=""),g.length>d.length?g:Yr(d.substr(0,d.length-g.length))+g;if(x=d.match(b0))return Lb(x,A,N);if(d.match(/^#+0+$/))return N+st(A,d.length-d.indexOf("0"));if(x=d.match(S0))return g=_0(f,x[1].length).replace(/^([^\.]+)$/,"$1."+Yr(x[1])).replace(/\.$/,"."+Yr(x[1])).replace(/\.(\d*)$/,function(X,B){return"."+B+on("0",Yr(x[1]).length-B.length)}),d.indexOf("0.")!==-1?g:g.replace(/^0\./,".");if(d=d.replace(/^#+([0.])/,"$1"),x=d.match(/^(0*)\.(#*)$/))return N+_0(A,x[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,x[1].length?"0.":".");if(x=d.match(/^#{1,3},##0(\.?)$/))return N+va(st(A,0));if(x=d.match(/^#,##0\.([#0]*0)$/))return f<0?"-"+Mn(c,d,-f):va(""+(Math.floor(f)+Ob(f,x[1].length)))+"."+Ie(R0(f,x[1].length),x[1].length);if(x=d.match(/^#,#*,#0/))return Mn(c,d.replace(/^#,#*,/,""),f);if(x=d.match(/^([0#]+)(\\?-([0#]+))+$/))return g=Te(Mn(c,d.replace(/[\\-]/g,""),f)),S=0,Te(Te(d.replace(/\\/g,"")).replace(/[0#]/g,function(X){return S<g.length?g.charAt(S++):X==="0"?"0":""}));if(d.match(T0))return g=Mn(c,"##########",f),"("+g.substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var O="";if(x=d.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return S=Math.min(x[4].length,7),T=Fa(A,Math.pow(10,S)-1,!1),g=""+N,O=zi("n",x[1],T[1]),O.charAt(O.length-1)==" "&&(O=O.substr(0,O.length-1)+"0"),g+=O+x[2]+"/"+x[3],O=Be(T[2],S),O.length<x[4].length&&(O=Yr(x[4].substr(x[4].length-O.length))+O),g+=O,g;if(x=d.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return S=Math.min(Math.max(x[1].length,x[4].length),7),T=Fa(A,Math.pow(10,S)-1,!0),N+(T[0]||(T[1]?"":"0"))+" "+(T[1]?je(T[1],S)+x[2]+"/"+x[3]+Be(T[2],S):on(" ",2*S+1+x[2].length+x[3].length));if(x=d.match(/^[#0?]+$/))return g=st(f,0),d.length<=g.length?g:Yr(d.substr(0,d.length-g.length))+g;if(x=d.match(/^([#0?]+)\.([#0]+)$/)){g=""+f.toFixed(Math.min(x[2].length,10)).replace(/([^0])0+$/,"$1"),S=g.indexOf(".");var F=d.indexOf(".")-S,W=d.length-g.length-F;return Yr(d.substr(0,F)+g+d.substr(d.length-W))}if(x=d.match(/^00,000\.([#0]*0)$/))return S=R0(f,x[1].length),f<0?"-"+Mn(c,d,-f):va(Ab(f)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(X){return"00,"+(X.length<3?Ie(0,3-X.length):"")+X})+"."+Ie(S,x[1].length);switch(d){case"###,##0.00":return Mn(c,"#,##0.00",f);case"###,###":case"##,###":case"#,###":var H=va(st(A,0));return H!=="0"?N+H:"";case"###,###.00":return Mn(c,"###,##0.00",f).replace(/^0\./,".");case"#,###.00":return Mn(c,"#,##0.00",f).replace(/^0\./,".")}throw new Error("unsupported format |"+d+"|")}function Nb(c,d,f){for(var y=d.length-1;d.charCodeAt(y-1)===44;)--y;return zi(c,d.substr(0,y),f/Math.pow(10,3*(d.length-y)))}function kb(c,d,f){var y=d.replace(w0,""),g=d.length-y.length;return zi(c,y,f*Math.pow(10,2*g))+on("%",g)}function L0(c,d){var f,y=c.indexOf("E")-c.indexOf(".")-1;if(c.match(/^#+0.0E\+0$/)){if(d==0)return"0.0E+0";if(d<0)return"-"+L0(c,-d);var g=c.indexOf(".");g===-1&&(g=c.indexOf("E"));var x=Math.floor(Math.log(d)*Math.LOG10E)%g;if(x<0&&(x+=g),f=(d/Math.pow(10,x)).toPrecision(y+1+(g+x)%g),!f.match(/[Ee]/)){var S=Math.floor(Math.log(d)*Math.LOG10E);f.indexOf(".")===-1?f=f.charAt(0)+"."+f.substr(1)+"E+"+(S-f.length+x):f+="E+"+(S-x),f=f.replace(/\+-/,"-")}f=f.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(T,A,N,O){return A+N+O.substr(0,(g+x)%g)+"."+O.substr(x)+"E"})}else f=d.toExponential(y);return c.match(/E\+00$/)&&f.match(/e[+-]\d$/)&&(f=f.substr(0,f.length-1)+"0"+f.charAt(f.length-1)),c.match(/E\-/)&&f.match(/e\+/)&&(f=f.replace(/e\+/,"e")),f.replace("e","E")}function pi(c,d,f){if(c.charCodeAt(0)===40&&!d.match(E0)){var y=d.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return f>=0?pi("n",y,f):"("+pi("n",y,-f)+")"}if(d.charCodeAt(d.length-1)===44)return Nb(c,d,f);if(d.indexOf("%")!==-1)return kb(c,d,f);if(d.indexOf("E")!==-1)return L0(d,f);if(d.charCodeAt(0)===36)return"$"+pi(c,d.substr(d.charAt(1)==" "?2:1),f);var g,x,S,T,A=Math.abs(f),N=f<0?"-":"";if(d.match(/^00+$/))return N+Ie(A,d.length);if(d.match(/^[#?]+$/))return g=""+f,f===0&&(g=""),g.length>d.length?g:Yr(d.substr(0,d.length-g.length))+g;if(x=d.match(b0))return Mb(x,A,N);if(d.match(/^#+0+$/))return N+Ie(A,d.length-d.indexOf("0"));if(x=d.match(S0))return g=(""+f).replace(/^([^\.]+)$/,"$1."+Yr(x[1])).replace(/\.$/,"."+Yr(x[1])),g=g.replace(/\.(\d*)$/,function(X,B){return"."+B+on("0",Yr(x[1]).length-B.length)}),d.indexOf("0.")!==-1?g:g.replace(/^0\./,".");if(d=d.replace(/^#+([0.])/,"$1"),x=d.match(/^(0*)\.(#*)$/))return N+(""+A).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,x[1].length?"0.":".");if(x=d.match(/^#{1,3},##0(\.?)$/))return N+va(""+A);if(x=d.match(/^#,##0\.([#0]*0)$/))return f<0?"-"+pi(c,d,-f):va(""+f)+"."+on("0",x[1].length);if(x=d.match(/^#,#*,#0/))return pi(c,d.replace(/^#,#*,/,""),f);if(x=d.match(/^([0#]+)(\\?-([0#]+))+$/))return g=Te(pi(c,d.replace(/[\\-]/g,""),f)),S=0,Te(Te(d.replace(/\\/g,"")).replace(/[0#]/g,function(X){return S<g.length?g.charAt(S++):X==="0"?"0":""}));if(d.match(T0))return g=pi(c,"##########",f),"("+g.substr(0,3)+") "+g.substr(3,3)+"-"+g.substr(6);var O="";if(x=d.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return S=Math.min(x[4].length,7),T=Fa(A,Math.pow(10,S)-1,!1),g=""+N,O=zi("n",x[1],T[1]),O.charAt(O.length-1)==" "&&(O=O.substr(0,O.length-1)+"0"),g+=O+x[2]+"/"+x[3],O=Be(T[2],S),O.length<x[4].length&&(O=Yr(x[4].substr(x[4].length-O.length))+O),g+=O,g;if(x=d.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return S=Math.min(Math.max(x[1].length,x[4].length),7),T=Fa(A,Math.pow(10,S)-1,!0),N+(T[0]||(T[1]?"":"0"))+" "+(T[1]?je(T[1],S)+x[2]+"/"+x[3]+Be(T[2],S):on(" ",2*S+1+x[2].length+x[3].length));if(x=d.match(/^[#0?]+$/))return g=""+f,d.length<=g.length?g:Yr(d.substr(0,d.length-g.length))+g;if(x=d.match(/^([#0]+)\.([#0]+)$/)){g=""+f.toFixed(Math.min(x[2].length,10)).replace(/([^0])0+$/,"$1"),S=g.indexOf(".");var F=d.indexOf(".")-S,W=d.length-g.length-F;return Yr(d.substr(0,F)+g+d.substr(d.length-W))}if(x=d.match(/^00,000\.([#0]*0)$/))return f<0?"-"+pi(c,d,-f):va(""+f).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(X){return"00,"+(X.length<3?Ie(0,3-X.length):"")+X})+"."+Ie(0,x[1].length);switch(d){case"###,###":case"##,###":case"#,###":var H=va(""+A);return H!=="0"?N+H:"";default:if(d.match(/\.[0#?]*$/))return pi(c,d.slice(0,d.lastIndexOf(".")),f)+Yr(d.slice(d.lastIndexOf(".")))}throw new Error("unsupported format |"+d+"|")}function zi(c,d,f){return(f|0)===f?pi(c,d,f):Mn(c,d,f)}function Ib(c){for(var d=[],f=!1,y=0,g=0;y<c.length;++y)switch(c.charCodeAt(y)){case 34:f=!f;break;case 95:case 42:case 92:++y;break;case 59:d[d.length]=c.substr(g,y-g),g=y+1}if(d[d.length]=c.substr(g),f===!0)throw new Error("Format |"+c+"| unterminated string ");return d}var M0=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function jl(c){for(var d=0,f="",y="";d<c.length;)switch(f=c.charAt(d)){case"G":fr(c,d)&&(d+=6),d++;break;case'"':for(;c.charCodeAt(++d)!==34&&d<c.length;);++d;break;case"\\":d+=2;break;case"_":d+=2;break;case"@":++d;break;case"B":case"b":if(c.charAt(d+1)==="1"||c.charAt(d+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(c.substr(d,3).toUpperCase()==="A/P"||c.substr(d,5).toUpperCase()==="AM/PM"||c.substr(d,5).toUpperCase()==="/")return!0;++d;break;case"[":for(y=f;c.charAt(d++)!=="]"&&d<c.length;)y+=c.charAt(d);if(y.match(M0))return!0;break;case".":case"0":case"#":for(;d<c.length&&("0#?.,E+-%".indexOf(f=c.charAt(++d))>-1||f=="\\"&&c.charAt(d+1)=="-"&&"0#".indexOf(c.charAt(d+2))>-1););break;case"?":for(;c.charAt(++d)===f;);break;case"*":++d,(c.charAt(d)==" "||c.charAt(d)=="*")&&++d;break;case"(":case")":++d;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;d<c.length&&"0123456789".indexOf(c.charAt(++d))>-1;);break;case" ":++d;break;default:++d;break}return!1}function Pb(c,d,f,y){for(var g=[],x="",S=0,T="",A="t",N,O,F,W="H";S<c.length;)switch(T=c.charAt(S)){case"G":if(!fr(c,S))throw new Error("unrecognized character "+T+" in "+c);g[g.length]={t:"G",v:"General"},S+=7;break;case'"':for(x="";(F=c.charCodeAt(++S))!==34&&S<c.length;)x+=String.fromCharCode(F);g[g.length]={t:"t",v:x},++S;break;case"\\":var H=c.charAt(++S),X=H==="("||H===")"?H:"t";g[g.length]={t:X,v:H},++S;break;case"_":g[g.length]={t:"t",v:" "},S+=2;break;case"@":g[g.length]={t:"T",v:d},++S;break;case"B":case"b":if(c.charAt(S+1)==="1"||c.charAt(S+1)==="2"){if(N==null&&(N=ha(d,f,c.charAt(S+1)==="2"),N==null))return"";g[g.length]={t:"X",v:c.substr(S,2)},A=T,S+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":T=T.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(d<0||N==null&&(N=ha(d,f),N==null))return"";for(x=T;++S<c.length&&c.charAt(S).toLowerCase()===T;)x+=T;T==="m"&&A.toLowerCase()==="h"&&(T="M"),T==="h"&&(T=W),g[g.length]={t:T,v:x},A=T;break;case"A":case"a":case"":var B={t:T,v:T};if(N==null&&(N=ha(d,f)),c.substr(S,3).toUpperCase()==="A/P"?(N!=null&&(B.v=N.H>=12?"P":"A"),B.t="T",W="h",S+=3):c.substr(S,5).toUpperCase()==="AM/PM"?(N!=null&&(B.v=N.H>=12?"PM":"AM"),B.t="T",S+=5,W="h"):c.substr(S,5).toUpperCase()==="/"?(N!=null&&(B.v=N.H>=12?"":""),B.t="T",S+=5,W="h"):(B.t="t",++S),N==null&&B.t==="T")return"";g[g.length]=B,A=T;break;case"[":for(x=T;c.charAt(S++)!=="]"&&S<c.length;)x+=c.charAt(S);if(x.slice(-1)!=="]")throw'unterminated "[" block: |'+x+"|";if(x.match(M0)){if(N==null&&(N=ha(d,f),N==null))return"";g[g.length]={t:"Z",v:x.toLowerCase()},A=x.charAt(1)}else x.indexOf("$")>-1&&(x=(x.match(/\$([^-\[\]]*)/)||[])[1]||"$",jl(c)||(g[g.length]={t:"t",v:x}));break;case".":if(N!=null){for(x=T;++S<c.length&&(T=c.charAt(S))==="0";)x+=T;g[g.length]={t:"s",v:x};break}case"0":case"#":for(x=T;++S<c.length&&"0#?.,E+-%".indexOf(T=c.charAt(S))>-1;)x+=T;g[g.length]={t:"n",v:x};break;case"?":for(x=T;c.charAt(++S)===T;)x+=T;g[g.length]={t:T,v:x},A=T;break;case"*":++S,(c.charAt(S)==" "||c.charAt(S)=="*")&&++S;break;case"(":case")":g[g.length]={t:y===1?"t":T,v:T},++S;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(x=T;S<c.length&&"0123456789".indexOf(c.charAt(++S))>-1;)x+=c.charAt(S);g[g.length]={t:"D",v:x};break;case" ":g[g.length]={t:T,v:T},++S;break;case"$":g[g.length]={t:"t",v:"$"},++S;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(T)===-1)throw new Error("unrecognized character "+T+" in "+c);g[g.length]={t:"t",v:T},++S;break}var G=0,ie=0,ae;for(S=g.length-1,A="t";S>=0;--S)switch(g[S].t){case"h":case"H":g[S].t=W,A="h",G<1&&(G=1);break;case"s":(ae=g[S].v.match(/\.0+$/))&&(ie=Math.max(ie,ae[0].length-1)),G<3&&(G=3);case"d":case"y":case"M":case"e":A=g[S].t;break;case"m":A==="s"&&(g[S].t="M",G<2&&(G=2));break;case"X":break;case"Z":G<1&&g[S].v.match(/[Hh]/)&&(G=1),G<2&&g[S].v.match(/[Mm]/)&&(G=2),G<3&&g[S].v.match(/[Ss]/)&&(G=3)}switch(G){case 0:break;case 1:N.u>=.5&&(N.u=0,++N.S),N.S>=60&&(N.S=0,++N.M),N.M>=60&&(N.M=0,++N.H);break;case 2:N.u>=.5&&(N.u=0,++N.S),N.S>=60&&(N.S=0,++N.M);break}var de="",we;for(S=0;S<g.length;++S)switch(g[S].t){case"t":case"T":case" ":case"D":break;case"X":g[S].v="",g[S].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":g[S].v=hf(g[S].t.charCodeAt(0),g[S].v,N,ie),g[S].t="t";break;case"n":case"?":for(we=S+1;g[we]!=null&&((T=g[we].t)==="?"||T==="D"||(T===" "||T==="t")&&g[we+1]!=null&&(g[we+1].t==="?"||g[we+1].t==="t"&&g[we+1].v==="/")||g[S].t==="("&&(T===" "||T==="n"||T===")")||T==="t"&&(g[we].v==="/"||g[we].v===" "&&g[we+1]!=null&&g[we+1].t=="?"));)g[S].v+=g[we].v,g[we]={v:"",t:";"},++we;de+=g[S].v,S=we-1;break;case"G":g[S].t="t",g[S].v=wo(d,f);break}var xe="",he,ee;if(de.length>0){de.charCodeAt(0)==40?(he=d<0&&de.charCodeAt(0)===45?-d:d,ee=zi("n",de,he)):(he=d<0&&y>1?-d:d,ee=zi("n",de,he),he<0&&g[0]&&g[0].t=="t"&&(ee=ee.substr(1),g[0].v="-"+g[0].v)),we=ee.length-1;var Ee=g.length;for(S=0;S<g.length;++S)if(g[S]!=null&&g[S].t!="t"&&g[S].v.indexOf(".")>-1){Ee=S;break}var Ce=g.length;if(Ee===g.length&&ee.indexOf("E")===-1){for(S=g.length-1;S>=0;--S)g[S]==null||"n?".indexOf(g[S].t)===-1||(we>=g[S].v.length-1?(we-=g[S].v.length,g[S].v=ee.substr(we+1,g[S].v.length)):we<0?g[S].v="":(g[S].v=ee.substr(0,we+1),we=-1),g[S].t="t",Ce=S);we>=0&&Ce<g.length&&(g[Ce].v=ee.substr(0,we+1)+g[Ce].v)}else if(Ee!==g.length&&ee.indexOf("E")===-1){for(we=ee.indexOf(".")-1,S=Ee;S>=0;--S)if(!(g[S]==null||"n?".indexOf(g[S].t)===-1)){for(O=g[S].v.indexOf(".")>-1&&S===Ee?g[S].v.indexOf(".")-1:g[S].v.length-1,xe=g[S].v.substr(O+1);O>=0;--O)we>=0&&(g[S].v.charAt(O)==="0"||g[S].v.charAt(O)==="#")&&(xe=ee.charAt(we--)+xe);g[S].v=xe,g[S].t="t",Ce=S}for(we>=0&&Ce<g.length&&(g[Ce].v=ee.substr(0,we+1)+g[Ce].v),we=ee.indexOf(".")+1,S=Ee;S<g.length;++S)if(!(g[S]==null||"n?(".indexOf(g[S].t)===-1&&S!==Ee)){for(O=g[S].v.indexOf(".")>-1&&S===Ee?g[S].v.indexOf(".")+1:0,xe=g[S].v.substr(0,O);O<g[S].v.length;++O)we<ee.length&&(xe+=ee.charAt(we++));g[S].v=xe,g[S].t="t",Ce=S}}}for(S=0;S<g.length;++S)g[S]!=null&&"n?".indexOf(g[S].t)>-1&&(he=y>1&&d<0&&S>0&&g[S-1].v==="-"?-d:d,g[S].v=zi(g[S].t,g[S].v,he),g[S].t="t");var Oe="";for(S=0;S!==g.length;++S)g[S]!=null&&(Oe+=g[S].v);return Oe}var O0=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function A0(c,d){if(d==null)return!1;var f=parseFloat(d[2]);switch(d[1]){case"=":if(c==f)return!0;break;case">":if(c>f)return!0;break;case"<":if(c<f)return!0;break;case"<>":if(c!=f)return!0;break;case">=":if(c>=f)return!0;break;case"<=":if(c<=f)return!0;break}return!1}function Db(c,d){var f=Ib(c),y=f.length,g=f[y-1].indexOf("@");if(y<4&&g>-1&&--y,f.length>4)throw new Error("cannot find right format for |"+f.join("|")+"|");if(typeof d!="number")return[4,f.length===4||g>-1?f[f.length-1]:"@"];switch(f.length){case 1:f=g>-1?["General","General","General",f[0]]:[f[0],f[0],f[0],"@"];break;case 2:f=g>-1?[f[0],f[0],f[0],f[1]]:[f[0],f[1],f[0],"@"];break;case 3:f=g>-1?[f[0],f[1],f[0],f[2]]:[f[0],f[1],f[2],"@"];break}var x=d>0?f[0]:d<0?f[1]:f[2];if(f[0].indexOf("[")===-1&&f[1].indexOf("[")===-1)return[y,x];if(f[0].match(/\[[=<>]/)!=null||f[1].match(/\[[=<>]/)!=null){var S=f[0].match(O0),T=f[1].match(O0);return A0(d,S)?[y,f[0]]:A0(d,T)?[y,f[1]]:[y,f[S!=null&&T!=null?2:1]]}return[y,x]}function Yn(c,d,f){f==null&&(f={});var y="";switch(typeof c){case"string":c=="m/d/yy"&&f.dateNF?y=f.dateNF:y=c;break;case"number":c==14&&f.dateNF?y=f.dateNF:y=(f.table!=null?f.table:mt)[c],y==null&&(y=f.table&&f.table[fa[c]]||mt[fa[c]]),y==null&&(y=xs[c]||"General");break}if(fr(y,0))return wo(d,f);d instanceof Date&&(d=bs(d,f.date1904));var g=Db(y,d);if(fr(g[1]))return wo(d,f);if(d===!0)d="TRUE";else if(d===!1)d="FALSE";else if(d===""||d==null)return"";return Pb(g[1],d,f,g[0])}function Es(c,d){if(typeof d!="number"){d=+d||-1;for(var f=0;f<392;++f){if(mt[f]==null){d<0&&(d=f);continue}if(mt[f]==c){d=f;break}}d<0&&(d=391)}return mt[d]=c,d}function df(c){for(var d=0;d!=392;++d)c[d]!==void 0&&Es(c[d],d)}function vf(){mt=Xr()}var N0={format:Yn,load:Es,_table:mt,load_table:df,parse_date_code:ha,is_date:jl,get_table:function(){return N0._table=mt}},Bb={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},k0=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Fb(c){var d=typeof c=="number"?mt[c]:c;return d=d.replace(k0,"(\\d+)"),new RegExp("^"+d+"$")}function Hb(c,d,f){var y=-1,g=-1,x=-1,S=-1,T=-1,A=-1;(d.match(k0)||[]).forEach(function(F,W){var H=parseInt(f[W+1],10);switch(F.toLowerCase().charAt(0)){case"y":y=H;break;case"d":x=H;break;case"h":S=H;break;case"s":A=H;break;case"m":S>=0?T=H:g=H;break}}),A>=0&&T==-1&&g>=0&&(T=g,g=-1);var N=(""+(y>=0?y:new Date().getFullYear())).slice(-4)+"-"+("00"+(g>=1?g:1)).slice(-2)+"-"+("00"+(x>=1?x:1)).slice(-2);N.length==7&&(N="0"+N),N.length==8&&(N="20"+N);var O=("00"+(S>=0?S:0)).slice(-2)+":"+("00"+(T>=0?T:0)).slice(-2)+":"+("00"+(A>=0?A:0)).slice(-2);return S==-1&&T==-1&&A==-1?N:y==-1&&g==-1&&x==-1?O:N+"T"+O}var zb=function(){var c={};c.version="1.2.0";function d(){for(var ee=0,Ee=new Array(256),Ce=0;Ce!=256;++Ce)ee=Ce,ee=ee&1?-306674912^ee>>>1:ee>>>1,ee=ee&1?-306674912^ee>>>1:ee>>>1,ee=ee&1?-306674912^ee>>>1:ee>>>1,ee=ee&1?-306674912^ee>>>1:ee>>>1,ee=ee&1?-306674912^ee>>>1:ee>>>1,ee=ee&1?-306674912^ee>>>1:ee>>>1,ee=ee&1?-306674912^ee>>>1:ee>>>1,ee=ee&1?-306674912^ee>>>1:ee>>>1,Ee[Ce]=ee;return typeof Int32Array<"u"?new Int32Array(Ee):Ee}var f=d();function y(ee){var Ee=0,Ce=0,Oe=0,Re=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Oe=0;Oe!=256;++Oe)Re[Oe]=ee[Oe];for(Oe=0;Oe!=256;++Oe)for(Ce=ee[Oe],Ee=256+Oe;Ee<4096;Ee+=256)Ce=Re[Ee]=Ce>>>8^ee[Ce&255];var Ae=[];for(Oe=1;Oe!=16;++Oe)Ae[Oe-1]=typeof Int32Array<"u"?Re.subarray(Oe*256,Oe*256+256):Re.slice(Oe*256,Oe*256+256);return Ae}var g=y(f),x=g[0],S=g[1],T=g[2],A=g[3],N=g[4],O=g[5],F=g[6],W=g[7],H=g[8],X=g[9],B=g[10],G=g[11],ie=g[12],ae=g[13],de=g[14];function we(ee,Ee){for(var Ce=Ee^-1,Oe=0,Re=ee.length;Oe<Re;)Ce=Ce>>>8^f[(Ce^ee.charCodeAt(Oe++))&255];return~Ce}function xe(ee,Ee){for(var Ce=Ee^-1,Oe=ee.length-15,Re=0;Re<Oe;)Ce=de[ee[Re++]^Ce&255]^ae[ee[Re++]^Ce>>8&255]^ie[ee[Re++]^Ce>>16&255]^G[ee[Re++]^Ce>>>24]^B[ee[Re++]]^X[ee[Re++]]^H[ee[Re++]]^W[ee[Re++]]^F[ee[Re++]]^O[ee[Re++]]^N[ee[Re++]]^A[ee[Re++]]^T[ee[Re++]]^S[ee[Re++]]^x[ee[Re++]]^f[ee[Re++]];for(Oe+=15;Re<Oe;)Ce=Ce>>>8^f[(Ce^ee[Re++])&255];return~Ce}function he(ee,Ee){for(var Ce=Ee^-1,Oe=0,Re=ee.length,Ae=0,Ve=0;Oe<Re;)Ae=ee.charCodeAt(Oe++),Ae<128?Ce=Ce>>>8^f[(Ce^Ae)&255]:Ae<2048?(Ce=Ce>>>8^f[(Ce^(192|Ae>>6&31))&255],Ce=Ce>>>8^f[(Ce^(128|Ae&63))&255]):Ae>=55296&&Ae<57344?(Ae=(Ae&1023)+64,Ve=ee.charCodeAt(Oe++)&1023,Ce=Ce>>>8^f[(Ce^(240|Ae>>8&7))&255],Ce=Ce>>>8^f[(Ce^(128|Ae>>2&63))&255],Ce=Ce>>>8^f[(Ce^(128|Ve>>6&15|(Ae&3)<<4))&255],Ce=Ce>>>8^f[(Ce^(128|Ve&63))&255]):(Ce=Ce>>>8^f[(Ce^(224|Ae>>12&15))&255],Ce=Ce>>>8^f[(Ce^(128|Ae>>6&63))&255],Ce=Ce>>>8^f[(Ce^(128|Ae&63))&255]);return~Ce}return c.table=f,c.bstr=we,c.buf=xe,c.str=he,c}(),kt=function(){var d={};d.version="1.2.1";function f(D,K){for(var z=D.split("/"),V=K.split("/"),Z=0,j=0,ue=Math.min(z.length,V.length);Z<ue;++Z){if(j=z[Z].length-V[Z].length)return j;if(z[Z]!=V[Z])return z[Z]<V[Z]?-1:1}return z.length-V.length}function y(D){if(D.charAt(D.length-1)=="/")return D.slice(0,-1).indexOf("/")===-1?D:y(D.slice(0,-1));var K=D.lastIndexOf("/");return K===-1?D:D.slice(0,K+1)}function g(D){if(D.charAt(D.length-1)=="/")return g(D.slice(0,-1));var K=D.lastIndexOf("/");return K===-1?D:D.slice(K+1)}function x(D,K){typeof K=="string"&&(K=new Date(K));var z=K.getHours();z=z<<6|K.getMinutes(),z=z<<5|K.getSeconds()>>>1,D._W(2,z);var V=K.getFullYear()-1980;V=V<<4|K.getMonth()+1,V=V<<5|K.getDate(),D._W(2,V)}function S(D){var K=D._R(2)&65535,z=D._R(2)&65535,V=new Date,Z=z&31;z>>>=5;var j=z&15;z>>>=4,V.setMilliseconds(0),V.setFullYear(z+1980),V.setMonth(j-1),V.setDate(Z);var ue=K&31;K>>>=5;var be=K&63;return K>>>=6,V.setHours(K),V.setMinutes(be),V.setSeconds(ue<<1),V}function T(D){Nn(D,0);for(var K={},z=0;D.l<=D.length-4;){var V=D._R(2),Z=D._R(2),j=D.l+Z,ue={};switch(V){case 21589:z=D._R(1),z&1&&(ue.mtime=D._R(4)),Z>5&&(z&2&&(ue.atime=D._R(4)),z&4&&(ue.ctime=D._R(4))),ue.mtime&&(ue.mt=new Date(ue.mtime*1e3));break}D.l=j,K[V]=ue}return K}var A;function N(){return A||(A=void 0)}function O(D,K){if(D[0]==80&&D[1]==75)return Sg(D,K);if((D[0]|32)==109&&(D[1]|32)==105)return KT(D,K);if(D.length<512)throw new Error("CFB file size "+D.length+" < 512");var z=3,V=512,Z=0,j=0,ue=0,be=0,le=0,fe=[],ve=D.slice(0,512);Nn(ve,0);var Ne=F(ve);switch(z=Ne[0],z){case 3:V=512;break;case 4:V=4096;break;case 0:if(Ne[1]==0)return Sg(D,K);default:throw new Error("Major Version: Expected 3 or 4 saw "+z)}V!==512&&(ve=D.slice(0,V),Nn(ve,28));var He=D.slice(0,V);W(ve,z);var Ge=ve._R(4,"i");if(z===3&&Ge!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ge);ve.l+=4,ue=ve._R(4,"i"),ve.l+=4,ve.chk("00100000","Mini Stream Cutoff Size: "),be=ve._R(4,"i"),Z=ve._R(4,"i"),le=ve._R(4,"i"),j=ve._R(4,"i");for(var Pe=-1,ze=0;ze<109&&(Pe=ve._R(4,"i"),!(Pe<0));++ze)fe[ze]=Pe;var et=H(D,V);G(le,j,et,V,fe);var Yt=ae(et,ue,fe,V);Yt[ue].name="!Directory",Z>0&&be!==Ve&&(Yt[be].name="!MiniFAT"),Yt[fe[0]].name="!FAT",Yt.fat_addrs=fe,Yt.ssz=V;var $t={},Fr=[],Fs=[],Hs=[];de(ue,Yt,et,Fr,Z,$t,Fs,be),X(Fs,Hs,Fr),Fr.shift();var zs={FileIndex:Fs,FullPaths:Hs};return K&&K.raw&&(zs.raw={header:He,sectors:et}),zs}function F(D){if(D[D.l]==80&&D[D.l+1]==75)return[0,0];D.chk(ft,"Header Signature: "),D.l+=16;var K=D._R(2,"u");return[D._R(2,"u"),K]}function W(D,K){var z=9;switch(D.l+=2,z=D._R(2)){case 9:if(K!=3)throw new Error("Sector Shift: Expected 9 saw "+z);break;case 12:if(K!=4)throw new Error("Sector Shift: Expected 12 saw "+z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+z)}D.chk("0600","Mini Sector Shift: "),D.chk("000000000000","Reserved: ")}function H(D,K){for(var z=Math.ceil(D.length/K)-1,V=[],Z=1;Z<z;++Z)V[Z-1]=D.slice(Z*K,(Z+1)*K);return V[z-1]=D.slice(z*K),V}function X(D,K,z){for(var V=0,Z=0,j=0,ue=0,be=0,le=z.length,fe=[],ve=[];V<le;++V)fe[V]=ve[V]=V,K[V]=z[V];for(;be<ve.length;++be)V=ve[be],Z=D[V].L,j=D[V].R,ue=D[V].C,fe[V]===V&&(Z!==-1&&fe[Z]!==Z&&(fe[V]=fe[Z]),j!==-1&&fe[j]!==j&&(fe[V]=fe[j])),ue!==-1&&(fe[ue]=V),Z!==-1&&V!=fe[V]&&(fe[Z]=fe[V],ve.lastIndexOf(Z)<be&&ve.push(Z)),j!==-1&&V!=fe[V]&&(fe[j]=fe[V],ve.lastIndexOf(j)<be&&ve.push(j));for(V=1;V<le;++V)fe[V]===V&&(j!==-1&&fe[j]!==j?fe[V]=fe[j]:Z!==-1&&fe[Z]!==Z&&(fe[V]=fe[Z]));for(V=1;V<le;++V)if(D[V].type!==0){if(be=V,be!=fe[be])do be=fe[be],K[V]=K[be]+"/"+K[V];while(be!==0&&fe[be]!==-1&&be!=fe[be]);fe[V]=-1}for(K[0]+="/",V=1;V<le;++V)D[V].type!==2&&(K[V]+="/")}function B(D,K,z){for(var V=D.start,Z=D.size,j=[],ue=V;z&&Z>0&&ue>=0;)j.push(K.slice(ue*Ae,ue*Ae+Ae)),Z-=Ae,ue=Eo(z,ue*4);return j.length===0?gi(0):ce(j).slice(0,D.size)}function G(D,K,z,V,Z){var j=Ve;if(D===Ve){if(K!==0)throw new Error("DIFAT chain shorter than expected")}else if(D!==-1){var ue=z[D],be=(V>>>2)-1;if(!ue)return;for(var le=0;le<be&&(j=Eo(ue,le*4))!==Ve;++le)Z.push(j);G(Eo(ue,V-4),K-1,z,V,Z)}}function ie(D,K,z,V,Z){var j=[],ue=[];Z||(Z=[]);var be=V-1,le=0,fe=0;for(le=K;le>=0;){Z[le]=!0,j[j.length]=le,ue.push(D[le]);var ve=z[Math.floor(le*4/V)];if(fe=le*4&be,V<4+fe)throw new Error("FAT boundary crossed: "+le+" 4 "+V);if(!D[ve])break;le=Eo(D[ve],fe)}return{nodes:j,data:Q0([ue])}}function ae(D,K,z,V){var Z=D.length,j=[],ue=[],be=[],le=[],fe=V-1,ve=0,Ne=0,He=0,Ge=0;for(ve=0;ve<Z;++ve)if(be=[],He=ve+K,He>=Z&&(He-=Z),!ue[He]){le=[];var Pe=[];for(Ne=He;Ne>=0;){Pe[Ne]=!0,ue[Ne]=!0,be[be.length]=Ne,le.push(D[Ne]);var ze=z[Math.floor(Ne*4/V)];if(Ge=Ne*4&fe,V<4+Ge)throw new Error("FAT boundary crossed: "+Ne+" 4 "+V);if(!D[ze]||(Ne=Eo(D[ze],Ge),Pe[Ne]))break}j[He]={nodes:be,data:Q0([le])}}return j}function de(D,K,z,V,Z,j,ue,be){for(var le=0,fe=V.length?2:0,ve=K[D].data,Ne=0,He=0,Ge;Ne<ve.length;Ne+=128){var Pe=ve.slice(Ne,Ne+128);Nn(Pe,64),He=Pe._R(2),Ge=tu(Pe,0,He-fe),V.push(Ge);var ze={name:Ge,type:Pe._R(1),color:Pe._R(1),L:Pe._R(4,"i"),R:Pe._R(4,"i"),C:Pe._R(4,"i"),clsid:Pe._R(16),state:Pe._R(4,"i"),start:0,size:0},et=Pe._R(2)+Pe._R(2)+Pe._R(2)+Pe._R(2);et!==0&&(ze.ct=we(Pe,Pe.l-8));var Yt=Pe._R(2)+Pe._R(2)+Pe._R(2)+Pe._R(2);Yt!==0&&(ze.mt=we(Pe,Pe.l-8)),ze.start=Pe._R(4,"i"),ze.size=Pe._R(4,"i"),ze.size<0&&ze.start<0&&(ze.size=ze.type=0,ze.start=Ve,ze.name=""),ze.type===5?(le=ze.start,Z>0&&le!==Ve&&(K[le].name="!StreamData")):ze.size>=4096?(ze.storage="fat",K[ze.start]===void 0&&(K[ze.start]=ie(z,ze.start,K.fat_addrs,K.ssz)),K[ze.start].name=ze.name,ze.content=K[ze.start].data.slice(0,ze.size)):(ze.storage="minifat",ze.size<0?ze.size=0:le!==Ve&&ze.start!==Ve&&K[le]&&(ze.content=B(ze,K[le].data,(K[be]||{}).data))),ze.content&&Nn(ze.content,0),j[Ge]=ze,ue.push(ze)}}function we(D,K){return new Date((Cr(D,K+4)/1e7*Math.pow(2,32)+Cr(D,K)/1e7-11644473600)*1e3)}function xe(D,K){return N(),O(A.readFileSync(D),K)}function he(D,K){var z=K&&K.type;switch(z||_&&Buffer.isBuffer(D)&&(z="buffer"),z||"base64"){case"file":return xe(D,K);case"base64":return O(q(L(D)),K);case"binary":return O(q(D),K)}return O(D,K)}function ee(D,K){var z=K||{},V=z.root||"Root Entry";if(D.FullPaths||(D.FullPaths=[]),D.FileIndex||(D.FileIndex=[]),D.FullPaths.length!==D.FileIndex.length)throw new Error("inconsistent CFB structure");D.FullPaths.length===0&&(D.FullPaths[0]=V+"/",D.FileIndex[0]={name:V,type:5}),z.CLSID&&(D.FileIndex[0].clsid=z.CLSID),Ee(D)}function Ee(D){var K="Sh33tJ5";if(!kt.find(D,"/"+K)){var z=gi(4);z[0]=55,z[1]=z[3]=50,z[2]=54,D.FileIndex.push({name:K,type:2,content:z,size:4,L:69,R:69,C:69}),D.FullPaths.push(D.FullPaths[0]+K),Ce(D)}}function Ce(D,K){ee(D);for(var z=!1,V=!1,Z=D.FullPaths.length-1;Z>=0;--Z){var j=D.FileIndex[Z];switch(j.type){case 0:V?z=!0:(D.FileIndex.pop(),D.FullPaths.pop());break;case 1:case 2:case 5:V=!0,isNaN(j.R*j.L*j.C)&&(z=!0),j.R>-1&&j.L>-1&&j.R==j.L&&(z=!0);break;default:z=!0;break}}if(!(!z&&!K)){var ue=new Date(1987,1,19),be=0,le=Object.create?Object.create(null):{},fe=[];for(Z=0;Z<D.FullPaths.length;++Z)le[D.FullPaths[Z]]=!0,D.FileIndex[Z].type!==0&&fe.push([D.FullPaths[Z],D.FileIndex[Z]]);for(Z=0;Z<fe.length;++Z){var ve=y(fe[Z][0]);V=le[ve],V||(fe.push([ve,{name:g(ve).replace("/",""),type:1,clsid:gt,ct:ue,mt:ue,content:null}]),le[ve]=!0)}for(fe.sort(function(Ge,Pe){return f(Ge[0],Pe[0])}),D.FullPaths=[],D.FileIndex=[],Z=0;Z<fe.length;++Z)D.FullPaths[Z]=fe[Z][0],D.FileIndex[Z]=fe[Z][1];for(Z=0;Z<fe.length;++Z){var Ne=D.FileIndex[Z],He=D.FullPaths[Z];if(Ne.name=g(He).replace("/",""),Ne.L=Ne.R=Ne.C=-(Ne.color=1),Ne.size=Ne.content?Ne.content.length:0,Ne.start=0,Ne.clsid=Ne.clsid||gt,Z===0)Ne.C=fe.length>1?1:-1,Ne.size=0,Ne.type=5;else if(He.slice(-1)=="/"){for(be=Z+1;be<fe.length&&y(D.FullPaths[be])!=He;++be);for(Ne.C=be>=fe.length?-1:be,be=Z+1;be<fe.length&&y(D.FullPaths[be])!=y(He);++be);Ne.R=be>=fe.length?-1:be,Ne.type=1}else y(D.FullPaths[Z+1]||"")==y(He)&&(Ne.R=Z+1),Ne.type=2}}}function Oe(D,K){var z=K||{};if(z.fileType=="mad")return ZT(D,z);switch(Ce(D),z.fileType){case"zip":return UT(D,z)}var V=function(Ge){for(var Pe=0,ze=0,et=0;et<Ge.FileIndex.length;++et){var Yt=Ge.FileIndex[et];if(Yt.content){var $t=Yt.content.length;$t>0&&($t<4096?Pe+=$t+63>>6:ze+=$t+511>>9)}}for(var Fr=Ge.FullPaths.length+3>>2,Fs=Pe+7>>3,Hs=Pe+127>>7,zs=Fs+ze+Fr+Hs,Ua=zs+127>>7,ah=Ua<=109?0:Math.ceil((Ua-109)/127);zs+Ua+ah+127>>7>Ua;)ah=++Ua<=109?0:Math.ceil((Ua-109)/127);var Zi=[1,ah,Ua,Hs,Fr,ze,Pe,0];return Ge.FileIndex[0].size=Pe<<6,Zi[7]=(Ge.FileIndex[0].start=Zi[0]+Zi[1]+Zi[2]+Zi[3]+Zi[4]+Zi[5])+(Zi[6]+7>>3),Zi}(D),Z=gi(V[7]<<9),j=0,ue=0;{for(j=0;j<8;++j)Z._W(1,Ye[j]);for(j=0;j<8;++j)Z._W(2,0);for(Z._W(2,62),Z._W(2,3),Z._W(2,65534),Z._W(2,9),Z._W(2,6),j=0;j<3;++j)Z._W(2,0);for(Z._W(4,0),Z._W(4,V[2]),Z._W(4,V[0]+V[1]+V[2]+V[3]-1),Z._W(4,0),Z._W(4,4096),Z._W(4,V[3]?V[0]+V[1]+V[2]-1:Ve),Z._W(4,V[3]),Z._W(-4,V[1]?V[0]-1:Ve),Z._W(4,V[1]),j=0;j<109;++j)Z._W(-4,j<V[2]?V[1]+j:-1)}if(V[1])for(ue=0;ue<V[1];++ue){for(;j<236+ue*127;++j)Z._W(-4,j<V[2]?V[1]+j:-1);Z._W(-4,ue===V[1]-1?Ve:ue+1)}var be=function(Ge){for(ue+=Ge;j<ue-1;++j)Z._W(-4,j+1);Ge&&(++j,Z._W(-4,Ve))};for(ue=j=0,ue+=V[1];j<ue;++j)Z._W(-4,Gt.DIFSECT);for(ue+=V[2];j<ue;++j)Z._W(-4,Gt.FATSECT);be(V[3]),be(V[4]);for(var le=0,fe=0,ve=D.FileIndex[0];le<D.FileIndex.length;++le)ve=D.FileIndex[le],ve.content&&(fe=ve.content.length,!(fe<4096)&&(ve.start=ue,be(fe+511>>9)));for(be(V[6]+7>>3);Z.l&511;)Z._W(-4,Gt.ENDOFCHAIN);for(ue=j=0,le=0;le<D.FileIndex.length;++le)ve=D.FileIndex[le],ve.content&&(fe=ve.content.length,!(!fe||fe>=4096)&&(ve.start=ue,be(fe+63>>6)));for(;Z.l&511;)Z._W(-4,Gt.ENDOFCHAIN);for(j=0;j<V[4]<<2;++j){var Ne=D.FullPaths[j];if(!Ne||Ne.length===0){for(le=0;le<17;++le)Z._W(4,0);for(le=0;le<3;++le)Z._W(4,-1);for(le=0;le<12;++le)Z._W(4,0);continue}ve=D.FileIndex[j],j===0&&(ve.start=ve.size?ve.start-1:Ve);var He=j===0&&z.root||ve.name;if(fe=2*(He.length+1),Z._W(64,He,"utf16le"),Z._W(2,fe),Z._W(1,ve.type),Z._W(1,ve.color),Z._W(-4,ve.L),Z._W(-4,ve.R),Z._W(-4,ve.C),ve.clsid)Z._W(16,ve.clsid,"hex");else for(le=0;le<4;++le)Z._W(4,0);Z._W(4,ve.state||0),Z._W(4,0),Z._W(4,0),Z._W(4,0),Z._W(4,0),Z._W(4,ve.start),Z._W(4,ve.size),Z._W(4,0)}for(j=1;j<D.FileIndex.length;++j)if(ve=D.FileIndex[j],ve.size>=4096)if(Z.l=ve.start+1<<9,_&&Buffer.isBuffer(ve.content))ve.content.copy(Z,Z.l,0,ve.size),Z.l+=ve.size+511&-512;else{for(le=0;le<ve.size;++le)Z._W(1,ve.content[le]);for(;le&511;++le)Z._W(1,0)}for(j=1;j<D.FileIndex.length;++j)if(ve=D.FileIndex[j],ve.size>0&&ve.size<4096)if(_&&Buffer.isBuffer(ve.content))ve.content.copy(Z,Z.l,0,ve.size),Z.l+=ve.size+63&-64;else{for(le=0;le<ve.size;++le)Z._W(1,ve.content[le]);for(;le&63;++le)Z._W(1,0)}if(_)Z.l=Z.length;else for(;Z.l<Z.length;)Z._W(1,0);return Z}function Re(D,K){var z=D.FullPaths.map(function(le){return le.toUpperCase()}),V=z.map(function(le){var fe=le.split("/");return fe[fe.length-(le.slice(-1)=="/"?2:1)]}),Z=!1;K.charCodeAt(0)===47?(Z=!0,K=z[0].slice(0,-1)+K):Z=K.indexOf("/")!==-1;var j=K.toUpperCase(),ue=Z===!0?z.indexOf(j):V.indexOf(j);if(ue!==-1)return D.FileIndex[ue];var be=!j.match(Se);for(j=j.replace(oe,""),be&&(j=j.replace(Se,"!")),ue=0;ue<z.length;++ue)if((be?z[ue].replace(Se,"!"):z[ue]).replace(oe,"")==j||(be?V[ue].replace(Se,"!"):V[ue]).replace(oe,"")==j)return D.FileIndex[ue];return null}var Ae=64,Ve=-2,ft="d0cf11e0a1b11ae1",Ye=[208,207,17,224,161,177,26,225],gt="00000000000000000000000000000000",Gt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Ve,FREESECT:-1,HEADER_SIGNATURE:ft,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:gt,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Yi(D,K,z){N();var V=Oe(D,z);A.writeFileSync(K,V)}function Et(D){for(var K=new Array(D.length),z=0;z<D.length;++z)K[z]=String.fromCharCode(D[z]);return K.join("")}function yt(D,K){var z=Oe(D,K);switch(K&&K.type||"buffer"){case"file":return N(),A.writeFileSync(K.filename,z),z;case"binary":return typeof z=="string"?z:Et(z);case"base64":return k(typeof z=="string"?z:Et(z));case"buffer":if(_)return Buffer.isBuffer(z)?z:I(z);case"array":return typeof z=="string"?q(z):z}return z}var Pt;function yn(D){try{var K=D.InflateRaw,z=new K;if(z._processChunk(new Uint8Array([3,0]),z._finishFlushFlag),z.bytesRead)Pt=D;else throw new Error("zlib does not expose bytesRead")}catch(V){console.error("cannot use native zlib: "+(V.message||V))}}function In(D,K){if(!Pt)return xg(D,K);var z=Pt.InflateRaw,V=new z,Z=V._processChunk(D.slice(D.l),V._finishFlushFlag);return D.l+=V.bytesRead,Z}function Pn(D){return Pt?Pt.deflateRawSync(D):pg(D)}var Ci=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],qn=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Jt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function $i(D){var K=(D<<1|D<<11)&139536|(D<<5|D<<15)&558144;return(K>>16|K>>8|K)&255}for(var bt=typeof Uint8Array<"u",Mr=bt?new Uint8Array(256):[],qi=0;qi<256;++qi)Mr[qi]=$i(qi);function Ki(D,K){var z=Mr[D&255];return K<=8?z>>>8-K:(z=z<<8|Mr[D>>8&255],K<=16?z>>>16-K:(z=z<<8|Mr[D>>16&255],z>>>24-K))}function cg(D,K){var z=K&7,V=K>>>3;return(D[V]|(z<=6?0:D[V+1]<<8))>>>z&3}function eh(D,K){var z=K&7,V=K>>>3;return(D[V]|(z<=5?0:D[V+1]<<8))>>>z&7}function BT(D,K){var z=K&7,V=K>>>3;return(D[V]|(z<=4?0:D[V+1]<<8))>>>z&15}function fg(D,K){var z=K&7,V=K>>>3;return(D[V]|(z<=3?0:D[V+1]<<8))>>>z&31}function hg(D,K){var z=K&7,V=K>>>3;return(D[V]|(z<=1?0:D[V+1]<<8))>>>z&127}function fu(D,K,z){var V=K&7,Z=K>>>3,j=(1<<z)-1,ue=D[Z]>>>V;return z<8-V||(ue|=D[Z+1]<<8-V,z<16-V)||(ue|=D[Z+2]<<16-V,z<24-V)||(ue|=D[Z+3]<<24-V),ue&j}function dg(D,K,z){var V=K&7,Z=K>>>3;return V<=5?D[Z]|=(z&7)<<V:(D[Z]|=z<<V&255,D[Z+1]=(z&7)>>8-V),K+3}function FT(D,K,z){var V=K&7,Z=K>>>3;return z=(z&1)<<V,D[Z]|=z,K+1}function Ao(D,K,z){var V=K&7,Z=K>>>3;return z<<=V,D[Z]|=z&255,z>>>=8,D[Z+1]=z,K+8}function vg(D,K,z){var V=K&7,Z=K>>>3;return z<<=V,D[Z]|=z&255,z>>>=8,D[Z+1]=z&255,D[Z+2]=z>>>8,K+16}function th(D,K){var z=D.length,V=2*z>K?2*z:K+5,Z=0;if(z>=K)return D;if(_){var j=U(V);if(D.copy)D.copy(j);else for(;Z<D.length;++Z)j[Z]=D[Z];return j}else if(bt){var ue=new Uint8Array(V);if(ue.set)ue.set(D);else for(;Z<z;++Z)ue[Z]=D[Z];return ue}return D.length=V,D}function wi(D){for(var K=new Array(D),z=0;z<D;++z)K[z]=0;return K}function hu(D,K,z){var V=1,Z=0,j=0,ue=0,be=0,le=D.length,fe=bt?new Uint16Array(32):wi(32);for(j=0;j<32;++j)fe[j]=0;for(j=le;j<z;++j)D[j]=0;le=D.length;var ve=bt?new Uint16Array(le):wi(le);for(j=0;j<le;++j)fe[Z=D[j]]++,V<Z&&(V=Z),ve[j]=0;for(fe[0]=0,j=1;j<=V;++j)fe[j+16]=be=be+fe[j-1]<<1;for(j=0;j<le;++j)be=D[j],be!=0&&(ve[j]=fe[be+16]++);var Ne=0;for(j=0;j<le;++j)if(Ne=D[j],Ne!=0)for(be=Ki(ve[j],V)>>V-Ne,ue=(1<<V+4-Ne)-1;ue>=0;--ue)K[be|ue<<Ne]=Ne&15|j<<4;return V}var rh=bt?new Uint16Array(512):wi(512),nh=bt?new Uint16Array(32):wi(32);if(!bt){for(var Ga=0;Ga<512;++Ga)rh[Ga]=0;for(Ga=0;Ga<32;++Ga)nh[Ga]=0}(function(){for(var D=[],K=0;K<32;K++)D.push(5);hu(D,nh,32);var z=[];for(K=0;K<=143;K++)z.push(8);for(;K<=255;K++)z.push(9);for(;K<=279;K++)z.push(7);for(;K<=287;K++)z.push(8);hu(z,rh,288)})();var HT=function(){for(var K=bt?new Uint8Array(32768):[],z=0,V=0;z<Jt.length-1;++z)for(;V<Jt[z+1];++V)K[V]=z;for(;V<32768;++V)K[V]=29;var Z=bt?new Uint8Array(259):[];for(z=0,V=0;z<qn.length-1;++z)for(;V<qn[z+1];++V)Z[V]=z;function j(be,le){for(var fe=0;fe<be.length;){var ve=Math.min(65535,be.length-fe),Ne=fe+ve==be.length;for(le._W(1,+Ne),le._W(2,ve),le._W(2,~ve&65535);ve-- >0;)le[le.l++]=be[fe++]}return le.l}function ue(be,le){for(var fe=0,ve=0,Ne=bt?new Uint16Array(32768):[];ve<be.length;){var He=Math.min(65535,be.length-ve);if(He<10){for(fe=dg(le,fe,+(ve+He==be.length)),fe&7&&(fe+=8-(fe&7)),le.l=fe/8|0,le._W(2,He),le._W(2,~He&65535);He-- >0;)le[le.l++]=be[ve++];fe=le.l*8;continue}fe=dg(le,fe,+(ve+He==be.length)+2);for(var Ge=0;He-- >0;){var Pe=be[ve];Ge=(Ge<<5^Pe)&32767;var ze=-1,et=0;if((ze=Ne[Ge])&&(ze|=ve&-32768,ze>ve&&(ze-=32768),ze<ve))for(;be[ze+et]==be[ve+et]&&et<250;)++et;if(et>2){Pe=Z[et],Pe<=22?fe=Ao(le,fe,Mr[Pe+1]>>1)-1:(Ao(le,fe,3),fe+=5,Ao(le,fe,Mr[Pe-23]>>5),fe+=3);var Yt=Pe<8?0:Pe-4>>2;Yt>0&&(vg(le,fe,et-qn[Pe]),fe+=Yt),Pe=K[ve-ze],fe=Ao(le,fe,Mr[Pe]>>3),fe-=3;var $t=Pe<4?0:Pe-2>>1;$t>0&&(vg(le,fe,ve-ze-Jt[Pe]),fe+=$t);for(var Fr=0;Fr<et;++Fr)Ne[Ge]=ve&32767,Ge=(Ge<<5^be[ve])&32767,++ve;He-=et-1}else Pe<=143?Pe=Pe+48:fe=FT(le,fe,1),fe=Ao(le,fe,Mr[Pe]),Ne[Ge]=ve&32767,++ve}fe=Ao(le,fe,0)-1}return le.l=(fe+7)/8|0,le.l}return function(le,fe){return le.length<8?j(le,fe):ue(le,fe)}}();function pg(D){var K=gi(50+Math.floor(D.length*1.1)),z=HT(D,K);return K.slice(0,z)}var gg=bt?new Uint16Array(32768):wi(32768),mg=bt?new Uint16Array(32768):wi(32768),yg=bt?new Uint16Array(128):wi(128),Cg=1,wg=1;function zT(D,K){var z=fg(D,K)+257;K+=5;var V=fg(D,K)+1;K+=5;var Z=BT(D,K)+4;K+=4;for(var j=0,ue=bt?new Uint8Array(19):wi(19),be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],le=1,fe=bt?new Uint8Array(8):wi(8),ve=bt?new Uint8Array(8):wi(8),Ne=ue.length,He=0;He<Z;++He)ue[Ci[He]]=j=eh(D,K),le<j&&(le=j),fe[j]++,K+=3;var Ge=0;for(fe[0]=0,He=1;He<=le;++He)ve[He]=Ge=Ge+fe[He-1]<<1;for(He=0;He<Ne;++He)(Ge=ue[He])!=0&&(be[He]=ve[Ge]++);var Pe=0;for(He=0;He<Ne;++He)if(Pe=ue[He],Pe!=0){Ge=Mr[be[He]]>>8-Pe;for(var ze=(1<<7-Pe)-1;ze>=0;--ze)yg[Ge|ze<<Pe]=Pe&7|He<<3}var et=[];for(le=1;et.length<z+V;)switch(Ge=yg[hg(D,K)],K+=Ge&7,Ge>>>=3){case 16:for(j=3+cg(D,K),K+=2,Ge=et[et.length-1];j-- >0;)et.push(Ge);break;case 17:for(j=3+eh(D,K),K+=3;j-- >0;)et.push(0);break;case 18:for(j=11+hg(D,K),K+=7;j-- >0;)et.push(0);break;default:et.push(Ge),le<Ge&&(le=Ge);break}var Yt=et.slice(0,z),$t=et.slice(z);for(He=z;He<286;++He)Yt[He]=0;for(He=V;He<30;++He)$t[He]=0;return Cg=hu(Yt,gg,286),wg=hu($t,mg,30),K}function WT(D,K){if(D[0]==3&&!(D[1]&3))return[P(K),2];for(var z=0,V=0,Z=U(K||1<<18),j=0,ue=Z.length>>>0,be=0,le=0;!(V&1);){if(V=eh(D,z),z+=3,V>>>1)V>>1==1?(be=9,le=5):(z=zT(D,z),be=Cg,le=wg);else{z&7&&(z+=8-(z&7));var fe=D[z>>>3]|D[(z>>>3)+1]<<8;if(z+=32,fe>0)for(!K&&ue<j+fe&&(Z=th(Z,j+fe),ue=Z.length);fe-- >0;)Z[j++]=D[z>>>3],z+=8;continue}for(;;){!K&&ue<j+32767&&(Z=th(Z,j+32767),ue=Z.length);var ve=fu(D,z,be),Ne=V>>>1==1?rh[ve]:gg[ve];if(z+=Ne&15,Ne>>>=4,!(Ne>>>8&255))Z[j++]=Ne;else{if(Ne==256)break;Ne-=257;var He=Ne<8?0:Ne-4>>2;He>5&&(He=0);var Ge=j+qn[Ne];He>0&&(Ge+=fu(D,z,He),z+=He),ve=fu(D,z,le),Ne=V>>>1==1?nh[ve]:mg[ve],z+=Ne&15,Ne>>>=4;var Pe=Ne<4?0:Ne-2>>1,ze=Jt[Ne];for(Pe>0&&(ze+=fu(D,z,Pe),z+=Pe),!K&&ue<Ge&&(Z=th(Z,Ge+100),ue=Z.length);j<Ge;)Z[j]=Z[j-ze],++j}}}return K?[Z,z+7>>>3]:[Z.slice(0,j),z+7>>>3]}function xg(D,K){var z=D.slice(D.l||0),V=WT(z,K);return D.l+=V[1],V[0]}function bg(D,K){if(D)typeof console<"u"&&console.error(K);else throw new Error(K)}function Sg(D,K){var z=D;Nn(z,0);var V=[],Z=[],j={FileIndex:V,FullPaths:Z};ee(j,{root:K.root});for(var ue=z.length-4;(z[ue]!=80||z[ue+1]!=75||z[ue+2]!=5||z[ue+3]!=6)&&ue>=0;)--ue;z.l=ue+4,z.l+=4;var be=z._R(2);z.l+=6;var le=z._R(4);for(z.l=le,ue=0;ue<be;++ue){z.l+=20;var fe=z._R(4),ve=z._R(4),Ne=z._R(2),He=z._R(2),Ge=z._R(2);z.l+=8;var Pe=z._R(4),ze=T(z.slice(z.l+Ne,z.l+Ne+He));z.l+=Ne+He+Ge;var et=z.l;z.l=Pe+4,GT(z,fe,ve,j,ze),z.l=et}return j}function GT(D,K,z,V,Z){D.l+=2;var j=D._R(2),ue=D._R(2),be=S(D);if(j&8257)throw new Error("Unsupported ZIP encryption");for(var le=D._R(4),fe=D._R(4),ve=D._R(4),Ne=D._R(2),He=D._R(2),Ge="",Pe=0;Pe<Ne;++Pe)Ge+=String.fromCharCode(D[D.l++]);if(He){var ze=T(D.slice(D.l,D.l+He));(ze[21589]||{}).mt&&(be=ze[21589].mt),((Z||{})[21589]||{}).mt&&(be=Z[21589].mt)}D.l+=He;var et=D.slice(D.l,D.l+fe);switch(ue){case 8:et=In(D,ve);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ue)}var Yt=!1;j&8&&(le=D._R(4),le==134695760&&(le=D._R(4),Yt=!0),fe=D._R(4),ve=D._R(4)),fe!=K&&bg(Yt,"Bad compressed size: "+K+" != "+fe),ve!=z&&bg(Yt,"Bad uncompressed size: "+z+" != "+ve),ih(V,Ge,et,{unsafe:!0,mt:be})}function UT(D,K){var z=K||{},V=[],Z=[],j=gi(1),ue=z.compression?8:0,be=0,le=0,fe=0,ve=0,Ne=0,He=D.FullPaths[0],Ge=He,Pe=D.FileIndex[0],ze=[],et=0;for(le=1;le<D.FullPaths.length;++le)if(Ge=D.FullPaths[le].slice(He.length),Pe=D.FileIndex[le],!(!Pe.size||!Pe.content||Ge=="Sh33tJ5")){var Yt=ve,$t=gi(Ge.length);for(fe=0;fe<Ge.length;++fe)$t._W(1,Ge.charCodeAt(fe)&127);$t=$t.slice(0,$t.l),ze[Ne]=zb.buf(Pe.content,0);var Fr=Pe.content;ue==8&&(Fr=Pn(Fr)),j=gi(30),j._W(4,67324752),j._W(2,20),j._W(2,be),j._W(2,ue),Pe.mt?x(j,Pe.mt):j._W(4,0),j._W(-4,ze[Ne]),j._W(4,Fr.length),j._W(4,Pe.content.length),j._W(2,$t.length),j._W(2,0),ve+=j.length,V.push(j),ve+=$t.length,V.push($t),ve+=Fr.length,V.push(Fr),j=gi(46),j._W(4,33639248),j._W(2,0),j._W(2,20),j._W(2,be),j._W(2,ue),j._W(4,0),j._W(-4,ze[Ne]),j._W(4,Fr.length),j._W(4,Pe.content.length),j._W(2,$t.length),j._W(2,0),j._W(2,0),j._W(2,0),j._W(2,0),j._W(4,0),j._W(4,Yt),et+=j.l,Z.push(j),et+=$t.length,Z.push($t),++Ne}return j=gi(22),j._W(4,101010256),j._W(2,0),j._W(2,0),j._W(2,Ne),j._W(2,Ne),j._W(4,et),j._W(4,ve),j._W(2,0),ce([ce(V),ce(Z),j])}var du={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function VT(D,K){if(D.ctype)return D.ctype;var z=D.name||"",V=z.match(/\.([^\.]+)$/);return V&&du[V[1]]||K&&(V=(z=K).match(/[\.\\]([^\.\\])+$/),V&&du[V[1]])?du[V[1]]:"application/octet-stream"}function XT(D){for(var K=k(D),z=[],V=0;V<K.length;V+=76)z.push(K.slice(V,V+76));return z.join(`\r
`)+`\r
`}function YT(D){var K=D.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(fe){var ve=fe.charCodeAt(0).toString(16).toUpperCase();return"="+(ve.length==1?"0"+ve:ve)});K=K.replace(/ $/gm,"=20").replace(/\t$/gm,"=09"),K.charAt(0)==`
`&&(K="=0D"+K.slice(1)),K=K.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,`
=0A`).replace(/([^\r\n])\n/gm,"$1=0A");for(var z=[],V=K.split(`\r
`),Z=0;Z<V.length;++Z){var j=V[Z];if(j.length==0){z.push("");continue}for(var ue=0;ue<j.length;){var be=76,le=j.slice(ue,ue+be);le.charAt(be-1)=="="?be--:le.charAt(be-2)=="="?be-=2:le.charAt(be-3)=="="&&(be-=3),le=j.slice(ue,ue+be),ue+=be,ue<j.length&&(le+="="),z.push(le)}}return z.join(`\r
`)}function $T(D){for(var K=[],z=0;z<D.length;++z){for(var V=D[z];z<=D.length&&V.charAt(V.length-1)=="=";)V=V.slice(0,V.length-1)+D[++z];K.push(V)}for(var Z=0;Z<K.length;++Z)K[Z]=K[Z].replace(/[=][0-9A-Fa-f]{2}/g,function(j){return String.fromCharCode(parseInt(j.slice(1),16))});return q(K.join(`\r
`))}function qT(D,K,z){for(var V="",Z="",j="",ue,be=0;be<10;++be){var le=K[be];if(!le||le.match(/^\s*$/))break;var fe=le.match(/^(.*?):\s*([^\s].*)$/);if(fe)switch(fe[1].toLowerCase()){case"content-location":V=fe[2].trim();break;case"content-type":j=fe[2].trim();break;case"content-transfer-encoding":Z=fe[2].trim();break}}switch(++be,Z.toLowerCase()){case"base64":ue=q(L(K.slice(be).join("")));break;case"quoted-printable":ue=$T(K.slice(be));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Z)}var ve=ih(D,V.slice(z.length),ue,{unsafe:!0});j&&(ve.ctype=j)}function KT(D,K){if(Et(D.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var z=K&&K.root||"",V=(_&&Buffer.isBuffer(D)?D.toString("binary"):Et(D)).split(`\r
`),Z=0,j="";for(Z=0;Z<V.length;++Z)if(j=V[Z],!!/^Content-Location:/i.test(j)&&(j=j.slice(j.indexOf("file")),z||(z=j.slice(0,j.lastIndexOf("/")+1)),j.slice(0,z.length)!=z))for(;z.length>0&&(z=z.slice(0,z.length-1),z=z.slice(0,z.lastIndexOf("/")+1),j.slice(0,z.length)!=z););var ue=(V[1]||"").match(/boundary="(.*?)"/);if(!ue)throw new Error("MAD cannot find boundary");var be="--"+(ue[1]||""),le=[],fe=[],ve={FileIndex:le,FullPaths:fe};ee(ve);var Ne,He=0;for(Z=0;Z<V.length;++Z){var Ge=V[Z];Ge!==be&&Ge!==be+"--"||(He++&&qT(ve,V.slice(Ne,Z),z),Ne=Z)}return ve}function ZT(D,K){var z=K||{},V=z.boundary||"SheetJS";V="------="+V;for(var Z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+V.slice(2)+'"',"","",""],j=D.FullPaths[0],ue=j,be=D.FileIndex[0],le=1;le<D.FullPaths.length;++le)if(ue=D.FullPaths[le].slice(j.length),be=D.FileIndex[le],!(!be.size||!be.content||ue=="Sh33tJ5")){ue=ue.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(et){return"_x"+et.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(et){return"_u"+et.charCodeAt(0).toString(16)+"_"});for(var fe=be.content,ve=_&&Buffer.isBuffer(fe)?fe.toString("binary"):Et(fe),Ne=0,He=Math.min(1024,ve.length),Ge=0,Pe=0;Pe<=He;++Pe)(Ge=ve.charCodeAt(Pe))>=32&&Ge<128&&++Ne;var ze=Ne>=He*4/5;Z.push(V),Z.push("Content-Location: "+(z.root||"file:///C:/SheetJS/")+ue),Z.push("Content-Transfer-Encoding: "+(ze?"quoted-printable":"base64")),Z.push("Content-Type: "+VT(be,ue)),Z.push(""),Z.push(ze?YT(ve):XT(ve))}return Z.push(V+`--\r
`),Z.join(`\r
`)}function jT(D){var K={};return ee(K,D),K}function ih(D,K,z,V){var Z=V&&V.unsafe;Z||ee(D);var j=!Z&&kt.find(D,K);if(!j){var ue=D.FullPaths[0];K.slice(0,ue.length)==ue?ue=K:(ue.slice(-1)!="/"&&(ue+="/"),ue=(ue+K).replace("//","/")),j={name:g(K),type:2},D.FileIndex.push(j),D.FullPaths.push(ue),Z||kt.utils.cfb_gc(D)}return j.content=z,j.size=z?z.length:0,V&&(V.CLSID&&(j.clsid=V.CLSID),V.mt&&(j.mt=V.mt),V.ct&&(j.ct=V.ct)),j}function JT(D,K){ee(D);var z=kt.find(D,K);if(z){for(var V=0;V<D.FileIndex.length;++V)if(D.FileIndex[V]==z)return D.FileIndex.splice(V,1),D.FullPaths.splice(V,1),!0}return!1}function QT(D,K,z){ee(D);var V=kt.find(D,K);if(V){for(var Z=0;Z<D.FileIndex.length;++Z)if(D.FileIndex[Z]==V)return D.FileIndex[Z].name=g(z),D.FullPaths[Z]=z,!0}return!1}function e_(D){Ce(D,!0)}return d.find=Re,d.read=he,d.parse=O,d.write=yt,d.writeFile=Yi,d.utils={cfb_new:jT,cfb_add:ih,cfb_del:JT,cfb_mov:QT,cfb_gc:e_,ReadShift:As,CheckField:cp,prep_blob:Nn,bconcat:ce,use_zlib:yn,_deflateRaw:pg,_inflateRaw:xg,consts:Gt},d}(),pa;if(typeof Eg<"u")try{pa=void 0}catch{}function Wb(c){return typeof c=="string"?Q(c):Array.isArray(c)?re(c):c}function Ts(c,d,f){if(typeof pa<"u"&&pa.writeFileSync)return f?pa.writeFileSync(c,d,f):pa.writeFileSync(c,d);if(typeof Deno<"u"){if(f&&typeof d=="string")switch(f){case"utf8":d=new TextEncoder(f).encode(d);break;case"binary":d=Q(d);break;default:throw new Error("Unsupported encoding "+f)}return Deno.writeFileSync(c,d)}var y=f=="utf8"?Ui(d):d;if(typeof IE_SaveFile<"u")return IE_SaveFile(y,c);if(typeof Blob<"u"){var g=new Blob([Wb(y)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(g,c);if(typeof saveAs<"u")return saveAs(g,c);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var x=URL.createObjectURL(g);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(x)},6e4),chrome.downloads.download({url:x,filename:c,saveAs:!0});var S=document.createElement("a");if(S.download!=null)return S.download=c,S.href=x,document.body.appendChild(S),S.click(),document.body.removeChild(S),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(x)},6e4),x}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var T=File(c);return T.open("w"),T.encoding="binary",Array.isArray(d)&&(d=J(d)),T.write(d),T.close(),d}catch(A){if(!A.message||!A.message.match(/onstruct/))throw A}throw new Error("cannot save file "+c)}function Gb(c){if(typeof pa<"u")return pa.readFileSync(c);if(typeof Deno<"u")return Deno.readFileSync(c);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var d=File(c);d.open("r"),d.encoding="binary";var f=d.read();return d.close(),f}catch(y){if(!y.message||!y.message.match(/onstruct/))throw y}throw new Error("Cannot access file "+c)}function $r(c){for(var d=Object.keys(c),f=[],y=0;y<d.length;++y)Object.prototype.hasOwnProperty.call(c,d[y])&&f.push(d[y]);return f}function I0(c){for(var d=[],f=$r(c),y=0;y!==f.length;++y)d[c[f[y]]]=f[y];return d}function P0(c){for(var d=[],f=$r(c),y=0;y!==f.length;++y)d[c[f[y]]]=parseInt(f[y],10);return d}function Ub(c){for(var d=[],f=$r(c),y=0;y!==f.length;++y)d[c[f[y]]]==null&&(d[c[f[y]]]=[]),d[c[f[y]]].push(f[y]);return d}var Jl=new Date(1899,11,30,0,0,0);function qr(c,d){var f=c.getTime(),y=Jl.getTime()+(c.getTimezoneOffset()-Jl.getTimezoneOffset())*6e4;return(f-y)/(24*60*60*1e3)}var D0=new Date,Vb=Jl.getTime()+(D0.getTimezoneOffset()-Jl.getTimezoneOffset())*6e4,B0=D0.getTimezoneOffset();function pf(c){var d=new Date;return d.setTime(c*24*60*60*1e3+Vb),d.getTimezoneOffset()!==B0&&d.setTime(d.getTime()+(d.getTimezoneOffset()-B0)*6e4),d}function Xb(c){var d=0,f=0,y=!1,g=c.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!g)throw new Error("|"+c+"| is not an ISO8601 Duration");for(var x=1;x!=g.length;++x)if(g[x]){switch(f=1,x>3&&(y=!0),g[x].slice(g[x].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+g[x].slice(g[x].length-1));case"D":f*=24;case"H":f*=60;case"M":if(y)f*=60;else throw new Error("Unsupported ISO Duration Field: M")}d+=f*parseInt(g[x],10)}return d}var F0=new Date("2017-02-19T19:06:09.000Z"),H0=isNaN(F0.getFullYear())?new Date("2/19/17"):F0,Yb=H0.getFullYear()==2017;function yr(c,d){var f=new Date(c);if(Yb)return d>0?f.setTime(f.getTime()+f.getTimezoneOffset()*60*1e3):d<0&&f.setTime(f.getTime()-f.getTimezoneOffset()*60*1e3),f;if(c instanceof Date)return c;if(H0.getFullYear()==1917&&!isNaN(f.getFullYear())){var y=f.getFullYear();return c.indexOf(""+y)>-1||f.setFullYear(f.getFullYear()+100),f}var g=c.match(/\d+/g)||["2017","2","19","0","0","0"],x=new Date(+g[0],+g[1]-1,+g[2],+g[3]||0,+g[4]||0,+g[5]||0);return c.indexOf("Z")>-1&&(x=new Date(x.getTime()-x.getTimezoneOffset()*60*1e3)),x}function xo(c,d){if(_&&Buffer.isBuffer(c)){if(d){if(c[0]==255&&c[1]==254)return Ui(c.slice(2).toString("utf16le"));if(c[1]==254&&c[2]==255)return Ui(w(c.slice(2).toString("binary")))}return c.toString("binary")}if(typeof TextDecoder<"u")try{if(d){if(c[0]==255&&c[1]==254)return Ui(new TextDecoder("utf-16le").decode(c.slice(2)));if(c[0]==254&&c[1]==255)return Ui(new TextDecoder("utf-16be").decode(c.slice(2)))}var f={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(c)&&(c=new Uint8Array(c)),new TextDecoder("latin1").decode(c).replace(/[]/g,function(x){return f[x]||x})}catch{}for(var y=[],g=0;g!=c.length;++g)y.push(String.fromCharCode(c[g]));return y.join("")}function Dr(c){if(typeof JSON<"u"&&!Array.isArray(c))return JSON.parse(JSON.stringify(c));if(typeof c!="object"||c==null)return c;if(c instanceof Date)return new Date(c.getTime());var d={};for(var f in c)Object.prototype.hasOwnProperty.call(c,f)&&(d[f]=Dr(c[f]));return d}function on(c,d){for(var f="";f.length<d;)f+=c;return f}function Wi(c){var d=Number(c);if(!isNaN(d))return isFinite(d)?d:NaN;if(!/\d/.test(c))return d;var f=1,y=c.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return f*=100,""});return!isNaN(d=Number(y))||(y=y.replace(/[(](.*)[)]/,function(g,x){return f=-f,x}),!isNaN(d=Number(y)))?d/f:d}var $b=["january","february","march","april","may","june","july","august","september","october","november","december"];function _s(c){var d=new Date(c),f=new Date(NaN),y=d.getYear(),g=d.getMonth(),x=d.getDate();if(isNaN(x))return f;var S=c.toLowerCase();if(S.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(S=S.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),S.length>3&&$b.indexOf(S)==-1)return f}else if(S.match(/[a-z]/))return f;return y<0||y>8099?f:(g>0||x>1)&&y!=101?d:c.match(/[^-0-9:,\/\\]/)?f:d}(function(){var c="abacaba".split(/(:?b)/i).length==5;return function(f,y,g){if(c||typeof y=="string")return f.split(y);for(var x=f.split(y),S=[x[0]],T=1;T<x.length;++T)S.push(g),S.push(x[T]);return S}})();function z0(c){return c?c.content&&c.type?xo(c.content,!0):c.data?b(c.data):c.asNodeBuffer&&_?b(c.asNodeBuffer().toString("binary")):c.asBinary?b(c.asBinary()):c._data&&c._data.getContent?b(xo(Array.prototype.slice.call(c._data.getContent(),0))):null:null}function W0(c){if(!c)return null;if(c.data)return m(c.data);if(c.asNodeBuffer&&_)return c.asNodeBuffer();if(c._data&&c._data.getContent){var d=c._data.getContent();return typeof d=="string"?m(d):Array.prototype.slice.call(d)}return c.content&&c.type?c.content:null}function qb(c){return c&&c.name.slice(-4)===".bin"?W0(c):z0(c)}function On(c,d){for(var f=c.FullPaths||$r(c.files),y=d.toLowerCase().replace(/[\/]/g,"\\"),g=y.replace(/\\/g,"/"),x=0;x<f.length;++x){var S=f[x].replace(/^Root Entry[\/]/,"").toLowerCase();if(y==S||g==S)return c.files?c.files[f[x]]:c.FileIndex[x]}return null}function gf(c,d){var f=On(c,d);if(f==null)throw new Error("Cannot find file "+d+" in zip");return f}function ar(c,d,f){if(!f)return qb(gf(c,d));if(!d)return null;try{return ar(c,d)}catch{return null}}function An(c,d,f){if(!f)return z0(gf(c,d));if(!d)return null;try{return An(c,d)}catch{return null}}function Kb(c,d,f){return W0(gf(c,d))}function G0(c){for(var d=c.FullPaths||$r(c.files),f=[],y=0;y<d.length;++y)d[y].slice(-1)!="/"&&f.push(d[y].replace(/^Root Entry[\/]/,""));return f.sort()}function nt(c,d,f){if(c.FullPaths){if(typeof f=="string"){var y;return _?y=I(f):y=me(f),kt.utils.cfb_add(c,d,y)}kt.utils.cfb_add(c,d,f)}else c.file(d,f)}function mf(){return kt.utils.cfb_new()}function Zb(c,d){switch(d.type){case"base64":return kt.read(c,{type:"base64"});case"binary":return kt.read(c,{type:"binary"});case"buffer":case"array":return kt.read(c,{type:"buffer"})}throw new Error("Unrecognized type "+d.type)}function Rs(c,d){if(c.charAt(0)=="/")return c.slice(1);var f=d.split("/");d.slice(-1)!="/"&&f.pop();for(var y=c.split("/");y.length!==0;){var g=y.shift();g===".."?f.pop():g!=="."&&f.push(g)}return f.join("/")}var or=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,jb=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,U0=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,Jb=/<[^>]*>/g,sn=or.match(U0)?U0:Jb,Qb=/<\w*:/,e2=/<(\/?)\w+:/;function ot(c,d,f){for(var y={},g=0,x=0;g!==c.length&&!((x=c.charCodeAt(g))===32||x===10||x===13);++g);if(d||(y[0]=c.slice(0,g)),g===c.length)return y;var S=c.match(jb),T=0,A="",N=0,O="",F="",W=1;if(S)for(N=0;N!=S.length;++N){for(F=S[N],x=0;x!=F.length&&F.charCodeAt(x)!==61;++x);for(O=F.slice(0,x).trim();F.charCodeAt(x+1)==32;)++x;for(W=(g=F.charCodeAt(x+1))==34||g==39?1:0,A=F.slice(x+1+W,F.length-W),T=0;T!=O.length&&O.charCodeAt(T)!==58;++T);if(T===O.length)O.indexOf("_")>0&&(O=O.slice(0,O.indexOf("_"))),y[O]=A,y[O.toLowerCase()]=A;else{var H=(T===5&&O.slice(0,5)==="xmlns"?"xmlns":"")+O.slice(T+1);if(y[H]&&O.slice(T-3,T)=="ext")continue;y[H]=A,y[H.toLowerCase()]=A}}return y}function Gi(c){return c.replace(e2,"<$1")}var V0={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},X0=I0(V0),Wt=function(){var c=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,d=/_x([\da-fA-F]{4})_/gi;return function f(y){var g=y+"",x=g.indexOf("<![CDATA[");if(x==-1)return g.replace(c,function(T,A){return V0[T]||String.fromCharCode(parseInt(A,T.indexOf("x")>-1?16:10))||T}).replace(d,function(T,A){return String.fromCharCode(parseInt(A,16))});var S=g.indexOf("]]>");return f(g.slice(0,x))+g.slice(x+9,S)+f(g.slice(S+3))}}(),Y0=/[&<>'"]/g,t2=/[\u0000-\u0008\u000b-\u001f]/g;function Xt(c){var d=c+"";return d.replace(Y0,function(f){return X0[f]}).replace(t2,function(f){return"_x"+("000"+f.charCodeAt(0).toString(16)).slice(-4)+"_"})}var r2=/[\u0000-\u001f]/g;function yf(c){var d=c+"";return d.replace(Y0,function(f){return X0[f]}).replace(/\n/g,"<br/>").replace(r2,function(f){return"&#x"+("000"+f.charCodeAt(0).toString(16)).slice(-4)+";"})}function jt(c){switch(c){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Cf(c){for(var d="",f=0,y=0,g=0,x=0,S=0,T=0;f<c.length;){if(y=c.charCodeAt(f++),y<128){d+=String.fromCharCode(y);continue}if(g=c.charCodeAt(f++),y>191&&y<224){S=(y&31)<<6,S|=g&63,d+=String.fromCharCode(S);continue}if(x=c.charCodeAt(f++),y<240){d+=String.fromCharCode((y&15)<<12|(g&63)<<6|x&63);continue}S=c.charCodeAt(f++),T=((y&7)<<18|(g&63)<<12|(x&63)<<6|S&63)-65536,d+=String.fromCharCode(55296+(T>>>10&1023)),d+=String.fromCharCode(56320+(T&1023))}return d}function $0(c){var d=P(2*c.length),f,y,g=1,x=0,S=0,T;for(y=0;y<c.length;y+=g)g=1,(T=c.charCodeAt(y))<128?f=T:T<224?(f=(T&31)*64+(c.charCodeAt(y+1)&63),g=2):T<240?(f=(T&15)*4096+(c.charCodeAt(y+1)&63)*64+(c.charCodeAt(y+2)&63),g=3):(g=4,f=(T&7)*262144+(c.charCodeAt(y+1)&63)*4096+(c.charCodeAt(y+2)&63)*64+(c.charCodeAt(y+3)&63),f-=65536,S=55296+(f>>>10&1023),f=56320+(f&1023)),S!==0&&(d[x++]=S&255,d[x++]=S>>>8,S=0),d[x++]=f%256,d[x++]=f>>>8;return d.slice(0,x).toString("ucs2")}function q0(c){return I(c,"binary").toString("utf8")}var Ql="foo bar baz",It=_&&(q0(Ql)==Cf(Ql)&&q0||$0(Ql)==Cf(Ql)&&$0)||Cf,Ui=_?function(c){return I(c,"utf8").toString("binary")}:function(c){for(var d=[],f=0,y=0,g=0;f<c.length;)switch(y=c.charCodeAt(f++),!0){case y<128:d.push(String.fromCharCode(y));break;case y<2048:d.push(String.fromCharCode(192+(y>>6))),d.push(String.fromCharCode(128+(y&63)));break;case(y>=55296&&y<57344):y-=55296,g=c.charCodeAt(f++)-56320+(y<<10),d.push(String.fromCharCode(240+(g>>18&7))),d.push(String.fromCharCode(144+(g>>12&63))),d.push(String.fromCharCode(128+(g>>6&63))),d.push(String.fromCharCode(128+(g&63)));break;default:d.push(String.fromCharCode(224+(y>>12))),d.push(String.fromCharCode(128+(y>>6&63))),d.push(String.fromCharCode(128+(y&63)))}return d.join("")},Ls=function(){var c={};return function(f,y){var g=f+"|"+(y||"");return c[g]?c[g]:c[g]=new RegExp("<(?:\\w+:)?"+f+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+f+">",y||"")}}(),n2=function(){var c=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(d){return[new RegExp("&"+d[0]+";","ig"),d[1]]});return function(f){for(var y=f.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),g=0;g<c.length;++g)y=y.replace(c[g][0],c[g][1]);return y}}(),i2=function(){var c={};return function(f){return c[f]!==void 0?c[f]:c[f]=new RegExp("<(?:vt:)?"+f+">([\\s\\S]*?)</(?:vt:)?"+f+">","g")}}(),a2=/<\/?(?:vt:)?variant>/g,o2=/<(?:vt:)([^>]*)>([\s\S]*)</;function K0(c,d){var f=ot(c),y=c.match(i2(f.baseType))||[],g=[];if(y.length!=f.size){if(d.WTF)throw new Error("unexpected vector length "+y.length+" != "+f.size);return g}return y.forEach(function(x){var S=x.replace(a2,"").match(o2);S&&g.push({v:It(S[2]),t:S[1]})}),g}var Z0=/(^\s|\s$|\n)/;function $n(c,d){return"<"+c+(d.match(Z0)?' xml:space="preserve"':"")+">"+d+"</"+c+">"}function Ms(c){return $r(c).map(function(d){return" "+d+'="'+c[d]+'"'}).join("")}function Ue(c,d,f){return"<"+c+(f!=null?Ms(f):"")+(d!=null?(d.match(Z0)?' xml:space="preserve"':"")+">"+d+"</"+c:"/")+">"}function wf(c,d){try{return c.toISOString().replace(/\.\d*/,"")}catch(f){if(d)throw f}return""}function s2(c,d){switch(typeof c){case"string":var f=Ue("vt:lpwstr",Xt(c));return f=f.replace(/&quot;/g,"_x0022_"),f;case"number":return Ue((c|0)==c?"vt:i4":"vt:r8",Xt(String(c)));case"boolean":return Ue("vt:bool",c?"true":"false")}if(c instanceof Date)return Ue("vt:filetime",wf(c));throw new Error("Unable to serialize "+c)}function j0(c){if(_&&Buffer.isBuffer(c))return c.toString("utf8");if(typeof c=="string")return c;if(typeof Uint8Array<"u"&&c instanceof Uint8Array)return It(J(ne(c)));throw new Error("Bad input format: expected Buffer or string")}var xf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,hr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},za=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],eu={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function l2(c,d){for(var f=1-2*(c[d+7]>>>7),y=((c[d+7]&127)<<4)+(c[d+6]>>>4&15),g=c[d+6]&15,x=5;x>=0;--x)g=g*256+c[d+x];return y==2047?g==0?f*(1/0):NaN:(y==0?y=-1022:(y-=1023,g+=Math.pow(2,52)),f*Math.pow(2,y-52)*g)}function u2(c,d,f){var y=(d<0||1/d==-1/0?1:0)<<7,g=0,x=0,S=y?-d:d;isFinite(S)?S==0?g=x=0:(g=Math.floor(Math.log(S)/Math.LN2),x=S*Math.pow(2,52-g),g<=-1023&&(!isFinite(x)||x<Math.pow(2,52))?g=-1022:(x-=Math.pow(2,52),g+=1023)):(g=2047,x=isNaN(d)?26985:0);for(var T=0;T<=5;++T,x/=256)c[f+T]=x&255;c[f+6]=(g&15)<<4|x&15,c[f+7]=g>>4|y}var J0=function(c){for(var d=[],f=10240,y=0;y<c[0].length;++y)if(c[0][y])for(var g=0,x=c[0][y].length;g<x;g+=f)d.push.apply(d,c[0][y].slice(g,g+f));return d},Q0=_?function(c){return c[0].length>0&&Buffer.isBuffer(c[0][0])?Buffer.concat(c[0].map(function(d){return Buffer.isBuffer(d)?d:I(d)})):J0(c)}:J0,ep=function(c,d,f){for(var y=[],g=d;g<f;g+=2)y.push(String.fromCharCode(Os(c,g)));return y.join("").replace(oe,"")},tu=_?function(c,d,f){return Buffer.isBuffer(c)?c.toString("utf16le",d,f).replace(oe,""):ep(c,d,f)}:ep,tp=function(c,d,f){for(var y=[],g=d;g<d+f;++g)y.push(("0"+c[g].toString(16)).slice(-2));return y.join("")},rp=_?function(c,d,f){return Buffer.isBuffer(c)?c.toString("hex",d,d+f):tp(c,d,f)}:tp,np=function(c,d,f){for(var y=[],g=d;g<f;g++)y.push(String.fromCharCode(So(c,g)));return y.join("")},bo=_?function(d,f,y){return Buffer.isBuffer(d)?d.toString("utf8",f,y):np(d,f,y)}:np,ip=function(c,d){var f=Cr(c,d);return f>0?bo(c,d+4,d+4+f-1):""},bf=ip,ap=function(c,d){var f=Cr(c,d);return f>0?bo(c,d+4,d+4+f-1):""},Sf=ap,op=function(c,d){var f=2*Cr(c,d);return f>0?bo(c,d+4,d+4+f-1):""},Ef=op,sp=function(d,f){var y=Cr(d,f);return y>0?tu(d,f+4,f+4+y):""},Tf=sp,lp=function(c,d){var f=Cr(c,d);return f>0?bo(c,d+4,d+4+f):""},_f=lp,up=function(c,d){return l2(c,d)},Rf=up;_&&(bf=function(d,f){if(!Buffer.isBuffer(d))return ip(d,f);var y=d.readUInt32LE(f);return y>0?d.toString("utf8",f+4,f+4+y-1):""},Sf=function(d,f){if(!Buffer.isBuffer(d))return ap(d,f);var y=d.readUInt32LE(f);return y>0?d.toString("utf8",f+4,f+4+y-1):""},Ef=function(d,f){if(!Buffer.isBuffer(d))return op(d,f);var y=2*d.readUInt32LE(f);return d.toString("utf16le",f+4,f+4+y-1)},Tf=function(d,f){if(!Buffer.isBuffer(d))return sp(d,f);var y=d.readUInt32LE(f);return d.toString("utf16le",f+4,f+4+y)},_f=function(d,f){if(!Buffer.isBuffer(d))return lp(d,f);var y=d.readUInt32LE(f);return d.toString("utf8",f+4,f+4+y)},Rf=function(d,f){return Buffer.isBuffer(d)?d.readDoubleLE(f):up(d,f)});function c2(){tu=function(c,d,f){return $cptable.utils.decode(1200,c.slice(d,f)).replace(oe,"")},bo=function(c,d,f){return $cptable.utils.decode(65001,c.slice(d,f))},bf=function(c,d){var f=Cr(c,d);return f>0?$cptable.utils.decode(o,c.slice(d+4,d+4+f-1)):""},Sf=function(c,d){var f=Cr(c,d);return f>0?$cptable.utils.decode(a,c.slice(d+4,d+4+f-1)):""},Ef=function(c,d){var f=2*Cr(c,d);return f>0?$cptable.utils.decode(1200,c.slice(d+4,d+4+f-1)):""},Tf=function(c,d){var f=Cr(c,d);return f>0?$cptable.utils.decode(1200,c.slice(d+4,d+4+f)):""},_f=function(c,d){var f=Cr(c,d);return f>0?$cptable.utils.decode(65001,c.slice(d+4,d+4+f)):""}}typeof $cptable<"u"&&c2();var So=function(c,d){return c[d]},Os=function(c,d){return c[d+1]*256+c[d]},f2=function(c,d){var f=c[d+1]*256+c[d];return f<32768?f:(65535-f+1)*-1},Cr=function(c,d){return c[d+3]*(1<<24)+(c[d+2]<<16)+(c[d+1]<<8)+c[d]},Eo=function(c,d){return c[d+3]<<24|c[d+2]<<16|c[d+1]<<8|c[d]},h2=function(c,d){return c[d]<<24|c[d+1]<<16|c[d+2]<<8|c[d+3]};function As(c,d){var f="",y,g,x=[],S,T,A,N;switch(d){case"dbcs":if(N=this.l,_&&Buffer.isBuffer(this))f=this.slice(this.l,this.l+2*c).toString("utf16le");else for(A=0;A<c;++A)f+=String.fromCharCode(Os(this,N)),N+=2;c*=2;break;case"utf8":f=bo(this,this.l,this.l+c);break;case"utf16le":c*=2,f=tu(this,this.l,this.l+c);break;case"wstr":if(typeof $cptable<"u")f=$cptable.utils.decode(a,this.slice(this.l,this.l+2*c));else return As.call(this,c,"dbcs");c=2*c;break;case"lpstr-ansi":f=bf(this,this.l),c=4+Cr(this,this.l);break;case"lpstr-cp":f=Sf(this,this.l),c=4+Cr(this,this.l);break;case"lpwstr":f=Ef(this,this.l),c=4+2*Cr(this,this.l);break;case"lpp4":c=4+Cr(this,this.l),f=Tf(this,this.l),c&2&&(c+=2);break;case"8lpp4":c=4+Cr(this,this.l),f=_f(this,this.l),c&3&&(c+=4-(c&3));break;case"cstr":for(c=0,f="";(S=So(this,this.l+c++))!==0;)x.push(E(S));f=x.join("");break;case"_wstr":for(c=0,f="";(S=Os(this,this.l+c))!==0;)x.push(E(S)),c+=2;c+=2,f=x.join("");break;case"dbcs-cont":for(f="",N=this.l,A=0;A<c;++A){if(this.lens&&this.lens.indexOf(N)!==-1)return S=So(this,N),this.l=N+1,T=As.call(this,c-A,S?"dbcs-cont":"sbcs-cont"),x.join("")+T;x.push(E(Os(this,N))),N+=2}f=x.join(""),c*=2;break;case"cpstr":if(typeof $cptable<"u"){f=$cptable.utils.decode(a,this.slice(this.l,this.l+c));break}case"sbcs-cont":for(f="",N=this.l,A=0;A!=c;++A){if(this.lens&&this.lens.indexOf(N)!==-1)return S=So(this,N),this.l=N+1,T=As.call(this,c-A,S?"dbcs-cont":"sbcs-cont"),x.join("")+T;x.push(E(So(this,N))),N+=1}f=x.join("");break;default:switch(c){case 1:return y=So(this,this.l),this.l++,y;case 2:return y=(d==="i"?f2:Os)(this,this.l),this.l+=2,y;case 4:case-4:return d==="i"||!(this[this.l+3]&128)?(y=(c>0?Eo:h2)(this,this.l),this.l+=4,y):(g=Cr(this,this.l),this.l+=4,g);case 8:case-8:if(d==="f")return c==8?g=Rf(this,this.l):g=Rf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,g;c=8;case 16:f=rp(this,this.l,c);break}}return this.l+=c,f}var d2=function(c,d,f){c[f]=d&255,c[f+1]=d>>>8&255,c[f+2]=d>>>16&255,c[f+3]=d>>>24&255},v2=function(c,d,f){c[f]=d&255,c[f+1]=d>>8&255,c[f+2]=d>>16&255,c[f+3]=d>>24&255},p2=function(c,d,f){c[f]=d&255,c[f+1]=d>>>8&255};function g2(c,d,f){var y=0,g=0;if(f==="dbcs"){for(g=0;g!=d.length;++g)p2(this,d.charCodeAt(g),this.l+2*g);y=2*d.length}else if(f==="sbcs"){if(typeof $cptable<"u"&&o==874)for(g=0;g!=d.length;++g){var x=$cptable.utils.encode(o,d.charAt(g));this[this.l+g]=x[0]}else for(d=d.replace(/[^\x00-\x7F]/g,"_"),g=0;g!=d.length;++g)this[this.l+g]=d.charCodeAt(g)&255;y=d.length}else if(f==="hex"){for(;g<c;++g)this[this.l++]=parseInt(d.slice(2*g,2*g+2),16)||0;return this}else if(f==="utf16le"){var S=Math.min(this.l+c,this.length);for(g=0;g<Math.min(d.length,c);++g){var T=d.charCodeAt(g);this[this.l++]=T&255,this[this.l++]=T>>8}for(;this.l<S;)this[this.l++]=0;return this}else switch(c){case 1:y=1,this[this.l]=d&255;break;case 2:y=2,this[this.l]=d&255,d>>>=8,this[this.l+1]=d&255;break;case 3:y=3,this[this.l]=d&255,d>>>=8,this[this.l+1]=d&255,d>>>=8,this[this.l+2]=d&255;break;case 4:y=4,d2(this,d,this.l);break;case 8:if(y=8,f==="f"){u2(this,d,this.l);break}case 16:break;case-4:y=4,v2(this,d,this.l);break}return this.l+=y,this}function cp(c,d){var f=rp(this,this.l,c.length>>1);if(f!==c)throw new Error(d+"Expected "+c+" saw "+f);this.l+=c.length>>1}function Nn(c,d){c.l=d,c._R=As,c.chk=cp,c._W=g2}function gi(c){var d=P(c);return Nn(d,0),d}function m2(c,d,f){if(c){var y,g,x;Nn(c,c.l||0);for(var S=c.length,T=0,A=0;c.l<S;){T=c._R(1),T&128&&(T=(T&127)+((c._R(1)&127)<<7));var N=XLSBRecordEnum[T]||XLSBRecordEnum[65535];for(y=c._R(1),x=y&127,g=1;g<4&&y&128;++g)x+=((y=c._R(1))&127)<<7*g;A=c.l+x;var O=N.f&&N.f(c,x,f);if(c.l=A,d(O,N,T))return}}}function y2(){var c=[],d=_?256:2048,f=function(N){var O=gi(N);return Nn(O,0),O},y=f(d),g=function(){y&&(y.length>y.l&&(y=y.slice(0,y.l),y.l=y.length),y.length>0&&c.push(y),y=null)},x=function(N){return y&&N<y.length-y.l?y:(g(),y=f(Math.max(N+1,d)))},S=function(){return g(),ce(c)},T=function(N){g(),y=N,y.l==null&&(y.l=y.length),x(d)};return{next:x,push:T,end:S,_bufs:c}}function Lf(c){return parseInt(C2(c),10)-1}function mi(c){return""+(c+1)}function C2(c){return c.replace(/\$(\d+)$/,"$1")}function Mf(c){for(var d=w2(c),f=0,y=0;y!==d.length;++y)f=26*f+d.charCodeAt(y)-64;return f-1}function Vi(c){if(c<0)throw new Error("invalid column "+c);var d="";for(++c;c;c=Math.floor((c-1)/26))d=String.fromCharCode((c-1)%26+65)+d;return d}function w2(c){return c.replace(/^\$([A-Z])/,"$1")}function x2(c){return c.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Br(c){for(var d=0,f=0,y=0;y<c.length;++y){var g=c.charCodeAt(y);g>=48&&g<=57?d=10*d+(g-48):g>=65&&g<=90&&(f=26*f+(g-64))}return{c:f-1,r:d-1}}function er(c){for(var d=c.c+1,f="";d;d=(d-1)/26|0)f=String.fromCharCode((d-1)%26+65)+f;return f+(c.r+1)}function Xi(c){var d=c.indexOf(":");return d==-1?{s:Br(c),e:Br(c)}:{s:Br(c.slice(0,d)),e:Br(c.slice(d+1))}}function sr(c,d){return typeof d>"u"||typeof d=="number"?sr(c.s,c.e):(typeof c!="string"&&(c=er(c)),typeof d!="string"&&(d=er(d)),c==d?c:c+":"+d)}function lr(c){var d={s:{c:0,r:0},e:{c:0,r:0}},f=0,y=0,g=0,x=c.length;for(f=0;y<x&&!((g=c.charCodeAt(y)-64)<1||g>26);++y)f=26*f+g;for(d.s.c=--f,f=0;y<x&&!((g=c.charCodeAt(y)-48)<0||g>9);++y)f=10*f+g;if(d.s.r=--f,y===x||g!=10)return d.e.c=d.s.c,d.e.r=d.s.r,d;for(++y,f=0;y!=x&&!((g=c.charCodeAt(y)-64)<1||g>26);++y)f=26*f+g;for(d.e.c=--f,f=0;y!=x&&!((g=c.charCodeAt(y)-48)<0||g>9);++y)f=10*f+g;return d.e.r=--f,d}function fp(c,d){var f=c.t=="d"&&d instanceof Date;if(c.z!=null)try{return c.w=Yn(c.z,f?qr(d):d)}catch{}try{return c.w=Yn((c.XF||{}).numFmtId||(f?14:0),f?qr(d):d)}catch{return""+d}}function To(c,d,f){return c==null||c.t==null||c.t=="z"?"":c.w!==void 0?c.w:(c.t=="d"&&!c.z&&f&&f.dateNF&&(c.z=f.dateNF),c.t=="e"?Af[c.v]||c.v:d==null?fp(c,c.v):fp(c,d))}function _o(c,d){var f=d&&d.sheet?d.sheet:"Sheet1",y={};return y[f]=c,{SheetNames:[f],Sheets:y}}function hp(c,d,f){var y=f||{},g=c?Array.isArray(c):y.dense,x=c||(g?[]:{}),S=0,T=0;if(x&&y.origin!=null){if(typeof y.origin=="number")S=y.origin;else{var A=typeof y.origin=="string"?Br(y.origin):y.origin;S=A.r,T=A.c}x["!ref"]||(x["!ref"]="A1:A1")}var N={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(x["!ref"]){var O=lr(x["!ref"]);N.s.c=O.s.c,N.s.r=O.s.r,N.e.c=Math.max(N.e.c,O.e.c),N.e.r=Math.max(N.e.r,O.e.r),S==-1&&(N.e.r=S=O.e.r+1)}for(var F=0;F!=d.length;++F)if(d[F]){if(!Array.isArray(d[F]))throw new Error("aoa_to_sheet expects an array of arrays");for(var W=0;W!=d[F].length;++W)if(!(typeof d[F][W]>"u")){var H={v:d[F][W]},X=S+F,B=T+W;if(N.s.r>X&&(N.s.r=X),N.s.c>B&&(N.s.c=B),N.e.r<X&&(N.e.r=X),N.e.c<B&&(N.e.c=B),d[F][W]&&typeof d[F][W]=="object"&&!Array.isArray(d[F][W])&&!(d[F][W]instanceof Date))H=d[F][W];else if(Array.isArray(H.v)&&(H.f=d[F][W][1],H.v=H.v[0]),H.v===null)if(H.f)H.t="n";else if(y.nullError)H.t="e",H.v=0;else if(y.sheetStubs)H.t="z";else continue;else typeof H.v=="number"?H.t="n":typeof H.v=="boolean"?H.t="b":H.v instanceof Date?(H.z=y.dateNF||mt[14],y.cellDates?(H.t="d",H.w=Yn(H.z,qr(H.v))):(H.t="n",H.v=qr(H.v),H.w=Yn(H.z,H.v))):H.t="s";if(g)x[X]||(x[X]=[]),x[X][B]&&x[X][B].z&&(H.z=x[X][B].z),x[X][B]=H;else{var G=er({c:B,r:X});x[G]&&x[G].z&&(H.z=x[G].z),x[G]=H}}}return N.s.c<1e7&&(x["!ref"]=sr(N)),x}function Ro(c,d){return hp(null,c,d)}function b2(c){return c.map(function(d){return[d>>16&255,d>>8&255,d&255]})}var S2=b2([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Of=Dr(S2),Af={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},E2={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Nf={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ru={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function kf(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function T2(c){var d=kf();if(!c||!c.match)return d;var f={};if((c.match(sn)||[]).forEach(function(y){var g=ot(y);switch(g[0].replace(Qb,"<")){case"<?xml":break;case"<Types":d.xmlns=g["xmlns"+(g[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":f[g.Extension]=g.ContentType;break;case"<Override":d[Nf[g.ContentType]]!==void 0&&d[Nf[g.ContentType]].push(g.PartName);break}}),d.xmlns!==hr.CT)throw new Error("Unknown Namespace: "+d.xmlns);return d.calcchain=d.calcchains.length>0?d.calcchains[0]:"",d.sst=d.strs.length>0?d.strs[0]:"",d.style=d.styles.length>0?d.styles[0]:"",d.defaults=f,delete d.calcchains,d}function dp(c,d){var f=Ub(Nf),y=[],g;y[y.length]=or,y[y.length]=Ue("Types",null,{xmlns:hr.CT,"xmlns:xsd":hr.xsd,"xmlns:xsi":hr.xsi}),y=y.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(A){return Ue("Default",null,{Extension:A[0],ContentType:A[1]})}));var x=function(A){c[A]&&c[A].length>0&&(g=c[A][0],y[y.length]=Ue("Override",null,{PartName:(g[0]=="/"?"":"/")+g,ContentType:ru[A][d.bookType]||ru[A].xlsx}))},S=function(A){(c[A]||[]).forEach(function(N){y[y.length]=Ue("Override",null,{PartName:(N[0]=="/"?"":"/")+N,ContentType:ru[A][d.bookType]||ru[A].xlsx})})},T=function(A){(c[A]||[]).forEach(function(N){y[y.length]=Ue("Override",null,{PartName:(N[0]=="/"?"":"/")+N,ContentType:f[A][0]})})};return x("workbooks"),S("sheets"),S("charts"),T("themes"),["strs","styles"].forEach(x),["coreprops","extprops","custprops"].forEach(T),T("vba"),T("comments"),T("threadedcomments"),T("drawings"),S("metadata"),T("people"),y.length>2&&(y[y.length]="</Types>",y[1]=y[1].replace("/>",">")),y.join("")}var lt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Ns(c){var d=c.lastIndexOf("/");return c.slice(0,d+1)+"_rels/"+c.slice(d+1)+".rels"}function ks(c,d){var f={"!id":{}};if(!c)return f;d.charAt(0)!=="/"&&(d="/"+d);var y={};return(c.match(sn)||[]).forEach(function(g){var x=ot(g);if(x[0]==="<Relationship"){var S={};S.Type=x.Type,S.Target=x.Target,S.Id=x.Id,x.TargetMode&&(S.TargetMode=x.TargetMode);var T=x.TargetMode==="External"?x.Target:Rs(x.Target,d);f[T]=S,y[x.Id]=S}}),f["!id"]=y,f}function Lo(c){var d=[or,Ue("Relationships",null,{xmlns:hr.RELS})];return $r(c["!id"]).forEach(function(f){d[d.length]=Ue("Relationship",null,c["!id"][f])}),d.length>2&&(d[d.length]="</Relationships>",d[1]=d[1].replace("/>",">")),d.join("")}function Lt(c,d,f,y,g,x){if(g||(g={}),c["!id"]||(c["!id"]={}),c["!idx"]||(c["!idx"]=1),d<0)for(d=c["!idx"];c["!id"]["rId"+d];++d);if(c["!idx"]=d+1,g.Id="rId"+d,g.Type=y,g.Target=f,[lt.HLINK,lt.XPATH,lt.XMISS].indexOf(g.Type)>-1&&(g.TargetMode="External"),c["!id"][g.Id])throw new Error("Cannot rewrite rId "+d);return c["!id"][g.Id]=g,c[("/"+g.Target).replace("//","/")]=g,d}var _2="application/vnd.oasis.opendocument.spreadsheet";function R2(c,d){for(var f=j0(c),y,g;y=xf.exec(f);)switch(y[3]){case"manifest":break;case"file-entry":if(g=ot(y[0],!1),g.path=="/"&&g.type!==_2)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(d&&d.WTF)throw y}}function L2(c){var d=[or];d.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),d.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var f=0;f<c.length;++f)d.push('  <manifest:file-entry manifest:full-path="'+c[f][0]+'" manifest:media-type="'+c[f][1]+`"/>
`);return d.push("</manifest:manifest>"),d.join("")}function vp(c,d,f){return['  <rdf:Description rdf:about="'+c+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(f||"odf")+"#"+d+`"/>
`,`  </rdf:Description>
`].join("")}function M2(c,d){return['  <rdf:Description rdf:about="'+c+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+d+`"/>
`,`  </rdf:Description>
`].join("")}function O2(c){var d=[or];d.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var f=0;f!=c.length;++f)d.push(vp(c[f][0],c[f][1])),d.push(M2("",c[f][0]));return d.push(vp("","Document","pkg")),d.push("</rdf:RDF>"),d.join("")}function pp(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+i.version+"</meta:generator></office:meta></office:document-meta>"}var Wa=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],A2=function(){for(var c=new Array(Wa.length),d=0;d<Wa.length;++d){var f=Wa[d],y="(?:"+f[0].slice(0,f[0].indexOf(":"))+":)"+f[0].slice(f[0].indexOf(":")+1);c[d]=new RegExp("<"+y+"[^>]*>([\\s\\S]*?)</"+y+">")}return c}();function gp(c){var d={};c=It(c);for(var f=0;f<Wa.length;++f){var y=Wa[f],g=c.match(A2[f]);g!=null&&g.length>0&&(d[y[1]]=Wt(g[1])),y[2]==="date"&&d[y[1]]&&(d[y[1]]=yr(d[y[1]]))}return d}function If(c,d,f,y,g){g[c]!=null||d==null||d===""||(g[c]=d,d=Xt(d),y[y.length]=f?Ue(c,d,f):$n(c,d))}function mp(c,d){var f=d||{},y=[or,Ue("cp:coreProperties",null,{"xmlns:cp":hr.CORE_PROPS,"xmlns:dc":hr.dc,"xmlns:dcterms":hr.dcterms,"xmlns:dcmitype":hr.dcmitype,"xmlns:xsi":hr.xsi})],g={};if(!c&&!f.Props)return y.join("");c&&(c.CreatedDate!=null&&If("dcterms:created",typeof c.CreatedDate=="string"?c.CreatedDate:wf(c.CreatedDate,f.WTF),{"xsi:type":"dcterms:W3CDTF"},y,g),c.ModifiedDate!=null&&If("dcterms:modified",typeof c.ModifiedDate=="string"?c.ModifiedDate:wf(c.ModifiedDate,f.WTF),{"xsi:type":"dcterms:W3CDTF"},y,g));for(var x=0;x!=Wa.length;++x){var S=Wa[x],T=f.Props&&f.Props[S[1]]!=null?f.Props[S[1]]:c?c[S[1]]:null;T===!0?T="1":T===!1?T="0":typeof T=="number"&&(T=String(T)),T!=null&&If(S[0],T,null,y,g)}return y.length>2&&(y[y.length]="</cp:coreProperties>",y[1]=y[1].replace("/>",">")),y.join("")}var yp=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function N2(c,d,f,y){var g=[];if(typeof c=="string")g=K0(c,y);else for(var x=0;x<c.length;++x)g=g.concat(c[x].map(function(O){return{v:O}}));var S=typeof d=="string"?K0(d,y).map(function(O){return O.v}):d,T=0,A=0;if(S.length>0)for(var N=0;N!==g.length;N+=2){switch(A=+g[N+1].v,g[N].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":f.Worksheets=A,f.SheetNames=S.slice(T,T+A);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":f.NamedRanges=A,f.DefinedNames=S.slice(T,T+A);break;case"Charts":case"Diagramme":f.Chartsheets=A,f.ChartNames=S.slice(T,T+A);break}T+=A}}function k2(c,d,f){var y={};return d||(d={}),c=It(c),yp.forEach(function(g){var x=(c.match(Ls(g[0]))||[])[1];switch(g[2]){case"string":x&&(d[g[1]]=Wt(x));break;case"bool":d[g[1]]=x==="true";break;case"raw":var S=c.match(new RegExp("<"+g[0]+"[^>]*>([\\s\\S]*?)</"+g[0]+">"));S&&S.length>0&&(y[g[1]]=S[1]);break}}),y.HeadingPairs&&y.TitlesOfParts&&N2(y.HeadingPairs,y.TitlesOfParts,d,f),d}function Cp(c){var d=[],f=Ue;return c||(c={}),c.Application="SheetJS",d[d.length]=or,d[d.length]=Ue("Properties",null,{xmlns:hr.EXT_PROPS,"xmlns:vt":hr.vt}),yp.forEach(function(y){if(c[y[1]]!==void 0){var g;switch(y[2]){case"string":g=Xt(String(c[y[1]]));break;case"bool":g=c[y[1]]?"true":"false";break}g!==void 0&&(d[d.length]=f(y[0],g))}}),d[d.length]=f("HeadingPairs",f("vt:vector",f("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+f("vt:variant",f("vt:i4",String(c.Worksheets))),{size:2,baseType:"variant"})),d[d.length]=f("TitlesOfParts",f("vt:vector",c.SheetNames.map(function(y){return"<vt:lpstr>"+Xt(y)+"</vt:lpstr>"}).join(""),{size:c.Worksheets,baseType:"lpstr"})),d.length>2&&(d[d.length]="</Properties>",d[1]=d[1].replace("/>",">")),d.join("")}var I2=/<[^>]+>[^<]*/g;function P2(c,d){var f={},y="",g=c.match(I2);if(g)for(var x=0;x!=g.length;++x){var S=g[x],T=ot(S);switch(T[0]){case"<?xml":break;case"<Properties":break;case"<property":y=Wt(T.name);break;case"</property>":y=null;break;default:if(S.indexOf("<vt:")===0){var A=S.split(">"),N=A[0].slice(4),O=A[1];switch(N){case"lpstr":case"bstr":case"lpwstr":f[y]=Wt(O);break;case"bool":f[y]=jt(O);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":f[y]=parseInt(O,10);break;case"r4":case"r8":case"decimal":f[y]=parseFloat(O);break;case"filetime":case"date":f[y]=yr(O);break;case"cy":case"error":f[y]=Wt(O);break;default:if(N.slice(-1)=="/")break;d.WTF&&typeof console<"u"&&console.warn("Unexpected",S,N,A)}}else if(S.slice(0,2)!=="</"){if(d.WTF)throw new Error(S)}}}return f}function wp(c){var d=[or,Ue("Properties",null,{xmlns:hr.CUST_PROPS,"xmlns:vt":hr.vt})];if(!c)return d.join("");var f=1;return $r(c).forEach(function(g){++f,d[d.length]=Ue("property",s2(c[g]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:f,name:Xt(g)})}),d.length>2&&(d[d.length]="</Properties>",d[1]=d[1].replace("/>",">")),d.join("")}var D2=[2,3,48,49,131,139,140,245],Pf=function(){var c={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},d=I0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function f(T,A){var N=[],O=P(1);switch(A.type){case"base64":O=q(L(T));break;case"binary":O=q(T);break;case"buffer":case"array":O=T;break}Nn(O,0);var F=O._R(1),W=!!(F&136),H=!1,X=!1;switch(F){case 2:break;case 3:break;case 48:H=!0,W=!0;break;case 49:H=!0,W=!0;break;case 131:break;case 139:break;case 140:X=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+F.toString(16))}var B=0,G=521;F==2&&(B=O._R(2)),O.l+=3,F!=2&&(B=O._R(4)),B>1048576&&(B=1e6),F!=2&&(G=O._R(2));var ie=O._R(2),ae=A.codepage||1252;F!=2&&(O.l+=16,O._R(1),O[O.l]!==0&&(ae=c[O[O.l]]),O.l+=1,O.l+=2),X&&(O.l+=36);for(var de=[],we={},xe=Math.min(O.length,F==2?521:G-10-(H?264:0)),he=X?32:11;O.l<xe&&O[O.l]!=13;)switch(we={},we.name=$cptable.utils.decode(ae,O.slice(O.l,O.l+he)).replace(/[\u0000\r\n].*$/g,""),O.l+=he,we.type=String.fromCharCode(O._R(1)),F!=2&&!X&&(we.offset=O._R(4)),we.len=O._R(1),F==2&&(we.offset=O._R(2)),we.dec=O._R(1),we.name.length&&de.push(we),F!=2&&(O.l+=X?13:14),we.type){case"B":(!H||we.len!=8)&&A.WTF&&console.log("Skipping "+we.name+":"+we.type);break;case"G":case"P":A.WTF&&console.log("Skipping "+we.name+":"+we.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+we.type)}if(O[O.l]!==13&&(O.l=G-1),O._R(1)!==13)throw new Error("DBF Terminator not found "+O.l+" "+O[O.l]);O.l=G;var ee=0,Ee=0;for(N[0]=[],Ee=0;Ee!=de.length;++Ee)N[0][Ee]=de[Ee].name;for(;B-- >0;){if(O[O.l]===42){O.l+=ie;continue}for(++O.l,N[++ee]=[],Ee=0,Ee=0;Ee!=de.length;++Ee){var Ce=O.slice(O.l,O.l+de[Ee].len);O.l+=de[Ee].len,Nn(Ce,0);var Oe=$cptable.utils.decode(ae,Ce);switch(de[Ee].type){case"C":Oe.trim().length&&(N[ee][Ee]=Oe.replace(/\s+$/,""));break;case"D":Oe.length===8?N[ee][Ee]=new Date(+Oe.slice(0,4),+Oe.slice(4,6)-1,+Oe.slice(6,8)):N[ee][Ee]=Oe;break;case"F":N[ee][Ee]=parseFloat(Oe.trim());break;case"+":case"I":N[ee][Ee]=X?Ce._R(-4,"i")^2147483648:Ce._R(4,"i");break;case"L":switch(Oe.trim().toUpperCase()){case"Y":case"T":N[ee][Ee]=!0;break;case"N":case"F":N[ee][Ee]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Oe+"|")}break;case"M":if(!W)throw new Error("DBF Unexpected MEMO for type "+F.toString(16));N[ee][Ee]="##MEMO##"+(X?parseInt(Oe.trim(),10):Ce._R(4));break;case"N":Oe=Oe.replace(/\u0000/g,"").trim(),Oe&&Oe!="."&&(N[ee][Ee]=+Oe||0);break;case"@":N[ee][Ee]=new Date(Ce._R(-8,"f")-621356832e5);break;case"T":N[ee][Ee]=new Date((Ce._R(4)-2440588)*864e5+Ce._R(4));break;case"Y":N[ee][Ee]=Ce._R(4,"i")/1e4+Ce._R(4,"i")/1e4*Math.pow(2,32);break;case"O":N[ee][Ee]=-Ce._R(-8,"f");break;case"B":if(H&&de[Ee].len==8){N[ee][Ee]=Ce._R(8,"f");break}case"G":case"P":Ce.l+=de[Ee].len;break;case"0":if(de[Ee].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+de[Ee].type)}}}if(F!=2&&O.l<O.length&&O[O.l++]!=26)throw new Error("DBF EOF Marker missing "+(O.l-1)+" of "+O.length+" "+O[O.l-1].toString(16));return A&&A.sheetRows&&(N=N.slice(0,A.sheetRows)),A.DBF=de,N}function y(T,A){var N=A||{};N.dateNF||(N.dateNF="yyyymmdd");var O=Ro(f(T,N),N);return O["!cols"]=N.DBF.map(function(F){return{wch:F.len,DBF:F}}),delete N.DBF,O}function g(T,A){try{return _o(y(T,A),A)}catch(N){if(A&&A.WTF)throw N}return{SheetNames:[],Sheets:{}}}var x={B:8,C:250,L:1,D:8,"?":0,"":0};function S(T,A){var N=A||{};if(+N.codepage>=0&&v(+N.codepage),N.type=="string")throw new Error("Cannot write DBF to JS string");var O=y2(),F=Jf(T,{header:1,raw:!0,cellDates:!0}),W=F[0],H=F.slice(1),X=T["!cols"]||[],B=0,G=0,ie=0,ae=1;for(B=0;B<W.length;++B){if(((X[B]||{}).DBF||{}).name){W[B]=X[B].DBF.name,++ie;continue}if(W[B]!=null){if(++ie,typeof W[B]=="number"&&(W[B]=W[B].toString(10)),typeof W[B]!="string")throw new Error("DBF Invalid column name "+W[B]+" |"+typeof W[B]+"|");if(W.indexOf(W[B])!==B){for(G=0;G<1024;++G)if(W.indexOf(W[B]+"_"+G)==-1){W[B]+="_"+G;break}}}}var de=lr(T["!ref"]),we=[],xe=[],he=[];for(B=0;B<=de.e.c-de.s.c;++B){var ee="",Ee="",Ce=0,Oe=[];for(G=0;G<H.length;++G)H[G][B]!=null&&Oe.push(H[G][B]);if(Oe.length==0||W[B]==null){we[B]="?";continue}for(G=0;G<Oe.length;++G){switch(typeof Oe[G]){case"number":Ee="B";break;case"string":Ee="C";break;case"boolean":Ee="L";break;case"object":Ee=Oe[G]instanceof Date?"D":"C";break;default:Ee="C"}Ce=Math.max(Ce,String(Oe[G]).length),ee=ee&&ee!=Ee?"C":Ee}Ce>250&&(Ce=250),Ee=((X[B]||{}).DBF||{}).type,Ee=="C"&&X[B].DBF.len>Ce&&(Ce=X[B].DBF.len),ee=="B"&&Ee=="N"&&(ee="N",he[B]=X[B].DBF.dec,Ce=X[B].DBF.len),xe[B]=ee=="C"||Ee=="N"?Ce:x[ee]||0,ae+=xe[B],we[B]=ee}var Re=O.next(32);for(Re._W(4,318902576),Re._W(4,H.length),Re._W(2,296+32*ie),Re._W(2,ae),B=0;B<4;++B)Re._W(4,0);for(Re._W(4,0|(+d[o]||3)<<8),B=0,G=0;B<W.length;++B)if(W[B]!=null){var Ae=O.next(32),Ve=(W[B].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);Ae._W(1,Ve,"sbcs"),Ae._W(1,we[B]=="?"?"C":we[B],"sbcs"),Ae._W(4,G),Ae._W(1,xe[B]||x[we[B]]||0),Ae._W(1,he[B]||0),Ae._W(1,2),Ae._W(4,0),Ae._W(1,0),Ae._W(4,0),Ae._W(4,0),G+=xe[B]||x[we[B]]||0}var ft=O.next(264);for(ft._W(4,13),B=0;B<65;++B)ft._W(4,0);for(B=0;B<H.length;++B){var Ye=O.next(ae);for(Ye._W(1,0),G=0;G<W.length;++G)if(W[G]!=null)switch(we[G]){case"L":Ye._W(1,H[B][G]==null?63:H[B][G]?84:70);break;case"B":Ye._W(8,H[B][G]||0,"f");break;case"N":var gt="0";for(typeof H[B][G]=="number"&&(gt=H[B][G].toFixed(he[G]||0)),ie=0;ie<xe[G]-gt.length;++ie)Ye._W(1,32);Ye._W(1,gt,"sbcs");break;case"D":H[B][G]?(Ye._W(4,("0000"+H[B][G].getFullYear()).slice(-4),"sbcs"),Ye._W(2,("00"+(H[B][G].getMonth()+1)).slice(-2),"sbcs"),Ye._W(2,("00"+H[B][G].getDate()).slice(-2),"sbcs")):Ye._W(8,"00000000","sbcs");break;case"C":var Gt=String(H[B][G]!=null?H[B][G]:"").slice(0,xe[G]);for(Ye._W(1,Gt,"sbcs"),ie=0;ie<xe[G]-Gt.length;++ie)Ye._W(1,32);break}}return O.next(1)._W(1,26),O.end()}return{to_workbook:g,to_sheet:y,from_sheet:S}}(),xp=function(){var c={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},d=new RegExp("\x1BN("+$r(c).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),f=function(W,H){var X=c[H];return typeof X=="number"?R(X):X},y=function(W,H,X){var B=H.charCodeAt(0)-32<<4|X.charCodeAt(0)-48;return B==59?W:R(B)};c["|"]=254;function g(W,H){switch(H.type){case"base64":return x(L(W),H);case"binary":return x(W,H);case"buffer":return x(_&&Buffer.isBuffer(W)?W.toString("binary"):J(W),H);case"array":return x(xo(W),H)}throw new Error("Unrecognized type "+H.type)}function x(W,H){var X=W.split(/[\n\r]+/),B=-1,G=-1,ie=0,ae=0,de=[],we=[],xe=null,he={},ee=[],Ee=[],Ce=[],Oe=0,Re;for(+H.codepage>=0&&v(+H.codepage);ie!==X.length;++ie){Oe=0;var Ae=X[ie].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,y).replace(d,f),Ve=Ae.replace(/;;/g,"\0").split(";").map(function(Ci){return Ci.replace(/\u0000/g,";")}),ft=Ve[0],Ye;if(Ae.length>0)switch(ft){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Ve[1].charAt(0)=="P"&&we.push(Ae.slice(3).replace(/;;/g,";"));break;case"C":var gt=!1,Gt=!1,Yi=!1,Et=!1,yt=-1,Pt=-1;for(ae=1;ae<Ve.length;++ae)switch(Ve[ae].charAt(0)){case"A":break;case"X":G=parseInt(Ve[ae].slice(1))-1,Gt=!0;break;case"Y":for(B=parseInt(Ve[ae].slice(1))-1,Gt||(G=0),Re=de.length;Re<=B;++Re)de[Re]=[];break;case"K":Ye=Ve[ae].slice(1),Ye.charAt(0)==='"'?Ye=Ye.slice(1,Ye.length-1):Ye==="TRUE"?Ye=!0:Ye==="FALSE"?Ye=!1:isNaN(Wi(Ye))?isNaN(_s(Ye).getDate())||(Ye=yr(Ye)):(Ye=Wi(Ye),xe!==null&&jl(xe)&&(Ye=pf(Ye))),typeof $cptable<"u"&&typeof Ye=="string"&&(H||{}).type!="string"&&(H||{}).codepage&&(Ye=$cptable.utils.decode(H.codepage,Ye)),gt=!0;break;case"E":Et=!0;var yn=PS(Ve[ae].slice(1),{r:B,c:G});de[B][G]=[de[B][G],yn];break;case"S":Yi=!0,de[B][G]=[de[B][G],"S5S"];break;case"G":break;case"R":yt=parseInt(Ve[ae].slice(1))-1;break;case"C":Pt=parseInt(Ve[ae].slice(1))-1;break;default:if(H&&H.WTF)throw new Error("SYLK bad record "+Ae)}if(gt&&(de[B][G]&&de[B][G].length==2?de[B][G][0]=Ye:de[B][G]=Ye,xe=null),Yi){if(Et)throw new Error("SYLK shared formula cannot have own formula");var In=yt>-1&&de[yt][Pt];if(!In||!In[1])throw new Error("SYLK shared formula cannot find base");de[B][G][1]=Np(In[1],{r:B-yt,c:G-Pt})}break;case"F":var Pn=0;for(ae=1;ae<Ve.length;++ae)switch(Ve[ae].charAt(0)){case"X":G=parseInt(Ve[ae].slice(1))-1,++Pn;break;case"Y":for(B=parseInt(Ve[ae].slice(1))-1,Re=de.length;Re<=B;++Re)de[Re]=[];break;case"M":Oe=parseInt(Ve[ae].slice(1))/20;break;case"F":break;case"G":break;case"P":xe=we[parseInt(Ve[ae].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(Ce=Ve[ae].slice(1).split(" "),Re=parseInt(Ce[0],10);Re<=parseInt(Ce[1],10);++Re)Oe=parseInt(Ce[2],10),Ee[Re-1]=Oe===0?{hidden:!0}:{wch:Oe},Hf(Ee[Re-1]);break;case"C":G=parseInt(Ve[ae].slice(1))-1,Ee[G]||(Ee[G]={});break;case"R":B=parseInt(Ve[ae].slice(1))-1,ee[B]||(ee[B]={}),Oe>0?(ee[B].hpt=Oe,ee[B].hpx=Wf(Oe)):Oe===0&&(ee[B].hidden=!0);break;default:if(H&&H.WTF)throw new Error("SYLK bad record "+Ae)}Pn<1&&(xe=null);break;default:if(H&&H.WTF)throw new Error("SYLK bad record "+Ae)}}return ee.length>0&&(he["!rows"]=ee),Ee.length>0&&(he["!cols"]=Ee),H&&H.sheetRows&&(de=de.slice(0,H.sheetRows)),[de,he]}function S(W,H){var X=g(W,H),B=X[0],G=X[1],ie=Ro(B,H);return $r(G).forEach(function(ae){ie[ae]=G[ae]}),ie}function T(W,H){return _o(S(W,H),H)}function A(W,H,X,B){var G="C;Y"+(X+1)+";X"+(B+1)+";K";switch(W.t){case"n":G+=W.v||0,W.f&&!W.F&&(G+=";E"+DS(W.f,{r:X,c:B}));break;case"b":G+=W.v?"TRUE":"FALSE";break;case"e":G+=W.w||W.v;break;case"d":G+='"'+(W.w||W.v)+'"';break;case"s":G+='"'+W.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return G}function N(W,H){H.forEach(function(X,B){var G="F;W"+(B+1)+" "+(B+1)+" ";X.hidden?G+="0":(typeof X.width=="number"&&!X.wpx&&(X.wpx=nu(X.width)),typeof X.wpx=="number"&&!X.wch&&(X.wch=Ps(X.wpx)),typeof X.wch=="number"&&(G+=Math.round(X.wch))),G.charAt(G.length-1)!=" "&&W.push(G)})}function O(W,H){H.forEach(function(X,B){var G="F;";X.hidden?G+="M0;":X.hpt?G+="M"+20*X.hpt+";":X.hpx&&(G+="M"+20*zf(X.hpx)+";"),G.length>2&&W.push(G+"R"+(B+1))})}function F(W,H){var X=["ID;PWXL;N;E"],B=[],G=lr(W["!ref"]),ie,ae=Array.isArray(W),de=`\r
`;X.push("P;PGeneral"),X.push("F;P0;DG0G8;M255"),W["!cols"]&&N(X,W["!cols"]),W["!rows"]&&O(X,W["!rows"]),X.push("B;Y"+(G.e.r-G.s.r+1)+";X"+(G.e.c-G.s.c+1)+";D"+[G.s.c,G.s.r,G.e.c,G.e.r].join(" "));for(var we=G.s.r;we<=G.e.r;++we)for(var xe=G.s.c;xe<=G.e.c;++xe){var he=er({r:we,c:xe});ie=ae?(W[we]||[])[xe]:W[he],!(!ie||ie.v==null&&(!ie.f||ie.F))&&B.push(A(ie,W,we,xe))}return X.join(de)+de+B.join(de)+de+"E"+de}return{to_workbook:T,to_sheet:S,from_sheet:F}}(),bp=function(){function c(x,S){switch(S.type){case"base64":return d(L(x),S);case"binary":return d(x,S);case"buffer":return d(_&&Buffer.isBuffer(x)?x.toString("binary"):J(x),S);case"array":return d(xo(x),S)}throw new Error("Unrecognized type "+S.type)}function d(x,S){for(var T=x.split(`
`),A=-1,N=-1,O=0,F=[];O!==T.length;++O){if(T[O].trim()==="BOT"){F[++A]=[],N=0;continue}if(!(A<0)){var W=T[O].trim().split(","),H=W[0],X=W[1];++O;for(var B=T[O]||"";(B.match(/["]/g)||[]).length&1&&O<T.length-1;)B+=`
`+T[++O];switch(B=B.trim(),+H){case-1:if(B==="BOT"){F[++A]=[],N=0;continue}else if(B!=="EOD")throw new Error("Unrecognized DIF special command "+B);break;case 0:B==="TRUE"?F[A][N]=!0:B==="FALSE"?F[A][N]=!1:isNaN(Wi(X))?isNaN(_s(X).getDate())?F[A][N]=X:F[A][N]=yr(X):F[A][N]=Wi(X),++N;break;case 1:B=B.slice(1,B.length-1),B=B.replace(/""/g,'"'),B&&B.match(/^=".*"$/)&&(B=B.slice(2,-1)),F[A][N++]=B!==""?B:null;break}if(B==="EOD")break}}return S&&S.sheetRows&&(F=F.slice(0,S.sheetRows)),F}function f(x,S){return Ro(c(x,S),S)}function y(x,S){return _o(f(x,S),S)}var g=function(){var x=function(A,N,O,F,W){A.push(N),A.push(O+","+F),A.push('"'+W.replace(/"/g,'""')+'"')},S=function(A,N,O,F){A.push(N+","+O),A.push(N==1?'"'+F.replace(/"/g,'""')+'"':F)};return function(A){var N=[],O=lr(A["!ref"]),F,W=Array.isArray(A);x(N,"TABLE",0,1,"sheetjs"),x(N,"VECTORS",0,O.e.r-O.s.r+1,""),x(N,"TUPLES",0,O.e.c-O.s.c+1,""),x(N,"DATA",0,0,"");for(var H=O.s.r;H<=O.e.r;++H){S(N,-1,0,"BOT");for(var X=O.s.c;X<=O.e.c;++X){var B=er({r:H,c:X});if(F=W?(A[H]||[])[X]:A[B],!F){S(N,1,0,"");continue}switch(F.t){case"n":var G=F.w;!G&&F.v!=null&&(G=F.v),G==null?F.f&&!F.F?S(N,1,0,"="+F.f):S(N,1,0,""):S(N,0,G,"V");break;case"b":S(N,0,F.v?1:0,F.v?"TRUE":"FALSE");break;case"s":S(N,1,0,isNaN(F.v)?F.v:'="'+F.v+'"');break;case"d":F.w||(F.w=Yn(F.z||mt[14],qr(yr(F.v)))),S(N,0,F.w,"V");break;default:S(N,1,0,"")}}}S(N,-1,0,"EOD");var ie=`\r
`,ae=N.join(ie);return ae}}();return{to_workbook:y,to_sheet:f,from_sheet:g}}(),Sp=function(){function c(F){return F.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function d(F){return F.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function f(F,W){for(var H=F.split(`
`),X=-1,B=-1,G=0,ie=[];G!==H.length;++G){var ae=H[G].trim().split(":");if(ae[0]==="cell"){var de=Br(ae[1]);if(ie.length<=de.r)for(X=ie.length;X<=de.r;++X)ie[X]||(ie[X]=[]);switch(X=de.r,B=de.c,ae[2]){case"t":ie[X][B]=c(ae[3]);break;case"v":ie[X][B]=+ae[3];break;case"vtf":var we=ae[ae.length-1];case"vtc":switch(ae[3]){case"nl":ie[X][B]=!!+ae[4];break;default:ie[X][B]=+ae[4];break}ae[2]=="vtf"&&(ie[X][B]=[ie[X][B],we])}}}return W&&W.sheetRows&&(ie=ie.slice(0,W.sheetRows)),ie}function y(F,W){return Ro(f(F,W),W)}function g(F,W){return _o(y(F,W),W)}var x=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),S=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,T=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),A="--SocialCalcSpreadsheetControlSave--";function N(F){if(!F||!F["!ref"])return"";for(var W=[],H=[],X,B="",G=Xi(F["!ref"]),ie=Array.isArray(F),ae=G.s.r;ae<=G.e.r;++ae)for(var de=G.s.c;de<=G.e.c;++de)if(B=er({r:ae,c:de}),X=ie?(F[ae]||[])[de]:F[B],!(!X||X.v==null||X.t==="z")){switch(H=["cell",B,"t"],X.t){case"s":case"str":H.push(d(X.v));break;case"n":X.f?(H[2]="vtf",H[3]="n",H[4]=X.v,H[5]=d(X.f)):(H[2]="v",H[3]=X.v);break;case"b":H[2]="vt"+(X.f?"f":"c"),H[3]="nl",H[4]=X.v?"1":"0",H[5]=d(X.f||(X.v?"TRUE":"FALSE"));break;case"d":var we=qr(yr(X.v));H[2]="vtc",H[3]="nd",H[4]=""+we,H[5]=X.w||Yn(X.z||mt[14],we);break;case"e":continue}W.push(H.join(":"))}return W.push("sheet:c:"+(G.e.c-G.s.c+1)+":r:"+(G.e.r-G.s.r+1)+":tvf:1"),W.push("valueformat:1:text-wiki"),W.join(`
`)}function O(F){return[x,S,T,S,N(F),A].join(`
`)}return{to_workbook:g,to_sheet:y,from_sheet:O}}(),Is=function(){function c(O,F,W,H,X){X.raw?F[W][H]=O:O===""||(O==="TRUE"?F[W][H]=!0:O==="FALSE"?F[W][H]=!1:isNaN(Wi(O))?isNaN(_s(O).getDate())?F[W][H]=O:F[W][H]=yr(O):F[W][H]=Wi(O))}function d(O,F){var W=F||{},H=[];if(!O||O.length===0)return H;for(var X=O.split(/[\r\n]/),B=X.length-1;B>=0&&X[B].length===0;)--B;for(var G=10,ie=0,ae=0;ae<=B;++ae)ie=X[ae].indexOf(" "),ie==-1?ie=X[ae].length:ie++,G=Math.max(G,ie);for(ae=0;ae<=B;++ae){H[ae]=[];var de=0;for(c(X[ae].slice(0,G).trim(),H,ae,de,W),de=1;de<=(X[ae].length-G)/10+1;++de)c(X[ae].slice(G+(de-1)*10,G+de*10).trim(),H,ae,de,W)}return W.sheetRows&&(H=H.slice(0,W.sheetRows)),H}var f={44:",",9:"	",59:";",124:"|"},y={44:3,9:2,59:1,124:0};function g(O){for(var F={},W=!1,H=0,X=0;H<O.length;++H)(X=O.charCodeAt(H))==34?W=!W:!W&&X in f&&(F[X]=(F[X]||0)+1);X=[];for(H in F)Object.prototype.hasOwnProperty.call(F,H)&&X.push([F[H],H]);if(!X.length){F=y;for(H in F)Object.prototype.hasOwnProperty.call(F,H)&&X.push([F[H],H])}return X.sort(function(B,G){return B[0]-G[0]||y[B[1]]-y[G[1]]}),f[X.pop()[1]]||44}function x(O,F){var W=F||{},H="",X=W.dense?[]:{},B={s:{c:0,r:0},e:{c:0,r:0}};O.slice(0,4)=="sep="?O.charCodeAt(5)==13&&O.charCodeAt(6)==10?(H=O.charAt(4),O=O.slice(7)):O.charCodeAt(5)==13||O.charCodeAt(5)==10?(H=O.charAt(4),O=O.slice(6)):H=g(O.slice(0,1024)):W&&W.FS?H=W.FS:H=g(O.slice(0,1024));var G=0,ie=0,ae=0,de=0,we=0,xe=H.charCodeAt(0),he=!1,ee=0,Ee=O.charCodeAt(0);O=O.replace(/\r\n/gm,`
`);var Ce=W.dateNF!=null?Fb(W.dateNF):null;function Oe(){var Re=O.slice(de,we),Ae={};if(Re.charAt(0)=='"'&&Re.charAt(Re.length-1)=='"'&&(Re=Re.slice(1,-1).replace(/""/g,'"')),Re.length===0)Ae.t="z";else if(W.raw)Ae.t="s",Ae.v=Re;else if(Re.trim().length===0)Ae.t="s",Ae.v=Re;else if(Re.charCodeAt(0)==61)Re.charCodeAt(1)==34&&Re.charCodeAt(Re.length-1)==34?(Ae.t="s",Ae.v=Re.slice(2,-1).replace(/""/g,'"')):FS(Re)?(Ae.t="n",Ae.f=Re.slice(1)):(Ae.t="s",Ae.v=Re);else if(Re=="TRUE")Ae.t="b",Ae.v=!0;else if(Re=="FALSE")Ae.t="b",Ae.v=!1;else if(!isNaN(ae=Wi(Re)))Ae.t="n",W.cellText!==!1&&(Ae.w=Re),Ae.v=ae;else if(!isNaN(_s(Re).getDate())||Ce&&Re.match(Ce)){Ae.z=W.dateNF||mt[14];var Ve=0;Ce&&Re.match(Ce)&&(Re=Hb(Re,W.dateNF,Re.match(Ce)||[]),Ve=1),W.cellDates?(Ae.t="d",Ae.v=yr(Re,Ve)):(Ae.t="n",Ae.v=qr(yr(Re,Ve))),W.cellText!==!1&&(Ae.w=Yn(Ae.z,Ae.v instanceof Date?qr(Ae.v):Ae.v)),W.cellNF||delete Ae.z}else Ae.t="s",Ae.v=Re;if(Ae.t=="z"||(W.dense?(X[G]||(X[G]=[]),X[G][ie]=Ae):X[er({c:ie,r:G})]=Ae),de=we+1,Ee=O.charCodeAt(de),B.e.c<ie&&(B.e.c=ie),B.e.r<G&&(B.e.r=G),ee==xe)++ie;else if(ie=0,++G,W.sheetRows&&W.sheetRows<=G)return!0}e:for(;we<O.length;++we)switch(ee=O.charCodeAt(we)){case 34:Ee===34&&(he=!he);break;case xe:case 10:case 13:if(!he&&Oe())break e;break}return we-de>0&&Oe(),X["!ref"]=sr(B),X}function S(O,F){return!(F&&F.PRN)||F.FS||O.slice(0,4)=="sep="||O.indexOf("	")>=0||O.indexOf(",")>=0||O.indexOf(";")>=0?x(O,F):Ro(d(O,F),F)}function T(O,F){var W="",H=F.type=="string"?[0,0,0,0]:qf(O,F);switch(F.type){case"base64":W=L(O);break;case"binary":W=O;break;case"buffer":F.codepage==65001?W=O.toString("utf8"):F.codepage&&typeof $cptable<"u"?W=$cptable.utils.decode(F.codepage,O):W=_&&Buffer.isBuffer(O)?O.toString("binary"):J(O);break;case"array":W=xo(O);break;case"string":W=O;break;default:throw new Error("Unrecognized type "+F.type)}return H[0]==239&&H[1]==187&&H[2]==191?W=It(W.slice(3)):F.type!="string"&&F.type!="buffer"&&F.codepage==65001?W=It(W):F.type=="binary"&&typeof $cptable<"u"&&F.codepage&&(W=$cptable.utils.decode(F.codepage,$cptable.utils.encode(28591,W))),W.slice(0,19)=="socialcalc:version:"?Sp.to_sheet(F.type=="string"?W:It(W),F):S(W,F)}function A(O,F){return _o(T(O,F),F)}function N(O){for(var F=[],W=lr(O["!ref"]),H,X=Array.isArray(O),B=W.s.r;B<=W.e.r;++B){for(var G=[],ie=W.s.c;ie<=W.e.c;++ie){var ae=er({r:B,c:ie});if(H=X?(O[B]||[])[ie]:O[ae],!H||H.v==null){G.push("          ");continue}for(var de=(H.w||(To(H),H.w)||"").slice(0,10);de.length<10;)de+=" ";G.push(de+(ie===0?" ":""))}F.push(G.join(""))}return F.join(`
`)}return{to_workbook:A,to_sheet:T,from_sheet:N}}();function B2(c,d){var f=d||{},y=!!f.WTF;f.WTF=!0;try{var g=xp.to_workbook(c,f);return f.WTF=y,g}catch(x){if(f.WTF=y,!x.message.match(/SYLK bad record ID/)&&y)throw x;return Is.to_workbook(c,d)}}function F2(c){var d={},f=c.match(sn),y=0,g=!1;if(f)for(;y!=f.length;++y){var x=ot(f[y]);switch(x[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!x.val)break;case"<shadow>":case"<shadow/>":d.shadow=1;break;case"</shadow>":break;case"<charset":if(x.val=="1")break;d.cp=l[parseInt(x.val,10)];break;case"<outline":if(!x.val)break;case"<outline>":case"<outline/>":d.outline=1;break;case"</outline>":break;case"<rFont":d.name=x.val;break;case"<sz":d.sz=x.val;break;case"<strike":if(!x.val)break;case"<strike>":case"<strike/>":d.strike=1;break;case"</strike>":break;case"<u":if(!x.val)break;switch(x.val){case"double":d.uval="double";break;case"singleAccounting":d.uval="single-accounting";break;case"doubleAccounting":d.uval="double-accounting";break}case"<u>":case"<u/>":d.u=1;break;case"</u>":break;case"<b":if(x.val=="0")break;case"<b>":case"<b/>":d.b=1;break;case"</b>":break;case"<i":if(x.val=="0")break;case"<i>":case"<i/>":d.i=1;break;case"</i>":break;case"<color":x.rgb&&(d.color=x.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":d.family=x.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":d.valign=x.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":g=!0;break;case"</ext>":g=!1;break;default:if(x[0].charCodeAt(1)!==47&&!g)throw new Error("Unrecognized rich format "+x[0])}}return d}var H2=function(){var c=Ls("t"),d=Ls("rPr");function f(x){var S=x.match(c);if(!S)return{t:"s",v:""};var T={t:"s",v:Wt(S[1])},A=x.match(d);return A&&(T.s=F2(A[1])),T}var y=/<(?:\w+:)?r>/g,g=/<\/(?:\w+:)?r>/;return function(S){return S.replace(y,"").split(g).map(f).filter(function(T){return T.v})}}(),z2=function(){var d=/(\r\n|\n)/g;function f(g,x,S){var T=[];g.u&&T.push("text-decoration: underline;"),g.uval&&T.push("text-underline-style:"+g.uval+";"),g.sz&&T.push("font-size:"+g.sz+"pt;"),g.outline&&T.push("text-effect: outline;"),g.shadow&&T.push("text-shadow: auto;"),x.push('<span style="'+T.join("")+'">'),g.b&&(x.push("<b>"),S.push("</b>")),g.i&&(x.push("<i>"),S.push("</i>")),g.strike&&(x.push("<s>"),S.push("</s>"));var A=g.valign||"";return A=="superscript"||A=="super"?A="sup":A=="subscript"&&(A="sub"),A!=""&&(x.push("<"+A+">"),S.push("</"+A+">")),S.push("</span>"),g}function y(g){var x=[[],g.v,[]];return g.v?(g.s&&f(g.s,x[0],x[2]),x[0].join("")+x[1].replace(d,"<br/>")+x[2].join("")):""}return function(x){return x.map(y).join("")}}(),W2=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,G2=/<(?:\w+:)?r>/,U2=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Df(c,d){var f=d?d.cellHTML:!0,y={};return c?(c.match(/^\s*<(?:\w+:)?t[^>]*>/)?(y.t=Wt(It(c.slice(c.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),y.r=It(c),f&&(y.h=yf(y.t))):c.match(G2)&&(y.r=It(c),y.t=Wt(It((c.replace(U2,"").match(W2)||[]).join("").replace(sn,""))),f&&(y.h=z2(H2(y.r)))),y):{t:""}}var V2=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,X2=/<(?:\w+:)?(?:si|sstItem)>/g,Y2=/<\/(?:\w+:)?(?:si|sstItem)>/;function $2(c,d){var f=[],y="";if(!c)return f;var g=c.match(V2);if(g){y=g[2].replace(X2,"").split(Y2);for(var x=0;x!=y.length;++x){var S=Df(y[x].trim(),d);S!=null&&(f[f.length]=S)}g=ot(g[1]),f.Count=g.count,f.Unique=g.uniqueCount}return f}var q2=/^\s|\s$|[\t\n\r]/;function Ep(c,d){if(!d.bookSST)return"";var f=[or];f[f.length]=Ue("sst",null,{xmlns:za[0],count:c.Count,uniqueCount:c.Unique});for(var y=0;y!=c.length;++y)if(c[y]!=null){var g=c[y],x="<si>";g.r?x+=g.r:(x+="<t",g.t||(g.t=""),g.t.match(q2)&&(x+=' xml:space="preserve"'),x+=">"+Xt(g.t)+"</t>"),x+="</si>",f[f.length]=x}return f.length>2&&(f[f.length]="</sst>",f[1]=f[1].replace("/>",">")),f.join("")}function K2(c){var d=c.slice(c[0]==="#"?1:0).slice(0,6);return[parseInt(d.slice(0,2),16),parseInt(d.slice(2,4),16),parseInt(d.slice(4,6),16)]}function Z2(c){for(var d=0,f=1;d!=3;++d)f=f*256+(c[d]>255?255:c[d]<0?0:c[d]);return f.toString(16).toUpperCase().slice(1)}function j2(c){var d=c[0]/255,f=c[1]/255,y=c[2]/255,g=Math.max(d,f,y),x=Math.min(d,f,y),S=g-x;if(S===0)return[0,0,d];var T=0,A=0,N=g+x;switch(A=S/(N>1?2-N:N),g){case d:T=((f-y)/S+6)%6;break;case f:T=(y-d)/S+2;break;case y:T=(d-f)/S+4;break}return[T/6,A,N/2]}function J2(c){var d=c[0],f=c[1],y=c[2],g=f*2*(y<.5?y:1-y),x=y-g/2,S=[x,x,x],T=6*d,A;if(f!==0)switch(T|0){case 0:case 6:A=g*T,S[0]+=g,S[1]+=A;break;case 1:A=g*(2-T),S[0]+=A,S[1]+=g;break;case 2:A=g*(T-2),S[1]+=g,S[2]+=A;break;case 3:A=g*(4-T),S[1]+=A,S[2]+=g;break;case 4:A=g*(T-4),S[2]+=g,S[0]+=A;break;case 5:A=g*(6-T),S[2]+=A,S[0]+=g;break}for(var N=0;N!=3;++N)S[N]=Math.round(S[N]*255);return S}function Bf(c,d){if(d===0)return c;var f=j2(K2(c));return d<0?f[2]=f[2]*(1+d):f[2]=1-(1-f[2])*(1-d),Z2(J2(f))}var Q2=6,eS=15,tS=1,Kr=Q2;function nu(c){return Math.floor((c+Math.round(128/Kr)/256)*Kr)}function Ps(c){return Math.floor((c-5)/Kr*100+.5)/100}function iu(c){return Math.round((c*Kr+5)/Kr*256)/256}function Ff(c){return iu(Ps(nu(c)))}function rS(c){var d=Math.abs(c-Ff(c)),f=Kr;if(d>.005)for(Kr=tS;Kr<eS;++Kr)Math.abs(c-Ff(c))<=d&&(d=Math.abs(c-Ff(c)),f=Kr);Kr=f}function Hf(c){c.width?(c.wpx=nu(c.width),c.wch=Ps(c.wpx),c.MDW=Kr):c.wpx?(c.wch=Ps(c.wpx),c.width=iu(c.wch),c.MDW=Kr):typeof c.wch=="number"&&(c.width=iu(c.wch),c.wpx=nu(c.width),c.MDW=Kr),c.customWidth&&delete c.customWidth}var nS=96,Tp=nS;function zf(c){return c*96/Tp}function Wf(c){return c*Tp/96}function iS(c,d,f,y){d.Borders=[];var g={},x=!1;(c[0].match(sn)||[]).forEach(function(S){var T=ot(S);switch(Gi(T[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":g={},T.diagonalUp&&(g.diagonalUp=jt(T.diagonalUp)),T.diagonalDown&&(g.diagonalDown=jt(T.diagonalDown)),d.Borders.push(g);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":x=!0;break;case"</ext>":x=!1;break;default:if(y&&y.WTF&&!x)throw new Error("unrecognized "+T[0]+" in borders")}})}function aS(c,d,f,y){d.Fills=[];var g={},x=!1;(c[0].match(sn)||[]).forEach(function(S){var T=ot(S);switch(Gi(T[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":g={},d.Fills.push(g);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":d.Fills.push(g),g={};break;case"<patternFill":case"<patternFill>":T.patternType&&(g.patternType=T.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":g.bgColor||(g.bgColor={}),T.indexed&&(g.bgColor.indexed=parseInt(T.indexed,10)),T.theme&&(g.bgColor.theme=parseInt(T.theme,10)),T.tint&&(g.bgColor.tint=parseFloat(T.tint)),T.rgb&&(g.bgColor.rgb=T.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":g.fgColor||(g.fgColor={}),T.theme&&(g.fgColor.theme=parseInt(T.theme,10)),T.tint&&(g.fgColor.tint=parseFloat(T.tint)),T.rgb!=null&&(g.fgColor.rgb=T.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":x=!0;break;case"</ext>":x=!1;break;default:if(y&&y.WTF&&!x)throw new Error("unrecognized "+T[0]+" in fills")}})}function oS(c,d,f,y){d.Fonts=[];var g={},x=!1;(c[0].match(sn)||[]).forEach(function(S){var T=ot(S);switch(Gi(T[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":d.Fonts.push(g),g={};break;case"<name":T.val&&(g.name=It(T.val));break;case"<name/>":case"</name>":break;case"<b":g.bold=T.val?jt(T.val):1;break;case"<b/>":g.bold=1;break;case"<i":g.italic=T.val?jt(T.val):1;break;case"<i/>":g.italic=1;break;case"<u":switch(T.val){case"none":g.underline=0;break;case"single":g.underline=1;break;case"double":g.underline=2;break;case"singleAccounting":g.underline=33;break;case"doubleAccounting":g.underline=34;break}break;case"<u/>":g.underline=1;break;case"<strike":g.strike=T.val?jt(T.val):1;break;case"<strike/>":g.strike=1;break;case"<outline":g.outline=T.val?jt(T.val):1;break;case"<outline/>":g.outline=1;break;case"<shadow":g.shadow=T.val?jt(T.val):1;break;case"<shadow/>":g.shadow=1;break;case"<condense":g.condense=T.val?jt(T.val):1;break;case"<condense/>":g.condense=1;break;case"<extend":g.extend=T.val?jt(T.val):1;break;case"<extend/>":g.extend=1;break;case"<sz":T.val&&(g.sz=+T.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":T.val&&(g.vertAlign=T.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":T.val&&(g.family=parseInt(T.val,10));break;case"<family/>":case"</family>":break;case"<scheme":T.val&&(g.scheme=T.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(T.val=="1")break;T.codepage=l[parseInt(T.val,10)];break;case"<color":if(g.color||(g.color={}),T.auto&&(g.color.auto=jt(T.auto)),T.rgb)g.color.rgb=T.rgb.slice(-6);else if(T.indexed){g.color.index=parseInt(T.indexed,10);var A=Of[g.color.index];g.color.index==81&&(A=Of[1]),A||(A=Of[1]),g.color.rgb=A[0].toString(16)+A[1].toString(16)+A[2].toString(16)}else T.theme&&(g.color.theme=parseInt(T.theme,10),T.tint&&(g.color.tint=parseFloat(T.tint)),T.theme&&f.themeElements&&f.themeElements.clrScheme&&(g.color.rgb=Bf(f.themeElements.clrScheme[g.color.theme].rgb,g.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":x=!0;break;case"</AlternateContent>":x=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":x=!0;break;case"</ext>":x=!1;break;default:if(y&&y.WTF&&!x)throw new Error("unrecognized "+T[0]+" in fonts")}})}function sS(c,d,f){d.NumberFmt=[];for(var y=$r(mt),g=0;g<y.length;++g)d.NumberFmt[y[g]]=mt[y[g]];var x=c[0].match(sn);if(x)for(g=0;g<x.length;++g){var S=ot(x[g]);switch(Gi(S[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var T=Wt(It(S.formatCode)),A=parseInt(S.numFmtId,10);if(d.NumberFmt[A]=T,A>0){if(A>392){for(A=392;A>60&&d.NumberFmt[A]!=null;--A);d.NumberFmt[A]=T}Es(T,A)}}break;case"</numFmt>":break;default:if(f.WTF)throw new Error("unrecognized "+S[0]+" in numFmts")}}}function lS(c){var d=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(f){for(var y=f[0];y<=f[1];++y)c[y]!=null&&(d[d.length]=Ue("numFmt",null,{numFmtId:y,formatCode:Xt(c[y])}))}),d.length===1?"":(d[d.length]="</numFmts>",d[0]=Ue("numFmts",null,{count:d.length-2}).replace("/>",">"),d.join(""))}var au=["numFmtId","fillId","fontId","borderId","xfId"],ou=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function uS(c,d,f){d.CellXf=[];var y,g=!1;(c[0].match(sn)||[]).forEach(function(x){var S=ot(x),T=0;switch(Gi(S[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(y=S,delete y[0],T=0;T<au.length;++T)y[au[T]]&&(y[au[T]]=parseInt(y[au[T]],10));for(T=0;T<ou.length;++T)y[ou[T]]&&(y[ou[T]]=jt(y[ou[T]]));if(d.NumberFmt&&y.numFmtId>392){for(T=392;T>60;--T)if(d.NumberFmt[y.numFmtId]==d.NumberFmt[T]){y.numFmtId=T;break}}d.CellXf.push(y);break;case"</xf>":break;case"<alignment":case"<alignment/>":var A={};S.vertical&&(A.vertical=S.vertical),S.horizontal&&(A.horizontal=S.horizontal),S.textRotation!=null&&(A.textRotation=S.textRotation),S.indent&&(A.indent=S.indent),S.wrapText&&(A.wrapText=jt(S.wrapText)),y.alignment=A;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":g=!0;break;case"</AlternateContent>":g=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":g=!0;break;case"</ext>":g=!1;break;default:if(f&&f.WTF&&!g)throw new Error("unrecognized "+S[0]+" in cellXfs")}})}function cS(c){var d=[];return d[d.length]=Ue("cellXfs",null),c.forEach(function(f){d[d.length]=Ue("xf",null,f)}),d[d.length]="</cellXfs>",d.length===2?"":(d[0]=Ue("cellXfs",null,{count:d.length-2}).replace("/>",">"),d.join(""))}var fS=function(){var d=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,f=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,y=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,g=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,x=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(T,A,N){var O={};if(!T)return O;T=T.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var F;return(F=T.match(d))&&sS(F,O,N),(F=T.match(g))&&oS(F,O,A,N),(F=T.match(y))&&aS(F,O,A,N),(F=T.match(x))&&iS(F,O,A,N),(F=T.match(f))&&uS(F,O,N),O}}();function _p(c,d){var f=[or,Ue("styleSheet",null,{xmlns:za[0],"xmlns:vt":hr.vt})],y;return c.SSF&&(y=lS(c.SSF))!=null&&(f[f.length]=y),f[f.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',f[f.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',f[f.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',f[f.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(y=cS(d.cellXfs))&&(f[f.length]=y),f[f.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',f[f.length]='<dxfs count="0"/>',f[f.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',f.length>2&&(f[f.length]="</styleSheet>",f[1]=f[1].replace("/>",">")),f.join("")}var hS=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function dS(c,d,f){d.themeElements.clrScheme=[];var y={};(c[0].match(sn)||[]).forEach(function(g){var x=ot(g);switch(x[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":y.rgb=x.val;break;case"<a:sysClr":y.rgb=x.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":x[0].charAt(1)==="/"?(d.themeElements.clrScheme[hS.indexOf(x[0])]=y,y={}):y.name=x[0].slice(3,x[0].length-1);break;default:if(f&&f.WTF)throw new Error("Unrecognized "+x[0]+" in clrScheme")}})}function vS(){}function pS(){}var gS=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,mS=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,yS=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function CS(c,d,f){d.themeElements={};var y;[["clrScheme",gS,dS],["fontScheme",mS,vS],["fmtScheme",yS,pS]].forEach(function(g){if(!(y=c.match(g[1])))throw new Error(g[0]+" not found in themeElements");g[2](y,d,f)})}var wS=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function xS(c,d){(!c||c.length===0)&&(c=Gf());var f,y={};if(!(f=c.match(wS)))throw new Error("themeElements not found in theme");return CS(f[0],y,d),y.raw=c,y}function Gf(c,d){if(d&&d.themeXLSX)return d.themeXLSX;if(c&&typeof c.raw=="string")return c.raw;var f=[or];return f[f.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',f[f.length]="<a:themeElements>",f[f.length]='<a:clrScheme name="Office">',f[f.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',f[f.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',f[f.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',f[f.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',f[f.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',f[f.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',f[f.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',f[f.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',f[f.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',f[f.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',f[f.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',f[f.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',f[f.length]="</a:clrScheme>",f[f.length]='<a:fontScheme name="Office">',f[f.length]="<a:majorFont>",f[f.length]='<a:latin typeface="Cambria"/>',f[f.length]='<a:ea typeface=""/>',f[f.length]='<a:cs typeface=""/>',f[f.length]='<a:font script="Jpan" typeface=" "/>',f[f.length]='<a:font script="Hang" typeface=" "/>',f[f.length]='<a:font script="Hans" typeface=""/>',f[f.length]='<a:font script="Hant" typeface=""/>',f[f.length]='<a:font script="Arab" typeface="Times New Roman"/>',f[f.length]='<a:font script="Hebr" typeface="Times New Roman"/>',f[f.length]='<a:font script="Thai" typeface="Tahoma"/>',f[f.length]='<a:font script="Ethi" typeface="Nyala"/>',f[f.length]='<a:font script="Beng" typeface="Vrinda"/>',f[f.length]='<a:font script="Gujr" typeface="Shruti"/>',f[f.length]='<a:font script="Khmr" typeface="MoolBoran"/>',f[f.length]='<a:font script="Knda" typeface="Tunga"/>',f[f.length]='<a:font script="Guru" typeface="Raavi"/>',f[f.length]='<a:font script="Cans" typeface="Euphemia"/>',f[f.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',f[f.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',f[f.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',f[f.length]='<a:font script="Thaa" typeface="MV Boli"/>',f[f.length]='<a:font script="Deva" typeface="Mangal"/>',f[f.length]='<a:font script="Telu" typeface="Gautami"/>',f[f.length]='<a:font script="Taml" typeface="Latha"/>',f[f.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',f[f.length]='<a:font script="Orya" typeface="Kalinga"/>',f[f.length]='<a:font script="Mlym" typeface="Kartika"/>',f[f.length]='<a:font script="Laoo" typeface="DokChampa"/>',f[f.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',f[f.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',f[f.length]='<a:font script="Viet" typeface="Times New Roman"/>',f[f.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',f[f.length]='<a:font script="Geor" typeface="Sylfaen"/>',f[f.length]="</a:majorFont>",f[f.length]="<a:minorFont>",f[f.length]='<a:latin typeface="Calibri"/>',f[f.length]='<a:ea typeface=""/>',f[f.length]='<a:cs typeface=""/>',f[f.length]='<a:font script="Jpan" typeface=" "/>',f[f.length]='<a:font script="Hang" typeface=" "/>',f[f.length]='<a:font script="Hans" typeface=""/>',f[f.length]='<a:font script="Hant" typeface=""/>',f[f.length]='<a:font script="Arab" typeface="Arial"/>',f[f.length]='<a:font script="Hebr" typeface="Arial"/>',f[f.length]='<a:font script="Thai" typeface="Tahoma"/>',f[f.length]='<a:font script="Ethi" typeface="Nyala"/>',f[f.length]='<a:font script="Beng" typeface="Vrinda"/>',f[f.length]='<a:font script="Gujr" typeface="Shruti"/>',f[f.length]='<a:font script="Khmr" typeface="DaunPenh"/>',f[f.length]='<a:font script="Knda" typeface="Tunga"/>',f[f.length]='<a:font script="Guru" typeface="Raavi"/>',f[f.length]='<a:font script="Cans" typeface="Euphemia"/>',f[f.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',f[f.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',f[f.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',f[f.length]='<a:font script="Thaa" typeface="MV Boli"/>',f[f.length]='<a:font script="Deva" typeface="Mangal"/>',f[f.length]='<a:font script="Telu" typeface="Gautami"/>',f[f.length]='<a:font script="Taml" typeface="Latha"/>',f[f.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',f[f.length]='<a:font script="Orya" typeface="Kalinga"/>',f[f.length]='<a:font script="Mlym" typeface="Kartika"/>',f[f.length]='<a:font script="Laoo" typeface="DokChampa"/>',f[f.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',f[f.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',f[f.length]='<a:font script="Viet" typeface="Arial"/>',f[f.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',f[f.length]='<a:font script="Geor" typeface="Sylfaen"/>',f[f.length]="</a:minorFont>",f[f.length]="</a:fontScheme>",f[f.length]='<a:fmtScheme name="Office">',f[f.length]="<a:fillStyleLst>",f[f.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',f[f.length]='<a:gradFill rotWithShape="1">',f[f.length]="<a:gsLst>",f[f.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',f[f.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',f[f.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',f[f.length]="</a:gsLst>",f[f.length]='<a:lin ang="16200000" scaled="1"/>',f[f.length]="</a:gradFill>",f[f.length]='<a:gradFill rotWithShape="1">',f[f.length]="<a:gsLst>",f[f.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',f[f.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',f[f.length]="</a:gsLst>",f[f.length]='<a:lin ang="16200000" scaled="0"/>',f[f.length]="</a:gradFill>",f[f.length]="</a:fillStyleLst>",f[f.length]="<a:lnStyleLst>",f[f.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',f[f.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',f[f.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',f[f.length]="</a:lnStyleLst>",f[f.length]="<a:effectStyleLst>",f[f.length]="<a:effectStyle>",f[f.length]="<a:effectLst>",f[f.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',f[f.length]="</a:effectLst>",f[f.length]="</a:effectStyle>",f[f.length]="<a:effectStyle>",f[f.length]="<a:effectLst>",f[f.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',f[f.length]="</a:effectLst>",f[f.length]="</a:effectStyle>",f[f.length]="<a:effectStyle>",f[f.length]="<a:effectLst>",f[f.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',f[f.length]="</a:effectLst>",f[f.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',f[f.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',f[f.length]="</a:effectStyle>",f[f.length]="</a:effectStyleLst>",f[f.length]="<a:bgFillStyleLst>",f[f.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',f[f.length]='<a:gradFill rotWithShape="1">',f[f.length]="<a:gsLst>",f[f.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',f[f.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',f[f.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',f[f.length]="</a:gsLst>",f[f.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',f[f.length]="</a:gradFill>",f[f.length]='<a:gradFill rotWithShape="1">',f[f.length]="<a:gsLst>",f[f.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',f[f.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',f[f.length]="</a:gsLst>",f[f.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',f[f.length]="</a:gradFill>",f[f.length]="</a:bgFillStyleLst>",f[f.length]="</a:fmtScheme>",f[f.length]="</a:themeElements>",f[f.length]="<a:objectDefaults>",f[f.length]="<a:spDef>",f[f.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',f[f.length]="</a:spDef>",f[f.length]="<a:lnDef>",f[f.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',f[f.length]="</a:lnDef>",f[f.length]="</a:objectDefaults>",f[f.length]="<a:extraClrSchemeLst/>",f[f.length]="</a:theme>",f.join("")}function bS(c,d,f){var y={Types:[],Cell:[],Value:[]};if(!c)return y;var g=!1,x=2,S;return c.replace(sn,function(T){var A=ot(T);switch(Gi(A[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":y.Types.push({name:A.name});break;case"</metadataType>":break;case"<futureMetadata":for(var N=0;N<y.Types.length;++N)y.Types[N].name==A.name&&(S=y.Types[N]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":x==1?y.Cell.push({type:y.Types[A.t-1].name,index:+A.v}):x==0&&y.Value.push({type:y.Types[A.t-1].name,index:+A.v});break;case"</rc>":break;case"<cellMetadata":x=1;break;case"</cellMetadata>":x=2;break;case"<valueMetadata":x=0;break;case"</valueMetadata>":x=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":g=!0;break;case"</ext>":g=!1;break;case"<rvb":if(!S)break;S.offsets||(S.offsets=[]),S.offsets.push(+A.i);break;default:if(!g&&f.WTF)throw new Error("unrecognized "+A[0]+" in metadata")}return T}),y}function Rp(){var c=[or];return c.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),c.join("")}function Oz(){}function SS(c,d,f,y){if(!c)return c;var g=y||{},x=!1;m2(c,function(T,A,N){switch(N){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:x=!0;break;case 36:x=!1;break;default:if(!A.T){if(!x||g.WTF)throw new Error("Unexpected record 0x"+N.toString(16))}}},g)}function ES(c,d){if(!c)return"??";var f=(c.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return d["!id"][f].Target}var Mo=1024;function Lp(c,d){for(var f=[21600,21600],y=["m0,0l0",f[1],f[0],f[1],f[0],"0xe"].join(","),g=[Ue("xml",null,{"xmlns:v":eu.v,"xmlns:o":eu.o,"xmlns:x":eu.x,"xmlns:mv":eu.mv}).replace(/\/>/,">"),Ue("o:shapelayout",Ue("o:idmap",null,{"v:ext":"edit",data:c}),{"v:ext":"edit"}),Ue("v:shapetype",[Ue("v:stroke",null,{joinstyle:"miter"}),Ue("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:f.join(","),path:y})];Mo<c*1e3;)Mo+=1e3;return d.forEach(function(x){var S=Br(x[0]),T={color2:"#BEFF82",type:"gradient"};T.type=="gradient"&&(T.angle="-180");var A=T.type=="gradient"?Ue("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,N=Ue("v:fill",A,T),O={on:"t",obscured:"t"};++Mo,g=g.concat(["<v:shape"+Ms({id:"_x0000_s"+Mo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(x[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",N,Ue("v:shadow",null,O),Ue("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",$n("x:Anchor",[S.c+1,0,S.r+1,0,S.c+3,20,S.r+5,20].join(",")),$n("x:AutoFill","False"),$n("x:Row",String(S.r)),$n("x:Column",String(S.c)),x[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),g.push("</xml>"),g.join("")}function Mp(c,d,f,y){var g=Array.isArray(c),x;d.forEach(function(S){var T=Br(S.ref);if(g?(c[T.r]||(c[T.r]=[]),x=c[T.r][T.c]):x=c[S.ref],!x){x={t:"z"},g?c[T.r][T.c]=x:c[S.ref]=x;var A=lr(c["!ref"]||"BDWGO1000001:A1");A.s.r>T.r&&(A.s.r=T.r),A.e.r<T.r&&(A.e.r=T.r),A.s.c>T.c&&(A.s.c=T.c),A.e.c<T.c&&(A.e.c=T.c);var N=sr(A);N!==c["!ref"]&&(c["!ref"]=N)}x.c||(x.c=[]);var O={a:S.author,t:S.t,r:S.r,T:f};S.h&&(O.h=S.h);for(var F=x.c.length-1;F>=0;--F){if(!f&&x.c[F].T)return;f&&!x.c[F].T&&x.c.splice(F,1)}if(f&&y){for(F=0;F<y.length;++F)if(O.a==y[F].id){O.a=y[F].name||O.a;break}}x.c.push(O)})}function TS(c,d){if(c.match(/<(?:\w+:)?comments *\/>/))return[];var f=[],y=[],g=c.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);g&&g[1]&&g[1].split(/<\/\w*:?author>/).forEach(function(S){if(!(S===""||S.trim()==="")){var T=S.match(/<(?:\w+:)?author[^>]*>(.*)/);T&&f.push(T[1])}});var x=c.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return x&&x[1]&&x[1].split(/<\/\w*:?comment>/).forEach(function(S){if(!(S===""||S.trim()==="")){var T=S.match(/<(?:\w+:)?comment[^>]*>/);if(T){var A=ot(T[0]),N={author:A.authorId&&f[A.authorId]||"sheetjsghost",ref:A.ref,guid:A.guid},O=Br(A.ref);if(!(d.sheetRows&&d.sheetRows<=O.r)){var F=S.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),W=!!F&&!!F[1]&&Df(F[1])||{r:"",t:"",h:""};N.r=W.r,W.r=="<t></t>"&&(W.t=W.h=""),N.t=(W.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),d.cellHTML&&(N.h=W.h),y.push(N)}}}}),y}function Op(c){var d=[or,Ue("comments",null,{xmlns:za[0]})],f=[];return d.push("<authors>"),c.forEach(function(y){y[1].forEach(function(g){var x=Xt(g.a);f.indexOf(x)==-1&&(f.push(x),d.push("<author>"+x+"</author>")),g.T&&g.ID&&f.indexOf("tc="+g.ID)==-1&&(f.push("tc="+g.ID),d.push("<author>tc="+g.ID+"</author>"))})}),f.length==0&&(f.push("SheetJ5"),d.push("<author>SheetJ5</author>")),d.push("</authors>"),d.push("<commentList>"),c.forEach(function(y){var g=0,x=[];if(y[1][0]&&y[1][0].T&&y[1][0].ID?g=f.indexOf("tc="+y[1][0].ID):y[1].forEach(function(A){A.a&&(g=f.indexOf(Xt(A.a))),x.push(A.t||"")}),d.push('<comment ref="'+y[0]+'" authorId="'+g+'"><text>'),x.length<=1)d.push($n("t",Xt(x[0]||"")));else{for(var S=`Comment:
    `+x[0]+`
`,T=1;T<x.length;++T)S+=`Reply:
    `+x[T]+`
`;d.push($n("t",Xt(S)))}d.push("</text></comment>")}),d.push("</commentList>"),d.length>2&&(d[d.length]="</comments>",d[1]=d[1].replace("/>",">")),d.join("")}function _S(c,d){var f=[],y=!1,g={},x=0;return c.replace(sn,function(T,A){var N=ot(T);switch(Gi(N[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":g={author:N.personId,guid:N.id,ref:N.ref,T:1};break;case"</threadedComment>":g.t!=null&&f.push(g);break;case"<text>":case"<text":x=A+T.length;break;case"</text>":g.t=c.slice(x,A).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":y=!0;break;case"</mentions>":y=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":y=!0;break;case"</ext>":y=!1;break;default:if(!y&&d.WTF)throw new Error("unrecognized "+N[0]+" in threaded comments")}return T}),f}function RS(c,d,f){var y=[or,Ue("ThreadedComments",null,{xmlns:hr.TCMNT}).replace(/[\/]>/,">")];return c.forEach(function(g){var x="";(g[1]||[]).forEach(function(S,T){if(!S.T){delete S.ID;return}S.a&&d.indexOf(S.a)==-1&&d.push(S.a);var A={ref:g[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+f.tcid++).slice(-12)+"}"};T==0?x=A.id:A.parentId=x,S.ID=A.id,S.a&&(A.personId="{54EE7950-7262-4200-6969-"+("000000000000"+d.indexOf(S.a)).slice(-12)+"}"),y.push(Ue("threadedComment",$n("text",S.t||""),A))})}),y.push("</ThreadedComments>"),y.join("")}function LS(c,d){var f=[],y=!1;return c.replace(sn,function(x){var S=ot(x);switch(Gi(S[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":f.push({name:S.displayname,id:S.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":y=!0;break;case"</ext>":y=!1;break;default:if(!y&&d.WTF)throw new Error("unrecognized "+S[0]+" in threaded comments")}return x}),f}function MS(c){var d=[or,Ue("personList",null,{xmlns:hr.TCMNT,"xmlns:x":za[0]}).replace(/[\/]>/,">")];return c.forEach(function(f,y){d.push(Ue("person",null,{displayName:f,id:"{54EE7950-7262-4200-6969-"+("000000000000"+y).slice(-12)+"}",userId:f,providerId:"None"}))}),d.push("</personList>"),d.join("")}var OS="application/vnd.ms-office.vbaProject",Ap=["xlsb","xlsm","xlam","biff8","xla"];function AS(){return{"!type":"dialog"}}function NS(){return{"!type":"dialog"}}function kS(){return{"!type":"macro"}}function IS(){return{"!type":"macro"}}var PS=function(){var c=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,d={r:0,c:0};function f(y,g,x,S){var T=!1,A=!1;x.length==0?A=!0:x.charAt(0)=="["&&(A=!0,x=x.slice(1,-1)),S.length==0?T=!0:S.charAt(0)=="["&&(T=!0,S=S.slice(1,-1));var N=x.length>0?parseInt(x,10)|0:0,O=S.length>0?parseInt(S,10)|0:0;return T?O+=d.c:--O,A?N+=d.r:--N,g+(T?"":"$")+Vi(O)+(A?"":"$")+mi(N)}return function(g,x){return d=x,g.replace(c,f)}}(),Uf=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,DS=function(){return function(d,f){return d.replace(Uf,function(y,g,x,S,T,A){var N=Mf(S)-(x?0:f.c),O=Lf(A)-(T?0:f.r),F=O==0?"":T?O+1:"["+O+"]",W=N==0?"":x?N+1:"["+N+"]";return g+"R"+F+"C"+W})}}();function Np(c,d){return c.replace(Uf,function(f,y,g,x,S,T){return y+(g=="$"?g+x:Vi(Mf(x)+d.c))+(S=="$"?S+T:mi(Lf(T)+d.r))})}function BS(c,d,f){var y=Xi(d),g=y.s,x=Br(f),S={r:x.r-g.r,c:x.c-g.c};return Np(c,S)}function FS(c){return c.length!=1}function kp(c){return c.replace(/_xlfn\./g,"")}function Ip(c){return c.slice(0,3)=="of:"&&(c=c.slice(3)),c.charCodeAt(0)==61&&(c=c.slice(1),c.charCodeAt(0)==61&&(c=c.slice(1))),c=c.replace(/COM\.MICROSOFT\./g,""),c=c.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(d,f){return f.replace(/\./g,"")}),c=c.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),c.replace(/[;~]/g,",").replace(/\|/g,";")}function HS(c){var d="of:="+c.replace(Uf,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return d.replace(/;/g,"|").replace(/,/g,";")}function Vf(c){var d=c.split(":"),f=d[0].split(".")[0];return[f,d[0].split(".")[1]+(d.length>1?":"+(d[1].split(".")[1]||d[1].split(".")[0]):"")]}function zS(c){return c.replace(/\./,"!")}var su={},Oo={},Ds=typeof Map<"u";function WS(c,d,f){var y=0,g=c.length;if(f){if(Ds?f.has(d):Object.prototype.hasOwnProperty.call(f,d)){for(var x=Ds?f.get(d):f[d];y<x.length;++y)if(c[x[y]].t===d)return c.Count++,x[y]}}else for(;y<g;++y)if(c[y].t===d)return c.Count++,y;return c[g]={t:d},c.Count++,c.Unique++,f&&(Ds?(f.has(d)||f.set(d,[]),f.get(d).push(g)):(Object.prototype.hasOwnProperty.call(f,d)||(f[d]=[]),f[d].push(g))),g}function GS(c,d){var f={min:c+1,max:c+1},y=-1;return d.MDW&&(Kr=d.MDW),d.width!=null?f.customWidth=1:d.wpx!=null?y=Ps(d.wpx):d.wch!=null&&(y=d.wch),y>-1?(f.width=iu(y),f.customWidth=1):d.width!=null&&(f.width=d.width),d.hidden&&(f.hidden=!0),d.level!=null&&(f.outlineLevel=f.level=d.level),f}function US(c,d){if(c){var f=[.7,.7,.75,.75,.3,.3];c.left==null&&(c.left=f[0]),c.right==null&&(c.right=f[1]),c.top==null&&(c.top=f[2]),c.bottom==null&&(c.bottom=f[3]),c.header==null&&(c.header=f[4]),c.footer==null&&(c.footer=f[5])}}function Xf(c,d,f){var y=f.revssf[d.z!=null?d.z:"General"],g=60,x=c.length;if(y==null&&f.ssf){for(;g<392;++g)if(f.ssf[g]==null){Es(d.z,g),f.ssf[g]=d.z,f.revssf[d.z]=y=g;break}}for(g=0;g!=x;++g)if(c[g].numFmtId===y)return g;return c[x]={numFmtId:y,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},x}function VS(c,d,f,y,g,x){try{y.cellNF&&(c.z=mt[d])}catch(T){if(y.WTF)throw T}if(!(c.t==="z"&&!y.cellStyles)){if(c.t==="d"&&typeof c.v=="string"&&(c.v=yr(c.v)),(!y||y.cellText!==!1)&&c.t!=="z")try{if(mt[d]==null&&Es(Bb[d]||"General",d),c.t==="e")c.w=c.w||Af[c.v];else if(d===0)if(c.t==="n")(c.v|0)===c.v?c.w=c.v.toString(10):c.w=Ss(c.v);else if(c.t==="d"){var S=qr(c.v);(S|0)===S?c.w=S.toString(10):c.w=Ss(S)}else{if(c.v===void 0)return"";c.w=wo(c.v,Oo)}else c.t==="d"?c.w=Yn(d,qr(c.v),Oo):c.w=Yn(d,c.v,Oo)}catch(T){if(y.WTF)throw T}if(y.cellStyles&&f!=null)try{c.s=x.Fills[f],c.s.fgColor&&c.s.fgColor.theme&&!c.s.fgColor.rgb&&(c.s.fgColor.rgb=Bf(g.themeElements.clrScheme[c.s.fgColor.theme].rgb,c.s.fgColor.tint||0),y.WTF&&(c.s.fgColor.raw_rgb=g.themeElements.clrScheme[c.s.fgColor.theme].rgb)),c.s.bgColor&&c.s.bgColor.theme&&(c.s.bgColor.rgb=Bf(g.themeElements.clrScheme[c.s.bgColor.theme].rgb,c.s.bgColor.tint||0),y.WTF&&(c.s.bgColor.raw_rgb=g.themeElements.clrScheme[c.s.bgColor.theme].rgb))}catch(T){if(y.WTF&&x.Fills)throw T}}}function XS(c,d,f){if(c&&c["!ref"]){var y=lr(c["!ref"]);if(y.e.c<y.s.c||y.e.r<y.s.r)throw new Error("Bad range ("+f+"): "+c["!ref"])}}function YS(c,d){var f=lr(d);f.s.r<=f.e.r&&f.s.c<=f.e.c&&f.s.r>=0&&f.s.c>=0&&(c["!ref"]=sr(f))}var $S=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,qS=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,KS=/<(?:\w:)?hyperlink [^>]*>/gm,ZS=/"(\w*:\w*)"/,jS=/<(?:\w:)?col\b[^>]*[\/]?>/g,JS=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,QS=/<(?:\w:)?pageMargins[^>]*\/>/g,Pp=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,eE=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,tE=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function rE(c,d,f,y,g,x,S){if(!c)return c;y||(y={"!id":{}});var T=d.dense?[]:{},A={s:{r:2e6,c:2e6},e:{r:0,c:0}},N="",O="",F=c.match(qS);F?(N=c.slice(0,F.index),O=c.slice(F.index+F[0].length)):N=O=c;var W=N.match(Pp);W?Yf(W[0],T,g,f):(W=N.match(eE))&&iE(W[0],W[1]||"",T,g,f);var H=(N.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(H>0){var X=N.slice(H,H+50).match(ZS);X&&YS(T,X[1])}var B=N.match(tE);B&&B[1]&&mE(B[1],g);var G=[];if(d.cellStyles){var ie=N.match(jS);ie&&hE(G,ie)}F&&wE(F[1],T,d,A,x,S);var ae=O.match(JS);ae&&(T["!autofilter"]=vE(ae[0]));var de=[],we=O.match($S);if(we)for(H=0;H!=we.length;++H)de[H]=lr(we[H].slice(we[H].indexOf('"')+1));var xe=O.match(KS);xe&&uE(T,xe,y);var he=O.match(QS);if(he&&(T["!margins"]=cE(ot(he[0]))),!T["!ref"]&&A.e.c>=A.s.c&&A.e.r>=A.s.r&&(T["!ref"]=sr(A)),d.sheetRows>0&&T["!ref"]){var ee=lr(T["!ref"]);d.sheetRows<=+ee.e.r&&(ee.e.r=d.sheetRows-1,ee.e.r>A.e.r&&(ee.e.r=A.e.r),ee.e.r<ee.s.r&&(ee.s.r=ee.e.r),ee.e.c>A.e.c&&(ee.e.c=A.e.c),ee.e.c<ee.s.c&&(ee.s.c=ee.e.c),T["!fullref"]=T["!ref"],T["!ref"]=sr(ee))}return G.length>0&&(T["!cols"]=G),de.length>0&&(T["!merges"]=de),T}function nE(c){if(c.length===0)return"";for(var d='<mergeCells count="'+c.length+'">',f=0;f!=c.length;++f)d+='<mergeCell ref="'+sr(c[f])+'"/>';return d+"</mergeCells>"}function Yf(c,d,f,y){var g=ot(c);f.Sheets[y]||(f.Sheets[y]={}),g.codeName&&(f.Sheets[y].CodeName=Wt(It(g.codeName)))}function iE(c,d,f,y,g){Yf(c.slice(0,c.indexOf(">")),f,y,g)}function aE(c,d,f,y,g){var x=!1,S={},T=null;if(y.bookType!=="xlsx"&&d.vbaraw){var A=d.SheetNames[f];try{d.Workbook&&(A=d.Workbook.Sheets[f].CodeName||A)}catch{}x=!0,S.codeName=Ui(Xt(A))}if(c&&c["!outline"]){var N={summaryBelow:1,summaryRight:1};c["!outline"].above&&(N.summaryBelow=0),c["!outline"].left&&(N.summaryRight=0),T=(T||"")+Ue("outlinePr",null,N)}!x&&!T||(g[g.length]=Ue("sheetPr",T,S))}var oE=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sE=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function lE(c){var d={sheet:1};return oE.forEach(function(f){c[f]!=null&&c[f]&&(d[f]="1")}),sE.forEach(function(f){c[f]!=null&&!c[f]&&(d[f]="0")}),c.password&&(d.password=crypto_CreatePasswordVerifier_Method1(c.password).toString(16).toUpperCase()),Ue("sheetProtection",null,d)}function uE(c,d,f){for(var y=Array.isArray(c),g=0;g!=d.length;++g){var x=ot(It(d[g]),!0);if(!x.ref)return;var S=((f||{})["!id"]||[])[x.id];S?(x.Target=S.Target,x.location&&(x.Target+="#"+Wt(x.location))):(x.Target="#"+Wt(x.location),S={Target:x.Target,TargetMode:"Internal"}),x.Rel=S,x.tooltip&&(x.Tooltip=x.tooltip,delete x.tooltip);for(var T=lr(x.ref),A=T.s.r;A<=T.e.r;++A)for(var N=T.s.c;N<=T.e.c;++N){var O=er({c:N,r:A});y?(c[A]||(c[A]=[]),c[A][N]||(c[A][N]={t:"z",v:void 0}),c[A][N].l=x):(c[O]||(c[O]={t:"z",v:void 0}),c[O].l=x)}}}function cE(c){var d={};return["left","right","top","bottom","header","footer"].forEach(function(f){c[f]&&(d[f]=parseFloat(c[f]))}),d}function fE(c){return US(c),Ue("pageMargins",null,c)}function hE(c,d){for(var f=!1,y=0;y!=d.length;++y){var g=ot(d[y],!0);g.hidden&&(g.hidden=jt(g.hidden));var x=parseInt(g.min,10)-1,S=parseInt(g.max,10)-1;for(g.outlineLevel&&(g.level=+g.outlineLevel||0),delete g.min,delete g.max,g.width=+g.width,!f&&g.width&&(f=!0,rS(g.width)),Hf(g);x<=S;)c[x++]=Dr(g)}}function dE(c,d){for(var f=["<cols>"],y,g=0;g!=d.length;++g)(y=d[g])&&(f[f.length]=Ue("col",null,GS(g,y)));return f[f.length]="</cols>",f.join("")}function vE(c){var d={ref:(c.match(/ref="([^"]*)"/)||[])[1]};return d}function pE(c,d,f,y){var g=typeof c.ref=="string"?c.ref:sr(c.ref);f.Workbook||(f.Workbook={Sheets:[]}),f.Workbook.Names||(f.Workbook.Names=[]);var x=f.Workbook.Names,S=Xi(g);S.s.r==S.e.r&&(S.e.r=Xi(d["!ref"]).e.r,g=sr(S));for(var T=0;T<x.length;++T){var A=x[T];if(A.Name=="_xlnm._FilterDatabase"&&A.Sheet==y){A.Ref="'"+f.SheetNames[y]+"'!"+g;break}}return T==x.length&&x.push({Name:"_xlnm._FilterDatabase",Sheet:y,Ref:"'"+f.SheetNames[y]+"'!"+g}),Ue("autoFilter",null,{ref:g})}var gE=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function mE(c,d){d.Views||(d.Views=[{}]),(c.match(gE)||[]).forEach(function(f,y){var g=ot(f);d.Views[y]||(d.Views[y]={}),+g.zoomScale&&(d.Views[y].zoom=+g.zoomScale),jt(g.rightToLeft)&&(d.Views[y].RTL=!0)})}function yE(c,d,f,y){var g={workbookViewId:"0"};return(((y||{}).Workbook||{}).Views||[])[0]&&(g.rightToLeft=y.Workbook.Views[0].RTL?"1":"0"),Ue("sheetViews",Ue("sheetView",null,g),{})}function CE(c,d,f,y){if(c.c&&f["!comments"].push([d,c.c]),c.v===void 0&&typeof c.f!="string"||c.t==="z"&&!c.f)return"";var g="",x=c.t,S=c.v;if(c.t!=="z")switch(c.t){case"b":g=c.v?"1":"0";break;case"n":g=""+c.v;break;case"e":g=Af[c.v];break;case"d":y&&y.cellDates?g=yr(c.v,-1).toISOString():(c=Dr(c),c.t="n",g=""+(c.v=qr(yr(c.v)))),typeof c.z>"u"&&(c.z=mt[14]);break;default:g=c.v;break}var T=$n("v",Xt(g)),A={r:d},N=Xf(y.cellXfs,c,y);switch(N!==0&&(A.s=N),c.t){case"n":break;case"d":A.t="d";break;case"b":A.t="b";break;case"e":A.t="e";break;case"z":break;default:if(c.v==null){delete c.t;break}if(c.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(y&&y.bookSST){T=$n("v",""+WS(y.Strings,c.v,y.revStrings)),A.t="s";break}A.t="str";break}if(c.t!=x&&(c.t=x,c.v=S),typeof c.f=="string"&&c.f){var O=c.F&&c.F.slice(0,d.length)==d?{t:"array",ref:c.F}:null;T=Ue("f",Xt(c.f),O)+(c.v!=null?T:"")}return c.l&&f["!links"].push([d,c.l]),c.D&&(A.cm=1),Ue("c",T,A)}var wE=function(){var c=/<(?:\w+:)?c[ \/>]/,d=/<\/(?:\w+:)?row>/,f=/r=["']([^"']*)["']/,y=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,g=/ref=["']([^"']*)["']/,x=Ls("v"),S=Ls("f");return function(A,N,O,F,W,H){for(var X=0,B="",G=[],ie=[],ae=0,de=0,we=0,xe="",he,ee,Ee=0,Ce=0,Oe,Re,Ae=0,Ve=0,ft=Array.isArray(H.CellXf),Ye,gt=[],Gt=[],Yi=Array.isArray(N),Et=[],yt={},Pt=!1,yn=!!O.sheetStubs,In=A.split(d),Pn=0,Ci=In.length;Pn!=Ci;++Pn){B=In[Pn].trim();var qn=B.length;if(qn!==0){var Jt=0;e:for(X=0;X<qn;++X)switch(B[X]){case">":if(B[X-1]!="/"){++X;break e}if(O&&O.cellStyles){if(ee=ot(B.slice(Jt,X),!0),Ee=ee.r!=null?parseInt(ee.r,10):Ee+1,Ce=-1,O.sheetRows&&O.sheetRows<Ee)continue;yt={},Pt=!1,ee.ht&&(Pt=!0,yt.hpt=parseFloat(ee.ht),yt.hpx=Wf(yt.hpt)),ee.hidden=="1"&&(Pt=!0,yt.hidden=!0),ee.outlineLevel!=null&&(Pt=!0,yt.level=+ee.outlineLevel),Pt&&(Et[Ee-1]=yt)}break;case"<":Jt=X;break}if(Jt>=X)break;if(ee=ot(B.slice(Jt,X),!0),Ee=ee.r!=null?parseInt(ee.r,10):Ee+1,Ce=-1,!(O.sheetRows&&O.sheetRows<Ee)){F.s.r>Ee-1&&(F.s.r=Ee-1),F.e.r<Ee-1&&(F.e.r=Ee-1),O&&O.cellStyles&&(yt={},Pt=!1,ee.ht&&(Pt=!0,yt.hpt=parseFloat(ee.ht),yt.hpx=Wf(yt.hpt)),ee.hidden=="1"&&(Pt=!0,yt.hidden=!0),ee.outlineLevel!=null&&(Pt=!0,yt.level=+ee.outlineLevel),Pt&&(Et[Ee-1]=yt)),G=B.slice(X).split(c);for(var $i=0;$i!=G.length&&G[$i].trim().charAt(0)=="<";++$i);for(G=G.slice($i),X=0;X!=G.length;++X)if(B=G[X].trim(),B.length!==0){if(ie=B.match(f),ae=X,de=0,we=0,B="<c "+(B.slice(0,1)=="<"?">":"")+B,ie!=null&&ie.length===2){for(ae=0,xe=ie[1],de=0;de!=xe.length&&!((we=xe.charCodeAt(de)-64)<1||we>26);++de)ae=26*ae+we;--ae,Ce=ae}else++Ce;for(de=0;de!=B.length&&B.charCodeAt(de)!==62;++de);if(++de,ee=ot(B.slice(0,de),!0),ee.r||(ee.r=er({r:Ee-1,c:Ce})),xe=B.slice(de),he={t:""},(ie=xe.match(x))!=null&&ie[1]!==""&&(he.v=Wt(ie[1])),O.cellFormula){if((ie=xe.match(S))!=null&&ie[1]!==""){if(he.f=Wt(It(ie[1])).replace(/\r\n/g,`
`),O.xlfn||(he.f=kp(he.f)),ie[0].indexOf('t="array"')>-1)he.F=(xe.match(g)||[])[1],he.F.indexOf(":")>-1&&gt.push([lr(he.F),he.F]);else if(ie[0].indexOf('t="shared"')>-1){Re=ot(ie[0]);var bt=Wt(It(ie[1]));O.xlfn||(bt=kp(bt)),Gt[parseInt(Re.si,10)]=[Re,bt,ee.r]}}else(ie=xe.match(/<f[^>]*\/>/))&&(Re=ot(ie[0]),Gt[Re.si]&&(he.f=BS(Gt[Re.si][1],Gt[Re.si][2],ee.r)));var Mr=Br(ee.r);for(de=0;de<gt.length;++de)Mr.r>=gt[de][0].s.r&&Mr.r<=gt[de][0].e.r&&Mr.c>=gt[de][0].s.c&&Mr.c<=gt[de][0].e.c&&(he.F=gt[de][1])}if(ee.t==null&&he.v===void 0)if(he.f||he.F)he.v=0,he.t="n";else if(yn)he.t="z";else continue;else he.t=ee.t||"n";switch(F.s.c>Ce&&(F.s.c=Ce),F.e.c<Ce&&(F.e.c=Ce),he.t){case"n":if(he.v==""||he.v==null){if(!yn)continue;he.t="z"}else he.v=parseFloat(he.v);break;case"s":if(typeof he.v>"u"){if(!yn)continue;he.t="z"}else Oe=su[parseInt(he.v,10)],he.v=Oe.t,he.r=Oe.r,O.cellHTML&&(he.h=Oe.h);break;case"str":he.t="s",he.v=he.v!=null?It(he.v):"",O.cellHTML&&(he.h=yf(he.v));break;case"inlineStr":ie=xe.match(y),he.t="s",ie!=null&&(Oe=Df(ie[1]))?(he.v=Oe.t,O.cellHTML&&(he.h=Oe.h)):he.v="";break;case"b":he.v=jt(he.v);break;case"d":O.cellDates?he.v=yr(he.v,1):(he.v=qr(yr(he.v,1)),he.t="n");break;case"e":(!O||O.cellText!==!1)&&(he.w=he.v),he.v=E2[he.v];break}if(Ae=Ve=0,Ye=null,ft&&ee.s!==void 0&&(Ye=H.CellXf[ee.s],Ye!=null&&(Ye.numFmtId!=null&&(Ae=Ye.numFmtId),O.cellStyles&&Ye.fillId!=null&&(Ve=Ye.fillId))),VS(he,Ae,Ve,O,W,H),O.cellDates&&ft&&he.t=="n"&&jl(mt[Ae])&&(he.t="d",he.v=pf(he.v)),ee.cm&&O.xlmeta){var qi=(O.xlmeta.Cell||[])[+ee.cm-1];qi&&qi.type=="XLDAPR"&&(he.D=!0)}if(Yi){var Ki=Br(ee.r);N[Ki.r]||(N[Ki.r]=[]),N[Ki.r][Ki.c]=he}else N[ee.r]=he}}}}Et.length>0&&(N["!rows"]=Et)}}();function xE(c,d,f,y){var g=[],x=[],S=lr(c["!ref"]),T="",A,N="",O=[],F=0,W=0,H=c["!rows"],X=Array.isArray(c),B={r:N},G,ie=-1;for(W=S.s.c;W<=S.e.c;++W)O[W]=Vi(W);for(F=S.s.r;F<=S.e.r;++F){for(x=[],N=mi(F),W=S.s.c;W<=S.e.c;++W){A=O[W]+N;var ae=X?(c[F]||[])[W]:c[A];ae!==void 0&&(T=CE(ae,A,c,d))!=null&&x.push(T)}(x.length>0||H&&H[F])&&(B={r:N},H&&H[F]&&(G=H[F],G.hidden&&(B.hidden=1),ie=-1,G.hpx?ie=zf(G.hpx):G.hpt&&(ie=G.hpt),ie>-1&&(B.ht=ie,B.customHeight=1),G.level&&(B.outlineLevel=G.level)),g[g.length]=Ue("row",x.join(""),B))}if(H)for(;F<H.length;++F)H&&H[F]&&(B={r:F+1},G=H[F],G.hidden&&(B.hidden=1),ie=-1,G.hpx?ie=zf(G.hpx):G.hpt&&(ie=G.hpt),ie>-1&&(B.ht=ie,B.customHeight=1),G.level&&(B.outlineLevel=G.level),g[g.length]=Ue("row","",B));return g.join("")}function Dp(c,d,f,y){var g=[or,Ue("worksheet",null,{xmlns:za[0],"xmlns:r":hr.r})],x=f.SheetNames[c],S=0,T="",A=f.Sheets[x];A==null&&(A={});var N=A["!ref"]||"A1",O=lr(N);if(O.e.c>16383||O.e.r>1048575){if(d.WTF)throw new Error("Range "+N+" exceeds format limit A1:XFD1048576");O.e.c=Math.min(O.e.c,16383),O.e.r=Math.min(O.e.c,1048575),N=sr(O)}y||(y={}),A["!comments"]=[];var F=[];aE(A,f,c,d,g),g[g.length]=Ue("dimension",null,{ref:N}),g[g.length]=yE(A,d,c,f),d.sheetFormat&&(g[g.length]=Ue("sheetFormatPr",null,{defaultRowHeight:d.sheetFormat.defaultRowHeight||"16",baseColWidth:d.sheetFormat.baseColWidth||"10",outlineLevelRow:d.sheetFormat.outlineLevelRow||"7"})),A["!cols"]!=null&&A["!cols"].length>0&&(g[g.length]=dE(A,A["!cols"])),g[S=g.length]="<sheetData/>",A["!links"]=[],A["!ref"]!=null&&(T=xE(A,d),T.length>0&&(g[g.length]=T)),g.length>S+1&&(g[g.length]="</sheetData>",g[S]=g[S].replace("/>",">")),A["!protect"]&&(g[g.length]=lE(A["!protect"])),A["!autofilter"]!=null&&(g[g.length]=pE(A["!autofilter"],A,f,c)),A["!merges"]!=null&&A["!merges"].length>0&&(g[g.length]=nE(A["!merges"]));var W=-1,H,X=-1;return A["!links"].length>0&&(g[g.length]="<hyperlinks>",A["!links"].forEach(function(B){B[1].Target&&(H={ref:B[0]},B[1].Target.charAt(0)!="#"&&(X=Lt(y,-1,Xt(B[1].Target).replace(/#.*$/,""),lt.HLINK),H["r:id"]="rId"+X),(W=B[1].Target.indexOf("#"))>-1&&(H.location=Xt(B[1].Target.slice(W+1))),B[1].Tooltip&&(H.tooltip=Xt(B[1].Tooltip)),g[g.length]=Ue("hyperlink",null,H))}),g[g.length]="</hyperlinks>"),delete A["!links"],A["!margins"]!=null&&(g[g.length]=fE(A["!margins"])),(!d||d.ignoreEC||d.ignoreEC==null)&&(g[g.length]=$n("ignoredErrors",Ue("ignoredError",null,{numberStoredAsText:1,sqref:N}))),F.length>0&&(X=Lt(y,-1,"../drawings/drawing"+(c+1)+".xml",lt.DRAW),g[g.length]=Ue("drawing",null,{"r:id":"rId"+X}),A["!drawing"]=F),A["!comments"].length>0&&(X=Lt(y,-1,"../drawings/vmlDrawing"+(c+1)+".vml",lt.VML),g[g.length]=Ue("legacyDrawing",null,{"r:id":"rId"+X}),A["!legacy"]=X),g.length>1&&(g[g.length]="</worksheet>",g[1]=g[1].replace("/>",">")),g.join("")}function bE(c){var d=[],f=c.match(/^<c:numCache>/),y;(c.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(x){var S=x.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);S&&(d[+S[1]]=f?+S[2]:S[2])});var g=Wt((c.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(c.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(x){y=x.replace(/<.*?>/g,"")}),[d,g,y]}function SE(c,d,f,y,g,x){var S=x||{"!type":"chart"};if(!c)return x;var T=0,A=0,N="A",O={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(c.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(F){var W=bE(F);O.s.r=O.s.c=0,O.e.c=T,N=Vi(T),W[0].forEach(function(H,X){S[N+mi(X)]={t:"n",v:H,z:W[1]},A=X}),O.e.r<A&&(O.e.r=A),++T}),T>0&&(S["!ref"]=sr(O)),S}lt.CS="http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet";function EE(c,d,f,y,g){if(!c)return c;y||(y={"!id":{}});var x={"!type":"chart","!drawel":null,"!rel":""},S,T=c.match(Pp);return T&&Yf(T[0],x,g,f),(S=c.match(/drawing r:id="(.*?)"/))&&(x["!rel"]=S[1]),y["!id"][x["!rel"]]&&(x["!drawel"]=y["!id"][x["!rel"]]),x}var $f=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],TE=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],_E=[],RE=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Bp(c,d){for(var f=0;f!=c.length;++f)for(var y=c[f],g=0;g!=d.length;++g){var x=d[g];if(y[x[0]]==null)y[x[0]]=x[1];else switch(x[2]){case"bool":typeof y[x[0]]=="string"&&(y[x[0]]=jt(y[x[0]]));break;case"int":typeof y[x[0]]=="string"&&(y[x[0]]=parseInt(y[x[0]],10));break}}}function Fp(c,d){for(var f=0;f!=d.length;++f){var y=d[f];if(c[y[0]]==null)c[y[0]]=y[1];else switch(y[2]){case"bool":typeof c[y[0]]=="string"&&(c[y[0]]=jt(c[y[0]]));break;case"int":typeof c[y[0]]=="string"&&(c[y[0]]=parseInt(c[y[0]],10));break}}}function LE(c){Fp(c.WBProps,$f),Fp(c.CalcPr,RE),Bp(c.WBView,TE),Bp(c.Sheets,_E),Oo.date1904=jt(c.WBProps.date1904)}var ME="][*?/\\".split("");function Hp(c,d){if(c.length>31)throw new Error("Sheet names cannot exceed 31 chars");var f=!0;return ME.forEach(function(y){if(c.indexOf(y)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),f}function OE(c,d,f){c.forEach(function(y,g){Hp(y);for(var x=0;x<g;++x)if(y==c[x])throw new Error("Duplicate Sheet Name: "+y);if(f){var S=d&&d[g]&&d[g].CodeName||y;if(S.charCodeAt(0)==95&&S.length>22)throw new Error("Bad Code Name: Worksheet"+S)}})}function zp(c){if(!c||!c.SheetNames||!c.Sheets)throw new Error("Invalid Workbook");if(!c.SheetNames.length)throw new Error("Workbook is empty");var d=c.Workbook&&c.Workbook.Sheets||[];OE(c.SheetNames,d,!!c.vbaraw);for(var f=0;f<c.SheetNames.length;++f)XS(c.Sheets[c.SheetNames[f]],c.SheetNames[f],f)}var AE=/<\w+:workbook/;function NE(c,d){if(!c)throw new Error("Could not find file");var f={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},y=!1,g="xmlns",x={},S=0;if(c.replace(sn,function(A,N){var O=ot(A);switch(Gi(O[0])){case"<?xml":break;case"<workbook":A.match(AE)&&(g="xmlns"+A.match(/<(\w+):/)[1]),f.xmlns=O[g];break;case"</workbook>":break;case"<fileVersion":delete O[0],f.AppVersion=O;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":$f.forEach(function(F){if(O[F[0]]!=null)switch(F[2]){case"bool":f.WBProps[F[0]]=jt(O[F[0]]);break;case"int":f.WBProps[F[0]]=parseInt(O[F[0]],10);break;default:f.WBProps[F[0]]=O[F[0]]}}),O.codeName&&(f.WBProps.CodeName=It(O.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete O[0],f.WBView.push(O);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(O.state){case"hidden":O.Hidden=1;break;case"veryHidden":O.Hidden=2;break;default:O.Hidden=0}delete O.state,O.name=Wt(It(O.name)),delete O[0],f.Sheets.push(O);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":y=!0;break;case"</definedNames>":y=!1;break;case"<definedName":x={},x.Name=It(O.name),O.comment&&(x.Comment=O.comment),O.localSheetId&&(x.Sheet=+O.localSheetId),jt(O.hidden||"0")&&(x.Hidden=!0),S=N+A.length;break;case"</definedName>":x.Ref=Wt(It(c.slice(S,N))),f.Names.push(x);break;case"<definedName/>":break;case"<calcPr":delete O[0],f.CalcPr=O;break;case"<calcPr/>":delete O[0],f.CalcPr=O;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":y=!0;break;case"</ext>":y=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":y=!0;break;case"</AlternateContent>":y=!1;break;case"<revisionPtr":break;default:if(!y&&d.WTF)throw new Error("unrecognized "+O[0]+" in workbook")}return A}),za.indexOf(f.xmlns)===-1)throw new Error("Unknown Namespace: "+f.xmlns);return LE(f),f}function Wp(c){var d=[or];d[d.length]=Ue("workbook",null,{xmlns:za[0],"xmlns:r":hr.r});var f=c.Workbook&&(c.Workbook.Names||[]).length>0,y={codeName:"ThisWorkbook"};c.Workbook&&c.Workbook.WBProps&&($f.forEach(function(T){c.Workbook.WBProps[T[0]]!=null&&c.Workbook.WBProps[T[0]]!=T[1]&&(y[T[0]]=c.Workbook.WBProps[T[0]])}),c.Workbook.WBProps.CodeName&&(y.codeName=c.Workbook.WBProps.CodeName,delete y.CodeName)),d[d.length]=Ue("workbookPr",null,y);var g=c.Workbook&&c.Workbook.Sheets||[],x=0;if(g&&g[0]&&g[0].Hidden){for(d[d.length]="<bookViews>",x=0;x!=c.SheetNames.length&&!(!g[x]||!g[x].Hidden);++x);x==c.SheetNames.length&&(x=0),d[d.length]='<workbookView firstSheet="'+x+'" activeTab="'+x+'"/>',d[d.length]="</bookViews>"}for(d[d.length]="<sheets>",x=0;x!=c.SheetNames.length;++x){var S={name:Xt(c.SheetNames[x].slice(0,31))};if(S.sheetId=""+(x+1),S["r:id"]="rId"+(x+1),g[x])switch(g[x].Hidden){case 1:S.state="hidden";break;case 2:S.state="veryHidden";break}d[d.length]=Ue("sheet",null,S)}return d[d.length]="</sheets>",f&&(d[d.length]="<definedNames>",c.Workbook&&c.Workbook.Names&&c.Workbook.Names.forEach(function(T){var A={name:T.Name};T.Comment&&(A.comment=T.Comment),T.Sheet!=null&&(A.localSheetId=""+T.Sheet),T.Hidden&&(A.hidden="1"),T.Ref&&(d[d.length]=Ue("definedName",Xt(T.Ref),A))}),d[d.length]="</definedNames>"),d.length>2&&(d[d.length]="</workbook>",d[1]=d[1].replace("/>",">")),d.join("")}function kE(c,d,f){return d.slice(-4)===".bin"?parse_wb_bin(c,f):NE(c,f)}function IE(c,d,f,y,g,x,S,T){return d.slice(-4)===".bin"?parse_ws_bin(c,y,f,g,x,S,T):rE(c,y,f,g,x,S,T)}function PE(c,d,f,y,g,x,S,T){return d.slice(-4)===".bin"?parse_cs_bin(c,y,f,g,x,S,T):EE(c,y,f,g,x)}function DE(c,d,f,y,g,x,S,T){return d.slice(-4)===".bin"?kS():IS()}function BE(c,d,f,y,g,x,S,T){return d.slice(-4)===".bin"?AS():NS()}function FE(c,d,f,y){return d.slice(-4)===".bin"?parse_sty_bin(c,f,y):fS(c,f,y)}function HE(c,d,f){return xS(c,f)}function zE(c,d,f){return d.slice(-4)===".bin"?parse_sst_bin(c,f):$2(c,f)}function WE(c,d,f){return d.slice(-4)===".bin"?parse_comments_bin(c,f):TS(c,f)}function GE(c,d,f){return d.slice(-4)===".bin"?parse_cc_bin(c,d,f):parse_cc_xml(c,d,f)}function UE(c,d,f,y){return f.slice(-4)===".bin"?SS(c,d,f,y):void 0}function VE(c,d,f){return d.slice(-4)===".bin"?parse_xlmeta_bin(c,d,f):bS(c,d,f)}function XE(c,d,f){return(d.slice(-4)===".bin"?write_wb_bin:Wp)(c,f)}function YE(c,d,f,y,g){return(d.slice(-4)===".bin"?write_ws_bin:Dp)(c,f,y,g)}function $E(c,d,f){return(d.slice(-4)===".bin"?write_sty_bin:_p)(c,f)}function qE(c,d,f){return(d.slice(-4)===".bin"?write_sst_bin:Ep)(c,f)}function KE(c,d,f){return(d.slice(-4)===".bin"?write_comments_bin:Op)(c,f)}function ZE(c){return(c.slice(-4)===".bin"?write_xlmeta_bin:Rp)()}function jE(c,d,f,y){for(var g=c["!merges"]||[],x=[],S=d.s.c;S<=d.e.c;++S){for(var T=0,A=0,N=0;N<g.length;++N)if(!(g[N].s.r>f||g[N].s.c>S)&&!(g[N].e.r<f||g[N].e.c<S)){if(g[N].s.r<f||g[N].s.c<S){T=-1;break}T=g[N].e.r-g[N].s.r+1,A=g[N].e.c-g[N].s.c+1;break}if(!(T<0)){var O=er({r:f,c:S}),F=y.dense?(c[f]||[])[S]:c[O],W=F&&F.v!=null&&(F.h||yf(F.w||(To(F),F.w)||""))||"",H={};T>1&&(H.rowspan=T),A>1&&(H.colspan=A),y.editable?W='<span contenteditable="true">'+W+"</span>":F&&(H["data-t"]=F&&F.t||"z",F.v!=null&&(H["data-v"]=F.v),F.z!=null&&(H["data-z"]=F.z),F.l&&(F.l.Target||"#").charAt(0)!="#"&&(W='<a href="'+F.l.Target+'">'+W+"</a>")),H.id=(y.id||"sjs")+"-"+O,x.push(Ue("td",W,H))}}var X="<tr>";return X+x.join("")+"</tr>"}var JE='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',QE="</body></html>";function eT(c,d,f){var y=[];return y.join("")+"<table"+(f&&f.id?' id="'+f.id+'"':"")+">"}function Gp(c,d){var f=d||{},y=f.header!=null?f.header:JE,g=f.footer!=null?f.footer:QE,x=[y],S=Xi(c["!ref"]);f.dense=Array.isArray(c),x.push(eT(c,S,f));for(var T=S.s.r;T<=S.e.r;++T)x.push(jE(c,S,T,f));return x.push("</table>"+g),x.join("")}function Up(c,d,f){var y=f||{},g=0,x=0;if(y.origin!=null)if(typeof y.origin=="number")g=y.origin;else{var S=typeof y.origin=="string"?Br(y.origin):y.origin;g=S.r,x=S.c}var T=d.getElementsByTagName("tr"),A=Math.min(y.sheetRows||1e7,T.length),N={s:{r:0,c:0},e:{r:g,c:x}};if(c["!ref"]){var O=Xi(c["!ref"]);N.s.r=Math.min(N.s.r,O.s.r),N.s.c=Math.min(N.s.c,O.s.c),N.e.r=Math.max(N.e.r,O.e.r),N.e.c=Math.max(N.e.c,O.e.c),g==-1&&(N.e.r=g=O.e.r+1)}var F=[],W=0,H=c["!rows"]||(c["!rows"]=[]),X=0,B=0,G=0,ie=0,ae=0,de=0;for(c["!cols"]||(c["!cols"]=[]);X<T.length&&B<A;++X){var we=T[X];if(Xp(we)){if(y.display)continue;H[B]={hidden:!0}}var xe=we.children;for(G=ie=0;G<xe.length;++G){var he=xe[G];if(!(y.display&&Xp(he))){var ee=he.hasAttribute("data-v")?he.getAttribute("data-v"):he.hasAttribute("v")?he.getAttribute("v"):n2(he.innerHTML),Ee=he.getAttribute("data-z")||he.getAttribute("z");for(W=0;W<F.length;++W){var Ce=F[W];Ce.s.c==ie+x&&Ce.s.r<B+g&&B+g<=Ce.e.r&&(ie=Ce.e.c+1-x,W=-1)}de=+he.getAttribute("colspan")||1,((ae=+he.getAttribute("rowspan")||1)>1||de>1)&&F.push({s:{r:B+g,c:ie+x},e:{r:B+g+(ae||1)-1,c:ie+x+(de||1)-1}});var Oe={t:"s",v:ee},Re=he.getAttribute("data-t")||he.getAttribute("t")||"";ee!=null&&(ee.length==0?Oe.t=Re||"z":y.raw||ee.trim().length==0||Re=="s"||(ee==="TRUE"?Oe={t:"b",v:!0}:ee==="FALSE"?Oe={t:"b",v:!1}:isNaN(Wi(ee))?isNaN(_s(ee).getDate())||(Oe={t:"d",v:yr(ee)},y.cellDates||(Oe={t:"n",v:qr(Oe.v)}),Oe.z=y.dateNF||mt[14]):Oe={t:"n",v:Wi(ee)})),Oe.z===void 0&&Ee!=null&&(Oe.z=Ee);var Ae="",Ve=he.getElementsByTagName("A");if(Ve&&Ve.length)for(var ft=0;ft<Ve.length&&!(Ve[ft].hasAttribute("href")&&(Ae=Ve[ft].getAttribute("href"),Ae.charAt(0)!="#"));++ft);Ae&&Ae.charAt(0)!="#"&&(Oe.l={Target:Ae}),y.dense?(c[B+g]||(c[B+g]=[]),c[B+g][ie+x]=Oe):c[er({c:ie+x,r:B+g})]=Oe,N.e.c<ie+x&&(N.e.c=ie+x),ie+=de}}++B}return F.length&&(c["!merges"]=(c["!merges"]||[]).concat(F)),N.e.r=Math.max(N.e.r,B-1+g),c["!ref"]=sr(N),B>=A&&(c["!fullref"]=sr((N.e.r=T.length-X+B-1+g,N))),c}function Vp(c,d){var f=d||{},y=f.dense?[]:{};return Up(y,c,d)}function tT(c,d){return _o(Vp(c,d),d)}function Xp(c){var d="",f=rT(c);return f&&(d=f(c).getPropertyValue("display")),d||(d=c.style&&c.style.display),d==="none"}function rT(c){return c.ownerDocument.defaultView&&typeof c.ownerDocument.defaultView.getComputedStyle=="function"?c.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function nT(c){var d=c.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(y,g){return Array(parseInt(g,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),f=Wt(d.replace(/<[^>]*>/g,""));return[f]}var Yp={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function iT(c,d){var f=d||{},y=j0(c),g=[],x,S,T={name:""},A="",N=0,O,F,W={},H=[],X=f.dense?[]:{},B,G,ie={value:""},ae="",de=0,we=[],xe=-1,he=-1,ee={s:{r:1e6,c:1e7},e:{r:0,c:0}},Ee=0,Ce={},Oe=[],Re={},Ae=0,Ve=0,ft=[],Ye=1,gt=1,Gt=[],Yi={Names:[]},Et={},yt=["",""],Pt=[],yn={},In="",Pn=0,Ci=!1,qn=!1,Jt=0;for(xf.lastIndex=0,y=y.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");B=xf.exec(y);)switch(B[3]=B[3].replace(/_.*$/,"")){case"table":case"":B[1]==="/"?(ee.e.c>=ee.s.c&&ee.e.r>=ee.s.r?X["!ref"]=sr(ee):X["!ref"]="A1:A1",f.sheetRows>0&&f.sheetRows<=ee.e.r&&(X["!fullref"]=X["!ref"],ee.e.r=f.sheetRows-1,X["!ref"]=sr(ee)),Oe.length&&(X["!merges"]=Oe),ft.length&&(X["!rows"]=ft),O.name=O.||O.name,typeof JSON<"u"&&JSON.stringify(O),H.push(O.name),W[O.name]=X,qn=!1):B[0].charAt(B[0].length-2)!=="/"&&(O=ot(B[0],!1),xe=he=-1,ee.s.r=ee.s.c=1e7,ee.e.r=ee.e.c=0,X=f.dense?[]:{},Oe=[],ft=[],qn=!0);break;case"table-row-group":B[1]==="/"?--Ee:++Ee;break;case"table-row":case"":if(B[1]==="/"){xe+=Ye,Ye=1;break}if(F=ot(B[0],!1),F.?xe=F.-1:xe==-1&&(xe=0),Ye=+F["number-rows-repeated"]||1,Ye<10)for(Jt=0;Jt<Ye;++Jt)Ee>0&&(ft[xe+Jt]={level:Ee});he=-1;break;case"covered-table-cell":B[1]!=="/"&&++he,f.sheetStubs&&(f.dense?(X[xe]||(X[xe]=[]),X[xe][he]={t:"z"}):X[er({r:xe,c:he})]={t:"z"}),ae="",we=[];break;case"table-cell":case"":if(B[0].charAt(B[0].length-2)==="/")++he,ie=ot(B[0],!1),gt=parseInt(ie["number-columns-repeated"]||"1",10),G={t:"z",v:null},ie.formula&&f.cellFormula!=!1&&(G.f=Ip(Wt(ie.formula))),(ie.||ie["value-type"])=="string"&&(G.t="s",G.v=Wt(ie["string-value"]||""),f.dense?(X[xe]||(X[xe]=[]),X[xe][he]=G):X[er({r:xe,c:he})]=G),he+=gt-1;else if(B[1]!=="/"){++he,ae="",de=0,we=[],gt=1;var $i=Ye?xe+Ye-1:xe;if(he>ee.e.c&&(ee.e.c=he),he<ee.s.c&&(ee.s.c=he),xe<ee.s.r&&(ee.s.r=xe),$i>ee.e.r&&(ee.e.r=$i),ie=ot(B[0],!1),Pt=[],yn={},G={t:ie.||ie["value-type"],v:null},f.cellFormula)if(ie.formula&&(ie.formula=Wt(ie.formula)),ie["number-matrix-columns-spanned"]&&ie["number-matrix-rows-spanned"]&&(Ae=parseInt(ie["number-matrix-rows-spanned"],10)||0,Ve=parseInt(ie["number-matrix-columns-spanned"],10)||0,Re={s:{r:xe,c:he},e:{r:xe+Ae-1,c:he+Ve-1}},G.F=sr(Re),Gt.push([Re,G.F])),ie.formula)G.f=Ip(ie.formula);else for(Jt=0;Jt<Gt.length;++Jt)xe>=Gt[Jt][0].s.r&&xe<=Gt[Jt][0].e.r&&he>=Gt[Jt][0].s.c&&he<=Gt[Jt][0].e.c&&(G.F=Gt[Jt][1]);switch((ie["number-columns-spanned"]||ie["number-rows-spanned"])&&(Ae=parseInt(ie["number-rows-spanned"],10)||0,Ve=parseInt(ie["number-columns-spanned"],10)||0,Re={s:{r:xe,c:he},e:{r:xe+Ae-1,c:he+Ve-1}},Oe.push(Re)),ie["number-columns-repeated"]&&(gt=parseInt(ie["number-columns-repeated"],10)),G.t){case"boolean":G.t="b",G.v=jt(ie["boolean-value"]);break;case"float":G.t="n",G.v=parseFloat(ie.value);break;case"percentage":G.t="n",G.v=parseFloat(ie.value);break;case"currency":G.t="n",G.v=parseFloat(ie.value);break;case"date":G.t="d",G.v=yr(ie["date-value"]),f.cellDates||(G.t="n",G.v=qr(G.v)),G.z="m/d/yy";break;case"time":G.t="n",G.v=Xb(ie["time-value"])/86400,f.cellDates&&(G.t="d",G.v=pf(G.v)),G.z="HH:MM:SS";break;case"number":G.t="n",G.v=parseFloat(ie.);break;default:if(G.t==="string"||G.t==="text"||!G.t)G.t="s",ie["string-value"]!=null&&(ae=Wt(ie["string-value"]),we=[]);else throw new Error("Unsupported value type "+G.t)}}else{if(Ci=!1,G.t==="s"&&(G.v=ae||"",we.length&&(G.R=we),Ci=de==0),Et.Target&&(G.l=Et),Pt.length>0&&(G.c=Pt,Pt=[]),ae&&f.cellText!==!1&&(G.w=ae),Ci&&(G.t="z",delete G.v),(!Ci||f.sheetStubs)&&!(f.sheetRows&&f.sheetRows<=xe))for(var bt=0;bt<Ye;++bt){if(gt=parseInt(ie["number-columns-repeated"]||"1",10),f.dense)for(X[xe+bt]||(X[xe+bt]=[]),X[xe+bt][he]=bt==0?G:Dr(G);--gt>0;)X[xe+bt][he+gt]=Dr(G);else for(X[er({r:xe+bt,c:he})]=G;--gt>0;)X[er({r:xe+bt,c:he+gt})]=Dr(G);ee.e.c<=he&&(ee.e.c=he)}gt=parseInt(ie["number-columns-repeated"]||"1",10),he+=gt-1,gt=0,G={},ae="",we=[]}Et={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(B[1]==="/"){if((x=g.pop())[0]!==B[3])throw"Bad state: "+x}else B[0].charAt(B[0].length-2)!=="/"&&g.push([B[3],!0]);break;case"annotation":if(B[1]==="/"){if((x=g.pop())[0]!==B[3])throw"Bad state: "+x;yn.t=ae,we.length&&(yn.R=we),yn.a=In,Pt.push(yn)}else B[0].charAt(B[0].length-2)!=="/"&&g.push([B[3],!1]);In="",Pn=0,ae="",de=0,we=[];break;case"creator":B[1]==="/"?In=y.slice(Pn,B.index):Pn=B.index+B[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(B[1]==="/"){if((x=g.pop())[0]!==B[3])throw"Bad state: "+x}else B[0].charAt(B[0].length-2)!=="/"&&g.push([B[3],!1]);ae="",de=0,we=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(B[1]==="/"){if(Ce[T.name]=A,(x=g.pop())[0]!==B[3])throw"Bad state: "+x}else B[0].charAt(B[0].length-2)!=="/"&&(A="",T=ot(B[0],!1),g.push([B[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(g[g.length-1][0]){case"time-style":case"date-style":S=ot(B[0],!1),A+=Yp[B[3]][S.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(g[g.length-1][0]){case"time-style":case"date-style":S=ot(B[0],!1),A+=Yp[B[3]][S.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(B[0].slice(-2)==="/>")break;if(B[1]==="/")switch(g[g.length-1][0]){case"number-style":case"date-style":case"time-style":A+=y.slice(N,B.index);break}else N=B.index+B[0].length;break;case"named-range":S=ot(B[0],!1),yt=Vf(S["cell-range-address"]);var Mr={Name:S.name,Ref:yt[0]+"!"+yt[1]};qn&&(Mr.Sheet=H.length),Yi.Names.push(Mr);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(g[g.length-1][0])>-1)break;if(B[1]==="/"&&(!ie||!ie["string-value"])){var qi=nT(y.slice(de,B.index));ae=(ae.length>0?ae+`
`:"")+qi[0]}else ot(B[0],!1),de=B.index+B[0].length;break;case"s":break;case"database-range":if(B[1]==="/")break;try{yt=Vf(ot(B[0])["target-range-address"]),W[yt[0]]["!autofilter"]={ref:yt[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(B[1]!=="/"){if(Et=ot(B[0],!1),!Et.href)break;Et.Target=Wt(Et.href),delete Et.href,Et.Target.charAt(0)=="#"&&Et.Target.indexOf(".")>-1?(yt=Vf(Et.Target.slice(1)),Et.Target="#"+yt[0]+"!"+yt[1]):Et.Target.match(/^\.\.[\\\/]/)&&(Et.Target=Et.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(B[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(f.WTF)throw new Error(B)}}var Ki={Sheets:W,SheetNames:H,Workbook:Yi};return f.bookSheets&&delete Ki.Sheets,Ki}function $p(c,d){d=d||{},On(c,"META-INF/manifest.xml")&&R2(ar(c,"META-INF/manifest.xml"),d);var f=An(c,"content.xml");if(!f)throw new Error("Missing content.xml in ODS / UOF file");var y=iT(It(f),d);return On(c,"meta.xml")&&(y.Props=gp(ar(c,"meta.xml"))),y}var aT=function(){var c=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),d="<office:document-styles "+Ms({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+c+"</office:document-styles>";return function(){return or+d}}(),qp=function(){var c=function(x){return Xt(x).replace(/  +/g,function(S){return'<text:s text:c="'+S.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},d=`          <table:table-cell />
`,f=`          <table:covered-table-cell/>
`,y=function(x,S,T){var A=[];A.push('      <table:table table:name="'+Xt(S.SheetNames[T])+`" table:style-name="ta1">
`);var N=0,O=0,F=Xi(x["!ref"]||"A1"),W=x["!merges"]||[],H=0,X=Array.isArray(x);if(x["!cols"])for(O=0;O<=F.e.c;++O)A.push("        <table:table-column"+(x["!cols"][O]?' table:style-name="co'+x["!cols"][O].ods+'"':"")+`></table:table-column>
`);var B="",G=x["!rows"]||[];for(N=0;N<F.s.r;++N)B=G[N]?' table:style-name="ro'+G[N].ods+'"':"",A.push("        <table:table-row"+B+`></table:table-row>
`);for(;N<=F.e.r;++N){for(B=G[N]?' table:style-name="ro'+G[N].ods+'"':"",A.push("        <table:table-row"+B+`>
`),O=0;O<F.s.c;++O)A.push(d);for(;O<=F.e.c;++O){var ie=!1,ae={},de="";for(H=0;H!=W.length;++H)if(!(W[H].s.c>O)&&!(W[H].s.r>N)&&!(W[H].e.c<O)&&!(W[H].e.r<N)){(W[H].s.c!=O||W[H].s.r!=N)&&(ie=!0),ae["table:number-columns-spanned"]=W[H].e.c-W[H].s.c+1,ae["table:number-rows-spanned"]=W[H].e.r-W[H].s.r+1;break}if(ie){A.push(f);continue}var we=er({r:N,c:O}),xe=X?(x[N]||[])[O]:x[we];if(xe&&xe.f&&(ae["table:formula"]=Xt(HS(xe.f)),xe.F&&xe.F.slice(0,we.length)==we)){var he=Xi(xe.F);ae["table:number-matrix-columns-spanned"]=he.e.c-he.s.c+1,ae["table:number-matrix-rows-spanned"]=he.e.r-he.s.r+1}if(!xe){A.push(d);continue}switch(xe.t){case"b":de=xe.v?"TRUE":"FALSE",ae["office:value-type"]="boolean",ae["office:boolean-value"]=xe.v?"true":"false";break;case"n":de=xe.w||String(xe.v||0),ae["office:value-type"]="float",ae["office:value"]=xe.v||0;break;case"s":case"str":de=xe.v==null?"":xe.v,ae["office:value-type"]="string";break;case"d":de=xe.w||yr(xe.v).toISOString(),ae["office:value-type"]="date",ae["office:date-value"]=yr(xe.v).toISOString(),ae["table:style-name"]="ce1";break;default:A.push(d);continue}var ee=c(de);if(xe.l&&xe.l.Target){var Ee=xe.l.Target;Ee=Ee.charAt(0)=="#"?"#"+zS(Ee.slice(1)):Ee,Ee.charAt(0)!="#"&&!Ee.match(/^\w+:/)&&(Ee="../"+Ee),ee=Ue("text:a",ee,{"xlink:href":Ee.replace(/&/g,"&amp;")})}A.push("          "+Ue("table:table-cell",Ue("text:p",ee,{}),ae)+`
`)}A.push(`        </table:table-row>
`)}return A.push(`      </table:table>
`),A.join("")},g=function(x,S){x.push(` <office:automatic-styles>
`),x.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),x.push(`   <number:month number:style="long"/>
`),x.push(`   <number:text>/</number:text>
`),x.push(`   <number:day number:style="long"/>
`),x.push(`   <number:text>/</number:text>
`),x.push(`   <number:year/>
`),x.push(`  </number:date-style>
`);var T=0;S.SheetNames.map(function(N){return S.Sheets[N]}).forEach(function(N){if(N&&N["!cols"]){for(var O=0;O<N["!cols"].length;++O)if(N["!cols"][O]){var F=N["!cols"][O];if(F.width==null&&F.wpx==null&&F.wch==null)continue;Hf(F),F.ods=T;var W=N["!cols"][O].wpx+"px";x.push('  <style:style style:name="co'+T+`" style:family="table-column">
`),x.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+W+`"/>
`),x.push(`  </style:style>
`),++T}}});var A=0;S.SheetNames.map(function(N){return S.Sheets[N]}).forEach(function(N){if(N&&N["!rows"]){for(var O=0;O<N["!rows"].length;++O)if(N["!rows"][O]){N["!rows"][O].ods=A;var F=N["!rows"][O].hpx+"px";x.push('  <style:style style:name="ro'+A+`" style:family="table-row">
`),x.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+F+`"/>
`),x.push(`  </style:style>
`),++A}}}),x.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),x.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),x.push(`  </style:style>
`),x.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),x.push(` </office:automatic-styles>
`)};return function(S,T){var A=[or],N=Ms({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),O=Ms({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});T.bookType=="fods"?(A.push("<office:document"+N+O+`>
`),A.push(pp().replace(/office:document-meta/g,"office:meta"))):A.push("<office:document-content"+N+`>
`),g(A,S),A.push(`  <office:body>
`),A.push(`    <office:spreadsheet>
`);for(var F=0;F!=S.SheetNames.length;++F)A.push(y(S.Sheets[S.SheetNames[F]],S,F));return A.push(`    </office:spreadsheet>
`),A.push(`  </office:body>
`),T.bookType=="fods"?A.push("</office:document>"):A.push("</office:document-content>"),A.join("")}}();function Kp(c,d){if(d.bookType=="fods")return qp(c,d);var f=mf(),y="",g=[],x=[];return y="mimetype",nt(f,y,"application/vnd.oasis.opendocument.spreadsheet"),y="content.xml",nt(f,y,qp(c,d)),g.push([y,"text/xml"]),x.push([y,"ContentFile"]),y="styles.xml",nt(f,y,aT(c,d)),g.push([y,"text/xml"]),x.push([y,"StylesFile"]),y="meta.xml",nt(f,y,or+pp()),g.push([y,"text/xml"]),x.push([y,"MetadataFile"]),y="manifest.rdf",nt(f,y,O2(x)),g.push([y,"application/rdf+xml"]),y="META-INF/manifest.xml",nt(f,y,L2(g)),f}function Zp(c){return function(f){for(var y=0;y!=c.length;++y){var g=c[y];f[g[0]]===void 0&&(f[g[0]]=g[1]),g[2]==="n"&&(f[g[0]]=Number(f[g[0]]))}}}function oT(c){Zp([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(c)}function jp(c){Zp([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(c)}function sT(c){return lt.WS.indexOf(c)>-1?"sheet":lt.CS&&c==lt.CS?"chart":c==lt.DS?"dialog":c==lt.MS?"macro":c&&c.length?c:"sheet"}function lT(c,d){if(!c)return 0;try{c=d.map(function(y){return y.id||(y.id=y.strRelID),[y.name,c["!id"][y.id].Target,sT(c["!id"][y.id].Type)]})}catch{return null}return!c||c.length===0?null:c}function uT(c,d,f,y,g,x,S,T,A,N,O,F){try{x[y]=ks(An(c,f,!0),d);var W=ar(c,d),H;switch(T){case"sheet":H=IE(W,d,g,A,x[y],N,O,F);break;case"chart":if(H=PE(W,d,g,A,x[y],N,O,F),!H||!H["!drawel"])break;var X=Rs(H["!drawel"].Target,d),B=Ns(X),G=ES(An(c,X,!0),ks(An(c,B,!0),X)),ie=Rs(G,X),ae=Ns(ie);H=SE(An(c,ie,!0),ie,A,ks(An(c,ae,!0),ie),N,H);break;case"macro":H=DE(W,d,g,A,x[y],N,O,F);break;case"dialog":H=BE(W,d,g,A,x[y],N,O,F);break;default:throw new Error("Unrecognized sheet type "+T)}S[y]=H;var de=[];x&&x[y]&&$r(x[y]).forEach(function(we){var xe="";if(x[y][we].Type==lt.CMNT){xe=Rs(x[y][we].Target,d);var he=WE(ar(c,xe,!0),xe,A);if(!he||!he.length)return;Mp(H,he,!1)}x[y][we].Type==lt.TCMNT&&(xe=Rs(x[y][we].Target,d),de=de.concat(_S(ar(c,xe,!0),A)))}),de&&de.length&&Mp(H,de,!0,A.people||[])}catch(we){if(A.WTF)throw we}}function kn(c){return c.charAt(0)=="/"?c.slice(1):c}function Jp(c,d){if(vf(),d=d||{},oT(d),On(c,"META-INF/manifest.xml")||On(c,"objectdata.xml"))return $p(c,d);if(On(c,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof parse_numbers_iwa<"u"){if(c.FileIndex)return parse_numbers_iwa(c);var f=kt.utils.cfb_new();return G0(c).forEach(function(ft){nt(f,ft,Kb(c,ft))}),parse_numbers_iwa(f)}throw new Error("Unsupported NUMBERS file")}if(!On(c,"[Content_Types].xml"))throw On(c,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):On(c,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var y=G0(c),g=T2(An(c,"[Content_Types].xml")),x=!1,S,T;if(g.workbooks.length===0&&(T="xl/workbook.xml",ar(c,T,!0)&&g.workbooks.push(T)),g.workbooks.length===0){if(T="xl/workbook.bin",!ar(c,T,!0))throw new Error("Could not find workbook");g.workbooks.push(T),x=!0}g.workbooks[0].slice(-3)=="bin"&&(x=!0);var A={},N={};if(!d.bookSheets&&!d.bookProps){if(su=[],g.sst)try{su=zE(ar(c,kn(g.sst)),g.sst,d)}catch(ft){if(d.WTF)throw ft}d.cellStyles&&g.themes.length&&(A=HE(An(c,g.themes[0].replace(/^\//,""),!0)||"",g.themes[0],d)),g.style&&(N=FE(ar(c,kn(g.style)),g.style,A,d))}g.links.map(function(ft){try{var Ye=ks(An(c,Ns(kn(ft))),ft);return UE(ar(c,kn(ft)),Ye,ft,d)}catch{}});var O=kE(ar(c,kn(g.workbooks[0])),g.workbooks[0],d),F={},W="";g.coreprops.length&&(W=ar(c,kn(g.coreprops[0]),!0),W&&(F=gp(W)),g.extprops.length!==0&&(W=ar(c,kn(g.extprops[0]),!0),W&&k2(W,F,d)));var H={};(!d.bookSheets||d.bookProps)&&g.custprops.length!==0&&(W=An(c,kn(g.custprops[0]),!0),W&&(H=P2(W,d)));var X={};if((d.bookSheets||d.bookProps)&&(O.Sheets?S=O.Sheets.map(function(Ye){return Ye.name}):F.Worksheets&&F.SheetNames.length>0&&(S=F.SheetNames),d.bookProps&&(X.Props=F,X.Custprops=H),d.bookSheets&&typeof S<"u"&&(X.SheetNames=S),d.bookSheets?X.SheetNames:d.bookProps))return X;S={};var B={};d.bookDeps&&g.calcchain&&(B=GE(ar(c,kn(g.calcchain)),g.calcchain,d));var G=0,ie={},ae,de;{var we=O.Sheets;F.Worksheets=we.length,F.SheetNames=[];for(var xe=0;xe!=we.length;++xe)F.SheetNames[xe]=we[xe].name}var he=x?"bin":"xml",ee=g.workbooks[0].lastIndexOf("/"),Ee=(g.workbooks[0].slice(0,ee+1)+"_rels/"+g.workbooks[0].slice(ee+1)+".rels").replace(/^\//,"");On(c,Ee)||(Ee="xl/_rels/workbook."+he+".rels");var Ce=ks(An(c,Ee,!0),Ee.replace(/_rels.*/,"s5s"));(g.metadata||[]).length>=1&&(d.xlmeta=VE(ar(c,kn(g.metadata[0])),g.metadata[0],d)),(g.people||[]).length>=1&&(d.people=LS(ar(c,kn(g.people[0])),d)),Ce&&(Ce=lT(Ce,O.Sheets));var Oe=ar(c,"xl/worksheets/sheet.xml",!0)?1:0;e:for(G=0;G!=F.Worksheets;++G){var Re="sheet";if(Ce&&Ce[G]?(ae="xl/"+Ce[G][1].replace(/[\/]?xl\//,""),On(c,ae)||(ae=Ce[G][1]),On(c,ae)||(ae=Ee.replace(/_rels\/.*$/,"")+Ce[G][1]),Re=Ce[G][2]):(ae="xl/worksheets/sheet"+(G+1-Oe)+"."+he,ae=ae.replace(/sheet0\./,"sheet.")),de=ae.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),d&&d.sheets!=null)switch(typeof d.sheets){case"number":if(G!=d.sheets)continue e;break;case"string":if(F.SheetNames[G].toLowerCase()!=d.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(d.sheets)){for(var Ae=!1,Ve=0;Ve!=d.sheets.length;++Ve)typeof d.sheets[Ve]=="number"&&d.sheets[Ve]==G&&(Ae=1),typeof d.sheets[Ve]=="string"&&d.sheets[Ve].toLowerCase()==F.SheetNames[G].toLowerCase()&&(Ae=1);if(!Ae)continue e}}uT(c,ae,de,F.SheetNames[G],G,ie,S,Re,d,O,A,N)}return X={Directory:g,Workbook:O,Props:F,Custprops:H,Deps:B,Sheets:S,SheetNames:F.SheetNames,Strings:su,Styles:N,Themes:A,SSF:Dr(mt)},d&&d.bookFiles&&(c.files?(X.keys=y,X.files=c.files):(X.keys=[],X.files={},c.FullPaths.forEach(function(ft,Ye){ft=ft.replace(/^Root Entry[\/]/,""),X.keys.push(ft),X.files[ft]=c.FileIndex[Ye]}))),d&&d.bookVBA&&(g.vba.length>0?X.vbaraw=ar(c,kn(g.vba[0]),!0):g.defaults&&g.defaults.bin===OS&&(X.vbaraw=ar(c,"xl/vbaProject.bin",!0))),X}function cT(c,d){var f=d||{},y="Workbook",g=kt.find(c,y);try{if(y="/!DataSpaces/Version",g=kt.find(c,y),!g||!g.content)throw new Error("ECMA-376 Encrypted file missing "+y);if(parse_DataSpaceVersionInfo(g.content),y="/!DataSpaces/DataSpaceMap",g=kt.find(c,y),!g||!g.content)throw new Error("ECMA-376 Encrypted file missing "+y);var x=parse_DataSpaceMap(g.content);if(x.length!==1||x[0].comps.length!==1||x[0].comps[0].t!==0||x[0].name!=="StrongEncryptionDataSpace"||x[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+y);if(y="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",g=kt.find(c,y),!g||!g.content)throw new Error("ECMA-376 Encrypted file missing "+y);var S=parse_DataSpaceDefinition(g.content);if(S.length!=1||S[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+y);if(y="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",g=kt.find(c,y),!g||!g.content)throw new Error("ECMA-376 Encrypted file missing "+y);parse_Primary(g.content)}catch{}if(y="/EncryptionInfo",g=kt.find(c,y),!g||!g.content)throw new Error("ECMA-376 Encrypted file missing "+y);var T=parse_EncryptionInfo(g.content);if(y="/EncryptedPackage",g=kt.find(c,y),!g||!g.content)throw new Error("ECMA-376 Encrypted file missing "+y);if(T[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(T[1],g.content,f.password||"",f);if(T[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(T[1],g.content,f.password||"",f);throw new Error("File is password-protected")}function fT(c,d){return d.bookType=="ods"?Kp(c,d):d.bookType=="numbers"?write_numbers_iwa(c,d):d.bookType=="xlsb"?hT(c,d):Qp(c,d)}function hT(c,d){Mo=1024,c&&!c.SSF&&(c.SSF=Dr(mt)),c&&c.SSF&&(vf(),df(c.SSF),d.revssf=P0(c.SSF),d.revssf[c.SSF[65535]]=0,d.ssf=c.SSF),d.rels={},d.wbrels={},d.Strings=[],d.Strings.Count=0,d.Strings.Unique=0,Ds?d.revStrings=new Map:(d.revStrings={},d.revStrings.foo=[],delete d.revStrings.foo);var f=d.bookType=="xlsb"?"bin":"xml",y=Ap.indexOf(d.bookType)>-1,g=kf();jp(d=d||{});var x=mf(),S="",T=0;if(d.cellXfs=[],Xf(d.cellXfs,{},{revssf:{General:0}}),c.Props||(c.Props={}),S="docProps/core.xml",nt(x,S,mp(c.Props,d)),g.coreprops.push(S),Lt(d.rels,2,S,lt.CORE_PROPS),S="docProps/app.xml",!(c.Props&&c.Props.SheetNames))if(!c.Workbook||!c.Workbook.Sheets)c.Props.SheetNames=c.SheetNames;else{for(var A=[],N=0;N<c.SheetNames.length;++N)(c.Workbook.Sheets[N]||{}).Hidden!=2&&A.push(c.SheetNames[N]);c.Props.SheetNames=A}for(c.Props.Worksheets=c.Props.SheetNames.length,nt(x,S,Cp(c.Props)),g.extprops.push(S),Lt(d.rels,3,S,lt.EXT_PROPS),c.Custprops!==c.Props&&$r(c.Custprops||{}).length>0&&(S="docProps/custom.xml",nt(x,S,wp(c.Custprops)),g.custprops.push(S),Lt(d.rels,4,S,lt.CUST_PROPS)),T=1;T<=c.SheetNames.length;++T){var O={"!id":{}},F=c.Sheets[c.SheetNames[T-1]],W=(F||{})["!type"]||"sheet";switch(W){case"chart":default:S="xl/worksheets/sheet"+T+"."+f,nt(x,S,YE(T-1,S,d,c,O)),g.sheets.push(S),Lt(d.wbrels,-1,"worksheets/sheet"+T+"."+f,lt.WS[0])}if(F){var H=F["!comments"],X=!1,B="";H&&H.length>0&&(B="xl/comments"+T+"."+f,nt(x,B,KE(H,B,d)),g.comments.push(B),Lt(O,-1,"../comments"+T+"."+f,lt.CMNT),X=!0),F["!legacy"]&&X&&nt(x,"xl/drawings/vmlDrawing"+T+".vml",Lp(T,F["!comments"])),delete F["!comments"],delete F["!legacy"]}O["!id"].rId1&&nt(x,Ns(S),Lo(O))}return d.Strings!=null&&d.Strings.length>0&&(S="xl/sharedStrings."+f,nt(x,S,qE(d.Strings,S,d)),g.strs.push(S),Lt(d.wbrels,-1,"sharedStrings."+f,lt.SST)),S="xl/workbook."+f,nt(x,S,XE(c,S,d)),g.workbooks.push(S),Lt(d.rels,1,S,lt.WB),S="xl/theme/theme1.xml",nt(x,S,Gf(c.Themes,d)),g.themes.push(S),Lt(d.wbrels,-1,"theme/theme1.xml",lt.THEME),S="xl/styles."+f,nt(x,S,$E(c,S,d)),g.styles.push(S),Lt(d.wbrels,-1,"styles."+f,lt.STY),c.vbaraw&&y&&(S="xl/vbaProject.bin",nt(x,S,c.vbaraw),g.vba.push(S),Lt(d.wbrels,-1,"vbaProject.bin",lt.VBA)),S="xl/metadata."+f,nt(x,S,ZE(S)),g.metadata.push(S),Lt(d.wbrels,-1,"metadata."+f,lt.XLMETA),nt(x,"[Content_Types].xml",dp(g,d)),nt(x,"_rels/.rels",Lo(d.rels)),nt(x,"xl/_rels/workbook."+f+".rels",Lo(d.wbrels)),delete d.revssf,delete d.ssf,x}function Qp(c,d){Mo=1024,c&&!c.SSF&&(c.SSF=Dr(mt)),c&&c.SSF&&(vf(),df(c.SSF),d.revssf=P0(c.SSF),d.revssf[c.SSF[65535]]=0,d.ssf=c.SSF),d.rels={},d.wbrels={},d.Strings=[],d.Strings.Count=0,d.Strings.Unique=0,Ds?d.revStrings=new Map:(d.revStrings={},d.revStrings.foo=[],delete d.revStrings.foo);var f="xml",y=Ap.indexOf(d.bookType)>-1,g=kf();jp(d=d||{});var x=mf(),S="",T=0;if(d.cellXfs=[],Xf(d.cellXfs,{},{revssf:{General:0}}),c.Props||(c.Props={}),S="docProps/core.xml",nt(x,S,mp(c.Props,d)),g.coreprops.push(S),Lt(d.rels,2,S,lt.CORE_PROPS),S="docProps/app.xml",!(c.Props&&c.Props.SheetNames))if(!c.Workbook||!c.Workbook.Sheets)c.Props.SheetNames=c.SheetNames;else{for(var A=[],N=0;N<c.SheetNames.length;++N)(c.Workbook.Sheets[N]||{}).Hidden!=2&&A.push(c.SheetNames[N]);c.Props.SheetNames=A}c.Props.Worksheets=c.Props.SheetNames.length,nt(x,S,Cp(c.Props)),g.extprops.push(S),Lt(d.rels,3,S,lt.EXT_PROPS),c.Custprops!==c.Props&&$r(c.Custprops||{}).length>0&&(S="docProps/custom.xml",nt(x,S,wp(c.Custprops)),g.custprops.push(S),Lt(d.rels,4,S,lt.CUST_PROPS));var O=["SheetJ5"];for(d.tcid=0,T=1;T<=c.SheetNames.length;++T){var F={"!id":{}},W=c.Sheets[c.SheetNames[T-1]],H=(W||{})["!type"]||"sheet";switch(H){case"chart":default:S="xl/worksheets/sheet"+T+"."+f,nt(x,S,Dp(T-1,d,c,F)),g.sheets.push(S),Lt(d.wbrels,-1,"worksheets/sheet"+T+"."+f,lt.WS[0])}if(W){var X=W["!comments"],B=!1,G="";if(X&&X.length>0){var ie=!1;X.forEach(function(ae){ae[1].forEach(function(de){de.T==!0&&(ie=!0)})}),ie&&(G="xl/threadedComments/threadedComment"+T+"."+f,nt(x,G,RS(X,O,d)),g.threadedcomments.push(G),Lt(F,-1,"../threadedComments/threadedComment"+T+"."+f,lt.TCMNT)),G="xl/comments"+T+"."+f,nt(x,G,Op(X)),g.comments.push(G),Lt(F,-1,"../comments"+T+"."+f,lt.CMNT),B=!0}W["!legacy"]&&B&&nt(x,"xl/drawings/vmlDrawing"+T+".vml",Lp(T,W["!comments"])),delete W["!comments"],delete W["!legacy"]}F["!id"].rId1&&nt(x,Ns(S),Lo(F))}return d.Strings!=null&&d.Strings.length>0&&(S="xl/sharedStrings."+f,nt(x,S,Ep(d.Strings,d)),g.strs.push(S),Lt(d.wbrels,-1,"sharedStrings."+f,lt.SST)),S="xl/workbook."+f,nt(x,S,Wp(c)),g.workbooks.push(S),Lt(d.rels,1,S,lt.WB),S="xl/theme/theme1.xml",nt(x,S,Gf(c.Themes,d)),g.themes.push(S),Lt(d.wbrels,-1,"theme/theme1.xml",lt.THEME),S="xl/styles."+f,nt(x,S,_p(c,d)),g.styles.push(S),Lt(d.wbrels,-1,"styles."+f,lt.STY),c.vbaraw&&y&&(S="xl/vbaProject.bin",nt(x,S,c.vbaraw),g.vba.push(S),Lt(d.wbrels,-1,"vbaProject.bin",lt.VBA)),S="xl/metadata."+f,nt(x,S,Rp()),g.metadata.push(S),Lt(d.wbrels,-1,"metadata."+f,lt.XLMETA),O.length>1&&(S="xl/persons/person.xml",nt(x,S,MS(O)),g.people.push(S),Lt(d.wbrels,-1,"persons/person.xml",lt.PEOPLE)),nt(x,"[Content_Types].xml",dp(g,d)),nt(x,"_rels/.rels",Lo(d.rels)),nt(x,"xl/_rels/workbook."+f+".rels",Lo(d.wbrels)),delete d.revssf,delete d.ssf,x}function qf(c,d){var f="";switch((d||{}).type||"base64"){case"buffer":return[c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7]];case"base64":f=L(c.slice(0,12));break;case"binary":f=c;break;case"array":return[c[0],c[1],c[2],c[3],c[4],c[5],c[6],c[7]];default:throw new Error("Unrecognized type "+(d&&d.type||"undefined"))}return[f.charCodeAt(0),f.charCodeAt(1),f.charCodeAt(2),f.charCodeAt(3),f.charCodeAt(4),f.charCodeAt(5),f.charCodeAt(6),f.charCodeAt(7)]}function dT(c,d){return kt.find(c,"EncryptedPackage")?cT(c,d):parse_xlscfb(c,d)}function vT(c,d){var f,y=c,g=d||{};return g.type||(g.type=_&&Buffer.isBuffer(c)?"buffer":"base64"),f=Zb(y,g),Jp(f,g)}function eg(c,d){var f=0;e:for(;f<c.length;)switch(c.charCodeAt(f)){case 10:case 13:case 32:++f;break;case 60:return parse_xlml(c.slice(f),d);default:break e}return Is.to_workbook(c,d)}function pT(c,d){var f="",y=qf(c,d);switch(d.type){case"base64":f=L(c);break;case"binary":f=c;break;case"buffer":f=c.toString("binary");break;case"array":f=xo(c);break;default:throw new Error("Unrecognized type "+d.type)}return y[0]==239&&y[1]==187&&y[2]==191&&(f=It(f)),d.type="binary",eg(f,d)}function gT(c,d){var f=c;return d.type=="base64"&&(f=L(f)),f=$cptable.utils.decode(1200,f.slice(2),"str"),d.type="binary",eg(f,d)}function mT(c){return c.match(/[^\x00-\x7F]/)?Ui(c):c}function Kf(c,d,f,y){return y?(f.type="string",Is.to_workbook(c,f)):Is.to_workbook(d,f)}function lu(c,d){p();var f=d||{};if(typeof ArrayBuffer<"u"&&c instanceof ArrayBuffer)return lu(new Uint8Array(c),(f=Dr(f),f.type="array",f));typeof Uint8Array<"u"&&c instanceof Uint8Array&&!f.type&&(f.type=typeof Deno<"u"?"buffer":"array");var y=c,g=[0,0,0,0],x=!1;if(f.cellStyles&&(f.cellNF=!0,f.sheetStubs=!0),Oo={},f.dateNF&&(Oo.dateNF=f.dateNF),f.type||(f.type=_&&Buffer.isBuffer(c)?"buffer":"base64"),f.type=="file"&&(f.type=_?"buffer":"binary",y=Gb(c),typeof Uint8Array<"u"&&!_&&(f.type="array")),f.type=="string"&&(x=!0,f.type="binary",f.codepage=65001,y=mT(c)),f.type=="array"&&typeof Uint8Array<"u"&&c instanceof Uint8Array&&typeof ArrayBuffer<"u"){var S=new ArrayBuffer(3),T=new Uint8Array(S);if(T.foo="bar",!T.foo)return f=Dr(f),f.type="array",lu(ne(y),f)}switch((g=qf(y,f))[0]){case 208:if(g[1]===207&&g[2]===17&&g[3]===224&&g[4]===161&&g[5]===177&&g[6]===26&&g[7]===225)return dT(kt.read(y,f),f);break;case 9:if(g[1]<=8)return parse_xlscfb(y,f);break;case 60:return parse_xlml(y,f);case 73:if(g[1]===73&&g[2]===42&&g[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(g[1]===68)return B2(y,f);break;case 84:if(g[1]===65&&g[2]===66&&g[3]===76)return bp.to_workbook(y,f);break;case 80:return g[1]===75&&g[2]<9&&g[3]<9?vT(y,f):Kf(c,y,f,x);case 239:return g[3]===60?parse_xlml(y,f):Kf(c,y,f,x);case 255:if(g[1]===254)return gT(y,f);if(g[1]===0&&g[2]===2&&g[3]===0)return WK_.to_workbook(y,f);break;case 0:if(g[1]===0&&(g[2]>=2&&g[3]===0||g[2]===0&&(g[3]===8||g[3]===9)))return WK_.to_workbook(y,f);break;case 3:case 131:case 139:case 140:return Pf.to_workbook(y,f);case 123:if(g[1]===92&&g[2]===114&&g[3]===116)return RTF.to_workbook(y,f);break;case 10:case 13:case 32:return pT(y,f);case 137:if(g[1]===80&&g[2]===78&&g[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return D2.indexOf(g[0])>-1&&g[2]<=12&&g[3]<=31?Pf.to_workbook(y,f):Kf(c,y,f,x)}function tg(c,d){var f=d||{};return f.type="file",lu(c,f)}function rg(c,d){switch(d.type){case"base64":case"binary":break;case"buffer":case"array":d.type="";break;case"file":return Ts(d.file,kt.write(c,{type:_?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+d.bookType+"' files");default:throw new Error("Unrecognized type "+d.type)}return kt.write(c,d)}function yT(c,d){var f=Dr(d||{}),y=fT(c,f);return ng(y,f)}function CT(c,d){var f=Dr(d||{}),y=Qp(c,f);return ng(y,f)}function ng(c,d){var f={},y=_?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(d.compression&&(f.compression="DEFLATE"),d.password)f.type=y;else switch(d.type){case"base64":f.type="base64";break;case"binary":f.type="string";break;case"string":throw new Error("'string' output type invalid for '"+d.bookType+"' files");case"buffer":case"file":f.type=y;break;default:throw new Error("Unrecognized type "+d.type)}var g=c.FullPaths?kt.write(c,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[f.type]||f.type,compression:!!d.compression}):c.generate(f);if(typeof Deno<"u"&&typeof g=="string"){if(d.type=="binary"||d.type=="base64")return g;g=new Uint8Array(Q(g))}return d.password&&typeof encrypt_agile<"u"?rg(encrypt_agile(g,d.password),d):d.type==="file"?Ts(d.file,g):d.type=="string"?It(g):g}function wT(c,d){var f=d||{},y=write_xlscfb(c,f);return rg(y,f)}function yi(c,d,f){f||(f="");var y=f+c;switch(d.type){case"base64":return k(Ui(y));case"binary":return Ui(y);case"string":return c;case"file":return Ts(d.file,y,"utf8");case"buffer":return _?I(y,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(y):yi(y,{type:"binary"}).split("").map(function(g){return g.charCodeAt(0)})}throw new Error("Unrecognized type "+d.type)}function xT(c,d){switch(d.type){case"base64":return k(c);case"binary":return c;case"string":return c;case"file":return Ts(d.file,c,"binary");case"buffer":return _?I(c,"binary"):c.split("").map(function(f){return f.charCodeAt(0)})}throw new Error("Unrecognized type "+d.type)}function uu(c,d){switch(d.type){case"string":case"base64":case"binary":for(var f="",y=0;y<c.length;++y)f+=String.fromCharCode(c[y]);return d.type=="base64"?k(f):d.type=="string"?It(f):f;case"file":return Ts(d.file,c);case"buffer":return c;default:throw new Error("Unrecognized type "+d.type)}}function Zf(c,d){p(),zp(c);var f=Dr(d||{});if(f.cellStyles&&(f.cellNF=!0,f.sheetStubs=!0),f.type=="array"){f.type="binary";var y=Zf(c,f);return f.type="array",Q(y)}return CT(c,f)}function cu(c,d){p(),zp(c);var f=Dr(d||{});if(f.cellStyles&&(f.cellNF=!0,f.sheetStubs=!0),f.type=="array"){f.type="binary";var y=cu(c,f);return f.type="array",Q(y)}var g=0;if(f.sheet&&(typeof f.sheet=="number"?g=f.sheet:g=c.SheetNames.indexOf(f.sheet),!c.SheetNames[g]))throw new Error("Sheet not found: "+f.sheet+" : "+typeof f.sheet);switch(f.bookType||"xlsb"){case"xml":case"xlml":return yi(write_xlml(c,f),f);case"slk":case"sylk":return yi(xp.from_sheet(c.Sheets[c.SheetNames[g]],f),f);case"htm":case"html":return yi(Gp(c.Sheets[c.SheetNames[g]],f),f);case"txt":return xT(og(c.Sheets[c.SheetNames[g]],f),f);case"csv":return yi(Qf(c.Sheets[c.SheetNames[g]],f),f,"\uFEFF");case"dif":return yi(bp.from_sheet(c.Sheets[c.SheetNames[g]],f),f);case"dbf":return uu(Pf.from_sheet(c.Sheets[c.SheetNames[g]],f),f);case"prn":return yi(Is.from_sheet(c.Sheets[c.SheetNames[g]],f),f);case"rtf":return yi(RTF.from_sheet(c.Sheets[c.SheetNames[g]],f),f);case"eth":return yi(Sp.from_sheet(c.Sheets[c.SheetNames[g]],f),f);case"fods":return yi(Kp(c,f),f);case"wk1":return uu(WK_.sheet_to_wk1(c.Sheets[c.SheetNames[g]],f),f);case"wk3":return uu(WK_.book_to_wk3(c,f),f);case"biff2":f.biff||(f.biff=2);case"biff3":f.biff||(f.biff=3);case"biff4":return f.biff||(f.biff=4),uu(write_biff_buf(c,f),f);case"biff5":f.biff||(f.biff=5);case"biff8":case"xla":case"xls":return f.biff||(f.biff=8),wT(c,f);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return yT(c,f);default:throw new Error("Unrecognized bookType |"+f.bookType+"|")}}function jf(c){if(!c.bookType){var d={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},f=c.file.slice(c.file.lastIndexOf(".")).toLowerCase();f.match(/^\.[a-z]+$/)&&(c.bookType=f.slice(1)),c.bookType=d[c.bookType]||c.bookType}}function ig(c,d,f){var y=f||{};return y.type="file",y.file=d,jf(y),cu(c,y)}function bT(c,d,f){var y=f||{};return y.type="file",y.file=d,jf(y),Zf(c,y)}function ST(c,d,f,y){var g=f||{};g.type="file",g.file=c,jf(g),g.type="buffer";var x=y;return x instanceof Function||(x=f),pa.writeFile(c,cu(d,g),x)}function ET(c,d,f,y,g,x,S,T){var A=mi(f),N=T.defval,O=T.raw||!Object.prototype.hasOwnProperty.call(T,"raw"),F=!0,W=g===1?[]:{};if(g!==1)if(Object.defineProperty)try{Object.defineProperty(W,"__rowNum__",{value:f,enumerable:!1})}catch{W.__rowNum__=f}else W.__rowNum__=f;if(!S||c[f])for(var H=d.s.c;H<=d.e.c;++H){var X=S?c[f][H]:c[y[H]+A];if(X===void 0||X.t===void 0){if(N===void 0)continue;x[H]!=null&&(W[x[H]]=N);continue}var B=X.v;switch(X.t){case"z":if(B==null)break;continue;case"e":B=B==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+X.t)}if(x[H]!=null){if(B==null)if(X.t=="e"&&B===null)W[x[H]]=null;else if(N!==void 0)W[x[H]]=N;else if(O&&B===null)W[x[H]]=null;else continue;else W[x[H]]=O&&(X.t!=="n"||X.t==="n"&&T.rawNumbers!==!1)?B:To(X,B,T);B!=null&&(F=!1)}}return{row:W,isempty:F}}function Jf(c,d){if(c==null||c["!ref"]==null)return[];var f={t:"n",v:0},y=0,g=1,x=[],S=0,T="",A={s:{r:0,c:0},e:{r:0,c:0}},N=d||{},O=N.range!=null?N.range:c["!ref"];switch(N.header===1?y=1:N.header==="A"?y=2:Array.isArray(N.header)?y=3:N.header==null&&(y=0),typeof O){case"string":A=lr(O);break;case"number":A=lr(c["!ref"]),A.s.r=O;break;default:A=O}y>0&&(g=0);var F=mi(A.s.r),W=[],H=[],X=0,B=0,G=Array.isArray(c),ie=A.s.r,ae=0,de={};G&&!c[ie]&&(c[ie]=[]);var we=N.skipHidden&&c["!cols"]||[],xe=N.skipHidden&&c["!rows"]||[];for(ae=A.s.c;ae<=A.e.c;++ae)if(!(we[ae]||{}).hidden)switch(W[ae]=Vi(ae),f=G?c[ie][ae]:c[W[ae]+F],y){case 1:x[ae]=ae-A.s.c;break;case 2:x[ae]=W[ae];break;case 3:x[ae]=N.header[ae-A.s.c];break;default:if(f==null&&(f={w:"__EMPTY",t:"s"}),T=S=To(f,null,N),B=de[S]||0,!B)de[S]=1;else{do T=S+"_"+B++;while(de[T]);de[S]=B,de[T]=1}x[ae]=T}for(ie=A.s.r+g;ie<=A.e.r;++ie)if(!(xe[ie]||{}).hidden){var he=ET(c,A,ie,W,y,x,G,N);(he.isempty===!1||(y===1?N.blankrows!==!1:N.blankrows))&&(H[X++]=he.row)}return H.length=X,H}var ag=/"/g;function TT(c,d,f,y,g,x,S,T){for(var A=!0,N=[],O="",F=mi(f),W=d.s.c;W<=d.e.c;++W)if(y[W]){var H=T.dense?(c[f]||[])[W]:c[y[W]+F];if(H==null)O="";else if(H.v!=null){A=!1,O=""+(T.rawNumbers&&H.t=="n"?H.v:To(H,null,T));for(var X=0,B=0;X!==O.length;++X)if((B=O.charCodeAt(X))===g||B===x||B===34||T.forceQuotes){O='"'+O.replace(ag,'""')+'"';break}O=="ID"&&(O='"ID"')}else H.f!=null&&!H.F?(A=!1,O="="+H.f,O.indexOf(",")>=0&&(O='"'+O.replace(ag,'""')+'"')):O="";N.push(O)}return T.blankrows===!1&&A?null:N.join(S)}function Qf(c,d){var f=[],y=d??{};if(c==null||c["!ref"]==null)return"";var g=lr(c["!ref"]),x=y.FS!==void 0?y.FS:",",S=x.charCodeAt(0),T=y.RS!==void 0?y.RS:`
`,A=T.charCodeAt(0),N=new RegExp((x=="|"?"\\|":x)+"+$"),O="",F=[];y.dense=Array.isArray(c);for(var W=y.skipHidden&&c["!cols"]||[],H=y.skipHidden&&c["!rows"]||[],X=g.s.c;X<=g.e.c;++X)(W[X]||{}).hidden||(F[X]=Vi(X));for(var B=0,G=g.s.r;G<=g.e.r;++G)(H[G]||{}).hidden||(O=TT(c,g,G,F,S,A,x,y),O!=null&&(y.strip&&(O=O.replace(N,"")),(O||y.blankrows!==!1)&&f.push((B++?T:"")+O)));return delete y.dense,f.join("")}function og(c,d){d||(d={}),d.FS="	",d.RS=`
`;var f=Qf(c,d);if(typeof $cptable>"u"||d.type=="string")return f;var y=$cptable.utils.encode(1200,f,"str");return""+y}function _T(c){var d="",f,y="";if(c==null||c["!ref"]==null)return[];var g=lr(c["!ref"]),x="",S=[],T,A=[],N=Array.isArray(c);for(T=g.s.c;T<=g.e.c;++T)S[T]=Vi(T);for(var O=g.s.r;O<=g.e.r;++O)for(x=mi(O),T=g.s.c;T<=g.e.c;++T)if(d=S[T]+x,f=N?(c[O]||[])[T]:c[d],y="",f!==void 0){if(f.F!=null){if(d=f.F,!f.f)continue;y=f.f,d.indexOf(":")==-1&&(d=d+":"+d)}if(f.f!=null)y=f.f;else{if(f.t=="z")continue;if(f.t=="n"&&f.v!=null)y=""+f.v;else if(f.t=="b")y=f.v?"TRUE":"FALSE";else if(f.w!==void 0)y="'"+f.w;else{if(f.v===void 0)continue;f.t=="s"?y="'"+f.v:y=""+f.v}}A[A.length]=d+"="+y}return A}function sg(c,d,f){var y=f||{},g=+!y.skipHeader,x=c||{},S=0,T=0;if(x&&y.origin!=null)if(typeof y.origin=="number")S=y.origin;else{var A=typeof y.origin=="string"?Br(y.origin):y.origin;S=A.r,T=A.c}var N,O={s:{c:0,r:0},e:{c:T,r:S+d.length-1+g}};if(x["!ref"]){var F=lr(x["!ref"]);O.e.c=Math.max(O.e.c,F.e.c),O.e.r=Math.max(O.e.r,F.e.r),S==-1&&(S=F.e.r+1,O.e.r=S+d.length-1+g)}else S==-1&&(S=0,O.e.r=d.length-1+g);var W=y.header||[],H=0;d.forEach(function(B,G){$r(B).forEach(function(ie){(H=W.indexOf(ie))==-1&&(W[H=W.length]=ie);var ae=B[ie],de="z",we="",xe=er({c:T+H,r:S+G+g});N=Bs(x,xe),ae&&typeof ae=="object"&&!(ae instanceof Date)?x[xe]=ae:(typeof ae=="number"?de="n":typeof ae=="boolean"?de="b":typeof ae=="string"?de="s":ae instanceof Date?(de="d",y.cellDates||(de="n",ae=qr(ae)),we=y.dateNF||mt[14]):ae===null&&y.nullError&&(de="e",ae=0),N?(N.t=de,N.v=ae,delete N.w,delete N.R,we&&(N.z=we)):x[xe]=N={t:de,v:ae},we&&(N.z=we))})}),O.e.c=Math.max(O.e.c,T+W.length-1);var X=mi(S);if(g)for(H=0;H<W.length;++H)x[Vi(H+T)+X]={t:"s",v:W[H]};return x["!ref"]=sr(O),x}function RT(c,d){return sg(null,c,d)}function Bs(c,d,f){if(typeof d=="string"){if(Array.isArray(c)){var y=Br(d);return c[y.r]||(c[y.r]=[]),c[y.r][y.c]||(c[y.r][y.c]={t:"z"})}return c[d]||(c[d]={t:"z"})}return typeof d!="number"?Bs(c,er(d)):Bs(c,er({r:d,c:f||0}))}function LT(c,d){if(typeof d=="number"){if(d>=0&&c.SheetNames.length>d)return d;throw new Error("Cannot find sheet # "+d)}else if(typeof d=="string"){var f=c.SheetNames.indexOf(d);if(f>-1)return f;throw new Error("Cannot find sheet name |"+d+"|")}else throw new Error("Cannot find sheet |"+d+"|")}function MT(){return{SheetNames:[],Sheets:{}}}function OT(c,d,f,y){var g=1;if(!f)for(;g<=65535&&c.SheetNames.indexOf(f="Sheet"+g)!=-1;++g,f=void 0);if(!f||c.SheetNames.length>=65535)throw new Error("Too many worksheets");if(y&&c.SheetNames.indexOf(f)>=0){var x=f.match(/(^.*?)(\d+)$/);g=x&&+x[2]||0;var S=x&&x[1]||f;for(++g;g<=65535&&c.SheetNames.indexOf(f=S+g)!=-1;++g);}if(Hp(f),c.SheetNames.indexOf(f)>=0)throw new Error("Worksheet with name |"+f+"| already exists!");return c.SheetNames.push(f),c.Sheets[f]=d,f}function AT(c,d,f){c.Workbook||(c.Workbook={}),c.Workbook.Sheets||(c.Workbook.Sheets=[]);var y=LT(c,d);switch(c.Workbook.Sheets[y]||(c.Workbook.Sheets[y]={}),f){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+f)}c.Workbook.Sheets[y].Hidden=f}function NT(c,d){return c.z=d,c}function lg(c,d,f){return d?(c.l={Target:d},f&&(c.l.Tooltip=f)):delete c.l,c}function kT(c,d,f){return lg(c,"#"+d,f)}function IT(c,d,f){c.c||(c.c=[]),c.c.push({t:d,a:f||"SheetJS"})}function PT(c,d,f,y){for(var g=typeof d!="string"?d:lr(d),x=typeof d=="string"?d:sr(d),S=g.s.r;S<=g.e.r;++S)for(var T=g.s.c;T<=g.e.c;++T){var A=Bs(c,S,T);A.t="n",A.F=x,delete A.v,S==g.s.r&&T==g.s.c&&(A.f=f,y&&(A.D=!0))}return c}var DT={encode_col:Vi,encode_row:mi,encode_cell:er,encode_range:sr,decode_col:Mf,decode_row:Lf,split_cell:x2,decode_cell:Br,decode_range:Xi,format_cell:To,sheet_add_aoa:hp,sheet_add_json:sg,sheet_add_dom:Up,aoa_to_sheet:Ro,json_to_sheet:RT,table_to_sheet:Vp,table_to_book:tT,sheet_to_csv:Qf,sheet_to_txt:og,sheet_to_json:Jf,sheet_to_html:Gp,sheet_to_formulae:_T,sheet_to_row_object_array:Jf,sheet_get_cell:Bs,book_new:MT,book_append_sheet:OT,book_set_sheet_visibility:AT,cell_set_number_format:NT,cell_set_hyperlink:lg,cell_set_internal_link:kT,cell_add_comment:IT,sheet_set_array_formula:PT,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};if(typeof parse_xlscfb<"u"&&(i.parse_xlscfb=parse_xlscfb),i.parse_zip=Jp,i.read=lu,i.readFile=tg,i.readFileSync=tg,i.write=cu,i.writeFile=ig,i.writeFileSync=ig,i.writeFileAsync=ST,i.utils=DT,i.writeXLSX=Zf,i.writeFileXLSX=bT,i.SSF=N0,typeof __stream<"u"&&(i.stream=__stream),typeof kt<"u"&&(i.CFB=kt),typeof Eg<"u"){var ug=void 0;(ug||{}).Readable&&set_readable(ug.Readable)}}if(n(r),typeof window<"u"&&!window.XLSX)try{window.XLSX=e}catch{}})(Jd,Jd.exports);var ny=Jd.exports;function Rz(t,r){new Date().getTime();const e=new Uint8Array(t).buffer,{sheets:n,maxCols:i}=r.toLowerCase()==".csv"?Lz(e):Mz(e);return n.map(a=>{const o=a.rows;if(o.length<26)for(let l=o.length;l<22;l++)o.push({});const s=Array(i).fill(0).map((l,u)=>String.fromCharCode(65+u));return{name:a.name,fields:{columns:s},data:o,meta:s.map(l=>({field:l,formatter:u=>typeof u=="string"?u.replace(/\n/," "):u}))}})}function Lz(t){let r=26;const e={maxCols:r,sheets:[{name:"Sheet1",rows:[]}]};let n=new TextDecoder("utf-8").decode(t);if(!n)return e;try{n.includes(`
`)||(n+=`
`);const i=Tz(n,{header:()=>[]}),a=_z(i).stringArrs(n).map(o=>o.reduce((s,l,u)=>(s[String.fromCharCode(65+u)]=l,u>r&&(r=u),s),{}));return{maxCols:r,sheets:[{name:"Sheet1",rows:a}]}}catch(i){return console.error(i),{maxCols:r,sheets:[{name:"Sheet1",rows:[{A:i.message}]}]}}}function Mz(t){const r=ny.read(t,{type:"array"}),e=[];let n=26;return r.SheetNames.forEach(i=>{const a={name:i,rows:[]},o=r.Sheets[i],s=ny.utils.sheet_to_json(o,{raw:!1,header:1});a.rows=s.map(l=>l.reduce((u,h,v)=>(u[String.fromCharCode(65+v)]=h,v>n&&(n=v),u),{})),e.push(a)}),{sheets:e,maxCols:n}}function Fz(){const t=Ws.useRef(!0),r=Ws.useRef(null),e=Ws.useRef(null),[n,i]=Ws.useState([]);Ws.useEffect(()=>{const l=document.getElementById("container"),u=new sz(l,{fields:{columns:[]},data:[]},{...cz,width:window.innerWidth-10,height:window.innerHeight-50});JD("en_US"),u.setTheme(fz),e.current=u,window.onresize=()=>{u.changeSheetSize(window.innerWidth-10,window.innerHeight-50),u.render(!1)},t_.on("open",({path:h,ext:v})=>{console.log("Loading..."),fetch(h).then(p=>p.arrayBuffer()).then(p=>{const m=Rz(p,v);r.current=v,u.setDataCfg(m[0]),u.render(),t.current=!1,i(m)})}).emit("init")},[]);function a(l){const u=n[parseInt(l)],h=e.current;h.setDataCfg(u),h.render()}const o=n.map((l,u)=>({key:u.toString(),label:l.name})),s=r.current;return Gs.jsxs("div",{className:"excel-viewer",children:[Gs.jsx(n_,{spinning:t.current,fullscreen:!0}),Gs.jsx("div",{id:"container"}),Gs.jsx(i_,{items:o,onChange:a,tabBarGutter:20,style:{marginLeft:"30px"}}),s!=null&&s.match(/csv/i)?Gs.jsx(r_,{}):null]})}export{Fz as default};
